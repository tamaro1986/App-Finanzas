(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function bw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sd={exports:{}},Fo={};var ly;function S4(){if(ly)return Fo;ly=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(r,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:r,key:c,ref:s!==void 0?s:null,props:l}}return Fo.Fragment=t,Fo.jsx=a,Fo.jsxs=a,Fo}var oy;function E4(){return oy||(oy=1,Sd.exports=S4()),Sd.exports}var d=E4(),Ed={exports:{}},He={};var cy;function k4(){if(cy)return He;cy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=y&&G[y]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function A(G,O,Z){this.props=G,this.context=O,this.refs=T,this.updater=Z||_}A.prototype.isReactComponent={},A.prototype.setState=function(G,O){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,O,"setState")},A.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function k(){}k.prototype=A.prototype;function S(G,O,Z){this.props=G,this.context=O,this.refs=T,this.updater=Z||_}var L=S.prototype=new k;L.constructor=S,w(L,A.prototype),L.isPureReactComponent=!0;var V=Array.isArray;function P(){}var N={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function I(G,O,Z){var W=Z.ref;return{$$typeof:e,type:G,key:O,ref:W!==void 0?W:null,props:Z}}function z(G,O){return I(G.type,O,G.props)}function X(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function q(G){var O={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Z){return O[Z]})}var Q=/\/+/g;function be(G,O){return typeof G=="object"&&G!==null&&G.key!=null?q(""+G.key):O.toString(36)}function ve(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(P,P):(G.status="pending",G.then(function(O){G.status==="pending"&&(G.status="fulfilled",G.value=O)},function(O){G.status==="pending"&&(G.status="rejected",G.reason=O)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function R(G,O,Z,W,J){var he=typeof G;(he==="undefined"||he==="boolean")&&(G=null);var we=!1;if(G===null)we=!0;else switch(he){case"bigint":case"string":case"number":we=!0;break;case"object":switch(G.$$typeof){case e:case t:we=!0;break;case p:return we=G._init,R(we(G._payload),O,Z,W,J)}}if(we)return J=J(G),we=W===""?"."+be(G,0):W,V(J)?(Z="",we!=null&&(Z=we.replace(Q,"$&/")+"/"),R(J,O,Z,"",function(Se){return Se})):J!=null&&(X(J)&&(J=z(J,Z+(J.key==null||G&&G.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+we)),O.push(J)),1;we=0;var Ne=W===""?".":W+":";if(V(G))for(var _e=0;_e<G.length;_e++)W=G[_e],he=Ne+be(W,_e),we+=R(W,O,Z,he,J);else if(_e=b(G),typeof _e=="function")for(G=_e.call(G),_e=0;!(W=G.next()).done;)W=W.value,he=Ne+be(W,_e++),we+=R(W,O,Z,he,J);else if(he==="object"){if(typeof G.then=="function")return R(ve(G),O,Z,W,J);throw O=String(G),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return we}function te(G,O,Z){if(G==null)return G;var W=[],J=0;return R(G,W,"","",function(he){return O.call(Z,he,J++)}),W}function ye(G){if(G._status===-1){var O=G._result;O=O(),O.then(function(Z){(G._status===0||G._status===-1)&&(G._status=1,G._result=Z)},function(Z){(G._status===0||G._status===-1)&&(G._status=2,G._result=Z)}),G._status===-1&&(G._status=0,G._result=O)}if(G._status===1)return G._result.default;throw G._result}var ae=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},Ee={map:te,forEach:function(G,O,Z){te(G,function(){O.apply(this,arguments)},Z)},count:function(G){var O=0;return te(G,function(){O++}),O},toArray:function(G){return te(G,function(O){return O})||[]},only:function(G){if(!X(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return He.Activity=g,He.Children=Ee,He.Component=A,He.Fragment=a,He.Profiler=s,He.PureComponent=S,He.StrictMode=r,He.Suspense=h,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,He.__COMPILER_RUNTIME={__proto__:null,c:function(G){return N.H.useMemoCache(G)}},He.cache=function(G){return function(){return G.apply(null,arguments)}},He.cacheSignal=function(){return null},He.cloneElement=function(G,O,Z){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var W=w({},G.props),J=G.key;if(O!=null)for(he in O.key!==void 0&&(J=""+O.key),O)!j.call(O,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&O.ref===void 0||(W[he]=O[he]);var he=arguments.length-2;if(he===1)W.children=Z;else if(1<he){for(var we=Array(he),Ne=0;Ne<he;Ne++)we[Ne]=arguments[Ne+2];W.children=we}return I(G.type,J,W)},He.createContext=function(G){return G={$$typeof:c,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:l,_context:G},G},He.createElement=function(G,O,Z){var W,J={},he=null;if(O!=null)for(W in O.key!==void 0&&(he=""+O.key),O)j.call(O,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(J[W]=O[W]);var we=arguments.length-2;if(we===1)J.children=Z;else if(1<we){for(var Ne=Array(we),_e=0;_e<we;_e++)Ne[_e]=arguments[_e+2];J.children=Ne}if(G&&G.defaultProps)for(W in we=G.defaultProps,we)J[W]===void 0&&(J[W]=we[W]);return I(G,he,J)},He.createRef=function(){return{current:null}},He.forwardRef=function(G){return{$$typeof:u,render:G}},He.isValidElement=X,He.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:ye}},He.memo=function(G,O){return{$$typeof:m,type:G,compare:O===void 0?null:O}},He.startTransition=function(G){var O=N.T,Z={};N.T=Z;try{var W=G(),J=N.S;J!==null&&J(Z,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(P,ae)}catch(he){ae(he)}finally{O!==null&&Z.types!==null&&(O.types=Z.types),N.T=O}},He.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},He.use=function(G){return N.H.use(G)},He.useActionState=function(G,O,Z){return N.H.useActionState(G,O,Z)},He.useCallback=function(G,O){return N.H.useCallback(G,O)},He.useContext=function(G){return N.H.useContext(G)},He.useDebugValue=function(){},He.useDeferredValue=function(G,O){return N.H.useDeferredValue(G,O)},He.useEffect=function(G,O){return N.H.useEffect(G,O)},He.useEffectEvent=function(G){return N.H.useEffectEvent(G)},He.useId=function(){return N.H.useId()},He.useImperativeHandle=function(G,O,Z){return N.H.useImperativeHandle(G,O,Z)},He.useInsertionEffect=function(G,O){return N.H.useInsertionEffect(G,O)},He.useLayoutEffect=function(G,O){return N.H.useLayoutEffect(G,O)},He.useMemo=function(G,O){return N.H.useMemo(G,O)},He.useOptimistic=function(G,O){return N.H.useOptimistic(G,O)},He.useReducer=function(G,O,Z){return N.H.useReducer(G,O,Z)},He.useRef=function(G){return N.H.useRef(G)},He.useState=function(G){return N.H.useState(G)},He.useSyncExternalStore=function(G,O,Z){return N.H.useSyncExternalStore(G,O,Z)},He.useTransition=function(){return N.H.useTransition()},He.version="19.2.3",He}var uy;function lp(){return uy||(uy=1,Ed.exports=k4()),Ed.exports}var ie=lp();const A4=bw(ie);var kd={exports:{}},Lo={},Ad={exports:{}},Nd={};var fy;function N4(){return fy||(fy=1,(function(e){function t(R,te){var ye=R.length;R.push(te);e:for(;0<ye;){var ae=ye-1>>>1,Ee=R[ae];if(0<s(Ee,te))R[ae]=te,R[ye]=Ee,ye=ae;else break e}}function a(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var te=R[0],ye=R.pop();if(ye!==te){R[0]=ye;e:for(var ae=0,Ee=R.length,G=Ee>>>1;ae<G;){var O=2*(ae+1)-1,Z=R[O],W=O+1,J=R[W];if(0>s(Z,ye))W<Ee&&0>s(J,Z)?(R[ae]=J,R[W]=ye,ae=W):(R[ae]=Z,R[O]=ye,ae=O);else if(W<Ee&&0>s(J,ye))R[ae]=J,R[W]=ye,ae=W;else break e}}return te}function s(R,te){var ye=R.sortIndex-te.sortIndex;return ye!==0?ye:R.id-te.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],m=[],p=1,g=null,y=3,b=!1,_=!1,w=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function L(R){for(var te=a(m);te!==null;){if(te.callback===null)r(m);else if(te.startTime<=R)r(m),te.sortIndex=te.expirationTime,t(h,te);else break;te=a(m)}}function V(R){if(w=!1,L(R),!_)if(a(h)!==null)_=!0,P||(P=!0,q());else{var te=a(m);te!==null&&ve(V,te.startTime-R)}}var P=!1,N=-1,j=5,I=-1;function z(){return T?!0:!(e.unstable_now()-I<j)}function X(){if(T=!1,P){var R=e.unstable_now();I=R;var te=!0;try{e:{_=!1,w&&(w=!1,k(N),N=-1),b=!0;var ye=y;try{t:{for(L(R),g=a(h);g!==null&&!(g.expirationTime>R&&z());){var ae=g.callback;if(typeof ae=="function"){g.callback=null,y=g.priorityLevel;var Ee=ae(g.expirationTime<=R);if(R=e.unstable_now(),typeof Ee=="function"){g.callback=Ee,L(R),te=!0;break t}g===a(h)&&r(h),L(R)}else r(h);g=a(h)}if(g!==null)te=!0;else{var G=a(m);G!==null&&ve(V,G.startTime-R),te=!1}}break e}finally{g=null,y=ye,b=!1}te=void 0}}finally{te?q():P=!1}}}var q;if(typeof S=="function")q=function(){S(X)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,be=Q.port2;Q.port1.onmessage=X,q=function(){be.postMessage(null)}}else q=function(){A(X,0)};function ve(R,te){N=A(function(){R(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(R){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var ye=y;y=te;try{return R()}finally{y=ye}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(R,te){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var ye=y;y=R;try{return te()}finally{y=ye}},e.unstable_scheduleCallback=function(R,te,ye){var ae=e.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?ae+ye:ae):ye=ae,R){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ye+Ee,R={id:p++,callback:te,priorityLevel:R,startTime:ye,expirationTime:Ee,sortIndex:-1},ye>ae?(R.sortIndex=ye,t(m,R),a(h)===null&&R===a(m)&&(w?(k(N),N=-1):w=!0,ve(V,ye-ae))):(R.sortIndex=Ee,t(h,R),_||b||(_=!0,P||(P=!0,q()))),R},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(R){var te=y;return function(){var ye=y;y=te;try{return R.apply(this,arguments)}finally{y=ye}}}})(Nd)),Nd}var hy;function C4(){return hy||(hy=1,Ad.exports=N4()),Ad.exports}var Cd={exports:{}},Ta={};var dy;function O4(){if(dy)return Ta;dy=1;var e=lp();function t(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var r={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,m,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:h,containerInfo:m,implementation:p}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ta.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(h,m,null,p)},Ta.flushSync=function(h){var m=c.T,p=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=m,r.p=p,r.d.f()}},Ta.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},Ta.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Ta.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,g=u(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:b}):p==="script"&&r.d.X(h,{crossOrigin:g,integrity:y,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Ta.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},Ta.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,g=u(p,m.crossOrigin);r.d.L(h,p,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Ta.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},Ta.requestFormReset=function(h){r.d.r(h)},Ta.unstable_batchedUpdates=function(h,m){return h(m)},Ta.useFormState=function(h,m,p){return c.H.useFormState(h,m,p)},Ta.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ta.version="19.2.3",Ta}var my;function D4(){if(my)return Cd.exports;my=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Cd.exports=O4(),Cd.exports}var py;function j4(){if(py)return Lo;py=1;var e=C4(),t=lp(),a=D4();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(r(188))}function m(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var o=n,f=i;;){var x=o.return;if(x===null)break;var v=x.alternate;if(v===null){if(f=x.return,f!==null){o=f;continue}break}if(x.child===v.child){for(v=x.child;v;){if(v===o)return h(x),n;if(v===f)return h(x),i;v=v.sibling}throw Error(r(188))}if(o.return!==f.return)o=x,f=v;else{for(var E=!1,D=x.child;D;){if(D===o){E=!0,o=x,f=v;break}if(D===f){E=!0,f=x,o=v;break}D=D.sibling}if(!E){for(D=v.child;D;){if(D===o){E=!0,o=v,f=x;break}if(D===f){E=!0,f=v,o=x;break}D=D.sibling}if(!E)throw Error(r(189))}}if(o.alternate!==f)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:i}function p(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=p(n),i!==null)return i;n=n.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),S=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function q(n){return n===null||typeof n!="object"?null:(n=X&&n[X]||n["@@iterator"],typeof n=="function"?n:null)}var Q=Symbol.for("react.client.reference");function be(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Q?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case V:return"Suspense";case P:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case S:return n.displayName||"Context";case k:return(n._context.displayName||"Context")+".Consumer";case L:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return i=n.displayName||null,i!==null?i:be(n.type)||"Memo";case j:i=n._payload,n=n._init;try{return be(n(i))}catch{}}return null}var ve=Array.isArray,R=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},ae=[],Ee=-1;function G(n){return{current:n}}function O(n){0>Ee||(n.current=ae[Ee],ae[Ee]=null,Ee--)}function Z(n,i){Ee++,ae[Ee]=n.current,n.current=i}var W=G(null),J=G(null),he=G(null),we=G(null);function Ne(n,i){switch(Z(he,i),Z(J,n),Z(W,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?Ov(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=Ov(i),n=Dv(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}O(W),Z(W,n)}function _e(){O(W),O(J),O(he)}function Se(n){n.memoizedState!==null&&Z(we,n);var i=W.current,o=Dv(i,n.type);i!==o&&(Z(J,n),Z(W,o))}function Je(n){J.current===n&&(O(W),O(J)),we.current===n&&(O(we),Do._currentValue=ye)}var Y,Nt;function Ke(n){if(Y===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Y=i&&i[1]||"",Nt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Y+n+Nt}var ct=!1;function We(n,i){if(!n||ct)return"";ct=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(de){var ue=de}Reflect.construct(n,[],ge)}else{try{ge.call()}catch(de){ue=de}n.call(ge.prototype)}}else{try{throw Error()}catch(de){ue=de}(ge=n())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(de){if(de&&ue&&typeof de.stack=="string")return[de.stack,ue.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),E=v[0],D=v[1];if(E&&D){var K=E.split(`
`),se=D.split(`
`);for(x=f=0;f<K.length&&!K[f].includes("DetermineComponentFrameRoot");)f++;for(;x<se.length&&!se[x].includes("DetermineComponentFrameRoot");)x++;if(f===K.length||x===se.length)for(f=K.length-1,x=se.length-1;1<=f&&0<=x&&K[f]!==se[x];)x--;for(;1<=f&&0<=x;f--,x--)if(K[f]!==se[x]){if(f!==1||x!==1)do if(f--,x--,0>x||K[f]!==se[x]){var me=`
`+K[f].replace(" at new "," at ");return n.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",n.displayName)),me}while(1<=f&&0<=x);break}}}finally{ct=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Ke(o):""}function Oe(n,i){switch(n.tag){case 26:case 27:case 5:return Ke(n.type);case 16:return Ke("Lazy");case 13:return n.child!==i&&i!==null?Ke("Suspense Fallback"):Ke("Suspense");case 19:return Ke("SuspenseList");case 0:case 15:return We(n.type,!1);case 11:return We(n.type.render,!1);case 1:return We(n.type,!0);case 31:return Ke("Activity");default:return""}}function Ct(n){try{var i="",o=null;do i+=Oe(n,o),o=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var _a=Object.prototype.hasOwnProperty,Va=e.unstable_scheduleCallback,Qa=e.unstable_cancelCallback,Ms=e.unstable_shouldYield,en=e.unstable_requestPaint,gt=e.unstable_now,Fr=e.unstable_getCurrentPriorityLevel,Lr=e.unstable_ImmediatePriority,qn=e.unstable_UserBlockingPriority,qt=e.unstable_NormalPriority,dr=e.unstable_LowPriority,Ye=e.unstable_IdlePriority,Rt=e.log,Ha=e.unstable_setDisableYieldValue,St=null,Vt=null;function Pr(n){if(typeof Rt=="function"&&Ha(n),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(St,n)}catch{}}var Ra=Math.clz32?Math.clz32:Hc,mf=Math.log,Vc=Math.LN2;function Hc(n){return n>>>=0,n===0?32:31-(mf(n)/Vc|0)|0}var Fs=256,ki=262144,Ai=4194304;function mr(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ni(n,i,o){var f=n.pendingLanes;if(f===0)return 0;var x=0,v=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var D=f&134217727;return D!==0?(f=D&~v,f!==0?x=mr(f):(E&=D,E!==0?x=mr(E):o||(o=D&~n,o!==0&&(x=mr(o))))):(D=f&~v,D!==0?x=mr(D):E!==0?x=mr(E):o||(o=f&~n,o!==0&&(x=mr(o)))),x===0?0:i!==0&&i!==x&&(i&v)===0&&(v=x&-x,o=i&-i,v>=o||v===32&&(o&4194048)!==0)?i:x}function Ls(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function pf(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $c(){var n=Ai;return Ai<<=1,(Ai&62914560)===0&&(Ai=4194304),n}function Hl(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Ps(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function xf(n,i,o,f,x,v){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var D=n.entanglements,K=n.expirationTimes,se=n.hiddenUpdates;for(o=E&~o;0<o;){var me=31-Ra(o),ge=1<<me;D[me]=0,K[me]=-1;var ue=se[me];if(ue!==null)for(se[me]=null,me=0;me<ue.length;me++){var de=ue[me];de!==null&&(de.lane&=-536870913)}o&=~ge}f!==0&&Gc(n,f,0),v!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=v&~(E&~i))}function Gc(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-Ra(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|o&261930}function Ci(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var f=31-Ra(o),x=1<<f;x&i|n[f]&i&&(n[f]|=i),o&=~x}}function qc(n,i){var o=i&-i;return o=(o&42)!==0?1:$l(o),(o&(n.suspendedLanes|i))!==0?0:o}function $l(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Gl(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function C(){var n=te.p;return n!==0?n:(n=window.event,n===void 0?32:ey(n.type))}function U(n,i){var o=te.p;try{return te.p=n,i()}finally{te.p=o}}var M=Math.random().toString(36).slice(2),F="__reactFiber$"+M,B="__reactProps$"+M,H="__reactContainer$"+M,le="__reactEvents$"+M,pe="__reactListeners$"+M,oe="__reactHandles$"+M,ce="__reactResources$"+M,fe="__reactMarker$"+M;function Te(n){delete n[F],delete n[B],delete n[le],delete n[pe],delete n[oe]}function Ae(n){var i=n[F];if(i)return i;for(var o=n.parentNode;o;){if(i=o[H]||o[F]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=Iv(n);n!==null;){if(o=n[F])return o;n=Iv(n)}return i}n=o,o=n.parentNode}return null}function De(n){if(n=n[F]||n[H]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function ke(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function Ce(n){var i=n[ce];return i||(i=n[ce]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Me(n){n[fe]=!0}var bt=new Set,wt={};function Ot(n,i){pr(n,i),pr(n+"Capture",i)}function pr(n,i){for(wt[n]=i,n=0;n<i.length;n++)bt.add(i[n])}var Is=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wn={},tn={};function ql(n){return _a.call(tn,n)?!0:_a.call(Wn,n)?!1:Is.test(n)?tn[n]=!0:(Wn[n]=!0,!1)}function $a(n,i,o){if(ql(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function Wc(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function vn(n,i,o,f){if(f===null)n.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+f)}}function xr(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function _x(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function gE(n,i,o){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,v=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return x.call(this)},set:function(E){o=""+E,v.call(this,E)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function gf(n){if(!n._valueTracker){var i=_x(n)?"checked":"value";n._valueTracker=gE(n,i,""+n[i])}}function Tx(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),f="";return n&&(f=_x(n)?n.checked?"true":"false":n.value),n=f,n!==o?(i.setValue(n),!0):!1}function Yc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var vE=/[\n"\\]/g;function gr(n){return n.replace(vE,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function vf(n,i,o,f,x,v,E,D){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),i!=null?E==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+xr(i)):n.value!==""+xr(i)&&(n.value=""+xr(i)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),i!=null?yf(n,E,xr(i)):o!=null?yf(n,E,xr(o)):f!=null&&n.removeAttribute("value"),x==null&&v!=null&&(n.defaultChecked=!!v),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?n.name=""+xr(D):n.removeAttribute("name")}function Sx(n,i,o,f,x,v,E,D){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.type=v),i!=null||o!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){gf(n);return}o=o!=null?""+xr(o):"",i=i!=null?""+xr(i):o,D||i===n.value||(n.value=i),n.defaultValue=i}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=D?n.checked:!!f,n.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E),gf(n)}function yf(n,i,o){i==="number"&&Yc(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Oi(n,i,o,f){if(n=n.options,i){i={};for(var x=0;x<o.length;x++)i["$"+o[x]]=!0;for(o=0;o<n.length;o++)x=i.hasOwnProperty("$"+n[o].value),n[o].selected!==x&&(n[o].selected=x),x&&f&&(n[o].defaultSelected=!0)}else{for(o=""+xr(o),i=null,x=0;x<n.length;x++){if(n[x].value===o){n[x].selected=!0,f&&(n[x].defaultSelected=!0);return}i!==null||n[x].disabled||(i=n[x])}i!==null&&(i.selected=!0)}}function Ex(n,i,o){if(i!=null&&(i=""+xr(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+xr(o):""}function kx(n,i,o,f){if(i==null){if(f!=null){if(o!=null)throw Error(r(92));if(ve(f)){if(1<f.length)throw Error(r(93));f=f[0]}o=f}o==null&&(o=""),i=o}o=xr(i),n.defaultValue=o,f=n.textContent,f===o&&f!==""&&f!==null&&(n.value=f),gf(n)}function Di(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var yE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ax(n,i,o){var f=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,o):typeof o!="number"||o===0||yE.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Nx(n,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var x in i)f=i[x],i.hasOwnProperty(x)&&o[x]!==f&&Ax(n,x,f)}else for(var v in i)i.hasOwnProperty(v)&&Ax(n,v,i[v])}function bf(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xc(n){return wE.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function yn(){}var wf=null;function _f(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ji=null,Ri=null;function Cx(n){var i=De(n);if(i&&(n=i.stateNode)){var o=n[B]||null;e:switch(n=i.stateNode,i.type){case"input":if(vf(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+gr(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var f=o[i];if(f!==n&&f.form===n.form){var x=f[B]||null;if(!x)throw Error(r(90));vf(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<o.length;i++)f=o[i],f.form===n.form&&Tx(f)}break e;case"textarea":Ex(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Oi(n,!!o.multiple,i,!1)}}}var Tf=!1;function Ox(n,i,o){if(Tf)return n(i,o);Tf=!0;try{var f=n(i);return f}finally{if(Tf=!1,(ji!==null||Ri!==null)&&(Lu(),ji&&(i=ji,n=Ri,Ri=ji=null,Cx(i),n)))for(i=0;i<n.length;i++)Cx(n[i])}}function Wl(n,i){var o=n.stateNode;if(o===null)return null;var f=o[B]||null;if(f===null)return null;o=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sf=!1;if(bn)try{var Yl={};Object.defineProperty(Yl,"passive",{get:function(){Sf=!0}}),window.addEventListener("test",Yl,Yl),window.removeEventListener("test",Yl,Yl)}catch{Sf=!1}var Yn=null,Ef=null,Kc=null;function Dx(){if(Kc)return Kc;var n,i=Ef,o=i.length,f,x="value"in Yn?Yn.value:Yn.textContent,v=x.length;for(n=0;n<o&&i[n]===x[n];n++);var E=o-n;for(f=1;f<=E&&i[o-f]===x[v-f];f++);return Kc=x.slice(n,1<f?1-f:void 0)}function Jc(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Qc(){return!0}function jx(){return!1}function Ga(n){function i(o,f,x,v,E){this._reactName=o,this._targetInst=x,this.type=f,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var D in n)n.hasOwnProperty(D)&&(o=n[D],this[D]=o?o(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Qc:jx,this.isPropagationStopped=jx,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Qc)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Qc)},persist:function(){},isPersistent:Qc}),i}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zc=Ga(Bs),Xl=g({},Bs,{view:0,detail:0}),_E=Ga(Xl),kf,Af,Kl,eu=g({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Kl&&(Kl&&n.type==="mousemove"?(kf=n.screenX-Kl.screenX,Af=n.screenY-Kl.screenY):Af=kf=0,Kl=n),kf)},movementY:function(n){return"movementY"in n?n.movementY:Af}}),Rx=Ga(eu),TE=g({},eu,{dataTransfer:0}),SE=Ga(TE),EE=g({},Xl,{relatedTarget:0}),Nf=Ga(EE),kE=g({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),AE=Ga(kE),NE=g({},Bs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),CE=Ga(NE),OE=g({},Bs,{data:0}),Mx=Ga(OE),DE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ME(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=RE[n])?!!i[n]:!1}function Cf(){return ME}var FE=g({},Xl,{key:function(n){if(n.key){var i=DE[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Jc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?jE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(n){return n.type==="keypress"?Jc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Jc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),LE=Ga(FE),PE=g({},eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fx=Ga(PE),IE=g({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),BE=Ga(IE),UE=g({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),zE=Ga(UE),VE=g({},eu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),HE=Ga(VE),$E=g({},Bs,{newState:0,oldState:0}),GE=Ga($E),qE=[9,13,27,32],Of=bn&&"CompositionEvent"in window,Jl=null;bn&&"documentMode"in document&&(Jl=document.documentMode);var WE=bn&&"TextEvent"in window&&!Jl,Lx=bn&&(!Of||Jl&&8<Jl&&11>=Jl),Px=" ",Ix=!1;function Bx(n,i){switch(n){case"keyup":return qE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ux(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Mi=!1;function YE(n,i){switch(n){case"compositionend":return Ux(i);case"keypress":return i.which!==32?null:(Ix=!0,Px);case"textInput":return n=i.data,n===Px&&Ix?null:n;default:return null}}function XE(n,i){if(Mi)return n==="compositionend"||!Of&&Bx(n,i)?(n=Dx(),Kc=Ef=Yn=null,Mi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Lx&&i.locale!=="ko"?null:i.data;default:return null}}var KE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zx(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!KE[n.type]:i==="textarea"}function Vx(n,i,o,f){ji?Ri?Ri.push(f):Ri=[f]:ji=f,i=Hu(i,"onChange"),0<i.length&&(o=new Zc("onChange","change",null,o,f),n.push({event:o,listeners:i}))}var Ql=null,Zl=null;function JE(n){Sv(n,0)}function tu(n){var i=ke(n);if(Tx(i))return n}function Hx(n,i){if(n==="change")return i}var $x=!1;if(bn){var Df;if(bn){var jf="oninput"in document;if(!jf){var Gx=document.createElement("div");Gx.setAttribute("oninput","return;"),jf=typeof Gx.oninput=="function"}Df=jf}else Df=!1;$x=Df&&(!document.documentMode||9<document.documentMode)}function qx(){Ql&&(Ql.detachEvent("onpropertychange",Wx),Zl=Ql=null)}function Wx(n){if(n.propertyName==="value"&&tu(Zl)){var i=[];Vx(i,Zl,n,_f(n)),Ox(JE,i)}}function QE(n,i,o){n==="focusin"?(qx(),Ql=i,Zl=o,Ql.attachEvent("onpropertychange",Wx)):n==="focusout"&&qx()}function ZE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tu(Zl)}function ek(n,i){if(n==="click")return tu(i)}function tk(n,i){if(n==="input"||n==="change")return tu(i)}function ak(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Za=typeof Object.is=="function"?Object.is:ak;function eo(n,i){if(Za(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),f=Object.keys(i);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var x=o[f];if(!_a.call(i,x)||!Za(n[x],i[x]))return!1}return!0}function Yx(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Xx(n,i){var o=Yx(n);n=0;for(var f;o;){if(o.nodeType===3){if(f=n+o.textContent.length,n<=i&&f>=i)return{node:o,offset:i-n};n=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Yx(o)}}function Kx(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Kx(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Jx(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Yc(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=Yc(n.document)}return i}function Rf(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var rk=bn&&"documentMode"in document&&11>=document.documentMode,Fi=null,Mf=null,to=null,Ff=!1;function Qx(n,i,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ff||Fi==null||Fi!==Yc(f)||(f=Fi,"selectionStart"in f&&Rf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),to&&eo(to,f)||(to=f,f=Hu(Mf,"onSelect"),0<f.length&&(i=new Zc("onSelect","select",null,i,o),n.push({event:i,listeners:f}),i.target=Fi)))}function Us(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var Li={animationend:Us("Animation","AnimationEnd"),animationiteration:Us("Animation","AnimationIteration"),animationstart:Us("Animation","AnimationStart"),transitionrun:Us("Transition","TransitionRun"),transitionstart:Us("Transition","TransitionStart"),transitioncancel:Us("Transition","TransitionCancel"),transitionend:Us("Transition","TransitionEnd")},Lf={},Zx={};bn&&(Zx=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function zs(n){if(Lf[n])return Lf[n];if(!Li[n])return n;var i=Li[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in Zx)return Lf[n]=i[o];return n}var e1=zs("animationend"),t1=zs("animationiteration"),a1=zs("animationstart"),nk=zs("transitionrun"),sk=zs("transitionstart"),ik=zs("transitioncancel"),r1=zs("transitionend"),n1=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function Ir(n,i){n1.set(n,i),Ot(i,[n])}var au=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},vr=[],Pi=0,If=0;function ru(){for(var n=Pi,i=If=Pi=0;i<n;){var o=vr[i];vr[i++]=null;var f=vr[i];vr[i++]=null;var x=vr[i];vr[i++]=null;var v=vr[i];if(vr[i++]=null,f!==null&&x!==null){var E=f.pending;E===null?x.next=x:(x.next=E.next,E.next=x),f.pending=x}v!==0&&s1(o,x,v)}}function nu(n,i,o,f){vr[Pi++]=n,vr[Pi++]=i,vr[Pi++]=o,vr[Pi++]=f,If|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function Bf(n,i,o,f){return nu(n,i,o,f),su(n)}function Vs(n,i){return nu(n,null,null,i),su(n)}function s1(n,i,o){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o);for(var x=!1,v=n.return;v!==null;)v.childLanes|=o,f=v.alternate,f!==null&&(f.childLanes|=o),v.tag===22&&(n=v.stateNode,n===null||n._visibility&1||(x=!0)),n=v,v=v.return;return n.tag===3?(v=n.stateNode,x&&i!==null&&(x=31-Ra(o),n=v.hiddenUpdates,f=n[x],f===null?n[x]=[i]:f.push(i),i.lane=o|536870912),v):null}function su(n){if(50<So)throw So=0,Yh=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Ii={};function lk(n,i,o,f){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(n,i,o,f){return new lk(n,i,o,f)}function Uf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function wn(n,i){var o=n.alternate;return o===null?(o=er(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function i1(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function iu(n,i,o,f,x,v){var E=0;if(f=n,typeof n=="function")Uf(n)&&(E=1);else if(typeof n=="string")E=h4(n,o,W.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=er(31,o,i,x),n.elementType=I,n.lanes=v,n;case w:return Hs(o.children,x,v,i);case T:E=8,x|=24;break;case A:return n=er(12,o,i,x|2),n.elementType=A,n.lanes=v,n;case V:return n=er(13,o,i,x),n.elementType=V,n.lanes=v,n;case P:return n=er(19,o,i,x),n.elementType=P,n.lanes=v,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case S:E=10;break e;case k:E=9;break e;case L:E=11;break e;case N:E=14;break e;case j:E=16,f=null;break e}E=29,o=Error(r(130,n===null?"null":typeof n,"")),f=null}return i=er(E,o,i,x),i.elementType=n,i.type=f,i.lanes=v,i}function Hs(n,i,o,f){return n=er(7,n,f,i),n.lanes=o,n}function zf(n,i,o){return n=er(6,n,null,i),n.lanes=o,n}function l1(n){var i=er(18,null,null,0);return i.stateNode=n,i}function Vf(n,i,o){return i=er(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var o1=new WeakMap;function yr(n,i){if(typeof n=="object"&&n!==null){var o=o1.get(n);return o!==void 0?o:(i={value:n,source:i,stack:Ct(i)},o1.set(n,i),i)}return{value:n,source:i,stack:Ct(i)}}var Bi=[],Ui=0,lu=null,ao=0,br=[],wr=0,Xn=null,an=1,rn="";function _n(n,i){Bi[Ui++]=ao,Bi[Ui++]=lu,lu=n,ao=i}function c1(n,i,o){br[wr++]=an,br[wr++]=rn,br[wr++]=Xn,Xn=n;var f=an;n=rn;var x=32-Ra(f)-1;f&=~(1<<x),o+=1;var v=32-Ra(i)+x;if(30<v){var E=x-x%5;v=(f&(1<<E)-1).toString(32),f>>=E,x-=E,an=1<<32-Ra(i)+x|o<<x|f,rn=v+n}else an=1<<v|o<<x|f,rn=n}function Hf(n){n.return!==null&&(_n(n,1),c1(n,1,0))}function $f(n){for(;n===lu;)lu=Bi[--Ui],Bi[Ui]=null,ao=Bi[--Ui],Bi[Ui]=null;for(;n===Xn;)Xn=br[--wr],br[wr]=null,rn=br[--wr],br[wr]=null,an=br[--wr],br[wr]=null}function u1(n,i){br[wr++]=an,br[wr++]=rn,br[wr++]=Xn,an=i.id,rn=i.overflow,Xn=n}var fa=null,Et=null,at=!1,Kn=null,_r=!1,Gf=Error(r(519));function Jn(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ro(yr(i,n)),Gf}function f1(n){var i=n.stateNode,o=n.type,f=n.memoizedProps;switch(i[F]=n,i[B]=f,o){case"dialog":Ze("cancel",i),Ze("close",i);break;case"iframe":case"object":case"embed":Ze("load",i);break;case"video":case"audio":for(o=0;o<ko.length;o++)Ze(ko[o],i);break;case"source":Ze("error",i);break;case"img":case"image":case"link":Ze("error",i),Ze("load",i);break;case"details":Ze("toggle",i);break;case"input":Ze("invalid",i),Sx(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ze("invalid",i);break;case"textarea":Ze("invalid",i),kx(i,f.value,f.defaultValue,f.children)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||f.suppressHydrationWarning===!0||Nv(i.textContent,o)?(f.popover!=null&&(Ze("beforetoggle",i),Ze("toggle",i)),f.onScroll!=null&&Ze("scroll",i),f.onScrollEnd!=null&&Ze("scrollend",i),f.onClick!=null&&(i.onclick=yn),i=!0):i=!1,i||Jn(n,!0)}function h1(n){for(fa=n.return;fa;)switch(fa.tag){case 5:case 31:case 13:_r=!1;return;case 27:case 3:_r=!0;return;default:fa=fa.return}}function zi(n){if(n!==fa)return!1;if(!at)return h1(n),at=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||cd(n.type,n.memoizedProps)),o=!o),o&&Et&&Jn(n),h1(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=Pv(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=Pv(n)}else i===27?(i=Et,fs(n.type)?(n=md,md=null,Et=n):Et=i):Et=fa?Sr(n.stateNode.nextSibling):null;return!0}function $s(){Et=fa=null,at=!1}function qf(){var n=Kn;return n!==null&&(Xa===null?Xa=n:Xa.push.apply(Xa,n),Kn=null),n}function ro(n){Kn===null?Kn=[n]:Kn.push(n)}var Wf=G(null),Gs=null,Tn=null;function Qn(n,i,o){Z(Wf,i._currentValue),i._currentValue=o}function Sn(n){n._currentValue=Wf.current,O(Wf)}function Yf(n,i,o){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===o)break;n=n.return}}function Xf(n,i,o,f){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var v=x.dependencies;if(v!==null){var E=x.child;v=v.firstContext;e:for(;v!==null;){var D=v;v=x;for(var K=0;K<i.length;K++)if(D.context===i[K]){v.lanes|=o,D=v.alternate,D!==null&&(D.lanes|=o),Yf(v.return,o,n),f||(E=null);break e}v=D.next}}else if(x.tag===18){if(E=x.return,E===null)throw Error(r(341));E.lanes|=o,v=E.alternate,v!==null&&(v.lanes|=o),Yf(E,o,n),E=null}else E=x.child;if(E!==null)E.return=x;else for(E=x;E!==null;){if(E===n){E=null;break}if(x=E.sibling,x!==null){x.return=E.return,E=x;break}E=E.return}x=E}}function Vi(n,i,o,f){n=null;for(var x=i,v=!1;x!==null;){if(!v){if((x.flags&524288)!==0)v=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var E=x.alternate;if(E===null)throw Error(r(387));if(E=E.memoizedProps,E!==null){var D=x.type;Za(x.pendingProps.value,E.value)||(n!==null?n.push(D):n=[D])}}else if(x===we.current){if(E=x.alternate,E===null)throw Error(r(387));E.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(Do):n=[Do])}x=x.return}n!==null&&Xf(i,n,o,f),i.flags|=262144}function ou(n){for(n=n.firstContext;n!==null;){if(!Za(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function qs(n){Gs=n,Tn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ha(n){return d1(Gs,n)}function cu(n,i){return Gs===null&&qs(n),d1(n,i)}function d1(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Tn===null){if(n===null)throw Error(r(308));Tn=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Tn=Tn.next=i;return o}var ok=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},ck=e.unstable_scheduleCallback,uk=e.unstable_NormalPriority,Wt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new ok,data:new Map,refCount:0}}function no(n){n.refCount--,n.refCount===0&&ck(uk,function(){n.controller.abort()})}var so=null,Jf=0,Hi=0,$i=null;function fk(n,i){if(so===null){var o=so=[];Jf=0,Hi=ed(),$i={status:"pending",value:void 0,then:function(f){o.push(f)}}}return Jf++,i.then(m1,m1),i}function m1(){if(--Jf===0&&so!==null){$i!==null&&($i.status="fulfilled");var n=so;so=null,Hi=0,$i=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function hk(n,i){var o=[],f={status:"pending",value:null,reason:null,then:function(x){o.push(x)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var x=0;x<o.length;x++)(0,o[x])(i)},function(x){for(f.status="rejected",f.reason=x,x=0;x<o.length;x++)(0,o[x])(void 0)}),f}var p1=R.S;R.S=function(n,i){Qg=gt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&fk(n,i),p1!==null&&p1(n,i)};var Ws=G(null);function Qf(){var n=Ws.current;return n!==null?n:vt.pooledCache}function uu(n,i){i===null?Z(Ws,Ws.current):Z(Ws,i.pool)}function x1(){var n=Qf();return n===null?null:{parent:Wt._currentValue,pool:n}}var Gi=Error(r(460)),Zf=Error(r(474)),fu=Error(r(542)),hu={then:function(){}};function g1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function v1(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(yn,yn),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,b1(n),n;default:if(typeof i.status=="string")i.then(yn,yn);else{if(n=vt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=f}},function(f){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,b1(n),n}throw Xs=i,Gi}}function Ys(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Xs=o,Gi):o}}var Xs=null;function y1(){if(Xs===null)throw Error(r(459));var n=Xs;return Xs=null,n}function b1(n){if(n===Gi||n===fu)throw Error(r(483))}var qi=null,io=0;function du(n){var i=io;return io+=1,qi===null&&(qi=[]),v1(qi,n,i)}function lo(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function mu(n,i){throw i.$$typeof===y?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function w1(n){function i(re,ee){if(n){var ne=re.deletions;ne===null?(re.deletions=[ee],re.flags|=16):ne.push(ee)}}function o(re,ee){if(!n)return null;for(;ee!==null;)i(re,ee),ee=ee.sibling;return null}function f(re){for(var ee=new Map;re!==null;)re.key!==null?ee.set(re.key,re):ee.set(re.index,re),re=re.sibling;return ee}function x(re,ee){return re=wn(re,ee),re.index=0,re.sibling=null,re}function v(re,ee,ne){return re.index=ne,n?(ne=re.alternate,ne!==null?(ne=ne.index,ne<ee?(re.flags|=67108866,ee):ne):(re.flags|=67108866,ee)):(re.flags|=1048576,ee)}function E(re){return n&&re.alternate===null&&(re.flags|=67108866),re}function D(re,ee,ne,xe){return ee===null||ee.tag!==6?(ee=zf(ne,re.mode,xe),ee.return=re,ee):(ee=x(ee,ne),ee.return=re,ee)}function K(re,ee,ne,xe){var Ie=ne.type;return Ie===w?me(re,ee,ne.props.children,xe,ne.key):ee!==null&&(ee.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===j&&Ys(Ie)===ee.type)?(ee=x(ee,ne.props),lo(ee,ne),ee.return=re,ee):(ee=iu(ne.type,ne.key,ne.props,null,re.mode,xe),lo(ee,ne),ee.return=re,ee)}function se(re,ee,ne,xe){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ne.containerInfo||ee.stateNode.implementation!==ne.implementation?(ee=Vf(ne,re.mode,xe),ee.return=re,ee):(ee=x(ee,ne.children||[]),ee.return=re,ee)}function me(re,ee,ne,xe,Ie){return ee===null||ee.tag!==7?(ee=Hs(ne,re.mode,xe,Ie),ee.return=re,ee):(ee=x(ee,ne),ee.return=re,ee)}function ge(re,ee,ne){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=zf(""+ee,re.mode,ne),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:return ne=iu(ee.type,ee.key,ee.props,null,re.mode,ne),lo(ne,ee),ne.return=re,ne;case _:return ee=Vf(ee,re.mode,ne),ee.return=re,ee;case j:return ee=Ys(ee),ge(re,ee,ne)}if(ve(ee)||q(ee))return ee=Hs(ee,re.mode,ne,null),ee.return=re,ee;if(typeof ee.then=="function")return ge(re,du(ee),ne);if(ee.$$typeof===S)return ge(re,cu(re,ee),ne);mu(re,ee)}return null}function ue(re,ee,ne,xe){var Ie=ee!==null?ee.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Ie!==null?null:D(re,ee,""+ne,xe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return ne.key===Ie?K(re,ee,ne,xe):null;case _:return ne.key===Ie?se(re,ee,ne,xe):null;case j:return ne=Ys(ne),ue(re,ee,ne,xe)}if(ve(ne)||q(ne))return Ie!==null?null:me(re,ee,ne,xe,null);if(typeof ne.then=="function")return ue(re,ee,du(ne),xe);if(ne.$$typeof===S)return ue(re,ee,cu(re,ne),xe);mu(re,ne)}return null}function de(re,ee,ne,xe,Ie){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return re=re.get(ne)||null,D(ee,re,""+xe,Ie);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case b:return re=re.get(xe.key===null?ne:xe.key)||null,K(ee,re,xe,Ie);case _:return re=re.get(xe.key===null?ne:xe.key)||null,se(ee,re,xe,Ie);case j:return xe=Ys(xe),de(re,ee,ne,xe,Ie)}if(ve(xe)||q(xe))return re=re.get(ne)||null,me(ee,re,xe,Ie,null);if(typeof xe.then=="function")return de(re,ee,ne,du(xe),Ie);if(xe.$$typeof===S)return de(re,ee,ne,cu(ee,xe),Ie);mu(ee,xe)}return null}function Re(re,ee,ne,xe){for(var Ie=null,lt=null,Fe=ee,Xe=ee=0,tt=null;Fe!==null&&Xe<ne.length;Xe++){Fe.index>Xe?(tt=Fe,Fe=null):tt=Fe.sibling;var ot=ue(re,Fe,ne[Xe],xe);if(ot===null){Fe===null&&(Fe=tt);break}n&&Fe&&ot.alternate===null&&i(re,Fe),ee=v(ot,ee,Xe),lt===null?Ie=ot:lt.sibling=ot,lt=ot,Fe=tt}if(Xe===ne.length)return o(re,Fe),at&&_n(re,Xe),Ie;if(Fe===null){for(;Xe<ne.length;Xe++)Fe=ge(re,ne[Xe],xe),Fe!==null&&(ee=v(Fe,ee,Xe),lt===null?Ie=Fe:lt.sibling=Fe,lt=Fe);return at&&_n(re,Xe),Ie}for(Fe=f(Fe);Xe<ne.length;Xe++)tt=de(Fe,re,Xe,ne[Xe],xe),tt!==null&&(n&&tt.alternate!==null&&Fe.delete(tt.key===null?Xe:tt.key),ee=v(tt,ee,Xe),lt===null?Ie=tt:lt.sibling=tt,lt=tt);return n&&Fe.forEach(function(xs){return i(re,xs)}),at&&_n(re,Xe),Ie}function Be(re,ee,ne,xe){if(ne==null)throw Error(r(151));for(var Ie=null,lt=null,Fe=ee,Xe=ee=0,tt=null,ot=ne.next();Fe!==null&&!ot.done;Xe++,ot=ne.next()){Fe.index>Xe?(tt=Fe,Fe=null):tt=Fe.sibling;var xs=ue(re,Fe,ot.value,xe);if(xs===null){Fe===null&&(Fe=tt);break}n&&Fe&&xs.alternate===null&&i(re,Fe),ee=v(xs,ee,Xe),lt===null?Ie=xs:lt.sibling=xs,lt=xs,Fe=tt}if(ot.done)return o(re,Fe),at&&_n(re,Xe),Ie;if(Fe===null){for(;!ot.done;Xe++,ot=ne.next())ot=ge(re,ot.value,xe),ot!==null&&(ee=v(ot,ee,Xe),lt===null?Ie=ot:lt.sibling=ot,lt=ot);return at&&_n(re,Xe),Ie}for(Fe=f(Fe);!ot.done;Xe++,ot=ne.next())ot=de(Fe,re,Xe,ot.value,xe),ot!==null&&(n&&ot.alternate!==null&&Fe.delete(ot.key===null?Xe:ot.key),ee=v(ot,ee,Xe),lt===null?Ie=ot:lt.sibling=ot,lt=ot);return n&&Fe.forEach(function(T4){return i(re,T4)}),at&&_n(re,Xe),Ie}function xt(re,ee,ne,xe){if(typeof ne=="object"&&ne!==null&&ne.type===w&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:e:{for(var Ie=ne.key;ee!==null;){if(ee.key===Ie){if(Ie=ne.type,Ie===w){if(ee.tag===7){o(re,ee.sibling),xe=x(ee,ne.props.children),xe.return=re,re=xe;break e}}else if(ee.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===j&&Ys(Ie)===ee.type){o(re,ee.sibling),xe=x(ee,ne.props),lo(xe,ne),xe.return=re,re=xe;break e}o(re,ee);break}else i(re,ee);ee=ee.sibling}ne.type===w?(xe=Hs(ne.props.children,re.mode,xe,ne.key),xe.return=re,re=xe):(xe=iu(ne.type,ne.key,ne.props,null,re.mode,xe),lo(xe,ne),xe.return=re,re=xe)}return E(re);case _:e:{for(Ie=ne.key;ee!==null;){if(ee.key===Ie)if(ee.tag===4&&ee.stateNode.containerInfo===ne.containerInfo&&ee.stateNode.implementation===ne.implementation){o(re,ee.sibling),xe=x(ee,ne.children||[]),xe.return=re,re=xe;break e}else{o(re,ee);break}else i(re,ee);ee=ee.sibling}xe=Vf(ne,re.mode,xe),xe.return=re,re=xe}return E(re);case j:return ne=Ys(ne),xt(re,ee,ne,xe)}if(ve(ne))return Re(re,ee,ne,xe);if(q(ne)){if(Ie=q(ne),typeof Ie!="function")throw Error(r(150));return ne=Ie.call(ne),Be(re,ee,ne,xe)}if(typeof ne.then=="function")return xt(re,ee,du(ne),xe);if(ne.$$typeof===S)return xt(re,ee,cu(re,ne),xe);mu(re,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,ee!==null&&ee.tag===6?(o(re,ee.sibling),xe=x(ee,ne),xe.return=re,re=xe):(o(re,ee),xe=zf(ne,re.mode,xe),xe.return=re,re=xe),E(re)):o(re,ee)}return function(re,ee,ne,xe){try{io=0;var Ie=xt(re,ee,ne,xe);return qi=null,Ie}catch(Fe){if(Fe===Gi||Fe===fu)throw Fe;var lt=er(29,Fe,null,re.mode);return lt.lanes=xe,lt.return=re,lt}}}var Ks=w1(!0),_1=w1(!1),Zn=!1;function eh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function th(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function es(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ts(n,i,o){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(ut&2)!==0){var x=f.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),f.pending=i,i=su(n),s1(n,null,o),i}return nu(n,f,i,o),su(n)}function oo(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Ci(n,o)}}function ah(n,i){var o=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var x=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};v===null?x=v=E:v=v.next=E,o=o.next}while(o!==null);v===null?x=v=i:v=v.next=i}else x=v=i;o={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var rh=!1;function co(){if(rh){var n=$i;if(n!==null)throw n}}function uo(n,i,o,f){rh=!1;var x=n.updateQueue;Zn=!1;var v=x.firstBaseUpdate,E=x.lastBaseUpdate,D=x.shared.pending;if(D!==null){x.shared.pending=null;var K=D,se=K.next;K.next=null,E===null?v=se:E.next=se,E=K;var me=n.alternate;me!==null&&(me=me.updateQueue,D=me.lastBaseUpdate,D!==E&&(D===null?me.firstBaseUpdate=se:D.next=se,me.lastBaseUpdate=K))}if(v!==null){var ge=x.baseState;E=0,me=se=K=null,D=v;do{var ue=D.lane&-536870913,de=ue!==D.lane;if(de?(et&ue)===ue:(f&ue)===ue){ue!==0&&ue===Hi&&(rh=!0),me!==null&&(me=me.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Re=n,Be=D;ue=i;var xt=o;switch(Be.tag){case 1:if(Re=Be.payload,typeof Re=="function"){ge=Re.call(xt,ge,ue);break e}ge=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Be.payload,ue=typeof Re=="function"?Re.call(xt,ge,ue):Re,ue==null)break e;ge=g({},ge,ue);break e;case 2:Zn=!0}}ue=D.callback,ue!==null&&(n.flags|=64,de&&(n.flags|=8192),de=x.callbacks,de===null?x.callbacks=[ue]:de.push(ue))}else de={lane:ue,tag:D.tag,payload:D.payload,callback:D.callback,next:null},me===null?(se=me=de,K=ge):me=me.next=de,E|=ue;if(D=D.next,D===null){if(D=x.shared.pending,D===null)break;de=D,D=de.next,de.next=null,x.lastBaseUpdate=de,x.shared.pending=null}}while(!0);me===null&&(K=ge),x.baseState=K,x.firstBaseUpdate=se,x.lastBaseUpdate=me,v===null&&(x.shared.lanes=0),is|=E,n.lanes=E,n.memoizedState=ge}}function T1(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function S1(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)T1(o[n],i)}var Wi=G(null),pu=G(0);function E1(n,i){n=Rn,Z(pu,n),Z(Wi,i),Rn=n|i.baseLanes}function nh(){Z(pu,Rn),Z(Wi,Wi.current)}function sh(){Rn=pu.current,O(Wi),O(pu)}var tr=G(null),Tr=null;function as(n){var i=n.alternate;Z(Ht,Ht.current&1),Z(tr,n),Tr===null&&(i===null||Wi.current!==null||i.memoizedState!==null)&&(Tr=n)}function ih(n){Z(Ht,Ht.current),Z(tr,n),Tr===null&&(Tr=n)}function k1(n){n.tag===22?(Z(Ht,Ht.current),Z(tr,n),Tr===null&&(Tr=n)):rs()}function rs(){Z(Ht,Ht.current),Z(tr,tr.current)}function ar(n){O(tr),Tr===n&&(Tr=null),O(Ht)}var Ht=G(0);function xu(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||hd(o)||dd(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var En=0,Ge=null,mt=null,Yt=null,gu=!1,Yi=!1,Js=!1,vu=0,fo=0,Xi=null,dk=0;function Lt(){throw Error(r(321))}function lh(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!Za(n[o],i[o]))return!1;return!0}function oh(n,i,o,f,x,v){return En=v,Ge=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,R.H=n===null||n.memoizedState===null?cg:Th,Js=!1,v=o(f,x),Js=!1,Yi&&(v=N1(i,o,f,x)),A1(n),v}function A1(n){R.H=po;var i=mt!==null&&mt.next!==null;if(En=0,Yt=mt=Ge=null,gu=!1,fo=0,Xi=null,i)throw Error(r(300));n===null||Xt||(n=n.dependencies,n!==null&&ou(n)&&(Xt=!0))}function N1(n,i,o,f){Ge=n;var x=0;do{if(Yi&&(Xi=null),fo=0,Yi=!1,25<=x)throw Error(r(301));if(x+=1,Yt=mt=null,n.updateQueue!=null){var v=n.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}R.H=ug,v=i(o,f)}while(Yi);return v}function mk(){var n=R.H,i=n.useState()[0];return i=typeof i.then=="function"?ho(i):i,n=n.useState()[0],(mt!==null?mt.memoizedState:null)!==n&&(Ge.flags|=1024),i}function ch(){var n=vu!==0;return vu=0,n}function uh(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function fh(n){if(gu){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}gu=!1}En=0,Yt=mt=Ge=null,Yi=!1,fo=vu=0,Xi=null}function Ma(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Ge.memoizedState=Yt=n:Yt=Yt.next=n,Yt}function $t(){if(mt===null){var n=Ge.alternate;n=n!==null?n.memoizedState:null}else n=mt.next;var i=Yt===null?Ge.memoizedState:Yt.next;if(i!==null)Yt=i,mt=n;else{if(n===null)throw Ge.alternate===null?Error(r(467)):Error(r(310));mt=n,n={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Yt===null?Ge.memoizedState=Yt=n:Yt=Yt.next=n}return Yt}function yu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ho(n){var i=fo;return fo+=1,Xi===null&&(Xi=[]),n=v1(Xi,n,i),i=Ge,(Yt===null?i.memoizedState:Yt.next)===null&&(i=i.alternate,R.H=i===null||i.memoizedState===null?cg:Th),n}function bu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ho(n);if(n.$$typeof===S)return ha(n)}throw Error(r(438,String(n)))}function hh(n){var i=null,o=Ge.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var f=Ge.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=yu(),Ge.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),f=0;f<n;f++)o[f]=z;return i.index++,o}function kn(n,i){return typeof i=="function"?i(n):i}function wu(n){var i=$t();return dh(i,mt,n)}function dh(n,i,o){var f=n.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=o;var x=n.baseQueue,v=f.pending;if(v!==null){if(x!==null){var E=x.next;x.next=v.next,v.next=E}i.baseQueue=x=v,f.pending=null}if(v=n.baseState,x===null)n.memoizedState=v;else{i=x.next;var D=E=null,K=null,se=i,me=!1;do{var ge=se.lane&-536870913;if(ge!==se.lane?(et&ge)===ge:(En&ge)===ge){var ue=se.revertLane;if(ue===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ge===Hi&&(me=!0);else if((En&ue)===ue){se=se.next,ue===Hi&&(me=!0);continue}else ge={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},K===null?(D=K=ge,E=v):K=K.next=ge,Ge.lanes|=ue,is|=ue;ge=se.action,Js&&o(v,ge),v=se.hasEagerState?se.eagerState:o(v,ge)}else ue={lane:ge,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},K===null?(D=K=ue,E=v):K=K.next=ue,Ge.lanes|=ge,is|=ge;se=se.next}while(se!==null&&se!==i);if(K===null?E=v:K.next=D,!Za(v,n.memoizedState)&&(Xt=!0,me&&(o=$i,o!==null)))throw o;n.memoizedState=v,n.baseState=E,n.baseQueue=K,f.lastRenderedState=v}return x===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function mh(n){var i=$t(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var f=o.dispatch,x=o.pending,v=i.memoizedState;if(x!==null){o.pending=null;var E=x=x.next;do v=n(v,E.action),E=E.next;while(E!==x);Za(v,i.memoizedState)||(Xt=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),o.lastRenderedState=v}return[v,f]}function C1(n,i,o){var f=Ge,x=$t(),v=at;if(v){if(o===void 0)throw Error(r(407));o=o()}else o=i();var E=!Za((mt||x).memoizedState,o);if(E&&(x.memoizedState=o,Xt=!0),x=x.queue,gh(j1.bind(null,f,x,n),[n]),x.getSnapshot!==i||E||Yt!==null&&Yt.memoizedState.tag&1){if(f.flags|=2048,Ki(9,{destroy:void 0},D1.bind(null,f,x,o,i),null),vt===null)throw Error(r(349));v||(En&127)!==0||O1(f,i,o)}return o}function O1(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=Ge.updateQueue,i===null?(i=yu(),Ge.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function D1(n,i,o,f){i.value=o,i.getSnapshot=f,R1(i)&&M1(n)}function j1(n,i,o){return o(function(){R1(i)&&M1(n)})}function R1(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!Za(n,o)}catch{return!0}}function M1(n){var i=Vs(n,2);i!==null&&Ka(i,n,2)}function ph(n){var i=Ma();if(typeof n=="function"){var o=n;if(n=o(),Js){Pr(!0);try{o()}finally{Pr(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:n},i}function F1(n,i,o,f){return n.baseState=o,dh(n,mt,typeof f=="function"?f:kn)}function pk(n,i,o,f,x){if(Su(n))throw Error(r(485));if(n=i.action,n!==null){var v={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};R.T!==null?o(!0):v.isTransition=!1,f(v),o=i.pending,o===null?(v.next=i.pending=v,L1(i,v)):(v.next=o.next,i.pending=o.next=v)}}function L1(n,i){var o=i.action,f=i.payload,x=n.state;if(i.isTransition){var v=R.T,E={};R.T=E;try{var D=o(x,f),K=R.S;K!==null&&K(E,D),P1(n,i,D)}catch(se){xh(n,i,se)}finally{v!==null&&E.types!==null&&(v.types=E.types),R.T=v}}else try{v=o(x,f),P1(n,i,v)}catch(se){xh(n,i,se)}}function P1(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){I1(n,i,f)},function(f){return xh(n,i,f)}):I1(n,i,o)}function I1(n,i,o){i.status="fulfilled",i.value=o,B1(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,L1(n,o)))}function xh(n,i,o){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=o,B1(i),i=i.next;while(i!==f)}n.action=null}function B1(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function U1(n,i){return i}function z1(n,i){if(at){var o=vt.formState;if(o!==null){e:{var f=Ge;if(at){if(Et){t:{for(var x=Et,v=_r;x.nodeType!==8;){if(!v){x=null;break t}if(x=Sr(x.nextSibling),x===null){x=null;break t}}v=x.data,x=v==="F!"||v==="F"?x:null}if(x){Et=Sr(x.nextSibling),f=x.data==="F!";break e}}Jn(f)}f=!1}f&&(i=o[0])}}return o=Ma(),o.memoizedState=o.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:U1,lastRenderedState:i},o.queue=f,o=ig.bind(null,Ge,f),f.dispatch=o,f=ph(!1),v=_h.bind(null,Ge,!1,f.queue),f=Ma(),x={state:i,dispatch:null,action:n,pending:null},f.queue=x,o=pk.bind(null,Ge,x,v,o),x.dispatch=o,f.memoizedState=n,[i,o,!1]}function V1(n){var i=$t();return H1(i,mt,n)}function H1(n,i,o){if(i=dh(n,i,U1)[0],n=wu(kn)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=ho(i)}catch(E){throw E===Gi?fu:E}else f=i;i=$t();var x=i.queue,v=x.dispatch;return o!==i.memoizedState&&(Ge.flags|=2048,Ki(9,{destroy:void 0},xk.bind(null,x,o),null)),[f,v,n]}function xk(n,i){n.action=i}function $1(n){var i=$t(),o=mt;if(o!==null)return H1(i,o,n);$t(),i=i.memoizedState,o=$t();var f=o.queue.dispatch;return o.memoizedState=n,[i,f,!1]}function Ki(n,i,o,f){return n={tag:n,create:o,deps:f,inst:i,next:null},i=Ge.updateQueue,i===null&&(i=yu(),Ge.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(f=o.next,o.next=n,n.next=f,i.lastEffect=n),n}function G1(){return $t().memoizedState}function _u(n,i,o,f){var x=Ma();Ge.flags|=n,x.memoizedState=Ki(1|i,{destroy:void 0},o,f===void 0?null:f)}function Tu(n,i,o,f){var x=$t();f=f===void 0?null:f;var v=x.memoizedState.inst;mt!==null&&f!==null&&lh(f,mt.memoizedState.deps)?x.memoizedState=Ki(i,v,o,f):(Ge.flags|=n,x.memoizedState=Ki(1|i,v,o,f))}function q1(n,i){_u(8390656,8,n,i)}function gh(n,i){Tu(2048,8,n,i)}function gk(n){Ge.flags|=4;var i=Ge.updateQueue;if(i===null)i=yu(),Ge.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function W1(n){var i=$t().memoizedState;return gk({ref:i,nextImpl:n}),function(){if((ut&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Y1(n,i){return Tu(4,2,n,i)}function X1(n,i){return Tu(4,4,n,i)}function K1(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function J1(n,i,o){o=o!=null?o.concat([n]):null,Tu(4,4,K1.bind(null,i,n),o)}function vh(){}function Q1(n,i){var o=$t();i=i===void 0?null:i;var f=o.memoizedState;return i!==null&&lh(i,f[1])?f[0]:(o.memoizedState=[n,i],n)}function Z1(n,i){var o=$t();i=i===void 0?null:i;var f=o.memoizedState;if(i!==null&&lh(i,f[1]))return f[0];if(f=n(),Js){Pr(!0);try{n()}finally{Pr(!1)}}return o.memoizedState=[f,i],f}function yh(n,i,o){return o===void 0||(En&1073741824)!==0&&(et&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=ev(),Ge.lanes|=n,is|=n,o)}function eg(n,i,o,f){return Za(o,i)?o:Wi.current!==null?(n=yh(n,o,f),Za(n,i)||(Xt=!0),n):(En&42)===0||(En&1073741824)!==0&&(et&261930)===0?(Xt=!0,n.memoizedState=o):(n=ev(),Ge.lanes|=n,is|=n,i)}function tg(n,i,o,f,x){var v=te.p;te.p=v!==0&&8>v?v:8;var E=R.T,D={};R.T=D,_h(n,!1,i,o);try{var K=x(),se=R.S;if(se!==null&&se(D,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var me=hk(K,f);mo(n,i,me,sr(n))}else mo(n,i,f,sr(n))}catch(ge){mo(n,i,{then:function(){},status:"rejected",reason:ge},sr())}finally{te.p=v,E!==null&&D.types!==null&&(E.types=D.types),R.T=E}}function vk(){}function bh(n,i,o,f){if(n.tag!==5)throw Error(r(476));var x=ag(n).queue;tg(n,x,i,ye,o===null?vk:function(){return rg(n),o(f)})}function ag(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:ye},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function rg(n){var i=ag(n);i.next===null&&(i=n.alternate.memoizedState),mo(n,i.next.queue,{},sr())}function wh(){return ha(Do)}function ng(){return $t().memoizedState}function sg(){return $t().memoizedState}function yk(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=sr();n=es(o);var f=ts(i,n,o);f!==null&&(Ka(f,i,o),oo(f,i,o)),i={cache:Kf()},n.payload=i;return}i=i.return}}function bk(n,i,o){var f=sr();o={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Su(n)?lg(i,o):(o=Bf(n,i,o,f),o!==null&&(Ka(o,n,f),og(o,i,f)))}function ig(n,i,o){var f=sr();mo(n,i,o,f)}function mo(n,i,o,f){var x={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Su(n))lg(i,x);else{var v=n.alternate;if(n.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var E=i.lastRenderedState,D=v(E,o);if(x.hasEagerState=!0,x.eagerState=D,Za(D,E))return nu(n,i,x,0),vt===null&&ru(),!1}catch{}if(o=Bf(n,i,x,f),o!==null)return Ka(o,n,f),og(o,i,f),!0}return!1}function _h(n,i,o,f){if(f={lane:2,revertLane:ed(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Su(n)){if(i)throw Error(r(479))}else i=Bf(n,o,f,2),i!==null&&Ka(i,n,2)}function Su(n){var i=n.alternate;return n===Ge||i!==null&&i===Ge}function lg(n,i){Yi=gu=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function og(n,i,o){if((o&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Ci(n,o)}}var po={readContext:ha,use:bu,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt};po.useEffectEvent=Lt;var cg={readContext:ha,use:bu,useCallback:function(n,i){return Ma().memoizedState=[n,i===void 0?null:i],n},useContext:ha,useEffect:q1,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,_u(4194308,4,K1.bind(null,i,n),o)},useLayoutEffect:function(n,i){return _u(4194308,4,n,i)},useInsertionEffect:function(n,i){_u(4,2,n,i)},useMemo:function(n,i){var o=Ma();i=i===void 0?null:i;var f=n();if(Js){Pr(!0);try{n()}finally{Pr(!1)}}return o.memoizedState=[f,i],f},useReducer:function(n,i,o){var f=Ma();if(o!==void 0){var x=o(i);if(Js){Pr(!0);try{o(i)}finally{Pr(!1)}}}else x=i;return f.memoizedState=f.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},f.queue=n,n=n.dispatch=bk.bind(null,Ge,n),[f.memoizedState,n]},useRef:function(n){var i=Ma();return n={current:n},i.memoizedState=n},useState:function(n){n=ph(n);var i=n.queue,o=ig.bind(null,Ge,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:vh,useDeferredValue:function(n,i){var o=Ma();return yh(o,n,i)},useTransition:function(){var n=ph(!1);return n=tg.bind(null,Ge,n.queue,!0,!1),Ma().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var f=Ge,x=Ma();if(at){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),vt===null)throw Error(r(349));(et&127)!==0||O1(f,i,o)}x.memoizedState=o;var v={value:o,getSnapshot:i};return x.queue=v,q1(j1.bind(null,f,v,n),[n]),f.flags|=2048,Ki(9,{destroy:void 0},D1.bind(null,f,v,o,i),null),o},useId:function(){var n=Ma(),i=vt.identifierPrefix;if(at){var o=rn,f=an;o=(f&~(1<<32-Ra(f)-1)).toString(32)+o,i="_"+i+"R_"+o,o=vu++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=dk++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:wh,useFormState:z1,useActionState:z1,useOptimistic:function(n){var i=Ma();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=_h.bind(null,Ge,!0,o),o.dispatch=i,[n,i]},useMemoCache:hh,useCacheRefresh:function(){return Ma().memoizedState=yk.bind(null,Ge)},useEffectEvent:function(n){var i=Ma(),o={impl:n};return i.memoizedState=o,function(){if((ut&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},Th={readContext:ha,use:bu,useCallback:Q1,useContext:ha,useEffect:gh,useImperativeHandle:J1,useInsertionEffect:Y1,useLayoutEffect:X1,useMemo:Z1,useReducer:wu,useRef:G1,useState:function(){return wu(kn)},useDebugValue:vh,useDeferredValue:function(n,i){var o=$t();return eg(o,mt.memoizedState,n,i)},useTransition:function(){var n=wu(kn)[0],i=$t().memoizedState;return[typeof n=="boolean"?n:ho(n),i]},useSyncExternalStore:C1,useId:ng,useHostTransitionStatus:wh,useFormState:V1,useActionState:V1,useOptimistic:function(n,i){var o=$t();return F1(o,mt,n,i)},useMemoCache:hh,useCacheRefresh:sg};Th.useEffectEvent=W1;var ug={readContext:ha,use:bu,useCallback:Q1,useContext:ha,useEffect:gh,useImperativeHandle:J1,useInsertionEffect:Y1,useLayoutEffect:X1,useMemo:Z1,useReducer:mh,useRef:G1,useState:function(){return mh(kn)},useDebugValue:vh,useDeferredValue:function(n,i){var o=$t();return mt===null?yh(o,n,i):eg(o,mt.memoizedState,n,i)},useTransition:function(){var n=mh(kn)[0],i=$t().memoizedState;return[typeof n=="boolean"?n:ho(n),i]},useSyncExternalStore:C1,useId:ng,useHostTransitionStatus:wh,useFormState:$1,useActionState:$1,useOptimistic:function(n,i){var o=$t();return mt!==null?F1(o,mt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:hh,useCacheRefresh:sg};ug.useEffectEvent=W1;function Sh(n,i,o,f){i=n.memoizedState,o=o(f,i),o=o==null?i:g({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Eh={enqueueSetState:function(n,i,o){n=n._reactInternals;var f=sr(),x=es(f);x.payload=i,o!=null&&(x.callback=o),i=ts(n,x,f),i!==null&&(Ka(i,n,f),oo(i,n,f))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var f=sr(),x=es(f);x.tag=1,x.payload=i,o!=null&&(x.callback=o),i=ts(n,x,f),i!==null&&(Ka(i,n,f),oo(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=sr(),f=es(o);f.tag=2,i!=null&&(f.callback=i),i=ts(n,f,o),i!==null&&(Ka(i,n,o),oo(i,n,o))}};function fg(n,i,o,f,x,v,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,v,E):i.prototype&&i.prototype.isPureReactComponent?!eo(o,f)||!eo(x,v):!0}function hg(n,i,o,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,f),i.state!==n&&Eh.enqueueReplaceState(i,i.state,null)}function Qs(n,i){var o=i;if("ref"in i){o={};for(var f in i)f!=="ref"&&(o[f]=i[f])}if(n=n.defaultProps){o===i&&(o=g({},o));for(var x in n)o[x]===void 0&&(o[x]=n[x])}return o}function dg(n){au(n)}function mg(n){console.error(n)}function pg(n){au(n)}function Eu(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function xg(n,i,o){try{var f=n.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function kh(n,i,o){return o=es(o),o.tag=3,o.payload={element:null},o.callback=function(){Eu(n,i)},o}function gg(n){return n=es(n),n.tag=3,n}function vg(n,i,o,f){var x=o.type.getDerivedStateFromError;if(typeof x=="function"){var v=f.value;n.payload=function(){return x(v)},n.callback=function(){xg(i,o,f)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){xg(i,o,f),typeof x!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var D=f.stack;this.componentDidCatch(f.value,{componentStack:D!==null?D:""})})}function wk(n,i,o,f,x){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=o.alternate,i!==null&&Vi(i,o,x,!0),o=tr.current,o!==null){switch(o.tag){case 31:case 13:return Tr===null?Pu():o.alternate===null&&Pt===0&&(Pt=3),o.flags&=-257,o.flags|=65536,o.lanes=x,f===hu?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([f]):i.add(f),Jh(n,f,x)),!1;case 22:return o.flags|=65536,f===hu?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([f]):o.add(f)),Jh(n,f,x)),!1}throw Error(r(435,o.tag))}return Jh(n,f,x),Pu(),!1}if(at)return i=tr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,f!==Gf&&(n=Error(r(422),{cause:f}),ro(yr(n,o)))):(f!==Gf&&(i=Error(r(423),{cause:f}),ro(yr(i,o))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,f=yr(f,o),x=kh(n.stateNode,f,x),ah(n,x),Pt!==4&&(Pt=2)),!1;var v=Error(r(520),{cause:f});if(v=yr(v,o),To===null?To=[v]:To.push(v),Pt!==4&&(Pt=2),i===null)return!0;f=yr(f,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=x&-x,o.lanes|=n,n=kh(o.stateNode,f,n),ah(o,n),!1;case 1:if(i=o.type,v=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ls===null||!ls.has(v))))return o.flags|=65536,x&=-x,o.lanes|=x,x=gg(x),vg(x,n,o,f),ah(o,x),!1}o=o.return}while(o!==null);return!1}var Ah=Error(r(461)),Xt=!1;function da(n,i,o,f){i.child=n===null?_1(i,null,o,f):Ks(i,n.child,o,f)}function yg(n,i,o,f,x){o=o.render;var v=i.ref;if("ref"in f){var E={};for(var D in f)D!=="ref"&&(E[D]=f[D])}else E=f;return qs(i),f=oh(n,i,o,E,v,x),D=ch(),n!==null&&!Xt?(uh(n,i,x),An(n,i,x)):(at&&D&&Hf(i),i.flags|=1,da(n,i,f,x),i.child)}function bg(n,i,o,f,x){if(n===null){var v=o.type;return typeof v=="function"&&!Uf(v)&&v.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=v,wg(n,i,v,f,x)):(n=iu(o.type,null,f,i,i.mode,x),n.ref=i.ref,n.return=i,i.child=n)}if(v=n.child,!Fh(n,x)){var E=v.memoizedProps;if(o=o.compare,o=o!==null?o:eo,o(E,f)&&n.ref===i.ref)return An(n,i,x)}return i.flags|=1,n=wn(v,f),n.ref=i.ref,n.return=i,i.child=n}function wg(n,i,o,f,x){if(n!==null){var v=n.memoizedProps;if(eo(v,f)&&n.ref===i.ref)if(Xt=!1,i.pendingProps=f=v,Fh(n,x))(n.flags&131072)!==0&&(Xt=!0);else return i.lanes=n.lanes,An(n,i,x)}return Nh(n,i,o,f,x)}function _g(n,i,o,f){var x=f.children,v=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|o:o,n!==null){for(f=i.child=n.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~v}else f=0,i.child=null;return Tg(n,i,v,o,f)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&uu(i,v!==null?v.cachePool:null),v!==null?E1(i,v):nh(),k1(i);else return f=i.lanes=536870912,Tg(n,i,v!==null?v.baseLanes|o:o,o,f)}else v!==null?(uu(i,v.cachePool),E1(i,v),rs(),i.memoizedState=null):(n!==null&&uu(i,null),nh(),rs());return da(n,i,x,o),i.child}function xo(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Tg(n,i,o,f,x){var v=Qf();return v=v===null?null:{parent:Wt._currentValue,pool:v},i.memoizedState={baseLanes:o,cachePool:v},n!==null&&uu(i,null),nh(),k1(i),n!==null&&Vi(n,i,f,!0),i.childLanes=x,null}function ku(n,i){return i=Nu({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Sg(n,i,o){return Ks(i,n.child,null,o),n=ku(i,i.pendingProps),n.flags|=2,ar(i),i.memoizedState=null,n}function _k(n,i,o){var f=i.pendingProps,x=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(at){if(f.mode==="hidden")return n=ku(i,f),i.lanes=536870912,xo(null,n);if(ih(i),(n=Et)?(n=Lv(n,_r),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Xn!==null?{id:an,overflow:rn}:null,retryLane:536870912,hydrationErrors:null},o=l1(n),o.return=i,i.child=o,fa=i,Et=null)):n=null,n===null)throw Jn(i);return i.lanes=536870912,null}return ku(i,f)}var v=n.memoizedState;if(v!==null){var E=v.dehydrated;if(ih(i),x)if(i.flags&256)i.flags&=-257,i=Sg(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(Xt||Vi(n,i,o,!1),x=(o&n.childLanes)!==0,Xt||x){if(f=vt,f!==null&&(E=qc(f,o),E!==0&&E!==v.retryLane))throw v.retryLane=E,Vs(n,E),Ka(f,n,E),Ah;Pu(),i=Sg(n,i,o)}else n=v.treeContext,Et=Sr(E.nextSibling),fa=i,at=!0,Kn=null,_r=!1,n!==null&&u1(i,n),i=ku(i,f),i.flags|=4096;return i}return n=wn(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function Au(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function Nh(n,i,o,f,x){return qs(i),o=oh(n,i,o,f,void 0,x),f=ch(),n!==null&&!Xt?(uh(n,i,x),An(n,i,x)):(at&&f&&Hf(i),i.flags|=1,da(n,i,o,x),i.child)}function Eg(n,i,o,f,x,v){return qs(i),i.updateQueue=null,o=N1(i,f,o,x),A1(n),f=ch(),n!==null&&!Xt?(uh(n,i,v),An(n,i,v)):(at&&f&&Hf(i),i.flags|=1,da(n,i,o,v),i.child)}function kg(n,i,o,f,x){if(qs(i),i.stateNode===null){var v=Ii,E=o.contextType;typeof E=="object"&&E!==null&&(v=ha(E)),v=new o(f,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Eh,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=f,v.state=i.memoizedState,v.refs={},eh(i),E=o.contextType,v.context=typeof E=="object"&&E!==null?ha(E):Ii,v.state=i.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(Sh(i,o,E,f),v.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&Eh.enqueueReplaceState(v,v.state,null),uo(i,f,v,x),co(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){v=i.stateNode;var D=i.memoizedProps,K=Qs(o,D);v.props=K;var se=v.context,me=o.contextType;E=Ii,typeof me=="object"&&me!==null&&(E=ha(me));var ge=o.getDerivedStateFromProps;me=typeof ge=="function"||typeof v.getSnapshotBeforeUpdate=="function",D=i.pendingProps!==D,me||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(D||se!==E)&&hg(i,v,f,E),Zn=!1;var ue=i.memoizedState;v.state=ue,uo(i,f,v,x),co(),se=i.memoizedState,D||ue!==se||Zn?(typeof ge=="function"&&(Sh(i,o,ge,f),se=i.memoizedState),(K=Zn||fg(i,o,K,f,ue,se,E))?(me||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=se),v.props=f,v.state=se,v.context=E,f=K):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{v=i.stateNode,th(n,i),E=i.memoizedProps,me=Qs(o,E),v.props=me,ge=i.pendingProps,ue=v.context,se=o.contextType,K=Ii,typeof se=="object"&&se!==null&&(K=ha(se)),D=o.getDerivedStateFromProps,(se=typeof D=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==ge||ue!==K)&&hg(i,v,f,K),Zn=!1,ue=i.memoizedState,v.state=ue,uo(i,f,v,x),co();var de=i.memoizedState;E!==ge||ue!==de||Zn||n!==null&&n.dependencies!==null&&ou(n.dependencies)?(typeof D=="function"&&(Sh(i,o,D,f),de=i.memoizedState),(me=Zn||fg(i,o,me,f,ue,de,K)||n!==null&&n.dependencies!==null&&ou(n.dependencies))?(se||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,de,K),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,de,K)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===n.memoizedProps&&ue===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&ue===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=de),v.props=f,v.state=de,v.context=K,f=me):(typeof v.componentDidUpdate!="function"||E===n.memoizedProps&&ue===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&ue===n.memoizedState||(i.flags|=1024),f=!1)}return v=f,Au(n,i),f=(i.flags&128)!==0,v||f?(v=i.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,n!==null&&f?(i.child=Ks(i,n.child,null,x),i.child=Ks(i,null,o,x)):da(n,i,o,x),i.memoizedState=v.state,n=i.child):n=An(n,i,x),n}function Ag(n,i,o,f){return $s(),i.flags|=256,da(n,i,o,f),i.child}var Ch={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Oh(n){return{baseLanes:n,cachePool:x1()}}function Dh(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=nr),n}function Ng(n,i,o){var f=i.pendingProps,x=!1,v=(i.flags&128)!==0,E;if((E=v)||(E=n!==null&&n.memoizedState===null?!1:(Ht.current&2)!==0),E&&(x=!0,i.flags&=-129),E=(i.flags&32)!==0,i.flags&=-33,n===null){if(at){if(x?as(i):rs(),(n=Et)?(n=Lv(n,_r),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Xn!==null?{id:an,overflow:rn}:null,retryLane:536870912,hydrationErrors:null},o=l1(n),o.return=i,i.child=o,fa=i,Et=null)):n=null,n===null)throw Jn(i);return dd(n)?i.lanes=32:i.lanes=536870912,null}var D=f.children;return f=f.fallback,x?(rs(),x=i.mode,D=Nu({mode:"hidden",children:D},x),f=Hs(f,x,o,null),D.return=i,f.return=i,D.sibling=f,i.child=D,f=i.child,f.memoizedState=Oh(o),f.childLanes=Dh(n,E,o),i.memoizedState=Ch,xo(null,f)):(as(i),jh(i,D))}var K=n.memoizedState;if(K!==null&&(D=K.dehydrated,D!==null)){if(v)i.flags&256?(as(i),i.flags&=-257,i=Rh(n,i,o)):i.memoizedState!==null?(rs(),i.child=n.child,i.flags|=128,i=null):(rs(),D=f.fallback,x=i.mode,f=Nu({mode:"visible",children:f.children},x),D=Hs(D,x,o,null),D.flags|=2,f.return=i,D.return=i,f.sibling=D,i.child=f,Ks(i,n.child,null,o),f=i.child,f.memoizedState=Oh(o),f.childLanes=Dh(n,E,o),i.memoizedState=Ch,i=xo(null,f));else if(as(i),dd(D)){if(E=D.nextSibling&&D.nextSibling.dataset,E)var se=E.dgst;E=se,f=Error(r(419)),f.stack="",f.digest=E,ro({value:f,source:null,stack:null}),i=Rh(n,i,o)}else if(Xt||Vi(n,i,o,!1),E=(o&n.childLanes)!==0,Xt||E){if(E=vt,E!==null&&(f=qc(E,o),f!==0&&f!==K.retryLane))throw K.retryLane=f,Vs(n,f),Ka(E,n,f),Ah;hd(D)||Pu(),i=Rh(n,i,o)}else hd(D)?(i.flags|=192,i.child=n.child,i=null):(n=K.treeContext,Et=Sr(D.nextSibling),fa=i,at=!0,Kn=null,_r=!1,n!==null&&u1(i,n),i=jh(i,f.children),i.flags|=4096);return i}return x?(rs(),D=f.fallback,x=i.mode,K=n.child,se=K.sibling,f=wn(K,{mode:"hidden",children:f.children}),f.subtreeFlags=K.subtreeFlags&65011712,se!==null?D=wn(se,D):(D=Hs(D,x,o,null),D.flags|=2),D.return=i,f.return=i,f.sibling=D,i.child=f,xo(null,f),f=i.child,D=n.child.memoizedState,D===null?D=Oh(o):(x=D.cachePool,x!==null?(K=Wt._currentValue,x=x.parent!==K?{parent:K,pool:K}:x):x=x1(),D={baseLanes:D.baseLanes|o,cachePool:x}),f.memoizedState=D,f.childLanes=Dh(n,E,o),i.memoizedState=Ch,xo(n.child,f)):(as(i),o=n.child,n=o.sibling,o=wn(o,{mode:"visible",children:f.children}),o.return=i,o.sibling=null,n!==null&&(E=i.deletions,E===null?(i.deletions=[n],i.flags|=16):E.push(n)),i.child=o,i.memoizedState=null,o)}function jh(n,i){return i=Nu({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Nu(n,i){return n=er(22,n,null,i),n.lanes=0,n}function Rh(n,i,o){return Ks(i,n.child,null,o),n=jh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function Cg(n,i,o){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Yf(n.return,i,o)}function Mh(n,i,o,f,x,v){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:x,treeForkCount:v}:(E.isBackwards=i,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=o,E.tailMode=x,E.treeForkCount=v)}function Og(n,i,o){var f=i.pendingProps,x=f.revealOrder,v=f.tail;f=f.children;var E=Ht.current,D=(E&2)!==0;if(D?(E=E&1|2,i.flags|=128):E&=1,Z(Ht,E),da(n,i,f,o),f=at?ao:0,!D&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Cg(n,o,i);else if(n.tag===19)Cg(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(x){case"forwards":for(o=i.child,x=null;o!==null;)n=o.alternate,n!==null&&xu(n)===null&&(x=o),o=o.sibling;o=x,o===null?(x=i.child,i.child=null):(x=o.sibling,o.sibling=null),Mh(i,!1,x,o,v,f);break;case"backwards":case"unstable_legacy-backwards":for(o=null,x=i.child,i.child=null;x!==null;){if(n=x.alternate,n!==null&&xu(n)===null){i.child=x;break}n=x.sibling,x.sibling=o,o=x,x=n}Mh(i,!0,o,null,v,f);break;case"together":Mh(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function An(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),is|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(Vi(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,o=wn(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=wn(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function Fh(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&ou(n)))}function Tk(n,i,o){switch(i.tag){case 3:Ne(i,i.stateNode.containerInfo),Qn(i,Wt,n.memoizedState.cache),$s();break;case 27:case 5:Se(i);break;case 4:Ne(i,i.stateNode.containerInfo);break;case 10:Qn(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,ih(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(as(i),i.flags|=128,null):(o&i.child.childLanes)!==0?Ng(n,i,o):(as(i),n=An(n,i,o),n!==null?n.sibling:null);as(i);break;case 19:var x=(n.flags&128)!==0;if(f=(o&i.childLanes)!==0,f||(Vi(n,i,o,!1),f=(o&i.childLanes)!==0),x){if(f)return Og(n,i,o);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Z(Ht,Ht.current),f)break;return null;case 22:return i.lanes=0,_g(n,i,o,i.pendingProps);case 24:Qn(i,Wt,n.memoizedState.cache)}return An(n,i,o)}function Dg(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)Xt=!0;else{if(!Fh(n,o)&&(i.flags&128)===0)return Xt=!1,Tk(n,i,o);Xt=(n.flags&131072)!==0}else Xt=!1,at&&(i.flags&1048576)!==0&&c1(i,ao,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=Ys(i.elementType),i.type=n,typeof n=="function")Uf(n)?(f=Qs(n,f),i.tag=1,i=kg(null,i,n,f,o)):(i.tag=0,i=Nh(null,i,n,f,o));else{if(n!=null){var x=n.$$typeof;if(x===L){i.tag=11,i=yg(null,i,n,f,o);break e}else if(x===N){i.tag=14,i=bg(null,i,n,f,o);break e}}throw i=be(n)||n,Error(r(306,i,""))}}return i;case 0:return Nh(n,i,i.type,i.pendingProps,o);case 1:return f=i.type,x=Qs(f,i.pendingProps),kg(n,i,f,x,o);case 3:e:{if(Ne(i,i.stateNode.containerInfo),n===null)throw Error(r(387));f=i.pendingProps;var v=i.memoizedState;x=v.element,th(n,i),uo(i,f,null,o);var E=i.memoizedState;if(f=E.cache,Qn(i,Wt,f),f!==v.cache&&Xf(i,[Wt],o,!0),co(),f=E.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:E.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=Ag(n,i,f,o);break e}else if(f!==x){x=yr(Error(r(424)),i),ro(x),i=Ag(n,i,f,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Et=Sr(n.firstChild),fa=i,at=!0,Kn=null,_r=!0,o=_1(i,null,f,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if($s(),f===x){i=An(n,i,o);break e}da(n,i,f,o)}i=i.child}return i;case 26:return Au(n,i),n===null?(o=Vv(i.type,null,i.pendingProps,null))?i.memoizedState=o:at||(o=i.type,n=i.pendingProps,f=$u(he.current).createElement(o),f[F]=i,f[B]=n,ma(f,o,n),Me(f),i.stateNode=f):i.memoizedState=Vv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Se(i),n===null&&at&&(f=i.stateNode=Bv(i.type,i.pendingProps,he.current),fa=i,_r=!0,x=Et,fs(i.type)?(md=x,Et=Sr(f.firstChild)):Et=x),da(n,i,i.pendingProps.children,o),Au(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&at&&((x=f=Et)&&(f=Zk(f,i.type,i.pendingProps,_r),f!==null?(i.stateNode=f,fa=i,Et=Sr(f.firstChild),_r=!1,x=!0):x=!1),x||Jn(i)),Se(i),x=i.type,v=i.pendingProps,E=n!==null?n.memoizedProps:null,f=v.children,cd(x,v)?f=null:E!==null&&cd(x,E)&&(i.flags|=32),i.memoizedState!==null&&(x=oh(n,i,mk,null,null,o),Do._currentValue=x),Au(n,i),da(n,i,f,o),i.child;case 6:return n===null&&at&&((n=o=Et)&&(o=e4(o,i.pendingProps,_r),o!==null?(i.stateNode=o,fa=i,Et=null,n=!0):n=!1),n||Jn(i)),null;case 13:return Ng(n,i,o);case 4:return Ne(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=Ks(i,null,f,o):da(n,i,f,o),i.child;case 11:return yg(n,i,i.type,i.pendingProps,o);case 7:return da(n,i,i.pendingProps,o),i.child;case 8:return da(n,i,i.pendingProps.children,o),i.child;case 12:return da(n,i,i.pendingProps.children,o),i.child;case 10:return f=i.pendingProps,Qn(i,i.type,f.value),da(n,i,f.children,o),i.child;case 9:return x=i.type._context,f=i.pendingProps.children,qs(i),x=ha(x),f=f(x),i.flags|=1,da(n,i,f,o),i.child;case 14:return bg(n,i,i.type,i.pendingProps,o);case 15:return wg(n,i,i.type,i.pendingProps,o);case 19:return Og(n,i,o);case 31:return _k(n,i,o);case 22:return _g(n,i,o,i.pendingProps);case 24:return qs(i),f=ha(Wt),n===null?(x=Qf(),x===null&&(x=vt,v=Kf(),x.pooledCache=v,v.refCount++,v!==null&&(x.pooledCacheLanes|=o),x=v),i.memoizedState={parent:f,cache:x},eh(i),Qn(i,Wt,x)):((n.lanes&o)!==0&&(th(n,i),uo(i,null,null,o),co()),x=n.memoizedState,v=i.memoizedState,x.parent!==f?(x={parent:f,cache:f},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),Qn(i,Wt,f)):(f=v.cache,Qn(i,Wt,f),f!==x.cache&&Xf(i,[Wt],o,!0))),da(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Nn(n){n.flags|=4}function Lh(n,i,o,f,x){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(x&335544128)===x)if(n.stateNode.complete)n.flags|=8192;else if(nv())n.flags|=8192;else throw Xs=hu,Zf}else n.flags&=-16777217}function jg(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Wv(i))if(nv())n.flags|=8192;else throw Xs=hu,Zf}function Cu(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?$c():536870912,n.lanes|=i,el|=i)}function go(n,i){if(!at)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function kt(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,f=0;if(i)for(var x=n.child;x!==null;)o|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)o|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=f,n.childLanes=o,i}function Sk(n,i,o){var f=i.pendingProps;switch($f(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(i),null;case 1:return kt(i),null;case 3:return o=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Sn(Wt),_e(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(zi(i)?Nn(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,qf())),kt(i),null;case 26:var x=i.type,v=i.memoizedState;return n===null?(Nn(i),v!==null?(kt(i),jg(i,v)):(kt(i),Lh(i,x,null,f,o))):v?v!==n.memoizedState?(Nn(i),kt(i),jg(i,v)):(kt(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&Nn(i),kt(i),Lh(i,x,n,f,o)),null;case 27:if(Je(i),o=he.current,x=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Nn(i);else{if(!f){if(i.stateNode===null)throw Error(r(166));return kt(i),null}n=W.current,zi(i)?f1(i):(n=Bv(x,f,o),i.stateNode=n,Nn(i))}return kt(i),null;case 5:if(Je(i),x=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Nn(i);else{if(!f){if(i.stateNode===null)throw Error(r(166));return kt(i),null}if(v=W.current,zi(i))f1(i);else{var E=$u(he.current);switch(v){case 1:v=E.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:v=E.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":v=E.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":v=E.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":v=E.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?v.multiple=!0:f.size&&(v.size=f.size);break;default:v=typeof f.is=="string"?E.createElement(x,{is:f.is}):E.createElement(x)}}v[F]=i,v[B]=f;e:for(E=i.child;E!==null;){if(E.tag===5||E.tag===6)v.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===i)break e;for(;E.sibling===null;){if(E.return===null||E.return===i)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}i.stateNode=v;e:switch(ma(v,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Nn(i)}}return kt(i),Lh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&Nn(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(r(166));if(n=he.current,zi(i)){if(n=i.stateNode,o=i.memoizedProps,f=null,x=fa,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}n[F]=i,n=!!(n.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||Nv(n.nodeValue,o)),n||Jn(i,!0)}else n=$u(n).createTextNode(f),n[F]=i,i.stateNode=n}return kt(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(f=zi(i),o!==null){if(n===null){if(!f)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[F]=i}else $s(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;kt(i),n=!1}else o=qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(ar(i),i):(ar(i),null);if((i.flags&128)!==0)throw Error(r(558))}return kt(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=zi(i),f!==null&&f.dehydrated!==null){if(n===null){if(!x)throw Error(r(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[F]=i}else $s(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;kt(i),x=!1}else x=qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(ar(i),i):(ar(i),null)}return ar(i),(i.flags&128)!==0?(i.lanes=o,i):(o=f!==null,n=n!==null&&n.memoizedState!==null,o&&(f=i.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),v=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==x&&(f.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),Cu(i,i.updateQueue),kt(i),null);case 4:return _e(),n===null&&nd(i.stateNode.containerInfo),kt(i),null;case 10:return Sn(i.type),kt(i),null;case 19:if(O(Ht),f=i.memoizedState,f===null)return kt(i),null;if(x=(i.flags&128)!==0,v=f.rendering,v===null)if(x)go(f,!1);else{if(Pt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(v=xu(n),v!==null){for(i.flags|=128,go(f,!1),n=v.updateQueue,i.updateQueue=n,Cu(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)i1(o,n),o=o.sibling;return Z(Ht,Ht.current&1|2),at&&_n(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&gt()>Mu&&(i.flags|=128,x=!0,go(f,!1),i.lanes=4194304)}else{if(!x)if(n=xu(v),n!==null){if(i.flags|=128,x=!0,n=n.updateQueue,i.updateQueue=n,Cu(i,n),go(f,!0),f.tail===null&&f.tailMode==="hidden"&&!v.alternate&&!at)return kt(i),null}else 2*gt()-f.renderingStartTime>Mu&&o!==536870912&&(i.flags|=128,x=!0,go(f,!1),i.lanes=4194304);f.isBackwards?(v.sibling=i.child,i.child=v):(n=f.last,n!==null?n.sibling=v:i.child=v,f.last=v)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=gt(),n.sibling=null,o=Ht.current,Z(Ht,x?o&1|2:o&1),at&&_n(i,f.treeForkCount),n):(kt(i),null);case 22:case 23:return ar(i),sh(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(o&536870912)!==0&&(i.flags&128)===0&&(kt(i),i.subtreeFlags&6&&(i.flags|=8192)):kt(i),o=i.updateQueue,o!==null&&Cu(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==o&&(i.flags|=2048),n!==null&&O(Ws),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Sn(Wt),kt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function Ek(n,i){switch($f(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Sn(Wt),_e(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Je(i),null;case 31:if(i.memoizedState!==null){if(ar(i),i.alternate===null)throw Error(r(340));$s()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(ar(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));$s()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return O(Ht),null;case 4:return _e(),null;case 10:return Sn(i.type),null;case 22:case 23:return ar(i),sh(),n!==null&&O(Ws),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Sn(Wt),null;case 25:return null;default:return null}}function Rg(n,i){switch($f(i),i.tag){case 3:Sn(Wt),_e();break;case 26:case 27:case 5:Je(i);break;case 4:_e();break;case 31:i.memoizedState!==null&&ar(i);break;case 13:ar(i);break;case 19:O(Ht);break;case 10:Sn(i.type);break;case 22:case 23:ar(i),sh(),n!==null&&O(Ws);break;case 24:Sn(Wt)}}function vo(n,i){try{var o=i.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var x=f.next;o=x;do{if((o.tag&n)===n){f=void 0;var v=o.create,E=o.inst;f=v(),E.destroy=f}o=o.next}while(o!==x)}}catch(D){ht(i,i.return,D)}}function ns(n,i,o){try{var f=i.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var v=x.next;f=v;do{if((f.tag&n)===n){var E=f.inst,D=E.destroy;if(D!==void 0){E.destroy=void 0,x=i;var K=o,se=D;try{se()}catch(me){ht(x,K,me)}}}f=f.next}while(f!==v)}}catch(me){ht(i,i.return,me)}}function Mg(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{S1(i,o)}catch(f){ht(n,n.return,f)}}}function Fg(n,i,o){o.props=Qs(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(f){ht(n,i,f)}}function yo(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof o=="function"?n.refCleanup=o(f):o.current=f}}catch(x){ht(n,i,x)}}function nn(n,i){var o=n.ref,f=n.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(x){ht(n,i,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(x){ht(n,i,x)}else o.current=null}function Lg(n){var i=n.type,o=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(x){ht(n,n.return,x)}}function Ph(n,i,o){try{var f=n.stateNode;Wk(f,n.type,o,i),f[B]=i}catch(x){ht(n,n.return,x)}}function Pg(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&fs(n.type)||n.tag===4}function Ih(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Pg(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&fs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Bh(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=yn));else if(f!==4&&(f===27&&fs(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Bh(n,i,o),n=n.sibling;n!==null;)Bh(n,i,o),n=n.sibling}function Ou(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(f!==4&&(f===27&&fs(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Ou(n,i,o),n=n.sibling;n!==null;)Ou(n,i,o),n=n.sibling}function Ig(n){var i=n.stateNode,o=n.memoizedProps;try{for(var f=n.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);ma(i,f,o),i[F]=n,i[B]=o}catch(v){ht(n,n.return,v)}}var Cn=!1,Kt=!1,Uh=!1,Bg=typeof WeakSet=="function"?WeakSet:Set,oa=null;function kk(n,i){if(n=n.containerInfo,ld=Ju,n=Jx(n),Rf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var x=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var E=0,D=-1,K=-1,se=0,me=0,ge=n,ue=null;t:for(;;){for(var de;ge!==o||x!==0&&ge.nodeType!==3||(D=E+x),ge!==v||f!==0&&ge.nodeType!==3||(K=E+f),ge.nodeType===3&&(E+=ge.nodeValue.length),(de=ge.firstChild)!==null;)ue=ge,ge=de;for(;;){if(ge===n)break t;if(ue===o&&++se===x&&(D=E),ue===v&&++me===f&&(K=E),(de=ge.nextSibling)!==null)break;ge=ue,ue=ge.parentNode}ge=de}o=D===-1||K===-1?null:{start:D,end:K}}else o=null}o=o||{start:0,end:0}}else o=null;for(od={focusedElem:n,selectionRange:o},Ju=!1,oa=i;oa!==null;)if(i=oa,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,oa=n;else for(;oa!==null;){switch(i=oa,v=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)x=n[o],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&v!==null){n=void 0,o=i,x=v.memoizedProps,v=v.memoizedState,f=o.stateNode;try{var Re=Qs(o.type,x);n=f.getSnapshotBeforeUpdate(Re,v),f.__reactInternalSnapshotBeforeUpdate=n}catch(Be){ht(o,o.return,Be)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)fd(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,oa=n;break}oa=i.return}}function Ug(n,i,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:Dn(n,o),f&4&&vo(5,o);break;case 1:if(Dn(n,o),f&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(E){ht(o,o.return,E)}else{var x=Qs(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(x,i,n.__reactInternalSnapshotBeforeUpdate)}catch(E){ht(o,o.return,E)}}f&64&&Mg(o),f&512&&yo(o,o.return);break;case 3:if(Dn(n,o),f&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{S1(n,i)}catch(E){ht(o,o.return,E)}}break;case 27:i===null&&f&4&&Ig(o);case 26:case 5:Dn(n,o),i===null&&f&4&&Lg(o),f&512&&yo(o,o.return);break;case 12:Dn(n,o);break;case 31:Dn(n,o),f&4&&Hg(n,o);break;case 13:Dn(n,o),f&4&&$g(n,o),f&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Fk.bind(null,o),t4(n,o))));break;case 22:if(f=o.memoizedState!==null||Cn,!f){i=i!==null&&i.memoizedState!==null||Kt,x=Cn;var v=Kt;Cn=f,(Kt=i)&&!v?jn(n,o,(o.subtreeFlags&8772)!==0):Dn(n,o),Cn=x,Kt=v}break;case 30:break;default:Dn(n,o)}}function zg(n){var i=n.alternate;i!==null&&(n.alternate=null,zg(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Te(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Dt=null,qa=!1;function On(n,i,o){for(o=o.child;o!==null;)Vg(n,i,o),o=o.sibling}function Vg(n,i,o){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(St,o)}catch{}switch(o.tag){case 26:Kt||nn(o,i),On(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Kt||nn(o,i);var f=Dt,x=qa;fs(o.type)&&(Dt=o.stateNode,qa=!1),On(n,i,o),No(o.stateNode),Dt=f,qa=x;break;case 5:Kt||nn(o,i);case 6:if(f=Dt,x=qa,Dt=null,On(n,i,o),Dt=f,qa=x,Dt!==null)if(qa)try{(Dt.nodeType===9?Dt.body:Dt.nodeName==="HTML"?Dt.ownerDocument.body:Dt).removeChild(o.stateNode)}catch(v){ht(o,i,v)}else try{Dt.removeChild(o.stateNode)}catch(v){ht(o,i,v)}break;case 18:Dt!==null&&(qa?(n=Dt,Mv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),ol(n)):Mv(Dt,o.stateNode));break;case 4:f=Dt,x=qa,Dt=o.stateNode.containerInfo,qa=!0,On(n,i,o),Dt=f,qa=x;break;case 0:case 11:case 14:case 15:ns(2,o,i),Kt||ns(4,o,i),On(n,i,o);break;case 1:Kt||(nn(o,i),f=o.stateNode,typeof f.componentWillUnmount=="function"&&Fg(o,i,f)),On(n,i,o);break;case 21:On(n,i,o);break;case 22:Kt=(f=Kt)||o.memoizedState!==null,On(n,i,o),Kt=f;break;default:On(n,i,o)}}function Hg(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ol(n)}catch(o){ht(i,i.return,o)}}}function $g(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ol(n)}catch(o){ht(i,i.return,o)}}function Ak(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Bg),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Bg),i;default:throw Error(r(435,n.tag))}}function Du(n,i){var o=Ak(n);i.forEach(function(f){if(!o.has(f)){o.add(f);var x=Lk.bind(null,n,f);f.then(x,x)}})}function Wa(n,i){var o=i.deletions;if(o!==null)for(var f=0;f<o.length;f++){var x=o[f],v=n,E=i,D=E;e:for(;D!==null;){switch(D.tag){case 27:if(fs(D.type)){Dt=D.stateNode,qa=!1;break e}break;case 5:Dt=D.stateNode,qa=!1;break e;case 3:case 4:Dt=D.stateNode.containerInfo,qa=!0;break e}D=D.return}if(Dt===null)throw Error(r(160));Vg(v,E,x),Dt=null,qa=!1,v=x.alternate,v!==null&&(v.return=null),x.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Gg(i,n),i=i.sibling}var Br=null;function Gg(n,i){var o=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Wa(i,n),Ya(n),f&4&&(ns(3,n,n.return),vo(3,n),ns(5,n,n.return));break;case 1:Wa(i,n),Ya(n),f&512&&(Kt||o===null||nn(o,o.return)),f&64&&Cn&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var x=Br;if(Wa(i,n),Ya(n),f&512&&(Kt||o===null||nn(o,o.return)),f&4){var v=o!==null?o.memoizedState:null;if(f=n.memoizedState,o===null)if(f===null)if(n.stateNode===null){e:{f=n.type,o=n.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":v=x.getElementsByTagName("title")[0],(!v||v[fe]||v[F]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=x.createElement(f),x.head.insertBefore(v,x.querySelector("head > title"))),ma(v,f,o),v[F]=n,Me(v),f=v;break e;case"link":var E=Gv("link","href",x).get(f+(o.href||""));if(E){for(var D=0;D<E.length;D++)if(v=E[D],v.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&v.getAttribute("rel")===(o.rel==null?null:o.rel)&&v.getAttribute("title")===(o.title==null?null:o.title)&&v.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(D,1);break t}}v=x.createElement(f),ma(v,f,o),x.head.appendChild(v);break;case"meta":if(E=Gv("meta","content",x).get(f+(o.content||""))){for(D=0;D<E.length;D++)if(v=E[D],v.getAttribute("content")===(o.content==null?null:""+o.content)&&v.getAttribute("name")===(o.name==null?null:o.name)&&v.getAttribute("property")===(o.property==null?null:o.property)&&v.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&v.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(D,1);break t}}v=x.createElement(f),ma(v,f,o),x.head.appendChild(v);break;default:throw Error(r(468,f))}v[F]=n,Me(v),f=v}n.stateNode=f}else qv(x,n.type,n.stateNode);else n.stateNode=$v(x,f,n.memoizedProps);else v!==f?(v===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):v.count--,f===null?qv(x,n.type,n.stateNode):$v(x,f,n.memoizedProps)):f===null&&n.stateNode!==null&&Ph(n,n.memoizedProps,o.memoizedProps)}break;case 27:Wa(i,n),Ya(n),f&512&&(Kt||o===null||nn(o,o.return)),o!==null&&f&4&&Ph(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Wa(i,n),Ya(n),f&512&&(Kt||o===null||nn(o,o.return)),n.flags&32){x=n.stateNode;try{Di(x,"")}catch(Re){ht(n,n.return,Re)}}f&4&&n.stateNode!=null&&(x=n.memoizedProps,Ph(n,x,o!==null?o.memoizedProps:x)),f&1024&&(Uh=!0);break;case 6:if(Wa(i,n),Ya(n),f&4){if(n.stateNode===null)throw Error(r(162));f=n.memoizedProps,o=n.stateNode;try{o.nodeValue=f}catch(Re){ht(n,n.return,Re)}}break;case 3:if(Wu=null,x=Br,Br=Gu(i.containerInfo),Wa(i,n),Br=x,Ya(n),f&4&&o!==null&&o.memoizedState.isDehydrated)try{ol(i.containerInfo)}catch(Re){ht(n,n.return,Re)}Uh&&(Uh=!1,qg(n));break;case 4:f=Br,Br=Gu(n.stateNode.containerInfo),Wa(i,n),Ya(n),Br=f;break;case 12:Wa(i,n),Ya(n);break;case 31:Wa(i,n),Ya(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Du(n,f)));break;case 13:Wa(i,n),Ya(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ru=gt()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Du(n,f)));break;case 22:x=n.memoizedState!==null;var K=o!==null&&o.memoizedState!==null,se=Cn,me=Kt;if(Cn=se||x,Kt=me||K,Wa(i,n),Kt=me,Cn=se,Ya(n),f&8192)e:for(i=n.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(o===null||K||Cn||Kt||Zs(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){K=o=i;try{if(v=K.stateNode,x)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{D=K.stateNode;var ge=K.memoizedProps.style,ue=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;D.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(Re){ht(K,K.return,Re)}}}else if(i.tag===6){if(o===null){K=i;try{K.stateNode.nodeValue=x?"":K.memoizedProps}catch(Re){ht(K,K.return,Re)}}}else if(i.tag===18){if(o===null){K=i;try{var de=K.stateNode;x?Fv(de,!0):Fv(K.stateNode,!1)}catch(Re){ht(K,K.return,Re)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,Du(n,o))));break;case 19:Wa(i,n),Ya(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Du(n,f)));break;case 30:break;case 21:break;default:Wa(i,n),Ya(n)}}function Ya(n){var i=n.flags;if(i&2){try{for(var o,f=n.return;f!==null;){if(Pg(f)){o=f;break}f=f.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var x=o.stateNode,v=Ih(n);Ou(n,v,x);break;case 5:var E=o.stateNode;o.flags&32&&(Di(E,""),o.flags&=-33);var D=Ih(n);Ou(n,D,E);break;case 3:case 4:var K=o.stateNode.containerInfo,se=Ih(n);Bh(n,se,K);break;default:throw Error(r(161))}}catch(me){ht(n,n.return,me)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function qg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;qg(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Dn(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Ug(n,i.alternate,i),i=i.sibling}function Zs(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:ns(4,i,i.return),Zs(i);break;case 1:nn(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&Fg(i,i.return,o),Zs(i);break;case 27:No(i.stateNode);case 26:case 5:nn(i,i.return),Zs(i);break;case 22:i.memoizedState===null&&Zs(i);break;case 30:Zs(i);break;default:Zs(i)}n=n.sibling}}function jn(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,x=n,v=i,E=v.flags;switch(v.tag){case 0:case 11:case 15:jn(x,v,o),vo(4,v);break;case 1:if(jn(x,v,o),f=v,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(se){ht(f,f.return,se)}if(f=v,x=f.updateQueue,x!==null){var D=f.stateNode;try{var K=x.shared.hiddenCallbacks;if(K!==null)for(x.shared.hiddenCallbacks=null,x=0;x<K.length;x++)T1(K[x],D)}catch(se){ht(f,f.return,se)}}o&&E&64&&Mg(v),yo(v,v.return);break;case 27:Ig(v);case 26:case 5:jn(x,v,o),o&&f===null&&E&4&&Lg(v),yo(v,v.return);break;case 12:jn(x,v,o);break;case 31:jn(x,v,o),o&&E&4&&Hg(x,v);break;case 13:jn(x,v,o),o&&E&4&&$g(x,v);break;case 22:v.memoizedState===null&&jn(x,v,o),yo(v,v.return);break;case 30:break;default:jn(x,v,o)}i=i.sibling}}function zh(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&no(o))}function Vh(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&no(n))}function Ur(n,i,o,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Wg(n,i,o,f),i=i.sibling}function Wg(n,i,o,f){var x=i.flags;switch(i.tag){case 0:case 11:case 15:Ur(n,i,o,f),x&2048&&vo(9,i);break;case 1:Ur(n,i,o,f);break;case 3:Ur(n,i,o,f),x&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&no(n)));break;case 12:if(x&2048){Ur(n,i,o,f),n=i.stateNode;try{var v=i.memoizedProps,E=v.id,D=v.onPostCommit;typeof D=="function"&&D(E,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(K){ht(i,i.return,K)}}else Ur(n,i,o,f);break;case 31:Ur(n,i,o,f);break;case 13:Ur(n,i,o,f);break;case 23:break;case 22:v=i.stateNode,E=i.alternate,i.memoizedState!==null?v._visibility&2?Ur(n,i,o,f):bo(n,i):v._visibility&2?Ur(n,i,o,f):(v._visibility|=2,Ji(n,i,o,f,(i.subtreeFlags&10256)!==0||!1)),x&2048&&zh(E,i);break;case 24:Ur(n,i,o,f),x&2048&&Vh(i.alternate,i);break;default:Ur(n,i,o,f)}}function Ji(n,i,o,f,x){for(x=x&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=n,E=i,D=o,K=f,se=E.flags;switch(E.tag){case 0:case 11:case 15:Ji(v,E,D,K,x),vo(8,E);break;case 23:break;case 22:var me=E.stateNode;E.memoizedState!==null?me._visibility&2?Ji(v,E,D,K,x):bo(v,E):(me._visibility|=2,Ji(v,E,D,K,x)),x&&se&2048&&zh(E.alternate,E);break;case 24:Ji(v,E,D,K,x),x&&se&2048&&Vh(E.alternate,E);break;default:Ji(v,E,D,K,x)}i=i.sibling}}function bo(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,f=i,x=f.flags;switch(f.tag){case 22:bo(o,f),x&2048&&zh(f.alternate,f);break;case 24:bo(o,f),x&2048&&Vh(f.alternate,f);break;default:bo(o,f)}i=i.sibling}}var wo=8192;function Qi(n,i,o){if(n.subtreeFlags&wo)for(n=n.child;n!==null;)Yg(n,i,o),n=n.sibling}function Yg(n,i,o){switch(n.tag){case 26:Qi(n,i,o),n.flags&wo&&n.memoizedState!==null&&d4(o,Br,n.memoizedState,n.memoizedProps);break;case 5:Qi(n,i,o);break;case 3:case 4:var f=Br;Br=Gu(n.stateNode.containerInfo),Qi(n,i,o),Br=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=wo,wo=16777216,Qi(n,i,o),wo=f):Qi(n,i,o));break;default:Qi(n,i,o)}}function Xg(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function _o(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];oa=f,Jg(f,n)}Xg(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Kg(n),n=n.sibling}function Kg(n){switch(n.tag){case 0:case 11:case 15:_o(n),n.flags&2048&&ns(9,n,n.return);break;case 3:_o(n);break;case 12:_o(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,ju(n)):_o(n);break;default:_o(n)}}function ju(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];oa=f,Jg(f,n)}Xg(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:ns(8,i,i.return),ju(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,ju(i));break;default:ju(i)}n=n.sibling}}function Jg(n,i){for(;oa!==null;){var o=oa;switch(o.tag){case 0:case 11:case 15:ns(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:no(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,oa=f;else e:for(o=n;oa!==null;){f=oa;var x=f.sibling,v=f.return;if(zg(f),f===o){oa=null;break e}if(x!==null){x.return=v,oa=x;break e}oa=v}}}var Nk={getCacheForType:function(n){var i=ha(Wt),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return ha(Wt).controller.signal}},Ck=typeof WeakMap=="function"?WeakMap:Map,ut=0,vt=null,Qe=null,et=0,ft=0,rr=null,ss=!1,Zi=!1,Hh=!1,Rn=0,Pt=0,is=0,ei=0,$h=0,nr=0,el=0,To=null,Xa=null,Gh=!1,Ru=0,Qg=0,Mu=1/0,Fu=null,ls=null,aa=0,os=null,tl=null,Mn=0,qh=0,Wh=null,Zg=null,So=0,Yh=null;function sr(){return(ut&2)!==0&&et!==0?et&-et:R.T!==null?ed():C()}function ev(){if(nr===0)if((et&536870912)===0||at){var n=ki;ki<<=1,(ki&3932160)===0&&(ki=262144),nr=n}else nr=536870912;return n=tr.current,n!==null&&(n.flags|=32),nr}function Ka(n,i,o){(n===vt&&(ft===2||ft===9)||n.cancelPendingCommit!==null)&&(al(n,0),cs(n,et,nr,!1)),Ps(n,o),((ut&2)===0||n!==vt)&&(n===vt&&((ut&2)===0&&(ei|=o),Pt===4&&cs(n,et,nr,!1)),sn(n))}function tv(n,i,o){if((ut&6)!==0)throw Error(r(327));var f=!o&&(i&127)===0&&(i&n.expiredLanes)===0||Ls(n,i),x=f?jk(n,i):Kh(n,i,!0),v=f;do{if(x===0){Zi&&!f&&cs(n,i,0,!1);break}else{if(o=n.current.alternate,v&&!Ok(o)){x=Kh(n,i,!1),v=!1;continue}if(x===2){if(v=i,n.errorRecoveryDisabledLanes&v)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){i=E;e:{var D=n;x=To;var K=D.current.memoizedState.isDehydrated;if(K&&(al(D,E).flags|=256),E=Kh(D,E,!1),E!==2){if(Hh&&!K){D.errorRecoveryDisabledLanes|=v,ei|=v,x=4;break e}v=Xa,Xa=x,v!==null&&(Xa===null?Xa=v:Xa.push.apply(Xa,v))}x=E}if(v=!1,x!==2)continue}}if(x===1){al(n,0),cs(n,i,0,!0);break}e:{switch(f=n,v=x,v){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:cs(f,i,nr,!ss);break e;case 2:Xa=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(x=Ru+300-gt(),10<x)){if(cs(f,i,nr,!ss),Ni(f,0,!0)!==0)break e;Mn=i,f.timeoutHandle=jv(av.bind(null,f,o,Xa,Fu,Gh,i,nr,ei,el,ss,v,"Throttled",-0,0),x);break e}av(f,o,Xa,Fu,Gh,i,nr,ei,el,ss,v,null,-0,0)}}break}while(!0);sn(n)}function av(n,i,o,f,x,v,E,D,K,se,me,ge,ue,de){if(n.timeoutHandle=-1,ge=i.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yn},Yg(i,v,ge);var Re=(v&62914560)===v?Ru-gt():(v&4194048)===v?Qg-gt():0;if(Re=m4(ge,Re),Re!==null){Mn=v,n.cancelPendingCommit=Re(uv.bind(null,n,i,v,o,f,x,E,D,K,me,ge,null,ue,de)),cs(n,v,E,!se);return}}uv(n,i,v,o,f,x,E,D,K)}function Ok(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var x=o[f],v=x.getSnapshot;x=x.value;try{if(!Za(v(),x))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function cs(n,i,o,f){i&=~$h,i&=~ei,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var x=i;0<x;){var v=31-Ra(x),E=1<<v;f[v]=-1,x&=~E}o!==0&&Gc(n,o,i)}function Lu(){return(ut&6)===0?(Eo(0),!1):!0}function Xh(){if(Qe!==null){if(ft===0)var n=Qe.return;else n=Qe,Tn=Gs=null,fh(n),qi=null,io=0,n=Qe;for(;n!==null;)Rg(n.alternate,n),n=n.return;Qe=null}}function al(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Kk(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Mn=0,Xh(),vt=n,Qe=o=wn(n.current,null),et=i,ft=0,rr=null,ss=!1,Zi=Ls(n,i),Hh=!1,el=nr=$h=ei=is=Pt=0,Xa=To=null,Gh=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var x=31-Ra(f),v=1<<x;i|=n[x],f&=~v}return Rn=i,ru(),o}function rv(n,i){Ge=null,R.H=po,i===Gi||i===fu?(i=y1(),ft=3):i===Zf?(i=y1(),ft=4):ft=i===Ah?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,rr=i,Qe===null&&(Pt=1,Eu(n,yr(i,n.current)))}function nv(){var n=tr.current;return n===null?!0:(et&4194048)===et?Tr===null:(et&62914560)===et||(et&536870912)!==0?n===Tr:!1}function sv(){var n=R.H;return R.H=po,n===null?po:n}function iv(){var n=R.A;return R.A=Nk,n}function Pu(){Pt=4,ss||(et&4194048)!==et&&tr.current!==null||(Zi=!0),(is&134217727)===0&&(ei&134217727)===0||vt===null||cs(vt,et,nr,!1)}function Kh(n,i,o){var f=ut;ut|=2;var x=sv(),v=iv();(vt!==n||et!==i)&&(Fu=null,al(n,i)),i=!1;var E=Pt;e:do try{if(ft!==0&&Qe!==null){var D=Qe,K=rr;switch(ft){case 8:Xh(),E=6;break e;case 3:case 2:case 9:case 6:tr.current===null&&(i=!0);var se=ft;if(ft=0,rr=null,rl(n,D,K,se),o&&Zi){E=0;break e}break;default:se=ft,ft=0,rr=null,rl(n,D,K,se)}}Dk(),E=Pt;break}catch(me){rv(n,me)}while(!0);return i&&n.shellSuspendCounter++,Tn=Gs=null,ut=f,R.H=x,R.A=v,Qe===null&&(vt=null,et=0,ru()),E}function Dk(){for(;Qe!==null;)lv(Qe)}function jk(n,i){var o=ut;ut|=2;var f=sv(),x=iv();vt!==n||et!==i?(Fu=null,Mu=gt()+500,al(n,i)):Zi=Ls(n,i);e:do try{if(ft!==0&&Qe!==null){i=Qe;var v=rr;t:switch(ft){case 1:ft=0,rr=null,rl(n,i,v,1);break;case 2:case 9:if(g1(v)){ft=0,rr=null,ov(i);break}i=function(){ft!==2&&ft!==9||vt!==n||(ft=7),sn(n)},v.then(i,i);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:g1(v)?(ft=0,rr=null,ov(i)):(ft=0,rr=null,rl(n,i,v,7));break;case 5:var E=null;switch(Qe.tag){case 26:E=Qe.memoizedState;case 5:case 27:var D=Qe;if(E?Wv(E):D.stateNode.complete){ft=0,rr=null;var K=D.sibling;if(K!==null)Qe=K;else{var se=D.return;se!==null?(Qe=se,Iu(se)):Qe=null}break t}}ft=0,rr=null,rl(n,i,v,5);break;case 6:ft=0,rr=null,rl(n,i,v,6);break;case 8:Xh(),Pt=6;break e;default:throw Error(r(462))}}Rk();break}catch(me){rv(n,me)}while(!0);return Tn=Gs=null,R.H=f,R.A=x,ut=o,Qe!==null?0:(vt=null,et=0,ru(),Pt)}function Rk(){for(;Qe!==null&&!Ms();)lv(Qe)}function lv(n){var i=Dg(n.alternate,n,Rn);n.memoizedProps=n.pendingProps,i===null?Iu(n):Qe=i}function ov(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=Eg(o,i,i.pendingProps,i.type,void 0,et);break;case 11:i=Eg(o,i,i.pendingProps,i.type.render,i.ref,et);break;case 5:fh(i);default:Rg(o,i),i=Qe=i1(i,Rn),i=Dg(o,i,Rn)}n.memoizedProps=n.pendingProps,i===null?Iu(n):Qe=i}function rl(n,i,o,f){Tn=Gs=null,fh(i),qi=null,io=0;var x=i.return;try{if(wk(n,x,i,o,et)){Pt=1,Eu(n,yr(o,n.current)),Qe=null;return}}catch(v){if(x!==null)throw Qe=x,v;Pt=1,Eu(n,yr(o,n.current)),Qe=null;return}i.flags&32768?(at||f===1?n=!0:Zi||(et&536870912)!==0?n=!1:(ss=n=!0,(f===2||f===9||f===3||f===6)&&(f=tr.current,f!==null&&f.tag===13&&(f.flags|=16384))),cv(i,n)):Iu(i)}function Iu(n){var i=n;do{if((i.flags&32768)!==0){cv(i,ss);return}n=i.return;var o=Sk(i.alternate,i,Rn);if(o!==null){Qe=o;return}if(i=i.sibling,i!==null){Qe=i;return}Qe=i=n}while(i!==null);Pt===0&&(Pt=5)}function cv(n,i){do{var o=Ek(n.alternate,n);if(o!==null){o.flags&=32767,Qe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Qe=n;return}Qe=n=o}while(n!==null);Pt=6,Qe=null}function uv(n,i,o,f,x,v,E,D,K){n.cancelPendingCommit=null;do Bu();while(aa!==0);if((ut&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(v=i.lanes|i.childLanes,v|=If,xf(n,o,v,E,D,K),n===vt&&(Qe=vt=null,et=0),tl=i,os=n,Mn=o,qh=v,Wh=x,Zg=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Pk(qt,function(){return pv(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=R.T,R.T=null,x=te.p,te.p=2,E=ut,ut|=4;try{kk(n,i,o)}finally{ut=E,te.p=x,R.T=f}}aa=1,fv(),hv(),dv()}}function fv(){if(aa===1){aa=0;var n=os,i=tl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=R.T,R.T=null;var f=te.p;te.p=2;var x=ut;ut|=4;try{Gg(i,n);var v=od,E=Jx(n.containerInfo),D=v.focusedElem,K=v.selectionRange;if(E!==D&&D&&D.ownerDocument&&Kx(D.ownerDocument.documentElement,D)){if(K!==null&&Rf(D)){var se=K.start,me=K.end;if(me===void 0&&(me=se),"selectionStart"in D)D.selectionStart=se,D.selectionEnd=Math.min(me,D.value.length);else{var ge=D.ownerDocument||document,ue=ge&&ge.defaultView||window;if(ue.getSelection){var de=ue.getSelection(),Re=D.textContent.length,Be=Math.min(K.start,Re),xt=K.end===void 0?Be:Math.min(K.end,Re);!de.extend&&Be>xt&&(E=xt,xt=Be,Be=E);var re=Xx(D,Be),ee=Xx(D,xt);if(re&&ee&&(de.rangeCount!==1||de.anchorNode!==re.node||de.anchorOffset!==re.offset||de.focusNode!==ee.node||de.focusOffset!==ee.offset)){var ne=ge.createRange();ne.setStart(re.node,re.offset),de.removeAllRanges(),Be>xt?(de.addRange(ne),de.extend(ee.node,ee.offset)):(ne.setEnd(ee.node,ee.offset),de.addRange(ne))}}}}for(ge=[],de=D;de=de.parentNode;)de.nodeType===1&&ge.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ge.length;D++){var xe=ge[D];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}Ju=!!ld,od=ld=null}finally{ut=x,te.p=f,R.T=o}}n.current=i,aa=2}}function hv(){if(aa===2){aa=0;var n=os,i=tl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=R.T,R.T=null;var f=te.p;te.p=2;var x=ut;ut|=4;try{Ug(n,i.alternate,i)}finally{ut=x,te.p=f,R.T=o}}aa=3}}function dv(){if(aa===4||aa===3){aa=0,en();var n=os,i=tl,o=Mn,f=Zg;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?aa=5:(aa=0,tl=os=null,mv(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(ls=null),Gl(o),i=i.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(St,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=R.T,x=te.p,te.p=2,R.T=null;try{for(var v=n.onRecoverableError,E=0;E<f.length;E++){var D=f[E];v(D.value,{componentStack:D.stack})}}finally{R.T=i,te.p=x}}(Mn&3)!==0&&Bu(),sn(n),x=n.pendingLanes,(o&261930)!==0&&(x&42)!==0?n===Yh?So++:(So=0,Yh=n):So=0,Eo(0)}}function mv(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,no(i)))}function Bu(){return fv(),hv(),dv(),pv()}function pv(){if(aa!==5)return!1;var n=os,i=qh;qh=0;var o=Gl(Mn),f=R.T,x=te.p;try{te.p=32>o?32:o,R.T=null,o=Wh,Wh=null;var v=os,E=Mn;if(aa=0,tl=os=null,Mn=0,(ut&6)!==0)throw Error(r(331));var D=ut;if(ut|=4,Kg(v.current),Wg(v,v.current,E,o),ut=D,Eo(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(St,v)}catch{}return!0}finally{te.p=x,R.T=f,mv(n,i)}}function xv(n,i,o){i=yr(o,i),i=kh(n.stateNode,i,2),n=ts(n,i,2),n!==null&&(Ps(n,2),sn(n))}function ht(n,i,o){if(n.tag===3)xv(n,n,o);else for(;i!==null;){if(i.tag===3){xv(i,n,o);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ls===null||!ls.has(f))){n=yr(o,n),o=gg(2),f=ts(i,o,2),f!==null&&(vg(o,f,i,n),Ps(f,2),sn(f));break}}i=i.return}}function Jh(n,i,o){var f=n.pingCache;if(f===null){f=n.pingCache=new Ck;var x=new Set;f.set(i,x)}else x=f.get(i),x===void 0&&(x=new Set,f.set(i,x));x.has(o)||(Hh=!0,x.add(o),n=Mk.bind(null,n,i,o),i.then(n,n))}function Mk(n,i,o){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,vt===n&&(et&o)===o&&(Pt===4||Pt===3&&(et&62914560)===et&&300>gt()-Ru?(ut&2)===0&&al(n,0):$h|=o,el===et&&(el=0)),sn(n)}function gv(n,i){i===0&&(i=$c()),n=Vs(n,i),n!==null&&(Ps(n,i),sn(n))}function Fk(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),gv(n,o)}function Lk(n,i){var o=0;switch(n.tag){case 31:case 13:var f=n.stateNode,x=n.memoizedState;x!==null&&(o=x.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(i),gv(n,o)}function Pk(n,i){return Va(n,i)}var Uu=null,nl=null,Qh=!1,zu=!1,Zh=!1,us=0;function sn(n){n!==nl&&n.next===null&&(nl===null?Uu=nl=n:nl=nl.next=n),zu=!0,Qh||(Qh=!0,Bk())}function Eo(n,i){if(!Zh&&zu){Zh=!0;do for(var o=!1,f=Uu;f!==null;){if(n!==0){var x=f.pendingLanes;if(x===0)var v=0;else{var E=f.suspendedLanes,D=f.pingedLanes;v=(1<<31-Ra(42|n)+1)-1,v&=x&~(E&~D),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(o=!0,wv(f,v))}else v=et,v=Ni(f,f===vt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||Ls(f,v)||(o=!0,wv(f,v));f=f.next}while(o);Zh=!1}}function Ik(){vv()}function vv(){zu=Qh=!1;var n=0;us!==0&&Xk()&&(n=us);for(var i=gt(),o=null,f=Uu;f!==null;){var x=f.next,v=yv(f,i);v===0?(f.next=null,o===null?Uu=x:o.next=x,x===null&&(nl=o)):(o=f,(n!==0||(v&3)!==0)&&(zu=!0)),f=x}aa!==0&&aa!==5||Eo(n),us!==0&&(us=0)}function yv(n,i){for(var o=n.suspendedLanes,f=n.pingedLanes,x=n.expirationTimes,v=n.pendingLanes&-62914561;0<v;){var E=31-Ra(v),D=1<<E,K=x[E];K===-1?((D&o)===0||(D&f)!==0)&&(x[E]=pf(D,i)):K<=i&&(n.expiredLanes|=D),v&=~D}if(i=vt,o=et,o=Ni(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,o===0||n===i&&(ft===2||ft===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&Qa(f),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Ls(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(f!==null&&Qa(f),Gl(o)){case 2:case 8:o=qn;break;case 32:o=qt;break;case 268435456:o=Ye;break;default:o=qt}return f=bv.bind(null,n),o=Va(o,f),n.callbackPriority=i,n.callbackNode=o,i}return f!==null&&f!==null&&Qa(f),n.callbackPriority=2,n.callbackNode=null,2}function bv(n,i){if(aa!==0&&aa!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Bu()&&n.callbackNode!==o)return null;var f=et;return f=Ni(n,n===vt?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(tv(n,f,i),yv(n,gt()),n.callbackNode!=null&&n.callbackNode===o?bv.bind(null,n):null)}function wv(n,i){if(Bu())return null;tv(n,i,!0)}function Bk(){Jk(function(){(ut&6)!==0?Va(Lr,Ik):vv()})}function ed(){if(us===0){var n=Hi;n===0&&(n=Fs,Fs<<=1,(Fs&261888)===0&&(Fs=256)),us=n}return us}function _v(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Xc(""+n)}function Tv(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function Uk(n,i,o,f,x){if(i==="submit"&&o&&o.stateNode===x){var v=_v((x[B]||null).action),E=f.submitter;E&&(i=(i=E[B]||null)?_v(i.formAction):E.getAttribute("formAction"),i!==null&&(v=i,E=null));var D=new Zc("action","action",null,f,x);n.push({event:D,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(us!==0){var K=E?Tv(x,E):new FormData(x);bh(o,{pending:!0,data:K,method:x.method,action:v},null,K)}}else typeof v=="function"&&(D.preventDefault(),K=E?Tv(x,E):new FormData(x),bh(o,{pending:!0,data:K,method:x.method,action:v},v,K))},currentTarget:x}]})}}for(var td=0;td<Pf.length;td++){var ad=Pf[td],zk=ad.toLowerCase(),Vk=ad[0].toUpperCase()+ad.slice(1);Ir(zk,"on"+Vk)}Ir(e1,"onAnimationEnd"),Ir(t1,"onAnimationIteration"),Ir(a1,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(nk,"onTransitionRun"),Ir(sk,"onTransitionStart"),Ir(ik,"onTransitionCancel"),Ir(r1,"onTransitionEnd"),pr("onMouseEnter",["mouseout","mouseover"]),pr("onMouseLeave",["mouseout","mouseover"]),pr("onPointerEnter",["pointerout","pointerover"]),pr("onPointerLeave",["pointerout","pointerover"]),Ot("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ot("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ot("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ot("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ot("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ot("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ko));function Sv(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var f=n[o],x=f.event;f=f.listeners;e:{var v=void 0;if(i)for(var E=f.length-1;0<=E;E--){var D=f[E],K=D.instance,se=D.currentTarget;if(D=D.listener,K!==v&&x.isPropagationStopped())break e;v=D,x.currentTarget=se;try{v(x)}catch(me){au(me)}x.currentTarget=null,v=K}else for(E=0;E<f.length;E++){if(D=f[E],K=D.instance,se=D.currentTarget,D=D.listener,K!==v&&x.isPropagationStopped())break e;v=D,x.currentTarget=se;try{v(x)}catch(me){au(me)}x.currentTarget=null,v=K}}}}function Ze(n,i){var o=i[le];o===void 0&&(o=i[le]=new Set);var f=n+"__bubble";o.has(f)||(Ev(i,n,2,!1),o.add(f))}function rd(n,i,o){var f=0;i&&(f|=4),Ev(o,n,f,i)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function nd(n){if(!n[Vu]){n[Vu]=!0,bt.forEach(function(o){o!=="selectionchange"&&(Hk.has(o)||rd(o,!1,n),rd(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Vu]||(i[Vu]=!0,rd("selectionchange",!1,i))}}function Ev(n,i,o,f){switch(ey(i)){case 2:var x=g4;break;case 8:x=v4;break;default:x=yd}o=x.bind(null,i,o,n),x=void 0,!Sf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),f?x!==void 0?n.addEventListener(i,o,{capture:!0,passive:x}):n.addEventListener(i,o,!0):x!==void 0?n.addEventListener(i,o,{passive:x}):n.addEventListener(i,o,!1)}function sd(n,i,o,f,x){var v=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var D=f.stateNode.containerInfo;if(D===x)break;if(E===4)for(E=f.return;E!==null;){var K=E.tag;if((K===3||K===4)&&E.stateNode.containerInfo===x)return;E=E.return}for(;D!==null;){if(E=Ae(D),E===null)return;if(K=E.tag,K===5||K===6||K===26||K===27){f=v=E;continue e}D=D.parentNode}}f=f.return}Ox(function(){var se=v,me=_f(o),ge=[];e:{var ue=n1.get(n);if(ue!==void 0){var de=Zc,Re=n;switch(n){case"keypress":if(Jc(o)===0)break e;case"keydown":case"keyup":de=LE;break;case"focusin":Re="focus",de=Nf;break;case"focusout":Re="blur",de=Nf;break;case"beforeblur":case"afterblur":de=Nf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Rx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=SE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=BE;break;case e1:case t1:case a1:de=AE;break;case r1:de=zE;break;case"scroll":case"scrollend":de=_E;break;case"wheel":de=HE;break;case"copy":case"cut":case"paste":de=CE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Fx;break;case"toggle":case"beforetoggle":de=GE}var Be=(i&4)!==0,xt=!Be&&(n==="scroll"||n==="scrollend"),re=Be?ue!==null?ue+"Capture":null:ue;Be=[];for(var ee=se,ne;ee!==null;){var xe=ee;if(ne=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ne===null||re===null||(xe=Wl(ee,re),xe!=null&&Be.push(Ao(ee,xe,ne))),xt)break;ee=ee.return}0<Be.length&&(ue=new de(ue,Re,null,o,me),ge.push({event:ue,listeners:Be}))}}if((i&7)===0){e:{if(ue=n==="mouseover"||n==="pointerover",de=n==="mouseout"||n==="pointerout",ue&&o!==wf&&(Re=o.relatedTarget||o.fromElement)&&(Ae(Re)||Re[H]))break e;if((de||ue)&&(ue=me.window===me?me:(ue=me.ownerDocument)?ue.defaultView||ue.parentWindow:window,de?(Re=o.relatedTarget||o.toElement,de=se,Re=Re?Ae(Re):null,Re!==null&&(xt=l(Re),Be=Re.tag,Re!==xt||Be!==5&&Be!==27&&Be!==6)&&(Re=null)):(de=null,Re=se),de!==Re)){if(Be=Rx,xe="onMouseLeave",re="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(Be=Fx,xe="onPointerLeave",re="onPointerEnter",ee="pointer"),xt=de==null?ue:ke(de),ne=Re==null?ue:ke(Re),ue=new Be(xe,ee+"leave",de,o,me),ue.target=xt,ue.relatedTarget=ne,xe=null,Ae(me)===se&&(Be=new Be(re,ee+"enter",Re,o,me),Be.target=ne,Be.relatedTarget=xt,xe=Be),xt=xe,de&&Re)t:{for(Be=$k,re=de,ee=Re,ne=0,xe=re;xe;xe=Be(xe))ne++;xe=0;for(var Ie=ee;Ie;Ie=Be(Ie))xe++;for(;0<ne-xe;)re=Be(re),ne--;for(;0<xe-ne;)ee=Be(ee),xe--;for(;ne--;){if(re===ee||ee!==null&&re===ee.alternate){Be=re;break t}re=Be(re),ee=Be(ee)}Be=null}else Be=null;de!==null&&kv(ge,ue,de,Be,!1),Re!==null&&xt!==null&&kv(ge,xt,Re,Be,!0)}}e:{if(ue=se?ke(se):window,de=ue.nodeName&&ue.nodeName.toLowerCase(),de==="select"||de==="input"&&ue.type==="file")var lt=Hx;else if(zx(ue))if($x)lt=tk;else{lt=ZE;var Fe=QE}else de=ue.nodeName,!de||de.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?se&&bf(se.elementType)&&(lt=Hx):lt=ek;if(lt&&(lt=lt(n,se))){Vx(ge,lt,o,me);break e}Fe&&Fe(n,ue,se),n==="focusout"&&se&&ue.type==="number"&&se.memoizedProps.value!=null&&yf(ue,"number",ue.value)}switch(Fe=se?ke(se):window,n){case"focusin":(zx(Fe)||Fe.contentEditable==="true")&&(Fi=Fe,Mf=se,to=null);break;case"focusout":to=Mf=Fi=null;break;case"mousedown":Ff=!0;break;case"contextmenu":case"mouseup":case"dragend":Ff=!1,Qx(ge,o,me);break;case"selectionchange":if(rk)break;case"keydown":case"keyup":Qx(ge,o,me)}var Xe;if(Of)e:{switch(n){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Mi?Bx(n,o)&&(tt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(tt="onCompositionStart");tt&&(Lx&&o.locale!=="ko"&&(Mi||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Mi&&(Xe=Dx()):(Yn=me,Ef="value"in Yn?Yn.value:Yn.textContent,Mi=!0)),Fe=Hu(se,tt),0<Fe.length&&(tt=new Mx(tt,n,null,o,me),ge.push({event:tt,listeners:Fe}),Xe?tt.data=Xe:(Xe=Ux(o),Xe!==null&&(tt.data=Xe)))),(Xe=WE?YE(n,o):XE(n,o))&&(tt=Hu(se,"onBeforeInput"),0<tt.length&&(Fe=new Mx("onBeforeInput","beforeinput",null,o,me),ge.push({event:Fe,listeners:tt}),Fe.data=Xe)),Uk(ge,n,se,o,me)}Sv(ge,i)})}function Ao(n,i,o){return{instance:n,listener:i,currentTarget:o}}function Hu(n,i){for(var o=i+"Capture",f=[];n!==null;){var x=n,v=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||v===null||(x=Wl(n,o),x!=null&&f.unshift(Ao(n,x,v)),x=Wl(n,i),x!=null&&f.push(Ao(n,x,v))),n.tag===3)return f;n=n.return}return[]}function $k(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function kv(n,i,o,f,x){for(var v=i._reactName,E=[];o!==null&&o!==f;){var D=o,K=D.alternate,se=D.stateNode;if(D=D.tag,K!==null&&K===f)break;D!==5&&D!==26&&D!==27||se===null||(K=se,x?(se=Wl(o,v),se!=null&&E.unshift(Ao(o,se,K))):x||(se=Wl(o,v),se!=null&&E.push(Ao(o,se,K)))),o=o.return}E.length!==0&&n.push({event:i,listeners:E})}var Gk=/\r\n?/g,qk=/\u0000|\uFFFD/g;function Av(n){return(typeof n=="string"?n:""+n).replace(Gk,`
`).replace(qk,"")}function Nv(n,i){return i=Av(i),Av(n)===i}function pt(n,i,o,f,x,v){switch(o){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||Di(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&Di(n,""+f);break;case"className":Wc(n,"class",f);break;case"tabIndex":Wc(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Wc(n,o,f);break;case"style":Nx(n,f,v);break;case"data":if(i!=="object"){Wc(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=Xc(""+f),n.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(o==="formAction"?(i!=="input"&&pt(n,i,"name",x.name,x,null),pt(n,i,"formEncType",x.formEncType,x,null),pt(n,i,"formMethod",x.formMethod,x,null),pt(n,i,"formTarget",x.formTarget,x,null)):(pt(n,i,"encType",x.encType,x,null),pt(n,i,"method",x.method,x,null),pt(n,i,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=Xc(""+f),n.setAttribute(o,f);break;case"onClick":f!=null&&(n.onclick=yn);break;case"onScroll":f!=null&&Ze("scroll",n);break;case"onScrollEnd":f!=null&&Ze("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(o=f.__html,o!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}o=Xc(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""+f):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":f===!0?n.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,f):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(o,f):n.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(o):n.setAttribute(o,f);break;case"popover":Ze("beforetoggle",n),Ze("toggle",n),$a(n,"popover",f);break;case"xlinkActuate":vn(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":vn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":vn(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":vn(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":vn(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":vn(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":vn(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":vn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":vn(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":$a(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=bE.get(o)||o,$a(n,o,f))}}function id(n,i,o,f,x,v){switch(o){case"style":Nx(n,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(o=f.__html,o!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof f=="string"?Di(n,f):(typeof f=="number"||typeof f=="bigint")&&Di(n,""+f);break;case"onScroll":f!=null&&Ze("scroll",n);break;case"onScrollEnd":f!=null&&Ze("scrollend",n);break;case"onClick":f!=null&&(n.onclick=yn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wt.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(x=o.endsWith("Capture"),i=o.slice(2,x?o.length-7:void 0),v=n[B]||null,v=v!=null?v[o]:null,typeof v=="function"&&n.removeEventListener(i,v,x),typeof f=="function")){typeof v!="function"&&v!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,f,x);break e}o in n?n[o]=f:f===!0?n.setAttribute(o,""):$a(n,o,f)}}}function ma(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ze("error",n),Ze("load",n);var f=!1,x=!1,v;for(v in o)if(o.hasOwnProperty(v)){var E=o[v];if(E!=null)switch(v){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:pt(n,i,v,E,o,null)}}x&&pt(n,i,"srcSet",o.srcSet,o,null),f&&pt(n,i,"src",o.src,o,null);return;case"input":Ze("invalid",n);var D=v=E=x=null,K=null,se=null;for(f in o)if(o.hasOwnProperty(f)){var me=o[f];if(me!=null)switch(f){case"name":x=me;break;case"type":E=me;break;case"checked":K=me;break;case"defaultChecked":se=me;break;case"value":v=me;break;case"defaultValue":D=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,i));break;default:pt(n,i,f,me,o,null)}}Sx(n,v,D,K,se,E,x,!1);return;case"select":Ze("invalid",n),f=E=v=null;for(x in o)if(o.hasOwnProperty(x)&&(D=o[x],D!=null))switch(x){case"value":v=D;break;case"defaultValue":E=D;break;case"multiple":f=D;default:pt(n,i,x,D,o,null)}i=v,o=E,n.multiple=!!f,i!=null?Oi(n,!!f,i,!1):o!=null&&Oi(n,!!f,o,!0);return;case"textarea":Ze("invalid",n),v=x=f=null;for(E in o)if(o.hasOwnProperty(E)&&(D=o[E],D!=null))switch(E){case"value":f=D;break;case"defaultValue":x=D;break;case"children":v=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(r(91));break;default:pt(n,i,E,D,o,null)}kx(n,f,x,v);return;case"option":for(K in o)o.hasOwnProperty(K)&&(f=o[K],f!=null)&&(K==="selected"?n.selected=f&&typeof f!="function"&&typeof f!="symbol":pt(n,i,K,f,o,null));return;case"dialog":Ze("beforetoggle",n),Ze("toggle",n),Ze("cancel",n),Ze("close",n);break;case"iframe":case"object":Ze("load",n);break;case"video":case"audio":for(f=0;f<ko.length;f++)Ze(ko[f],n);break;case"image":Ze("error",n),Ze("load",n);break;case"details":Ze("toggle",n);break;case"embed":case"source":case"link":Ze("error",n),Ze("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(f=o[se],f!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:pt(n,i,se,f,o,null)}return;default:if(bf(i)){for(me in o)o.hasOwnProperty(me)&&(f=o[me],f!==void 0&&id(n,i,me,f,o,void 0));return}}for(D in o)o.hasOwnProperty(D)&&(f=o[D],f!=null&&pt(n,i,D,f,o,null))}function Wk(n,i,o,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,v=null,E=null,D=null,K=null,se=null,me=null;for(de in o){var ge=o[de];if(o.hasOwnProperty(de)&&ge!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":K=ge;default:f.hasOwnProperty(de)||pt(n,i,de,null,f,ge)}}for(var ue in f){var de=f[ue];if(ge=o[ue],f.hasOwnProperty(ue)&&(de!=null||ge!=null))switch(ue){case"type":v=de;break;case"name":x=de;break;case"checked":se=de;break;case"defaultChecked":me=de;break;case"value":E=de;break;case"defaultValue":D=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,i));break;default:de!==ge&&pt(n,i,ue,de,f,ge)}}vf(n,E,D,K,se,me,v,x);return;case"select":de=E=D=ue=null;for(v in o)if(K=o[v],o.hasOwnProperty(v)&&K!=null)switch(v){case"value":break;case"multiple":de=K;default:f.hasOwnProperty(v)||pt(n,i,v,null,f,K)}for(x in f)if(v=f[x],K=o[x],f.hasOwnProperty(x)&&(v!=null||K!=null))switch(x){case"value":ue=v;break;case"defaultValue":D=v;break;case"multiple":E=v;default:v!==K&&pt(n,i,x,v,f,K)}i=D,o=E,f=de,ue!=null?Oi(n,!!o,ue,!1):!!f!=!!o&&(i!=null?Oi(n,!!o,i,!0):Oi(n,!!o,o?[]:"",!1));return;case"textarea":de=ue=null;for(D in o)if(x=o[D],o.hasOwnProperty(D)&&x!=null&&!f.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:pt(n,i,D,null,f,x)}for(E in f)if(x=f[E],v=o[E],f.hasOwnProperty(E)&&(x!=null||v!=null))switch(E){case"value":ue=x;break;case"defaultValue":de=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==v&&pt(n,i,E,x,f,v)}Ex(n,ue,de);return;case"option":for(var Re in o)ue=o[Re],o.hasOwnProperty(Re)&&ue!=null&&!f.hasOwnProperty(Re)&&(Re==="selected"?n.selected=!1:pt(n,i,Re,null,f,ue));for(K in f)ue=f[K],de=o[K],f.hasOwnProperty(K)&&ue!==de&&(ue!=null||de!=null)&&(K==="selected"?n.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":pt(n,i,K,ue,f,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in o)ue=o[Be],o.hasOwnProperty(Be)&&ue!=null&&!f.hasOwnProperty(Be)&&pt(n,i,Be,null,f,ue);for(se in f)if(ue=f[se],de=o[se],f.hasOwnProperty(se)&&ue!==de&&(ue!=null||de!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,i));break;default:pt(n,i,se,ue,f,de)}return;default:if(bf(i)){for(var xt in o)ue=o[xt],o.hasOwnProperty(xt)&&ue!==void 0&&!f.hasOwnProperty(xt)&&id(n,i,xt,void 0,f,ue);for(me in f)ue=f[me],de=o[me],!f.hasOwnProperty(me)||ue===de||ue===void 0&&de===void 0||id(n,i,me,ue,f,de);return}}for(var re in o)ue=o[re],o.hasOwnProperty(re)&&ue!=null&&!f.hasOwnProperty(re)&&pt(n,i,re,null,f,ue);for(ge in f)ue=f[ge],de=o[ge],!f.hasOwnProperty(ge)||ue===de||ue==null&&de==null||pt(n,i,ge,ue,f,de)}function Cv(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Yk(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),f=0;f<o.length;f++){var x=o[f],v=x.transferSize,E=x.initiatorType,D=x.duration;if(v&&D&&Cv(E)){for(E=0,D=x.responseEnd,f+=1;f<o.length;f++){var K=o[f],se=K.startTime;if(se>D)break;var me=K.transferSize,ge=K.initiatorType;me&&Cv(ge)&&(K=K.responseEnd,E+=me*(K<D?1:(D-se)/(K-se)))}if(--f,i+=8*(v+E)/(x.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var ld=null,od=null;function $u(n){return n.nodeType===9?n:n.ownerDocument}function Ov(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dv(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function cd(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var ud=null;function Xk(){var n=window.event;return n&&n.type==="popstate"?n===ud?!1:(ud=n,!0):(ud=null,!1)}var jv=typeof setTimeout=="function"?setTimeout:void 0,Kk=typeof clearTimeout=="function"?clearTimeout:void 0,Rv=typeof Promise=="function"?Promise:void 0,Jk=typeof queueMicrotask=="function"?queueMicrotask:typeof Rv<"u"?function(n){return Rv.resolve(null).then(n).catch(Qk)}:jv;function Qk(n){setTimeout(function(){throw n})}function fs(n){return n==="head"}function Mv(n,i){var o=i,f=0;do{var x=o.nextSibling;if(n.removeChild(o),x&&x.nodeType===8)if(o=x.data,o==="/$"||o==="/&"){if(f===0){n.removeChild(x),ol(i);return}f--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")f++;else if(o==="html")No(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,No(o);for(var v=o.firstChild;v;){var E=v.nextSibling,D=v.nodeName;v[fe]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&v.rel.toLowerCase()==="stylesheet"||o.removeChild(v),v=E}}else o==="body"&&No(n.ownerDocument.body);o=x}while(o);ol(i)}function Fv(n,i){var o=n;n=0;do{var f=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=f}while(o)}function fd(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fd(o),Te(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function Zk(n,i,o,f){for(;n.nodeType===1;){var x=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[fe])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(v=n.getAttribute("rel"),v==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(v!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(v=n.getAttribute("src"),(v!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&v&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var v=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===v)return n}else return n;if(n=Sr(n.nextSibling),n===null)break}return null}function e4(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Sr(n.nextSibling),n===null))return null;return n}function Lv(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=Sr(n.nextSibling),n===null))return null;return n}function hd(n){return n.data==="$?"||n.data==="$~"}function dd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function t4(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var f=function(){i(),o.removeEventListener("DOMContentLoaded",f)};o.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function Sr(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var md=null;function Pv(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return Sr(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function Iv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function Bv(n,i,o){switch(i=$u(o),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function No(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Te(n)}var Er=new Map,Uv=new Set;function Gu(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Fn=te.d;te.d={f:a4,r:r4,D:n4,C:s4,L:i4,m:l4,X:c4,S:o4,M:u4};function a4(){var n=Fn.f(),i=Lu();return n||i}function r4(n){var i=De(n);i!==null&&i.tag===5&&i.type==="form"?rg(i):Fn.r(n)}var sl=typeof document>"u"?null:document;function zv(n,i,o){var f=sl;if(f&&typeof i=="string"&&i){var x=gr(i);x='link[rel="'+n+'"][href="'+x+'"]',typeof o=="string"&&(x+='[crossorigin="'+o+'"]'),Uv.has(x)||(Uv.add(x),n={rel:n,crossOrigin:o,href:i},f.querySelector(x)===null&&(i=f.createElement("link"),ma(i,"link",n),Me(i),f.head.appendChild(i)))}}function n4(n){Fn.D(n),zv("dns-prefetch",n,null)}function s4(n,i){Fn.C(n,i),zv("preconnect",n,i)}function i4(n,i,o){Fn.L(n,i,o);var f=sl;if(f&&n&&i){var x='link[rel="preload"][as="'+gr(i)+'"]';i==="image"&&o&&o.imageSrcSet?(x+='[imagesrcset="'+gr(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(x+='[imagesizes="'+gr(o.imageSizes)+'"]')):x+='[href="'+gr(n)+'"]';var v=x;switch(i){case"style":v=il(n);break;case"script":v=ll(n)}Er.has(v)||(n=g({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),Er.set(v,n),f.querySelector(x)!==null||i==="style"&&f.querySelector(Co(v))||i==="script"&&f.querySelector(Oo(v))||(i=f.createElement("link"),ma(i,"link",n),Me(i),f.head.appendChild(i)))}}function l4(n,i){Fn.m(n,i);var o=sl;if(o&&n){var f=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+gr(f)+'"][href="'+gr(n)+'"]',v=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ll(n)}if(!Er.has(v)&&(n=g({rel:"modulepreload",href:n},i),Er.set(v,n),o.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Oo(v)))return}f=o.createElement("link"),ma(f,"link",n),Me(f),o.head.appendChild(f)}}}function o4(n,i,o){Fn.S(n,i,o);var f=sl;if(f&&n){var x=Ce(f).hoistableStyles,v=il(n);i=i||"default";var E=x.get(v);if(!E){var D={loading:0,preload:null};if(E=f.querySelector(Co(v)))D.loading=5;else{n=g({rel:"stylesheet",href:n,"data-precedence":i},o),(o=Er.get(v))&&pd(n,o);var K=E=f.createElement("link");Me(K),ma(K,"link",n),K._p=new Promise(function(se,me){K.onload=se,K.onerror=me}),K.addEventListener("load",function(){D.loading|=1}),K.addEventListener("error",function(){D.loading|=2}),D.loading|=4,qu(E,i,f)}E={type:"stylesheet",instance:E,count:1,state:D},x.set(v,E)}}}function c4(n,i){Fn.X(n,i);var o=sl;if(o&&n){var f=Ce(o).hoistableScripts,x=ll(n),v=f.get(x);v||(v=o.querySelector(Oo(x)),v||(n=g({src:n,async:!0},i),(i=Er.get(x))&&xd(n,i),v=o.createElement("script"),Me(v),ma(v,"link",n),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(x,v))}}function u4(n,i){Fn.M(n,i);var o=sl;if(o&&n){var f=Ce(o).hoistableScripts,x=ll(n),v=f.get(x);v||(v=o.querySelector(Oo(x)),v||(n=g({src:n,async:!0,type:"module"},i),(i=Er.get(x))&&xd(n,i),v=o.createElement("script"),Me(v),ma(v,"link",n),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(x,v))}}function Vv(n,i,o,f){var x=(x=he.current)?Gu(x):null;if(!x)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=il(o.href),o=Ce(x).hoistableStyles,f=o.get(i),f||(f={type:"style",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=il(o.href);var v=Ce(x).hoistableStyles,E=v.get(n);if(E||(x=x.ownerDocument||x,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(n,E),(v=x.querySelector(Co(n)))&&!v._p&&(E.instance=v,E.state.loading=5),Er.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Er.set(n,o),v||f4(x,n,o,E.state))),i&&f===null)throw Error(r(528,""));return E}if(i&&f!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ll(o),o=Ce(x).hoistableScripts,f=o.get(i),f||(f={type:"script",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function il(n){return'href="'+gr(n)+'"'}function Co(n){return'link[rel="stylesheet"]['+n+"]"}function Hv(n){return g({},n,{"data-precedence":n.precedence,precedence:null})}function f4(n,i,o,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),ma(i,"link",o),Me(i),n.head.appendChild(i))}function ll(n){return'[src="'+gr(n)+'"]'}function Oo(n){return"script[async]"+n}function $v(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+gr(o.href)+'"]');if(f)return i.instance=f,Me(f),f;var x=g({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),Me(f),ma(f,"style",x),qu(f,o.precedence,n),i.instance=f;case"stylesheet":x=il(o.href);var v=n.querySelector(Co(x));if(v)return i.state.loading|=4,i.instance=v,Me(v),v;f=Hv(o),(x=Er.get(x))&&pd(f,x),v=(n.ownerDocument||n).createElement("link"),Me(v);var E=v;return E._p=new Promise(function(D,K){E.onload=D,E.onerror=K}),ma(v,"link",f),i.state.loading|=4,qu(v,o.precedence,n),i.instance=v;case"script":return v=ll(o.src),(x=n.querySelector(Oo(v)))?(i.instance=x,Me(x),x):(f=o,(x=Er.get(v))&&(f=g({},o),xd(f,x)),n=n.ownerDocument||n,x=n.createElement("script"),Me(x),ma(x,"link",f),n.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,qu(f,o.precedence,n));return i.instance}function qu(n,i,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,v=x,E=0;E<f.length;E++){var D=f[E];if(D.dataset.precedence===i)v=D;else if(v!==x)break}v?v.parentNode.insertBefore(n,v.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function pd(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function xd(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Wu=null;function Gv(n,i,o){if(Wu===null){var f=new Map,x=Wu=new Map;x.set(o,f)}else x=Wu,f=x.get(o),f||(f=new Map,x.set(o,f));if(f.has(n))return f;for(f.set(n,null),o=o.getElementsByTagName(n),x=0;x<o.length;x++){var v=o[x];if(!(v[fe]||v[F]||n==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(i)||"";E=n+E;var D=f.get(E);D?D.push(v):f.set(E,[v])}}return f}function qv(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function h4(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Wv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function d4(n,i,o,f){if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var x=il(f.href),v=i.querySelector(Co(x));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Yu.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=v,Me(v);return}v=i.ownerDocument||i,f=Hv(f),(x=Er.get(x))&&pd(f,x),v=v.createElement("link"),Me(v);var E=v;E._p=new Promise(function(D,K){E.onload=D,E.onerror=K}),ma(v,"link",f),o.instance=v}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Yu.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var gd=0;function m4(n,i){return n.stylesheets&&n.count===0&&Ku(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var f=setTimeout(function(){if(n.stylesheets&&Ku(n,n.stylesheets),n.unsuspend){var v=n.unsuspend;n.unsuspend=null,v()}},6e4+i);0<n.imgBytes&&gd===0&&(gd=62500*Yk());var x=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Ku(n,n.stylesheets),n.unsuspend)){var v=n.unsuspend;n.unsuspend=null,v()}},(n.imgBytes>gd?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function Yu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ku(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Xu=null;function Ku(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Xu=new Map,i.forEach(p4,n),Xu=null,Yu.call(n))}function p4(n,i){if(!(i.state.loading&4)){var o=Xu.get(n);if(o)var f=o.get(null);else{o=new Map,Xu.set(n,o);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<x.length;v++){var E=x[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),f=E)}f&&o.set(null,f)}x=i.instance,E=x.getAttribute("data-precedence"),v=o.get(E)||f,v===f&&o.set(null,x),o.set(E,x),this.count++,f=Yu.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),v?v.parentNode.insertBefore(x,v.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),i.state.loading|=4}}var Do={$$typeof:S,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function x4(n,i,o,f,x,v,E,D,K){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hl(0),this.hiddenUpdates=Hl(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function Yv(n,i,o,f,x,v,E,D,K,se,me,ge){return n=new x4(n,i,o,E,K,se,me,ge,D),i=1,v===!0&&(i|=24),v=er(3,null,null,i),n.current=v,v.stateNode=n,i=Kf(),i.refCount++,n.pooledCache=i,i.refCount++,v.memoizedState={element:f,isDehydrated:o,cache:i},eh(v),n}function Xv(n){return n?(n=Ii,n):Ii}function Kv(n,i,o,f,x,v){x=Xv(x),f.context===null?f.context=x:f.pendingContext=x,f=es(i),f.payload={element:o},v=v===void 0?null:v,v!==null&&(f.callback=v),o=ts(n,f,i),o!==null&&(Ka(o,n,i),oo(o,n,i))}function Jv(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function vd(n,i){Jv(n,i),(n=n.alternate)&&Jv(n,i)}function Qv(n){if(n.tag===13||n.tag===31){var i=Vs(n,67108864);i!==null&&Ka(i,n,67108864),vd(n,67108864)}}function Zv(n){if(n.tag===13||n.tag===31){var i=sr();i=$l(i);var o=Vs(n,i);o!==null&&Ka(o,n,i),vd(n,i)}}var Ju=!0;function g4(n,i,o,f){var x=R.T;R.T=null;var v=te.p;try{te.p=2,yd(n,i,o,f)}finally{te.p=v,R.T=x}}function v4(n,i,o,f){var x=R.T;R.T=null;var v=te.p;try{te.p=8,yd(n,i,o,f)}finally{te.p=v,R.T=x}}function yd(n,i,o,f){if(Ju){var x=bd(f);if(x===null)sd(n,i,f,Qu,o),ty(n,f);else if(b4(x,n,i,o,f))f.stopPropagation();else if(ty(n,f),i&4&&-1<y4.indexOf(n)){for(;x!==null;){var v=De(x);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=mr(v.pendingLanes);if(E!==0){var D=v;for(D.pendingLanes|=2,D.entangledLanes|=2;E;){var K=1<<31-Ra(E);D.entanglements[1]|=K,E&=~K}sn(v),(ut&6)===0&&(Mu=gt()+500,Eo(0))}}break;case 31:case 13:D=Vs(v,2),D!==null&&Ka(D,v,2),Lu(),vd(v,2)}if(v=bd(f),v===null&&sd(n,i,f,Qu,o),v===x)break;x=v}x!==null&&f.stopPropagation()}else sd(n,i,f,null,o)}}function bd(n){return n=_f(n),wd(n)}var Qu=null;function wd(n){if(Qu=null,n=Ae(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=c(i),n!==null)return n;n=null}else if(o===31){if(n=u(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Qu=n,null}function ey(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fr()){case Lr:return 2;case qn:return 8;case qt:case dr:return 32;case Ye:return 268435456;default:return 32}default:return 32}}var _d=!1,hs=null,ds=null,ms=null,jo=new Map,Ro=new Map,ps=[],y4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ty(n,i){switch(n){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":jo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(i.pointerId)}}function Mo(n,i,o,f,x,v){return n===null||n.nativeEvent!==v?(n={blockedOn:i,domEventName:o,eventSystemFlags:f,nativeEvent:v,targetContainers:[x]},i!==null&&(i=De(i),i!==null&&Qv(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),n)}function b4(n,i,o,f,x){switch(i){case"focusin":return hs=Mo(hs,n,i,o,f,x),!0;case"dragenter":return ds=Mo(ds,n,i,o,f,x),!0;case"mouseover":return ms=Mo(ms,n,i,o,f,x),!0;case"pointerover":var v=x.pointerId;return jo.set(v,Mo(jo.get(v)||null,n,i,o,f,x)),!0;case"gotpointercapture":return v=x.pointerId,Ro.set(v,Mo(Ro.get(v)||null,n,i,o,f,x)),!0}return!1}function ay(n){var i=Ae(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){n.blockedOn=i,U(n.priority,function(){Zv(o)});return}}else if(i===31){if(i=u(o),i!==null){n.blockedOn=i,U(n.priority,function(){Zv(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Zu(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=bd(n.nativeEvent);if(o===null){o=n.nativeEvent;var f=new o.constructor(o.type,o);wf=f,o.target.dispatchEvent(f),wf=null}else return i=De(o),i!==null&&Qv(i),n.blockedOn=o,!1;i.shift()}return!0}function ry(n,i,o){Zu(n)&&o.delete(i)}function w4(){_d=!1,hs!==null&&Zu(hs)&&(hs=null),ds!==null&&Zu(ds)&&(ds=null),ms!==null&&Zu(ms)&&(ms=null),jo.forEach(ry),Ro.forEach(ry)}function e0(n,i){n.blockedOn===i&&(n.blockedOn=null,_d||(_d=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,w4)))}var t0=null;function ny(n){t0!==n&&(t0=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){t0===n&&(t0=null);for(var i=0;i<n.length;i+=3){var o=n[i],f=n[i+1],x=n[i+2];if(typeof f!="function"){if(wd(f||o)===null)continue;break}var v=De(o);v!==null&&(n.splice(i,3),i-=3,bh(v,{pending:!0,data:x,method:o.method,action:f},f,x))}}))}function ol(n){function i(K){return e0(K,n)}hs!==null&&e0(hs,n),ds!==null&&e0(ds,n),ms!==null&&e0(ms,n),jo.forEach(i),Ro.forEach(i);for(var o=0;o<ps.length;o++){var f=ps[o];f.blockedOn===n&&(f.blockedOn=null)}for(;0<ps.length&&(o=ps[0],o.blockedOn===null);)ay(o),o.blockedOn===null&&ps.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var x=o[f],v=o[f+1],E=x[B]||null;if(typeof v=="function")E||ny(o);else if(E){var D=null;if(v&&v.hasAttribute("formAction")){if(x=v,E=v[B]||null)D=E.formAction;else if(wd(x)!==null)continue}else D=E.action;typeof D=="function"?o[f+1]=D:(o.splice(f,3),f-=3),ny(o)}}}function sy(){function n(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(E){return x=E})},focusReset:"manual",scroll:"manual"})}function i(){x!==null&&(x(),x=null),f||setTimeout(o,20)}function o(){if(!f&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),x!==null&&(x(),x=null)}}}function Td(n){this._internalRoot=n}a0.prototype.render=Td.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,f=sr();Kv(o,f,n,i,null,null)},a0.prototype.unmount=Td.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Kv(n.current,2,null,n,null,null),Lu(),i[H]=null}};function a0(n){this._internalRoot=n}a0.prototype.unstable_scheduleHydration=function(n){if(n){var i=C();n={blockedOn:null,target:n,priority:i};for(var o=0;o<ps.length&&i!==0&&i<ps[o].priority;o++);ps.splice(o,0,n),o===0&&ay(n)}};var iy=t.version;if(iy!=="19.2.3")throw Error(r(527,iy,"19.2.3"));te.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=m(i),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var _4={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var r0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!r0.isDisabled&&r0.supportsFiber)try{St=r0.inject(_4),Vt=r0}catch{}}return Lo.createRoot=function(n,i){if(!s(n))throw Error(r(299));var o=!1,f="",x=dg,v=mg,E=pg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError)),i=Yv(n,1,!1,null,null,o,f,null,x,v,E,sy),n[H]=i.current,nd(n),new Td(i)},Lo.hydrateRoot=function(n,i,o){if(!s(n))throw Error(r(299));var f=!1,x="",v=dg,E=mg,D=pg,K=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(D=o.onRecoverableError),o.formState!==void 0&&(K=o.formState)),i=Yv(n,1,!0,i,o??null,f,x,K,v,E,D,sy),i.context=Xv(null),o=i.current,f=sr(),f=$l(f),x=es(f),x.callback=null,ts(o,x,f),o=f,i.current.lanes=o,Ps(i,o),sn(i),n[H]=i.current,nd(n),new a0(i)},Lo.version="19.2.3",Lo}var xy;function R4(){if(xy)return kd.exports;xy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),kd.exports=j4(),kd.exports}var M4=R4();const F4=bw(M4);const L4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ww=(...e)=>e.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim();var P4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const I4=ie.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:s="",children:l,iconNode:c,...u},h)=>ie.createElement("svg",{ref:h,...P4,width:t,height:t,stroke:e,strokeWidth:r?Number(a)*24/Number(t):a,className:ww("lucide",s),...u},[...c.map(([m,p])=>ie.createElement(m,p)),...Array.isArray(l)?l:[l]]));const Le=(e,t)=>{const a=ie.forwardRef(({className:r,...s},l)=>ie.createElement(I4,{ref:l,iconNode:t,className:ww(`lucide-${L4(e)}`,r),...s}));return a.displayName=`${e}`,a};const B4=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],n0=Le("Activity",B4);const U4=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],z4=Le("ArrowDownRight",U4);const V4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],H4=Le("ArrowLeft",V4);const $4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],G4=Le("ArrowRight",$4);const q4=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],gy=Le("ArrowUpRight",q4);const W4=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Y4=Le("Award",W4);const X4=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],mm=Le("Brain",X4);const K4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],J4=Le("CalendarCheck",K4);const Q4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],lc=Le("Calendar",Q4);const Z4=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],pm=Le("Camera",Z4);const eA=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],T0=Le("Car",eA);const tA=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],aA=Le("ChartColumn",tA);const rA=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],nA=Le("ChartPie",rA);const sA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],op=Le("CircleAlert",sA);const iA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],lA=Le("CircleArrowDown",iA);const oA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],cA=Le("CircleArrowUp",oA);const uA=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fA=Le("CircleCheckBig",uA);const hA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xm=Le("CircleCheck",hA);const dA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],mA=Le("Circle",dA);const pA=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],xA=Le("Clipboard",pA);const gA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],vA=Le("Clock",gA);const yA=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],bA=Le("Copy",yA);const wA=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Z0=Le("CreditCard",wA);const _A=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],_w=Le("DollarSign",_A);const TA=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],vy=Le("ExternalLink",TA);const SA=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],EA=Le("Filter",SA);const kA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],AA=Le("Image",kA);const NA=[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]],S0=Le("Landmark",NA);const CA=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],OA=Le("LayoutDashboard",CA);const DA=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],yy=Le("LayoutGrid",DA);const jA=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],RA=Le("Menu",jA);const MA=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],FA=Le("MessageSquare",MA);const LA=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],PA=Le("Mic",LA);const IA=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],BA=Le("PenLine",IA);const UA=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Tw=Le("Pill",UA);const zA=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],VA=Le("Play",zA);const HA=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],zn=Le("Plus",HA);const $A=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],cp=Le("RefreshCw",$A);const GA=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],qA=Le("Ruler",GA);const WA=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],by=Le("Save",WA);const YA=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ef=Le("Search",YA);const XA=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],up=Le("Settings",XA);const KA=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],wy=Le("ShieldCheck",KA);const JA=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Sw=Le("Sparkles",JA);const QA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ZA=Le("Square",QA);const eN=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],E0=Le("Stethoscope",eN);const tN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],aN=Le("Target",tN);const rN=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],nN=Le("Timer",rN);const sN=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],jr=Le("Trash2",sN);const iN=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],oc=Le("TrendingDown",iN);const lN=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],fn=Le("TrendingUp",lN);const oN=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],cN=Le("TriangleAlert",oN);const uN=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],fN=Le("Upload",uN);const hN=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_y=Le("User",hN);const dN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Ty=Le("Users",dN);const mN=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],O0=Le("Wallet",mN);const pN=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],xN=Le("Weight",pN);const gN=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],vN=Le("Wind",gN);const yN=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qr=Le("X",yN),bN=({activeView:e,setActiveView:t})=>{const a=[{id:"dashboard",label:"Panel Principal",icon:OA},{id:"budget",label:"Presupuesto",icon:nA},{id:"accounts",label:"Mis Cuentas",icon:O0},{id:"transactions",label:"Movimientos",icon:Z0},{id:"debts",label:"Deudas",icon:S0},{id:"investments",label:"Inversiones",icon:fn},{id:"vehicles",label:"Mis Vehculos",icon:T0},{id:"medical",label:"Salud",icon:E0},{id:"journal",label:"Pensamientos",icon:mm}];return d.jsxs("div",{className:"flex flex-col h-full bg-white",children:[d.jsx("div",{className:"p-6 pb-4 flex-shrink-0",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-blue-200",children:d.jsx(O0,{size:24})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"FinanzasPro"}),d.jsx("p",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold",children:"Smart Wealth"})]})]})}),d.jsx("nav",{className:"flex-1 px-4 space-y-1.5 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200 scrollbar-track-transparent",children:a.map(r=>d.jsxs("button",{onClick:()=>t(r.id),className:`sidebar-link group w-full ${e===r.id?"bg-blue-50 text-blue-700 font-semibold":"text-slate-500 hover:bg-slate-50 hover:text-slate-900"}`,children:[d.jsx(r.icon,{size:20,className:`transition-colors ${e===r.id?"text-blue-600":"text-slate-400 group-hover:text-slate-600"}`}),d.jsx("span",{className:"text-sm",children:r.label}),e===r.id&&d.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-600 shadow-sm"})]},r.id))}),d.jsx("div",{className:"p-4 flex-shrink-0 border-t border-slate-100/80",children:d.jsxs("button",{onClick:()=>t("settings"),className:`sidebar-link group w-full ${e==="settings"?"bg-blue-50 text-blue-700 font-semibold":"text-slate-500 hover:bg-slate-50 hover:text-slate-900"}`,children:[d.jsx(up,{size:20,className:`transition-colors ${e==="settings"?"text-blue-600":"text-slate-400 group-hover:text-slate-600"}`}),d.jsx("span",{className:"text-sm",children:"Configuracin"}),e==="settings"&&d.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-600 shadow-sm"})]})})]})},Ew=6048e5,wN=864e5,kw=6e4,Aw=36e5,Sy=Symbol.for("constructDateFrom");function Zr(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Sy in e?e[Sy](t):e instanceof Date?new e.constructor(t):new Date(t)}function Oa(e,t){return Zr(t||e,e)}function Nw(e,t,a){const r=Oa(e,a?.in);if(isNaN(t))return Zr(e,NaN);if(!t)return r;const s=r.getDate(),l=Zr(e,r.getTime());l.setMonth(r.getMonth()+t+1,0);const c=l.getDate();return s>=c?l:(r.setFullYear(l.getFullYear(),l.getMonth(),s),r)}let _N={};function tf(){return _N}function cc(e,t){const a=tf(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,s=Oa(e,t?.in),l=s.getDay(),c=(l<r?7:0)+l-r;return s.setDate(s.getDate()-c),s.setHours(0,0,0,0),s}function D0(e,t){return cc(e,{...t,weekStartsOn:1})}function Cw(e,t){const a=Oa(e,t?.in),r=a.getFullYear(),s=Zr(a,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const l=D0(s),c=Zr(a,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const u=D0(c);return a.getTime()>=l.getTime()?r+1:a.getTime()>=u.getTime()?r:r-1}function Ey(e){const t=Oa(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),+e-+a}function TN(e,...t){const a=Zr.bind(null,t.find(r=>typeof r=="object"));return t.map(a)}function ky(e,t){const a=Oa(e,t?.in);return a.setHours(0,0,0,0),a}function SN(e,t,a){const[r,s]=TN(a?.in,e,t),l=ky(r),c=ky(s),u=+l-Ey(l),h=+c-Ey(c);return Math.round((u-h)/wN)}function EN(e,t){const a=Cw(e,t),r=Zr(e,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),D0(r)}function kN(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function AN(e){return!(!kN(e)&&typeof e!="number"||isNaN(+Oa(e)))}function NN(e,t){const a=Oa(e,t?.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const CN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ON=(e,t,a)=>{let r;const s=CN[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),a?.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function Nl(e){return(t={})=>{const a=t.width?String(t.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const DN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},RN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},MN={date:Nl({formats:DN,defaultWidth:"full"}),time:Nl({formats:jN,defaultWidth:"full"}),dateTime:Nl({formats:RN,defaultWidth:"full"})},FN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},LN=(e,t,a,r)=>FN[e];function cn(e){return(t,a)=>{const r=a?.context?String(a.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,u=a?.width?String(a.width):c;s=e.formattingValues[u]||e.formattingValues[c]}else{const c=e.defaultWidth,u=a?.width?String(a.width):e.defaultWidth;s=e.values[u]||e.values[c]}const l=e.argumentCallback?e.argumentCallback(t):t;return s[l]}}const PN={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},IN={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},BN={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},UN={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},zN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},VN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},HN=(e,t)=>{const a=Number(e),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},$N={ordinalNumber:HN,era:cn({values:PN,defaultWidth:"wide"}),quarter:cn({values:IN,defaultWidth:"wide",argumentCallback:e=>e-1}),month:cn({values:BN,defaultWidth:"wide"}),day:cn({values:UN,defaultWidth:"wide"}),dayPeriod:cn({values:zN,defaultWidth:"wide",formattingValues:VN,defaultFormattingWidth:"wide"})};function un(e){return(t,a={})=>{const r=a.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=t.match(s);if(!l)return null;const c=l[0],u=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],h=Array.isArray(u)?qN(u,g=>g.test(c)):GN(u,g=>g.test(c));let m;m=e.valueCallback?e.valueCallback(h):h,m=a.valueCallback?a.valueCallback(m):m;const p=t.slice(c.length);return{value:m,rest:p}}}function GN(e,t){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t(e[a]))return a}function qN(e,t){for(let a=0;a<e.length;a++)if(t(e[a]))return a}function Ow(e){return(t,a={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],l=t.match(e.parsePattern);if(!l)return null;let c=e.valueCallback?e.valueCallback(l[0]):l[0];c=a.valueCallback?a.valueCallback(c):c;const u=t.slice(s.length);return{value:c,rest:u}}}const WN=/^(\d+)(th|st|nd|rd)?/i,YN=/\d+/i,XN={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},KN={any:[/^b/i,/^(a|c)/i]},JN={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},QN={any:[/1/i,/2/i,/3/i,/4/i]},ZN={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},e3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},t3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},a3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},r3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},n3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},s3={ordinalNumber:Ow({matchPattern:WN,parsePattern:YN,valueCallback:e=>parseInt(e,10)}),era:un({matchPatterns:XN,defaultMatchWidth:"wide",parsePatterns:KN,defaultParseWidth:"any"}),quarter:un({matchPatterns:JN,defaultMatchWidth:"wide",parsePatterns:QN,defaultParseWidth:"any",valueCallback:e=>e+1}),month:un({matchPatterns:ZN,defaultMatchWidth:"wide",parsePatterns:e3,defaultParseWidth:"any"}),day:un({matchPatterns:t3,defaultMatchWidth:"wide",parsePatterns:a3,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:r3,defaultMatchWidth:"any",parsePatterns:n3,defaultParseWidth:"any"})},i3={code:"en-US",formatDistance:ON,formatLong:MN,formatRelative:LN,localize:$N,match:s3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function l3(e,t){const a=Oa(e,t?.in);return SN(a,NN(a))+1}function o3(e,t){const a=Oa(e,t?.in),r=+D0(a)-+EN(a);return Math.round(r/Ew)+1}function Dw(e,t){const a=Oa(e,t?.in),r=a.getFullYear(),s=tf(),l=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=Zr(t?.in||e,0);c.setFullYear(r+1,0,l),c.setHours(0,0,0,0);const u=cc(c,t),h=Zr(t?.in||e,0);h.setFullYear(r,0,l),h.setHours(0,0,0,0);const m=cc(h,t);return+a>=+u?r+1:+a>=+m?r:r-1}function c3(e,t){const a=tf(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=Dw(e,t),l=Zr(t?.in||e,0);return l.setFullYear(s,0,r),l.setHours(0,0,0,0),cc(l,t)}function u3(e,t){const a=Oa(e,t?.in),r=+cc(a,t)-+c3(a,t);return Math.round(r/Ew)+1}function dt(e,t){const a=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return a+r}const gs={y(e,t){const a=e.getFullYear(),r=a>0?a:1-a;return dt(t==="yy"?r%100:r,t.length)},M(e,t){const a=e.getMonth();return t==="M"?String(a+1):dt(a+1,2)},d(e,t){return dt(e.getDate(),t.length)},a(e,t){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];default:return a==="am"?"a.m.":"p.m."}},h(e,t){return dt(e.getHours()%12||12,t.length)},H(e,t){return dt(e.getHours(),t.length)},m(e,t){return dt(e.getMinutes(),t.length)},s(e,t){return dt(e.getSeconds(),t.length)},S(e,t){const a=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,a-3));return dt(s,t.length)}},cl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ay={G:function(e,t,a){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});default:return a.era(r,{width:"wide"})}},y:function(e,t,a){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return a.ordinalNumber(s,{unit:"year"})}return gs.y(e,t)},Y:function(e,t,a,r){const s=Dw(e,r),l=s>0?s:1-s;if(t==="YY"){const c=l%100;return dt(c,2)}return t==="Yo"?a.ordinalNumber(l,{unit:"year"}):dt(l,t.length)},R:function(e,t){const a=Cw(e);return dt(a,t.length)},u:function(e,t){const a=e.getFullYear();return dt(a,t.length)},Q:function(e,t,a){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return dt(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,a){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return dt(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,a){const r=e.getMonth();switch(t){case"M":case"MM":return gs.M(e,t);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,a){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return dt(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,a,r){const s=u3(e,r);return t==="wo"?a.ordinalNumber(s,{unit:"week"}):dt(s,t.length)},I:function(e,t,a){const r=o3(e);return t==="Io"?a.ordinalNumber(r,{unit:"week"}):dt(r,t.length)},d:function(e,t,a){return t==="do"?a.ordinalNumber(e.getDate(),{unit:"date"}):gs.d(e,t)},D:function(e,t,a){const r=l3(e);return t==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):dt(r,t.length)},E:function(e,t,a){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,a,r){const s=e.getDay(),l=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return dt(l,2);case"eo":return a.ordinalNumber(l,{unit:"day"});case"eee":return a.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(s,{width:"short",context:"formatting"});default:return a.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,a,r){const s=e.getDay(),l=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return dt(l,t.length);case"co":return a.ordinalNumber(l,{unit:"day"});case"ccc":return a.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(s,{width:"narrow",context:"standalone"});case"cccccc":return a.day(s,{width:"short",context:"standalone"});default:return a.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,a){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return dt(s,t.length);case"io":return a.ordinalNumber(s,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,a){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,a){const r=e.getHours();let s;switch(r===12?s=cl.noon:r===0?s=cl.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,a){const r=e.getHours();let s;switch(r>=17?s=cl.evening:r>=12?s=cl.afternoon:r>=4?s=cl.morning:s=cl.night,t){case"B":case"BB":case"BBB":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,a){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return gs.h(e,t)},H:function(e,t,a){return t==="Ho"?a.ordinalNumber(e.getHours(),{unit:"hour"}):gs.H(e,t)},K:function(e,t,a){const r=e.getHours()%12;return t==="Ko"?a.ordinalNumber(r,{unit:"hour"}):dt(r,t.length)},k:function(e,t,a){let r=e.getHours();return r===0&&(r=24),t==="ko"?a.ordinalNumber(r,{unit:"hour"}):dt(r,t.length)},m:function(e,t,a){return t==="mo"?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):gs.m(e,t)},s:function(e,t,a){return t==="so"?a.ordinalNumber(e.getSeconds(),{unit:"second"}):gs.s(e,t)},S:function(e,t){return gs.S(e,t)},X:function(e,t,a){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Cy(r);case"XXXX":case"XX":return ni(r);default:return ni(r,":")}},x:function(e,t,a){const r=e.getTimezoneOffset();switch(t){case"x":return Cy(r);case"xxxx":case"xx":return ni(r);default:return ni(r,":")}},O:function(e,t,a){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ny(r,":");default:return"GMT"+ni(r,":")}},z:function(e,t,a){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ny(r,":");default:return"GMT"+ni(r,":")}},t:function(e,t,a){const r=Math.trunc(+e/1e3);return dt(r,t.length)},T:function(e,t,a){return dt(+e,t.length)}};function Ny(e,t=""){const a=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),l=r%60;return l===0?a+String(s):a+String(s)+t+dt(l,2)}function Cy(e,t){return e%60===0?(e>0?"-":"+")+dt(Math.abs(e)/60,2):ni(e,t)}function ni(e,t=""){const a=e>0?"-":"+",r=Math.abs(e),s=dt(Math.trunc(r/60),2),l=dt(r%60,2);return a+s+t+l}const Oy=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},jw=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},f3=(e,t)=>{const a=e.match(/(P+)(p+)?/)||[],r=a[1],s=a[2];if(!s)return Oy(e,t);let l;switch(r){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",Oy(r,t)).replace("{{time}}",jw(s,t))},h3={p:jw,P:f3},d3=/^D+$/,m3=/^Y+$/,p3=["D","DD","YY","YYYY"];function x3(e){return d3.test(e)}function g3(e){return m3.test(e)}function v3(e,t,a){const r=y3(e,t,a);if(console.warn(r),p3.includes(e))throw new RangeError(r)}function y3(e,t,a){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const b3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,w3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_3=/^'([^]*?)'?$/,T3=/''/g,S3=/[a-zA-Z]/;function yt(e,t,a){const r=tf(),s=a?.locale??r.locale??i3,l=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,c=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,u=Oa(e,a?.in);if(!AN(u))throw new RangeError("Invalid time value");let h=t.match(w3).map(p=>{const g=p[0];if(g==="p"||g==="P"){const y=h3[g];return y(p,s.formatLong)}return p}).join("").match(b3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const g=p[0];if(g==="'")return{isToken:!1,value:E3(p)};if(Ay[g])return{isToken:!0,value:p};if(g.match(S3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:p}});s.localize.preprocessor&&(h=s.localize.preprocessor(u,h));const m={firstWeekContainsDate:l,weekStartsOn:c,locale:s};return h.map(p=>{if(!p.isToken)return p.value;const g=p.value;(!a?.useAdditionalWeekYearTokens&&g3(g)||!a?.useAdditionalDayOfYearTokens&&x3(g))&&v3(g,t,String(e));const y=Ay[g[0]];return y(u,g,s.localize,m)}).join("")}function E3(e){const t=e.match(_3);return t?t[1].replace(T3,"'"):e}function k3(e,t){return+Oa(e)>+Oa(t)}function or(e,t){const a=()=>Zr(t?.in,NaN),s=O3(e);let l;if(s.date){const m=D3(s.date,2);l=j3(m.restDateString,m.year)}if(!l||isNaN(+l))return a();const c=+l;let u=0,h;if(s.time&&(u=R3(s.time),isNaN(u)))return a();if(s.timezone){if(h=M3(s.timezone),isNaN(h))return a()}else{const m=new Date(c+u),p=Oa(0,t?.in);return p.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),p.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),p}return Oa(c+u+h,t?.in)}const s0={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},A3=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,N3=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,C3=/^([+-])(\d{2})(?::?(\d{2}))?$/;function O3(e){const t={},a=e.split(s0.dateTimeDelimiter);let r;if(a.length>2)return t;if(/:/.test(a[0])?r=a[0]:(t.date=a[0],r=a[1],s0.timeZoneDelimiter.test(t.date)&&(t.date=e.split(s0.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=s0.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function D3(e,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(a);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:l===null?s:l*100,restDateString:e.slice((r[1]||r[2]).length)}}function j3(e,t){if(t===null)return new Date(NaN);const a=e.match(A3);if(!a)return new Date(NaN);const r=!!a[4],s=Po(a[1]),l=Po(a[2])-1,c=Po(a[3]),u=Po(a[4]),h=Po(a[5])-1;if(r)return B3(t,u,h)?F3(t,u,h):new Date(NaN);{const m=new Date(0);return!P3(t,l,c)||!I3(t,s)?new Date(NaN):(m.setUTCFullYear(t,l,Math.max(s,c)),m)}}function Po(e){return e?parseInt(e):1}function R3(e){const t=e.match(N3);if(!t)return NaN;const a=Od(t[1]),r=Od(t[2]),s=Od(t[3]);return U3(a,r,s)?a*Aw+r*kw+s*1e3:NaN}function Od(e){return e&&parseFloat(e.replace(",","."))||0}function M3(e){if(e==="Z")return 0;const t=e.match(C3);if(!t)return 0;const a=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return z3(r,s)?a*(r*Aw+s*kw):NaN}function F3(e,t,a){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,l=(t-1)*7+a+1-s;return r.setUTCDate(r.getUTCDate()+l),r}const L3=[31,null,31,30,31,30,31,31,30,31,30,31];function Rw(e){return e%400===0||e%4===0&&e%100!==0}function P3(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(L3[t]||(Rw(e)?29:28))}function I3(e,t){return t>=1&&t<=(Rw(e)?366:365)}function B3(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function U3(e,t,a){return e===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}function z3(e,t){return t>=0&&t<=59}function V3(e,t,a){return Nw(e,-1,a)}const H3={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},$3=(e,t,a)=>{let r;const s=H3[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),a?.addSuffix?a.comparison&&a.comparison>0?"en "+r:"hace "+r:r},G3={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},q3={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},W3={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Y3={date:Nl({formats:G3,defaultWidth:"full"}),time:Nl({formats:q3,defaultWidth:"full"}),dateTime:Nl({formats:W3,defaultWidth:"full"})},X3={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},K3={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},J3=(e,t,a,r)=>t.getHours()!==1?K3[e]:X3[e],Q3={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},Z3={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},eC={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},tC={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},aC={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},rC={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},nC=(e,t)=>Number(e)+"",sC={ordinalNumber:nC,era:cn({values:Q3,defaultWidth:"wide"}),quarter:cn({values:Z3,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:cn({values:eC,defaultWidth:"wide"}),day:cn({values:tC,defaultWidth:"wide"}),dayPeriod:cn({values:aC,defaultWidth:"wide",formattingValues:rC,defaultFormattingWidth:"wide"})},iC=/^(\d+)()?/i,lC=/\d+/i,oC={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},cC={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},uC={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},fC={any:[/1/i,/2/i,/3/i,/4/i]},hC={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},dC={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},mC={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},pC={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},xC={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},gC={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},vC={ordinalNumber:Ow({matchPattern:iC,parsePattern:lC,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:oC,defaultMatchWidth:"wide",parsePatterns:cC,defaultParseWidth:"any"}),quarter:un({matchPatterns:uC,defaultMatchWidth:"wide",parsePatterns:fC,defaultParseWidth:"any",valueCallback:e=>e+1}),month:un({matchPatterns:hC,defaultMatchWidth:"wide",parsePatterns:dC,defaultParseWidth:"any"}),day:un({matchPatterns:mC,defaultMatchWidth:"wide",parsePatterns:pC,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:xC,defaultMatchWidth:"any",parsePatterns:gC,defaultParseWidth:"any"})},hn={code:"es",formatDistance:$3,formatLong:Y3,formatRelative:J3,localize:sC,match:vC,options:{weekStartsOn:1,firstWeekContainsDate:1}},Dd=({title:e,amount:t,icon:a,colorClass:r,trend:s})=>d.jsxs("div",{className:"card group hover:border-blue-200 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center justify-between mb-5",children:[d.jsx("div",{className:`p-2.5 rounded-xl ${r.split(" ")[0]} bg-opacity-10 ${r.split(" ")[1]}`,children:d.jsx(a,{size:22,strokeWidth:2.5})}),s!==void 0&&d.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-full text-[11px] font-bold tracking-tight ${s>=0?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"}`,children:[s>=0?d.jsx(fn,{size:12}):d.jsx(oc,{size:12}),Math.abs(s),"%"]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1",children:e}),d.jsxs("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:["$",t.toLocaleString("es-MX",{minimumFractionDigits:2})]})]})]}),Dy=()=>{const[e,t]=ie.useState({balance:0,income:0,expense:0,recentTransactions:[]});ie.useEffect(()=>{const r=JSON.parse(localStorage.getItem("finanzas_transactions")||"[]"),s=yt(new Date,"yyyy-MM"),l=r.filter(m=>m.type==="income"&&m.date.startsWith(s)).reduce((m,p)=>m+p.amount,0),c=r.filter(m=>m.type==="expense"&&m.date.startsWith(s)).reduce((m,p)=>m+p.amount,0),u=r.reduce((m,p)=>p.type==="income"?m+p.amount:p.type==="expense"?m-p.amount:m,0),h=[...r].sort((m,p)=>new Date(p.date)-new Date(m.date)).slice(0,5);t({balance:u,income:l,expense:c,recentTransactions:h})},[]);const a=yt(new Date,"EEEE, d 'de' MMMM yyyy",{locale:hn});return d.jsxs("div",{className:"space-y-10",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Hola, Enrique! "}),d.jsx("p",{className:"text-slate-500 mt-1 font-medium",children:"Esto es lo que est pasando con tu dinero hoy."})]}),d.jsx("div",{className:"hidden md:block",children:d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest bg-slate-100 px-3 py-1.5 rounded-lg border border-slate-200 capitalize",children:a})})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[d.jsx(Dd,{title:"Balance Total",amount:e.balance,icon:O0,colorClass:"bg-blue-600 text-blue-600"}),d.jsx(Dd,{title:"Ingresos del Mes",amount:e.income,icon:fn,colorClass:"bg-emerald-600 text-emerald-600"}),d.jsx(Dd,{title:"Gastos del Mes",amount:e.expense,icon:oc,colorClass:"bg-rose-600 text-rose-600"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"card min-h-[350px] flex flex-col items-center justify-center text-center p-10 border-dashed border-2 hover:border-slate-300 transition-colors",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4 text-slate-400",children:d.jsx(fn,{size:32})}),d.jsx("h4",{className:"font-bold text-slate-900 mb-1",children:"Anlisis de Gastos"}),d.jsxs("p",{className:"text-sm text-slate-500 max-w-xs",children:["Tus gastos de ",yt(new Date,"MMMM",{locale:hn})," aparecen aqu."]}),d.jsxs("div",{className:"mt-8 text-2xl font-bold text-slate-900",children:["$",e.expense.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),d.jsxs("div",{className:"card min-h-[350px] p-0 flex flex-col",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:[d.jsx("h4",{className:"font-bold text-slate-900",children:"ltimos Movimientos"}),d.jsx(vA,{size:18,className:"text-slate-400"})]}),d.jsx("div",{className:"flex-1 overflow-y-auto",children:e.recentTransactions.length===0?d.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-10 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4 text-slate-400",children:d.jsx(Z0,{size:32})}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No hay transacciones recientes."})]}):d.jsx("div",{className:"divide-y divide-slate-50",children:e.recentTransactions.map(r=>d.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`p-2 rounded-lg ${r.type==="income"?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"}`,children:r.type==="income"?d.jsx(fn,{size:16}):d.jsx(oc,{size:16})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-bold text-slate-900",children:r.note||"Sin nota"}),d.jsx("p",{className:"text-xs text-slate-500",children:r.date})]})]}),d.jsxs("p",{className:`text-sm font-bold ${r.type==="income"?"text-emerald-600":"text-rose-600"}`,children:[r.type==="income"?"+":"-","$",r.amount.toLocaleString("es-MX",{minimumFractionDigits:2})]})]},r.id))})})]})]})]})},fp=ie.createContext({});function hp(e){const t=ie.useRef(null);return t.current===null&&(t.current=e()),t.current}const Mw=typeof window<"u",Fw=Mw?ie.useLayoutEffect:ie.useEffect,af=ie.createContext(null);function dp(e,t){e.indexOf(t)===-1&&e.push(t)}function mp(e,t){const a=e.indexOf(t);a>-1&&e.splice(a,1)}const mn=(e,t,a)=>a>t?t:a<e?e:a;let pp=()=>{};const Vn={},Lw=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Pw(e){return typeof e=="object"&&e!==null}const Iw=e=>/^0[^.\s]+$/u.test(e);function xp(e){let t;return()=>(t===void 0&&(t=e()),t)}const Dr=e=>e,yC=(e,t)=>a=>t(e(a)),Dc=(...e)=>e.reduce(yC),uc=(e,t,a)=>{const r=t-e;return r===0?1:(a-e)/r};class gp{constructor(){this.subscriptions=[]}add(t){return dp(this.subscriptions,t),()=>mp(this.subscriptions,t)}notify(t,a,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,a,r);else for(let l=0;l<s;l++){const c=this.subscriptions[l];c&&c(t,a,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const In=e=>e*1e3,Or=e=>e/1e3;function Bw(e,t){return t?e*(1e3/t):0}const Uw=(e,t,a)=>(((1-3*a+3*t)*e+(3*a-6*t))*e+3*t)*e,bC=1e-7,wC=12;function _C(e,t,a,r,s){let l,c,u=0;do c=t+(a-t)/2,l=Uw(c,r,s)-e,l>0?a=c:t=c;while(Math.abs(l)>bC&&++u<wC);return c}function jc(e,t,a,r){if(e===t&&a===r)return Dr;const s=l=>_C(l,0,1,e,a);return l=>l===0||l===1?l:Uw(s(l),t,r)}const zw=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Vw=e=>t=>1-e(1-t),Hw=jc(.33,1.53,.69,.99),vp=Vw(Hw),$w=zw(vp),Gw=e=>(e*=2)<1?.5*vp(e):.5*(2-Math.pow(2,-10*(e-1))),yp=e=>1-Math.sin(Math.acos(e)),qw=Vw(yp),Ww=zw(yp),TC=jc(.42,0,1,1),SC=jc(0,0,.58,1),Yw=jc(.42,0,.58,1),EC=e=>Array.isArray(e)&&typeof e[0]!="number",Xw=e=>Array.isArray(e)&&typeof e[0]=="number",kC={linear:Dr,easeIn:TC,easeInOut:Yw,easeOut:SC,circIn:yp,circInOut:Ww,circOut:qw,backIn:vp,backInOut:$w,backOut:Hw,anticipate:Gw},AC=e=>typeof e=="string",jy=e=>{if(Xw(e)){pp(e.length===4);const[t,a,r,s]=e;return jc(t,a,r,s)}else if(AC(e))return kC[e];return e},i0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function NC(e,t){let a=new Set,r=new Set,s=!1,l=!1;const c=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function h(p){c.has(p)&&(m.schedule(p),e()),p(u)}const m={schedule:(p,g=!1,y=!1)=>{const _=y&&s?a:r;return g&&c.add(p),_.has(p)||_.add(p),p},cancel:p=>{r.delete(p),c.delete(p)},process:p=>{if(u=p,s){l=!0;return}s=!0,[a,r]=[r,a],a.forEach(h),a.clear(),s=!1,l&&(l=!1,m.process(p))}};return m}const CC=40;function Kw(e,t){let a=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},l=()=>a=!0,c=i0.reduce((S,L)=>(S[L]=NC(l),S),{}),{setup:u,read:h,resolveKeyframes:m,preUpdate:p,update:g,preRender:y,render:b,postRender:_}=c,w=()=>{const S=Vn.useManualTiming?s.timestamp:performance.now();a=!1,Vn.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,CC),1)),s.timestamp=S,s.isProcessing=!0,u.process(s),h.process(s),m.process(s),p.process(s),g.process(s),y.process(s),b.process(s),_.process(s),s.isProcessing=!1,a&&t&&(r=!1,e(w))},T=()=>{a=!0,r=!0,s.isProcessing||e(w)};return{schedule:i0.reduce((S,L)=>{const V=c[L];return S[L]=(P,N=!1,j=!1)=>(a||T(),V.schedule(P,N,j)),S},{}),cancel:S=>{for(let L=0;L<i0.length;L++)c[i0[L]].cancel(S)},state:s,steps:c}}const{schedule:At,cancel:Ns,state:ga,steps:jd}=Kw(typeof requestAnimationFrame<"u"?requestAnimationFrame:Dr,!0);let k0;function OC(){k0=void 0}const Pa={now:()=>(k0===void 0&&Pa.set(ga.isProcessing||Vn.useManualTiming?ga.timestamp:performance.now()),k0),set:e=>{k0=e,queueMicrotask(OC)}},Jw=e=>t=>typeof t=="string"&&t.startsWith(e),Qw=Jw("--"),DC=Jw("var(--"),bp=e=>DC(e)?jC.test(e.split("/*")[0].trim()):!1,jC=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Ry(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Pl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},fc={...Pl,transform:e=>mn(0,1,e)},l0={...Pl,default:1},qo=e=>Math.round(e*1e5)/1e5,wp=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function RC(e){return e==null}const MC=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,_p=(e,t)=>a=>!!(typeof a=="string"&&MC.test(a)&&a.startsWith(e)||t&&!RC(a)&&Object.prototype.hasOwnProperty.call(a,t)),Zw=(e,t,a)=>r=>{if(typeof r!="string")return r;const[s,l,c,u]=r.match(wp);return{[e]:parseFloat(s),[t]:parseFloat(l),[a]:parseFloat(c),alpha:u!==void 0?parseFloat(u):1}},FC=e=>mn(0,255,e),Rd={...Pl,transform:e=>Math.round(FC(e))},ui={test:_p("rgb","red"),parse:Zw("red","green","blue"),transform:({red:e,green:t,blue:a,alpha:r=1})=>"rgba("+Rd.transform(e)+", "+Rd.transform(t)+", "+Rd.transform(a)+", "+qo(fc.transform(r))+")"};function LC(e){let t="",a="",r="",s="";return e.length>5?(t=e.substring(1,3),a=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),a=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,a+=a,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(a,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const gm={test:_p("#"),parse:LC,transform:ui.transform},Rc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),bs=Rc("deg"),dn=Rc("%"),je=Rc("px"),PC=Rc("vh"),IC=Rc("vw"),My={...dn,parse:e=>dn.parse(e)/100,transform:e=>dn.transform(e*100)},wl={test:_p("hsl","hue"),parse:Zw("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:a,alpha:r=1})=>"hsla("+Math.round(e)+", "+dn.transform(qo(t))+", "+dn.transform(qo(a))+", "+qo(fc.transform(r))+")"},ta={test:e=>ui.test(e)||gm.test(e)||wl.test(e),parse:e=>ui.test(e)?ui.parse(e):wl.test(e)?wl.parse(e):gm.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ui.transform(e):wl.transform(e),getAnimatableNone:e=>{const t=ta.parse(e);return t.alpha=0,ta.transform(t)}},BC=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function UC(e){return isNaN(e)&&typeof e=="string"&&(e.match(wp)?.length||0)+(e.match(BC)?.length||0)>0}const e_="number",t_="color",zC="var",VC="var(",Fy="${}",HC=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hc(e){const t=e.toString(),a=[],r={color:[],number:[],var:[]},s=[];let l=0;const u=t.replace(HC,h=>(ta.test(h)?(r.color.push(l),s.push(t_),a.push(ta.parse(h))):h.startsWith(VC)?(r.var.push(l),s.push(zC),a.push(h)):(r.number.push(l),s.push(e_),a.push(parseFloat(h))),++l,Fy)).split(Fy);return{values:a,split:u,indexes:r,types:s}}function a_(e){return hc(e).values}function r_(e){const{split:t,types:a}=hc(e),r=t.length;return s=>{let l="";for(let c=0;c<r;c++)if(l+=t[c],s[c]!==void 0){const u=a[c];u===e_?l+=qo(s[c]):u===t_?l+=ta.transform(s[c]):l+=s[c]}return l}}const $C=e=>typeof e=="number"?0:ta.test(e)?ta.getAnimatableNone(e):e;function GC(e){const t=a_(e);return r_(e)(t.map($C))}const Cs={test:UC,parse:a_,createTransformer:r_,getAnimatableNone:GC};function Md(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(t-e)*6*a:a<1/2?t:a<2/3?e+(t-e)*(2/3-a)*6:e}function qC({hue:e,saturation:t,lightness:a,alpha:r}){e/=360,t/=100,a/=100;let s=0,l=0,c=0;if(!t)s=l=c=a;else{const u=a<.5?a*(1+t):a+t-a*t,h=2*a-u;s=Md(h,u,e+1/3),l=Md(h,u,e),c=Md(h,u,e-1/3)}return{red:Math.round(s*255),green:Math.round(l*255),blue:Math.round(c*255),alpha:r}}function j0(e,t){return a=>a>0?t:e}const Ft=(e,t,a)=>e+(t-e)*a,Fd=(e,t,a)=>{const r=e*e,s=a*(t*t-r)+r;return s<0?0:Math.sqrt(s)},WC=[gm,ui,wl],YC=e=>WC.find(t=>t.test(e));function Ly(e){const t=YC(e);if(!t)return!1;let a=t.parse(e);return t===wl&&(a=qC(a)),a}const Py=(e,t)=>{const a=Ly(e),r=Ly(t);if(!a||!r)return j0(e,t);const s={...a};return l=>(s.red=Fd(a.red,r.red,l),s.green=Fd(a.green,r.green,l),s.blue=Fd(a.blue,r.blue,l),s.alpha=Ft(a.alpha,r.alpha,l),ui.transform(s))},vm=new Set(["none","hidden"]);function XC(e,t){return vm.has(e)?a=>a<=0?e:t:a=>a>=1?t:e}function KC(e,t){return a=>Ft(e,t,a)}function Tp(e){return typeof e=="number"?KC:typeof e=="string"?bp(e)?j0:ta.test(e)?Py:ZC:Array.isArray(e)?n_:typeof e=="object"?ta.test(e)?Py:JC:j0}function n_(e,t){const a=[...e],r=a.length,s=e.map((l,c)=>Tp(l)(l,t[c]));return l=>{for(let c=0;c<r;c++)a[c]=s[c](l);return a}}function JC(e,t){const a={...e,...t},r={};for(const s in a)e[s]!==void 0&&t[s]!==void 0&&(r[s]=Tp(e[s])(e[s],t[s]));return s=>{for(const l in r)a[l]=r[l](s);return a}}function QC(e,t){const a=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const l=t.types[s],c=e.indexes[l][r[l]],u=e.values[c]??0;a[s]=u,r[l]++}return a}const ZC=(e,t)=>{const a=Cs.createTransformer(t),r=hc(e),s=hc(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?vm.has(e)&&!s.values.length||vm.has(t)&&!r.values.length?XC(e,t):Dc(n_(QC(r,s),s.values),a):j0(e,t)};function s_(e,t,a){return typeof e=="number"&&typeof t=="number"&&typeof a=="number"?Ft(e,t,a):Tp(e)(e,t)}const eO=e=>{const t=({timestamp:a})=>e(a);return{start:(a=!0)=>At.update(t,a),stop:()=>Ns(t),now:()=>ga.isProcessing?ga.timestamp:Pa.now()}},i_=(e,t,a=10)=>{let r="";const s=Math.max(Math.round(t/a),2);for(let l=0;l<s;l++)r+=Math.round(e(l/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},R0=2e4;function Sp(e){let t=0;const a=50;let r=e.next(t);for(;!r.done&&t<R0;)t+=a,r=e.next(t);return t>=R0?1/0:t}function tO(e,t=100,a){const r=a({...e,keyframes:[0,t]}),s=Math.min(Sp(r),R0);return{type:"keyframes",ease:l=>r.next(s*l).value/t,duration:Or(s)}}const aO=5;function l_(e,t,a){const r=Math.max(t-aO,0);return Bw(a-e(r),t-r)}const Bt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ld=.001;function rO({duration:e=Bt.duration,bounce:t=Bt.bounce,velocity:a=Bt.velocity,mass:r=Bt.mass}){let s,l,c=1-t;c=mn(Bt.minDamping,Bt.maxDamping,c),e=mn(Bt.minDuration,Bt.maxDuration,Or(e)),c<1?(s=m=>{const p=m*c,g=p*e,y=p-a,b=ym(m,c),_=Math.exp(-g);return Ld-y/b*_},l=m=>{const g=m*c*e,y=g*a+a,b=Math.pow(c,2)*Math.pow(m,2)*e,_=Math.exp(-g),w=ym(Math.pow(m,2),c);return(-s(m)+Ld>0?-1:1)*((y-b)*_)/w}):(s=m=>{const p=Math.exp(-m*e),g=(m-a)*e+1;return-Ld+p*g},l=m=>{const p=Math.exp(-m*e),g=(a-m)*(e*e);return p*g});const u=5/e,h=sO(s,l,u);if(e=In(e),isNaN(h))return{stiffness:Bt.stiffness,damping:Bt.damping,duration:e};{const m=Math.pow(h,2)*r;return{stiffness:m,damping:c*2*Math.sqrt(r*m),duration:e}}}const nO=12;function sO(e,t,a){let r=a;for(let s=1;s<nO;s++)r=r-e(r)/t(r);return r}function ym(e,t){return e*Math.sqrt(1-t*t)}const iO=["duration","bounce"],lO=["stiffness","damping","mass"];function Iy(e,t){return t.some(a=>e[a]!==void 0)}function oO(e){let t={velocity:Bt.velocity,stiffness:Bt.stiffness,damping:Bt.damping,mass:Bt.mass,isResolvedFromDuration:!1,...e};if(!Iy(e,lO)&&Iy(e,iO))if(e.visualDuration){const a=e.visualDuration,r=2*Math.PI/(a*1.2),s=r*r,l=2*mn(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Bt.mass,stiffness:s,damping:l}}else{const a=rO(e);t={...t,...a,mass:Bt.mass},t.isResolvedFromDuration=!0}return t}function M0(e=Bt.visualDuration,t=Bt.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=a;const l=a.keyframes[0],c=a.keyframes[a.keyframes.length-1],u={done:!1,value:l},{stiffness:h,damping:m,mass:p,duration:g,velocity:y,isResolvedFromDuration:b}=oO({...a,velocity:-Or(a.velocity||0)}),_=y||0,w=m/(2*Math.sqrt(h*p)),T=c-l,A=Or(Math.sqrt(h/p)),k=Math.abs(T)<5;r||(r=k?Bt.restSpeed.granular:Bt.restSpeed.default),s||(s=k?Bt.restDelta.granular:Bt.restDelta.default);let S;if(w<1){const V=ym(A,w);S=P=>{const N=Math.exp(-w*A*P);return c-N*((_+w*A*T)/V*Math.sin(V*P)+T*Math.cos(V*P))}}else if(w===1)S=V=>c-Math.exp(-A*V)*(T+(_+A*T)*V);else{const V=A*Math.sqrt(w*w-1);S=P=>{const N=Math.exp(-w*A*P),j=Math.min(V*P,300);return c-N*((_+w*A*T)*Math.sinh(j)+V*T*Math.cosh(j))/V}}const L={calculatedDuration:b&&g||null,next:V=>{const P=S(V);if(b)u.done=V>=g;else{let N=V===0?_:0;w<1&&(N=V===0?In(_):l_(S,V,P));const j=Math.abs(N)<=r,I=Math.abs(c-P)<=s;u.done=j&&I}return u.value=u.done?c:P,u},toString:()=>{const V=Math.min(Sp(L),R0),P=i_(N=>L.next(V*N).value,V,30);return V+"ms "+P},toTransition:()=>{}};return L}M0.applyToOptions=e=>{const t=tO(e,100,M0);return e.ease=t.ease,e.duration=In(t.duration),e.type="keyframes",e};function bm({keyframes:e,velocity:t=0,power:a=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:l=500,modifyTarget:c,min:u,max:h,restDelta:m=.5,restSpeed:p}){const g=e[0],y={done:!1,value:g},b=j=>u!==void 0&&j<u||h!==void 0&&j>h,_=j=>u===void 0?h:h===void 0||Math.abs(u-j)<Math.abs(h-j)?u:h;let w=a*t;const T=g+w,A=c===void 0?T:c(T);A!==T&&(w=A-g);const k=j=>-w*Math.exp(-j/r),S=j=>A+k(j),L=j=>{const I=k(j),z=S(j);y.done=Math.abs(I)<=m,y.value=y.done?A:z};let V,P;const N=j=>{b(y.value)&&(V=j,P=M0({keyframes:[y.value,_(y.value)],velocity:l_(S,j,y.value),damping:s,stiffness:l,restDelta:m,restSpeed:p}))};return N(0),{calculatedDuration:null,next:j=>{let I=!1;return!P&&V===void 0&&(I=!0,L(j),N(j)),V!==void 0&&j>=V?P.next(j-V):(!I&&L(j),y)}}}function cO(e,t,a){const r=[],s=a||Vn.mix||s_,l=e.length-1;for(let c=0;c<l;c++){let u=s(e[c],e[c+1]);if(t){const h=Array.isArray(t)?t[c]||Dr:t;u=Dc(h,u)}r.push(u)}return r}function uO(e,t,{clamp:a=!0,ease:r,mixer:s}={}){const l=e.length;if(pp(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const c=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const u=cO(t,r,s),h=u.length,m=p=>{if(c&&p<e[0])return t[0];let g=0;if(h>1)for(;g<e.length-2&&!(p<e[g+1]);g++);const y=uc(e[g],e[g+1],p);return u[g](y)};return a?p=>m(mn(e[0],e[l-1],p)):m}function fO(e,t){const a=e[e.length-1];for(let r=1;r<=t;r++){const s=uc(0,t,r);e.push(Ft(a,1,s))}}function hO(e){const t=[0];return fO(t,e.length-1),t}function dO(e,t){return e.map(a=>a*t)}function mO(e,t){return e.map(()=>t||Yw).splice(0,e.length-1)}function Wo({duration:e=300,keyframes:t,times:a,ease:r="easeInOut"}){const s=EC(r)?r.map(jy):jy(r),l={done:!1,value:t[0]},c=dO(a&&a.length===t.length?a:hO(t),e),u=uO(c,t,{ease:Array.isArray(s)?s:mO(t,s)});return{calculatedDuration:e,next:h=>(l.value=u(h),l.done=h>=e,l)}}const pO=e=>e!==null;function Ep(e,{repeat:t,repeatType:a="loop"},r,s=1){const l=e.filter(pO),u=s<0||t&&a!=="loop"&&t%2===1?0:l.length-1;return!u||r===void 0?l[u]:r}const xO={decay:bm,inertia:bm,tween:Wo,keyframes:Wo,spring:M0};function o_(e){typeof e.type=="string"&&(e.type=xO[e.type])}class kp{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,a){return this.finished.then(t,a)}}const gO=e=>e/100;class Ap extends kp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==Pa.now()&&this.tick(Pa.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;o_(t);const{type:a=Wo,repeat:r=0,repeatDelay:s=0,repeatType:l,velocity:c=0}=t;let{keyframes:u}=t;const h=a||Wo;h!==Wo&&typeof u[0]!="number"&&(this.mixKeyframes=Dc(gO,s_(u[0],u[1])),u=[0,100]);const m=h({...t,keyframes:u});l==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...u].reverse(),velocity:-c})),m.calculatedDuration===null&&(m.calculatedDuration=Sp(m));const{calculatedDuration:p}=m;this.calculatedDuration=p,this.resolvedDuration=p+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=m}updateTime(t){const a=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(t,a=!1){const{generator:r,totalDuration:s,mixKeyframes:l,mirroredGenerator:c,resolvedDuration:u,calculatedDuration:h}=this;if(this.startTime===null)return r.next(0);const{delay:m=0,keyframes:p,repeat:g,repeatType:y,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),a?this.currentTime=t:this.updateTime(t);const A=this.currentTime-m*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?A<0:A>s;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,L=r;if(g){const j=Math.min(this.currentTime,s)/u;let I=Math.floor(j),z=j%1;!z&&j>=1&&(z=1),z===1&&I--,I=Math.min(I,g+1),I%2&&(y==="reverse"?(z=1-z,b&&(z-=b/u)):y==="mirror"&&(L=c)),S=mn(0,1,z)*u}const V=k?{done:!1,value:p[0]}:L.next(S);l&&(V.value=l(V.value));let{done:P}=V;!k&&h!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return N&&_!==bm&&(V.value=Ep(p,this.options,T,this.speed)),w&&w(V.value),N&&this.finish(),V}then(t,a){return this.finished.then(t,a)}get duration(){return Or(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Or(t)}get time(){return Or(this.currentTime)}set time(t){t=In(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Pa.now());const a=this.playbackSpeed!==t;this.playbackSpeed=t,a&&(this.time=Or(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=eO,startTime:a}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=a??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Pa.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function vO(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const fi=e=>e*180/Math.PI,wm=e=>{const t=fi(Math.atan2(e[1],e[0]));return _m(t)},yO={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:wm,rotateZ:wm,skewX:e=>fi(Math.atan(e[1])),skewY:e=>fi(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},_m=e=>(e=e%360,e<0&&(e+=360),e),By=wm,Uy=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),zy=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),bO={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Uy,scaleY:zy,scale:e=>(Uy(e)+zy(e))/2,rotateX:e=>_m(fi(Math.atan2(e[6],e[5]))),rotateY:e=>_m(fi(Math.atan2(-e[2],e[0]))),rotateZ:By,rotate:By,skewX:e=>fi(Math.atan(e[4])),skewY:e=>fi(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Tm(e){return e.includes("scale")?1:0}function Sm(e,t){if(!e||e==="none")return Tm(t);const a=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(a)r=bO,s=a;else{const u=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=yO,s=u}if(!s)return Tm(t);const l=r[t],c=s[1].split(",").map(_O);return typeof l=="function"?l(c):c[l]}const wO=(e,t)=>{const{transform:a="none"}=getComputedStyle(e);return Sm(a,t)};function _O(e){return parseFloat(e.trim())}const Il=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bl=new Set(Il),Vy=e=>e===Pl||e===je,TO=new Set(["x","y","z"]),SO=Il.filter(e=>!TO.has(e));function EO(e){const t=[];return SO.forEach(a=>{const r=e.getValue(a);r!==void 0&&(t.push([a,r.get()]),r.set(a.startsWith("scale")?1:0))}),t}const Ss={width:({x:e},{paddingLeft:t="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),height:({y:e},{paddingTop:t="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Sm(t,"x"),y:(e,{transform:t})=>Sm(t,"y")};Ss.translateX=Ss.x;Ss.translateY=Ss.y;const mi=new Set;let Em=!1,km=!1,Am=!1;function c_(){if(km){const e=Array.from(mi).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),a=new Map;t.forEach(r=>{const s=EO(r);s.length&&(a.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=a.get(r);s&&s.forEach(([l,c])=>{r.getValue(l)?.set(c)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}km=!1,Em=!1,mi.forEach(e=>e.complete(Am)),mi.clear()}function u_(){mi.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(km=!0)})}function kO(){Am=!0,u_(),c_(),Am=!1}class Np{constructor(t,a,r,s,l,c=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=a,this.name=r,this.motionValue=s,this.element=l,this.isAsync=c}scheduleResolve(){this.state="scheduled",this.isAsync?(mi.add(this),Em||(Em=!0,At.read(u_),At.resolveKeyframes(c_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:a,element:r,motionValue:s}=this;if(t[0]===null){const l=s?.get(),c=t[t.length-1];if(l!==void 0)t[0]=l;else if(r&&a){const u=r.readValue(a,c);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=c),s&&l===void 0&&s.set(t[0])}vO(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),mi.delete(this)}cancel(){this.state==="scheduled"&&(mi.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const AO=e=>e.startsWith("--");function NO(e,t,a){AO(t)?e.style.setProperty(t,a):e.style[t]=a}const CO=xp(()=>window.ScrollTimeline!==void 0),OO={};function DO(e,t){const a=xp(e);return()=>OO[t]??a()}const f_=DO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Bo=([e,t,a,r])=>`cubic-bezier(${e}, ${t}, ${a}, ${r})`,Hy={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Bo([0,.65,.55,1]),circOut:Bo([.55,0,1,.45]),backIn:Bo([.31,.01,.66,-.59]),backOut:Bo([.33,1.53,.69,.99])};function h_(e,t){if(e)return typeof e=="function"?f_()?i_(e,t):"ease-out":Xw(e)?Bo(e):Array.isArray(e)?e.map(a=>h_(a,t)||Hy.easeOut):Hy[e]}function jO(e,t,a,{delay:r=0,duration:s=300,repeat:l=0,repeatType:c="loop",ease:u="easeOut",times:h}={},m=void 0){const p={[t]:a};h&&(p.offset=h);const g=h_(u,s);Array.isArray(g)&&(p.easing=g);const y={delay:r,duration:s,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:l+1,direction:c==="reverse"?"alternate":"normal"};return m&&(y.pseudoElement=m),e.animate(p,y)}function d_(e){return typeof e=="function"&&"applyToOptions"in e}function RO({type:e,...t}){return d_(e)&&f_()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class MO extends kp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:a,name:r,keyframes:s,pseudoElement:l,allowFlatten:c=!1,finalKeyframe:u,onComplete:h}=t;this.isPseudoElement=!!l,this.allowFlatten=c,this.options=t,pp(typeof t.type!="string");const m=RO(t);this.animation=jO(a,r,s,m,l),m.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const p=Ep(s,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(p):NO(a,r,p),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Or(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Or(t)}get time(){return Or(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=In(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&CO()?(this.animation.timeline=t,Dr):a(this)}}const m_={anticipate:Gw,backInOut:$w,circInOut:Ww};function FO(e){return e in m_}function LO(e){typeof e.ease=="string"&&FO(e.ease)&&(e.ease=m_[e.ease])}const Pd=10;class PO extends MO{constructor(t){LO(t),o_(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:a,onUpdate:r,onComplete:s,element:l,...c}=this.options;if(!a)return;if(t!==void 0){a.set(t);return}const u=new Ap({...c,autoplay:!1}),h=Math.max(Pd,Pa.now()-this.startTime),m=mn(0,Pd,h-Pd);a.setWithVelocity(u.sample(Math.max(0,h-m)).value,u.sample(h).value,m),u.stop()}}const $y=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Cs.test(e)||e==="0")&&!e.startsWith("url("));function IO(e){const t=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==t)return!0}function BO(e,t,a,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],c=$y(s,t),u=$y(l,t);return!c||!u?!1:IO(e)||(a==="spring"||d_(a))&&r}function Nm(e){e.duration=0,e.type="keyframes"}const UO=new Set(["opacity","clipPath","filter","transform"]),zO=xp(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function VO(e){const{motionValue:t,name:a,repeatDelay:r,repeatType:s,damping:l,type:c}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:m}=t.owner.getProps();return zO()&&a&&UO.has(a)&&(a!=="transform"||!m)&&!h&&!r&&s!=="mirror"&&l!==0&&c!=="inertia"}const HO=40;class $O extends kp{constructor({autoplay:t=!0,delay:a=0,type:r="keyframes",repeat:s=0,repeatDelay:l=0,repeatType:c="loop",keyframes:u,name:h,motionValue:m,element:p,...g}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Pa.now();const y={autoplay:t,delay:a,type:r,repeat:s,repeatDelay:l,repeatType:c,name:h,motionValue:m,element:p,...g},b=p?.KeyframeResolver||Np;this.keyframeResolver=new b(u,(_,w,T)=>this.onKeyframesResolved(_,w,y,!T),h,m,p),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,a,r,s){this.keyframeResolver=void 0;const{name:l,type:c,velocity:u,delay:h,isHandoff:m,onUpdate:p}=r;this.resolvedAt=Pa.now(),BO(t,l,c,u)||((Vn.instantAnimations||!h)&&p?.(Ep(t,r,a)),t[0]=t[t.length-1],Nm(r),r.repeat=0);const y={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>HO?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...r,keyframes:t},b=!m&&VO(y)?new PO({...y,element:y.motionValue.owner.current}):new Ap(y);b.finished.then(()=>this.notifyFinished()).catch(Dr),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(t,a){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),kO()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const GO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qO(e){const t=GO.exec(e);if(!t)return[,];const[,a,r,s]=t;return[`--${a??r}`,s]}function p_(e,t,a=1){const[r,s]=qO(e);if(!r)return;const l=window.getComputedStyle(t).getPropertyValue(r);if(l){const c=l.trim();return Lw(c)?parseFloat(c):c}return bp(s)?p_(s,t,a+1):s}function Cp(e,t){return e?.[t]??e?.default??e}const WO={type:"spring",stiffness:500,damping:25,restSpeed:10},YO=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),XO={type:"keyframes",duration:.8},KO={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JO=(e,{keyframes:t})=>t.length>2?XO:Bl.has(e)?e.startsWith("scale")?YO(t[1]):WO:KO;function QO({when:e,delay:t,delayChildren:a,staggerChildren:r,staggerDirection:s,repeat:l,repeatType:c,repeatDelay:u,from:h,elapsed:m,...p}){return!!Object.keys(p).length}const ZO=e=>e!==null;function e6(e,{repeat:t,repeatType:a="loop"},r){const s=e.filter(ZO),l=t&&a!=="loop"&&t%2===1?0:s.length-1;return s[l]}function x_(e,t,a,r=0,s=1){const l=Array.from(e).sort((m,p)=>m.sortNodePosition(p)).indexOf(t),c=e.size,u=(c-1)*r;return typeof a=="function"?a(l,c):s===1?l*r:u-l*r}const Op=(e,t,a,r={},s,l)=>c=>{const u=Cp(r,e)||{},h=u.delay||r.delay||0;let{elapsed:m=0}=r;m=m-In(h);const p={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:t.getVelocity(),...u,delay:-m,onUpdate:y=>{t.set(y),u.onUpdate&&u.onUpdate(y)},onComplete:()=>{c(),u.onComplete&&u.onComplete()},name:e,motionValue:t,element:l?void 0:s};QO(u)||Object.assign(p,JO(e,p)),p.duration&&(p.duration=In(p.duration)),p.repeatDelay&&(p.repeatDelay=In(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let g=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(Nm(p),p.delay===0&&(g=!0)),(Vn.instantAnimations||Vn.skipAnimations)&&(g=!0,Nm(p),p.delay=0),p.allowFlatten=!u.type&&!u.ease,g&&!l&&t.get()!==void 0){const y=e6(p.keyframes,u);if(y!==void 0){At.update(()=>{p.onUpdate(y),p.onComplete()});return}}return u.isSync?new Ap(p):new $O(p)},g_=new Set(["width","height","top","left","right","bottom",...Il]),Gy=30,t6=e=>!isNaN(parseFloat(e));class a6{constructor(t,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const s=Pa.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=a.owner}setCurrent(t){this.current=t,this.updatedAt=Pa.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=t6(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,a){this.events[t]||(this.events[t]=new gp);const r=this.events[t].add(a);return t==="change"?()=>{r(),At.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,a){this.passiveEffect=t,this.stopPassiveEffect=a}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,a,r){this.set(a),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,a=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Pa.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Gy)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,Gy);return Bw(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(t){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=t(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ml(e,t){return new a6(e,t)}function qy(e){const t=[{},{}];return e?.values.forEach((a,r)=>{t[0][r]=a.get(),t[1][r]=a.getVelocity()}),t}function Dp(e,t,a,r){if(typeof t=="function"){const[s,l]=qy(r);t=t(a!==void 0?a:e.custom,s,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,l]=qy(r);t=t(a!==void 0?a:e.custom,s,l)}return t}function Cl(e,t,a){const r=e.getProps();return Dp(r,t,a!==void 0?a:r.custom,e)}const Cm=e=>Array.isArray(e);function r6(e,t,a){e.hasValue(t)?e.getValue(t).set(a):e.addValue(t,Ml(a))}function n6(e){return Cm(e)?e[e.length-1]||0:e}function s6(e,t){const a=Cl(e,t);let{transitionEnd:r={},transition:s={},...l}=a||{};l={...l,...r};for(const c in l){const u=n6(l[c]);r6(e,c,u)}}const Aa=e=>!!(e&&e.getVelocity);function i6(e){return!!(Aa(e)&&e.add)}function Om(e,t){const a=e.getValue("willChange");if(i6(a))return a.add(t);if(!a&&Vn.WillChange){const r=new Vn.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function jp(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const l6="framerAppearId",v_="data-"+jp(l6);function y_(e){return e.props[v_]}function o6({protectedKeys:e,needsAnimating:t},a){const r=e.hasOwnProperty(a)&&t[a]!==!0;return t[a]=!1,r}function b_(e,t,{delay:a=0,transitionOverride:r,type:s}={}){let{transition:l=e.getDefaultTransition(),transitionEnd:c,...u}=t;r&&(l=r);const h=[],m=s&&e.animationState&&e.animationState.getState()[s];for(const p in u){const g=e.getValue(p,e.latestValues[p]??null),y=u[p];if(y===void 0||m&&o6(m,p))continue;const b={delay:a,...Cp(l||{},p)},_=g.get();if(_!==void 0&&!g.isAnimating&&!Array.isArray(y)&&y===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const A=y_(e);if(A){const k=window.MotionHandoffAnimation(A,p,At);k!==null&&(b.startTime=k,w=!0)}}Om(e,p),g.start(Op(p,g,y,e.shouldReduceMotion&&g_.has(p)?{type:!1}:b,e,w));const T=g.animation;T&&h.push(T)}return c&&Promise.all(h).then(()=>{At.update(()=>{c&&s6(e,c)})}),h}function Dm(e,t,a={}){const r=Cl(e,t,a.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(s=a.transitionOverride);const l=r?()=>Promise.all(b_(e,r,a)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:m=0,staggerChildren:p,staggerDirection:g}=s;return c6(e,t,h,m,p,g,a)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,m]=u==="beforeChildren"?[l,c]:[c,l];return h().then(()=>m())}else return Promise.all([l(),c(a.delay)])}function c6(e,t,a=0,r=0,s=0,l=1,c){const u=[];for(const h of e.variantChildren)h.notify("AnimationStart",t),u.push(Dm(h,t,{...c,delay:a+(typeof r=="function"?0:r)+x_(e.variantChildren,h,r,s,l)}).then(()=>h.notify("AnimationComplete",t)));return Promise.all(u)}function u6(e,t,a={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(l=>Dm(e,l,a));r=Promise.all(s)}else if(typeof t=="string")r=Dm(e,t,a);else{const s=typeof t=="function"?Cl(e,t,a.custom):t;r=Promise.all(b_(e,s,a))}return r.then(()=>{e.notify("AnimationComplete",t)})}const f6={test:e=>e==="auto",parse:e=>e},w_=e=>t=>t.test(e),__=[Pl,je,dn,bs,IC,PC,f6],Wy=e=>__.find(w_(e));function h6(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Iw(e):!0}const d6=new Set(["brightness","contrast","saturate","opacity"]);function m6(e){const[t,a]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=a.match(wp)||[];if(!r)return e;const s=a.replace(r,"");let l=d6.has(t)?1:0;return r!==a&&(l*=100),t+"("+l+s+")"}const p6=/\b([a-z-]*)\(.*?\)/gu,jm={...Cs,getAnimatableNone:e=>{const t=e.match(p6);return t?t.map(m6).join(" "):e}},Yy={...Pl,transform:Math.round},x6={rotate:bs,rotateX:bs,rotateY:bs,rotateZ:bs,scale:l0,scaleX:l0,scaleY:l0,scaleZ:l0,skew:bs,skewX:bs,skewY:bs,distance:je,translateX:je,translateY:je,translateZ:je,x:je,y:je,z:je,perspective:je,transformPerspective:je,opacity:fc,originX:My,originY:My,originZ:je},Rp={borderWidth:je,borderTopWidth:je,borderRightWidth:je,borderBottomWidth:je,borderLeftWidth:je,borderRadius:je,radius:je,borderTopLeftRadius:je,borderTopRightRadius:je,borderBottomRightRadius:je,borderBottomLeftRadius:je,width:je,maxWidth:je,height:je,maxHeight:je,top:je,right:je,bottom:je,left:je,inset:je,insetBlock:je,insetBlockStart:je,insetBlockEnd:je,insetInline:je,insetInlineStart:je,insetInlineEnd:je,padding:je,paddingTop:je,paddingRight:je,paddingBottom:je,paddingLeft:je,paddingBlock:je,paddingBlockStart:je,paddingBlockEnd:je,paddingInline:je,paddingInlineStart:je,paddingInlineEnd:je,margin:je,marginTop:je,marginRight:je,marginBottom:je,marginLeft:je,marginBlock:je,marginBlockStart:je,marginBlockEnd:je,marginInline:je,marginInlineStart:je,marginInlineEnd:je,backgroundPositionX:je,backgroundPositionY:je,...x6,zIndex:Yy,fillOpacity:fc,strokeOpacity:fc,numOctaves:Yy},g6={...Rp,color:ta,backgroundColor:ta,outlineColor:ta,fill:ta,stroke:ta,borderColor:ta,borderTopColor:ta,borderRightColor:ta,borderBottomColor:ta,borderLeftColor:ta,filter:jm,WebkitFilter:jm},T_=e=>g6[e];function S_(e,t){let a=T_(e);return a!==jm&&(a=Cs),a.getAnimatableNone?a.getAnimatableNone(t):void 0}const v6=new Set(["auto","none","0"]);function y6(e,t,a){let r=0,s;for(;r<e.length&&!s;){const l=e[r];typeof l=="string"&&!v6.has(l)&&hc(l).values.length&&(s=e[r]),r++}if(s&&a)for(const l of t)e[l]=S_(a,s)}class b6 extends Np{constructor(t,a,r,s,l){super(t,a,r,s,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:a,name:r}=this;if(!a||!a.current)return;super.readKeyframes();for(let p=0;p<t.length;p++){let g=t[p];if(typeof g=="string"&&(g=g.trim(),bp(g))){const y=p_(g,a.current);y!==void 0&&(t[p]=y),p===t.length-1&&(this.finalKeyframe=g)}}if(this.resolveNoneKeyframes(),!g_.has(r)||t.length!==2)return;const[s,l]=t,c=Wy(s),u=Wy(l),h=Ry(s),m=Ry(l);if(h!==m&&Ss[r]){this.needsMeasurement=!0;return}if(c!==u)if(Vy(c)&&Vy(u))for(let p=0;p<t.length;p++){const g=t[p];typeof g=="string"&&(t[p]=parseFloat(g))}else Ss[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:a}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||h6(t[s]))&&r.push(s);r.length&&y6(t,r,a)}measureInitialState(){const{element:t,unresolvedKeyframes:a,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ss[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a[0]=this.measuredOrigin;const s=a[a.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){const{element:t,name:a,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(a);s&&s.jump(this.measuredOrigin,!1);const l=r.length-1,c=r[l];r[l]=Ss[a](t.measureViewportBox(),window.getComputedStyle(t.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),this.removedTransforms?.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}function w6(e,t,a){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=a?.[e]??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const E_=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function k_(e){return Pw(e)&&"offsetHeight"in e}const{schedule:Mp}=Kw(queueMicrotask,!1),Gr={x:!1,y:!1};function A_(){return Gr.x||Gr.y}function _6(e){return e==="x"||e==="y"?Gr[e]?null:(Gr[e]=!0,()=>{Gr[e]=!1}):Gr.x||Gr.y?null:(Gr.x=Gr.y=!0,()=>{Gr.x=Gr.y=!1})}function N_(e,t){const a=w6(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[a,s,()=>r.abort()]}function Xy(e){return!(e.pointerType==="touch"||A_())}function T6(e,t,a={}){const[r,s,l]=N_(e,a),c=u=>{if(!Xy(u))return;const{target:h}=u,m=t(h,u);if(typeof m!="function"||!h)return;const p=g=>{Xy(g)&&(m(g),h.removeEventListener("pointerleave",p))};h.addEventListener("pointerleave",p,s)};return r.forEach(u=>{u.addEventListener("pointerenter",c,s)}),l}const C_=(e,t)=>t?e===t?!0:C_(e,t.parentElement):!1,Fp=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,S6=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function O_(e){return S6.has(e.tagName)||e.isContentEditable===!0}const A0=new WeakSet;function Ky(e){return t=>{t.key==="Enter"&&e(t)}}function Id(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const E6=(e,t)=>{const a=e.currentTarget;if(!a)return;const r=Ky(()=>{if(A0.has(a))return;Id(a,"down");const s=Ky(()=>{Id(a,"up")}),l=()=>Id(a,"cancel");a.addEventListener("keyup",s,t),a.addEventListener("blur",l,t)});a.addEventListener("keydown",r,t),a.addEventListener("blur",()=>a.removeEventListener("keydown",r),t)};function Jy(e){return Fp(e)&&!A_()}function k6(e,t,a={}){const[r,s,l]=N_(e,a),c=u=>{const h=u.currentTarget;if(!Jy(u))return;A0.add(h);const m=t(h,u),p=(b,_)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",y),A0.has(h)&&A0.delete(h),Jy(b)&&typeof m=="function"&&m(b,{success:_})},g=b=>{p(b,h===window||h===document||a.useGlobalTarget||C_(h,b.target))},y=b=>{p(b,!1)};window.addEventListener("pointerup",g,s),window.addEventListener("pointercancel",y,s)};return r.forEach(u=>{(a.useGlobalTarget?window:u).addEventListener("pointerdown",c,s),k_(u)&&(u.addEventListener("focus",m=>E6(m,s)),!O_(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),l}function D_(e){return Pw(e)&&"ownerSVGElement"in e}function A6(e){return D_(e)&&e.tagName==="svg"}const N6=[...__,ta,Cs],C6=e=>N6.find(w_(e)),Qy=()=>({translate:0,scale:1,origin:0,originPoint:0}),_l=()=>({x:Qy(),y:Qy()}),Zy=()=>({min:0,max:0}),na=()=>({x:Zy(),y:Zy()}),Rm={current:null},j_={current:!1},O6=typeof window<"u";function D6(){if(j_.current=!0,!!O6)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Rm.current=e.matches;e.addEventListener("change",t),t()}else Rm.current=!1}const j6=new WeakMap;function rf(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function dc(e){return typeof e=="string"||Array.isArray(e)}const Lp=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Pp=["initial",...Lp];function nf(e){return rf(e.animate)||Pp.some(t=>dc(e[t]))}function R_(e){return!!(nf(e)||e.variants)}function R6(e,t,a){for(const r in t){const s=t[r],l=a[r];if(Aa(s))e.addValue(r,s);else if(Aa(l))e.addValue(r,Ml(s,{owner:e}));else if(l!==s)if(e.hasValue(r)){const c=e.getValue(r);c.liveStyle===!0?c.jump(s):c.hasAnimated||c.set(s)}else{const c=e.getStaticValue(r);e.addValue(r,Ml(c!==void 0?c:s,{owner:e}))}}for(const r in a)t[r]===void 0&&e.removeValue(r);return t}const e2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let F0={};function M_(e){F0=e}function M6(){return F0}class F6{scrapeMotionValuesFromProps(t,a,r){return{}}constructor({parent:t,props:a,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:l,visualState:c},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Np,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=Pa.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,At.render(this.render,!1,!0))};const{latestValues:h,renderState:m}=c;this.latestValues=h,this.baseTarget={...h},this.initialValues=a.initial?{...h}:{},this.renderState=m,this.parent=t,this.props=a,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=u,this.blockInitialAnimation=!!l,this.isControllingVariants=nf(a),this.isVariantNode=R_(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(a,{},this);for(const y in g){const b=g[y];h[y]!==void 0&&Aa(b)&&b.set(h[y])}}mount(t){this.current=t,j6.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,r)=>this.bindToMotionValue(r,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(j_.current||D6(),this.shouldReduceMotion=Rm.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ns(this.notifyUpdate),Ns(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const a=this.features[t];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,a){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Bl.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=a.on("change",c=>{this.latestValues[t]=c,this.props.onUpdate&&At.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;typeof window<"u"&&window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,t,a)),this.valueSubscriptions.set(t,()=>{s(),l&&l(),a.owner&&a.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in F0){const a=F0[t];if(!a)continue;const{isEnabled:r,Feature:s}=a;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):na()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,a){this.latestValues[t]=a}update(t,a){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let r=0;r<e2.length;r++){const s=e2[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const l="on"+s,c=t[l];c&&(this.propEventSubscriptions[s]=this.on(s,c))}this.prevMotionValues=R6(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(t),()=>a.variantChildren.delete(t)}addValue(t,a){const r=this.values.get(t);a!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,a),this.values.set(t,a),this.latestValues[t]=a.get())}removeValue(t){this.values.delete(t);const a=this.valueSubscriptions.get(t);a&&(a(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,a){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&a!==void 0&&(r=Ml(a===null?void 0:a,{owner:this}),this.addValue(t,r)),r}readValue(t,a){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(Lw(r)||Iw(r))?r=parseFloat(r):!C6(r)&&Cs.test(a)&&(r=S_(t,a)),this.setBaseTarget(t,Aa(r)?r.get():r)),Aa(r)?r.get():r}setBaseTarget(t,a){this.baseTarget[t]=a}getBaseTarget(t){const{initial:a}=this.props;let r;if(typeof a=="string"||typeof a=="object"){const l=Dp(this.props,a,this.presenceContext?.custom);l&&(r=l[t])}if(a&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Aa(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,a){return this.events[t]||(this.events[t]=new gp),this.events[t].add(a)}notify(t,...a){this.events[t]&&this.events[t].notify(...a)}scheduleRenderMicrotask(){Mp.render(this.render)}}class js{constructor(t){this.isMounted=!1,this.node=t}update(){}}class F_ extends F6{constructor(){super(...arguments),this.KeyframeResolver=b6}sortInstanceNodePosition(t,a){return t.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(t,a){const r=t.style;return r?r[a]:void 0}removeValueFromRenderState(t,{vars:a,style:r}){delete a[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Aa(t)&&(this.childSubscription=t.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function L_({top:e,left:t,right:a,bottom:r}){return{x:{min:t,max:a},y:{min:e,max:r}}}function L6({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function P6(e,t){if(!t)return e;const a=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:r.y,right:r.x}}function Bd(e){return e===void 0||e===1}function Mm({scale:e,scaleX:t,scaleY:a}){return!Bd(e)||!Bd(t)||!Bd(a)}function si(e){return Mm(e)||P_(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function P_(e){return t2(e.x)||t2(e.y)}function t2(e){return e&&e!=="0%"}function L0(e,t,a){const r=e-a,s=t*r;return a+s}function a2(e,t,a,r,s){return s!==void 0&&(e=L0(e,s,r)),L0(e,a,r)+t}function Fm(e,t=0,a=1,r,s){e.min=a2(e.min,t,a,r,s),e.max=a2(e.max,t,a,r,s)}function I_(e,{x:t,y:a}){Fm(e.x,t.translate,t.scale,t.originPoint),Fm(e.y,a.translate,a.scale,a.originPoint)}const r2=.999999999999,n2=1.0000000000001;function I6(e,t,a,r=!1){const s=a.length;if(!s)return;t.x=t.y=1;let l,c;for(let u=0;u<s;u++){l=a[u],c=l.projectionDelta;const{visualElement:h}=l.options;h&&h.props.style&&h.props.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Sl(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),c&&(t.x*=c.x.scale,t.y*=c.y.scale,I_(e,c)),r&&si(l.latestValues)&&Sl(e,l.latestValues))}t.x<n2&&t.x>r2&&(t.x=1),t.y<n2&&t.y>r2&&(t.y=1)}function Tl(e,t){e.min=e.min+t,e.max=e.max+t}function s2(e,t,a,r,s=.5){const l=Ft(e.min,e.max,s);Fm(e,t,a,l,r)}function Sl(e,t){s2(e.x,t.x,t.scaleX,t.scale,t.originX),s2(e.y,t.y,t.scaleY,t.scale,t.originY)}function B_(e,t){return L_(P6(e.getBoundingClientRect(),t))}function B6(e,t,a){const r=B_(e,a),{scroll:s}=t;return s&&(Tl(r.x,s.offset.x),Tl(r.y,s.offset.y)),r}const U6={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},z6=Il.length;function V6(e,t,a){let r="",s=!0;for(let l=0;l<z6;l++){const c=Il[l],u=e[c];if(u===void 0)continue;let h=!0;if(typeof u=="number"?h=u===(c.startsWith("scale")?1:0):h=parseFloat(u)===0,!h||a){const m=E_(u,Rp[c]);if(!h){s=!1;const p=U6[c]||c;r+=`${p}(${m}) `}a&&(t[c]=m)}}return r=r.trim(),a?r=a(t,s?"":r):s&&(r="none"),r}function Ip(e,t,a){const{style:r,vars:s,transformOrigin:l}=e;let c=!1,u=!1;for(const h in t){const m=t[h];if(Bl.has(h)){c=!0;continue}else if(Qw(h)){s[h]=m;continue}else{const p=E_(m,Rp[h]);h.startsWith("origin")?(u=!0,l[h]=p):r[h]=p}}if(t.transform||(c||a?r.transform=V6(t,e.transform,a):r.transform&&(r.transform="none")),u){const{originX:h="50%",originY:m="50%",originZ:p=0}=l;r.transformOrigin=`${h} ${m} ${p}`}}function U_(e,{style:t,vars:a},r,s){const l=e.style;let c;for(c in t)l[c]=t[c];s?.applyProjectionStyles(l,r);for(c in a)l.setProperty(c,a[c])}function i2(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Io={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(je.test(e))e=parseFloat(e);else return e;const a=i2(e,t.target.x),r=i2(e,t.target.y);return`${a}% ${r}%`}},H6={correct:(e,{treeScale:t,projectionDelta:a})=>{const r=e,s=Cs.parse(e);if(s.length>5)return r;const l=Cs.createTransformer(e),c=typeof s[0]!="number"?1:0,u=a.x.scale*t.x,h=a.y.scale*t.y;s[0+c]/=u,s[1+c]/=h;const m=Ft(u,h,.5);return typeof s[2+c]=="number"&&(s[2+c]/=m),typeof s[3+c]=="number"&&(s[3+c]/=m),l(s)}},Lm={borderRadius:{...Io,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Io,borderTopRightRadius:Io,borderBottomLeftRadius:Io,borderBottomRightRadius:Io,boxShadow:H6};function z_(e,{layout:t,layoutId:a}){return Bl.has(e)||e.startsWith("origin")||(t||a!==void 0)&&(!!Lm[e]||e==="opacity")}function Bp(e,t,a){const r=e.style,s=t?.style,l={};if(!r)return l;for(const c in r)(Aa(r[c])||s&&Aa(s[c])||z_(c,e)||a?.getValue(c)?.liveStyle!==void 0)&&(l[c]=r[c]);return l}function $6(e){return window.getComputedStyle(e)}class G6 extends F_{constructor(){super(...arguments),this.type="html",this.renderInstance=U_}readValueFromInstance(t,a){if(Bl.has(a))return this.projection?.isProjecting?Tm(a):wO(t,a);{const r=$6(t),s=(Qw(a)?r.getPropertyValue(a):r[a])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:a}){return B_(t,a)}build(t,a,r){Ip(t,a,r.transformTemplate)}scrapeMotionValuesFromProps(t,a,r){return Bp(t,a,r)}}const q6={offset:"stroke-dashoffset",array:"stroke-dasharray"},W6={offset:"strokeDashoffset",array:"strokeDasharray"};function Y6(e,t,a=1,r=0,s=!0){e.pathLength=1;const l=s?q6:W6;e[l.offset]=je.transform(-r);const c=je.transform(t),u=je.transform(a);e[l.array]=`${c} ${u}`}const X6=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function V_(e,{attrX:t,attrY:a,attrScale:r,pathLength:s,pathSpacing:l=1,pathOffset:c=0,...u},h,m,p){if(Ip(e,u,m),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:g,style:y}=e;g.transform&&(y.transform=g.transform,delete g.transform),(y.transform||g.transformOrigin)&&(y.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),y.transform&&(y.transformBox=p?.transformBox??"fill-box",delete g.transformBox);for(const b of X6)g[b]!==void 0&&(y[b]=g[b],delete g[b]);t!==void 0&&(g.x=t),a!==void 0&&(g.y=a),r!==void 0&&(g.scale=r),s!==void 0&&Y6(g,s,l,c,!1)}const H_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),$_=e=>typeof e=="string"&&e.toLowerCase()==="svg";function K6(e,t,a,r){U_(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(H_.has(s)?s:jp(s),t.attrs[s])}function G_(e,t,a){const r=Bp(e,t,a);for(const s in e)if(Aa(e[s])||Aa(t[s])){const l=Il.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[l]=e[s]}return r}class J6 extends F_{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=na}getBaseTargetFromProps(t,a){return t[a]}readValueFromInstance(t,a){if(Bl.has(a)){const r=T_(a);return r&&r.default||0}return a=H_.has(a)?a:jp(a),t.getAttribute(a)}scrapeMotionValuesFromProps(t,a,r){return G_(t,a,r)}build(t,a,r){V_(t,a,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,a,r,s){K6(t,a,r,s)}mount(t){this.isSVGTag=$_(t.tagName),super.mount(t)}}const Q6=Pp.length;function q_(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?q_(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const t={};for(let a=0;a<Q6;a++){const r=Pp[a],s=e.props[r];(dc(s)||s===!1)&&(t[r]=s)}return t}function W_(e,t){if(!Array.isArray(t))return!1;const a=t.length;if(a!==e.length)return!1;for(let r=0;r<a;r++)if(t[r]!==e[r])return!1;return!0}const Z6=[...Lp].reverse(),e5=Lp.length;function t5(e){return t=>Promise.all(t.map(({animation:a,options:r})=>u6(e,a,r)))}function a5(e){let t=t5(e),a=l2(),r=!0;const s=h=>(m,p)=>{const g=Cl(e,p,h==="exit"?e.presenceContext?.custom:void 0);if(g){const{transition:y,transitionEnd:b,..._}=g;m={...m,..._,...b}}return m};function l(h){t=h(e)}function c(h){const{props:m}=e,p=q_(e.parent)||{},g=[],y=new Set;let b={},_=1/0;for(let T=0;T<e5;T++){const A=Z6[T],k=a[A],S=m[A]!==void 0?m[A]:p[A],L=dc(S),V=A===h?k.isActive:null;V===!1&&(_=T);let P=S===p[A]&&S!==m[A]&&L;if(P&&r&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...b},!k.isActive&&V===null||!S&&!k.prevProp||rf(S)||typeof S=="boolean")continue;const N=r5(k.prevProp,S);let j=N||A===h&&k.isActive&&!P&&L||T>_&&L,I=!1;const z=Array.isArray(S)?S:[S];let X=z.reduce(s(A),{});V===!1&&(X={});const{prevResolvedValues:q={}}=k,Q={...q,...X},be=te=>{j=!0,y.has(te)&&(I=!0,y.delete(te)),k.needsAnimating[te]=!0;const ye=e.getValue(te);ye&&(ye.liveStyle=!1)};for(const te in Q){const ye=X[te],ae=q[te];if(b.hasOwnProperty(te))continue;let Ee=!1;Cm(ye)&&Cm(ae)?Ee=!W_(ye,ae):Ee=ye!==ae,Ee?ye!=null?be(te):y.add(te):ye!==void 0&&y.has(te)?be(te):k.protectedKeys[te]=!0}k.prevProp=S,k.prevResolvedValues=X,k.isActive&&(b={...b,...X}),r&&e.blockInitialAnimation&&(j=!1);const ve=P&&N;j&&(!ve||I)&&g.push(...z.map(te=>{const ye={type:A};if(typeof te=="string"&&r&&!ve&&e.manuallyAnimateOnMount&&e.parent){const{parent:ae}=e,Ee=Cl(ae,te);if(ae.enteringChildren&&Ee){const{delayChildren:G}=Ee.transition||{};ye.delay=x_(ae.enteringChildren,e,G)}}return{animation:te,options:ye}}))}if(y.size){const T={};if(typeof m.initial!="boolean"){const A=Cl(e,Array.isArray(m.initial)?m.initial[0]:m.initial);A&&A.transition&&(T.transition=A.transition)}y.forEach(A=>{const k=e.getBaseTarget(A),S=e.getValue(A);S&&(S.liveStyle=!0),T[A]=k??null}),g.push({animation:T})}let w=!!g.length;return r&&(m.initial===!1||m.initial===m.animate)&&!e.manuallyAnimateOnMount&&(w=!1),r=!1,w?t(g):Promise.resolve()}function u(h,m){if(a[h].isActive===m)return Promise.resolve();e.variantChildren?.forEach(g=>g.animationState?.setActive(h,m)),a[h].isActive=m;const p=c(h);for(const g in a)a[g].protectedKeys={};return p}return{animateChanges:c,setActive:u,setAnimateFunction:l,getState:()=>a,reset:()=>{a=l2()}}}function r5(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!W_(t,e):!1}function ti(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function l2(){return{animate:ti(!0),whileInView:ti(),whileHover:ti(),whileTap:ti(),whileDrag:ti(),whileFocus:ti(),exit:ti()}}const Y_=1e-4,n5=1-Y_,s5=1+Y_,X_=.01,i5=0-X_,l5=0+X_;function Ia(e){return e.max-e.min}function o5(e,t,a){return Math.abs(e-t)<=a}function o2(e,t,a,r=.5){e.origin=r,e.originPoint=Ft(t.min,t.max,e.origin),e.scale=Ia(a)/Ia(t),e.translate=Ft(a.min,a.max,e.origin)-e.originPoint,(e.scale>=n5&&e.scale<=s5||isNaN(e.scale))&&(e.scale=1),(e.translate>=i5&&e.translate<=l5||isNaN(e.translate))&&(e.translate=0)}function Yo(e,t,a,r){o2(e.x,t.x,a.x,r?r.originX:void 0),o2(e.y,t.y,a.y,r?r.originY:void 0)}function c2(e,t,a){e.min=a.min+t.min,e.max=e.min+Ia(t)}function c5(e,t,a){c2(e.x,t.x,a.x),c2(e.y,t.y,a.y)}function u2(e,t,a){e.min=t.min-a.min,e.max=e.min+Ia(t)}function P0(e,t,a){u2(e.x,t.x,a.x),u2(e.y,t.y,a.y)}function f2(e,t,a,r,s){return e-=t,e=L0(e,1/a,r),s!==void 0&&(e=L0(e,1/s,r)),e}function u5(e,t=0,a=1,r=.5,s,l=e,c=e){if(dn.test(t)&&(t=parseFloat(t),t=Ft(c.min,c.max,t/100)-c.min),typeof t!="number")return;let u=Ft(l.min,l.max,r);e===l&&(u-=t),e.min=f2(e.min,t,a,u,s),e.max=f2(e.max,t,a,u,s)}function h2(e,t,[a,r,s],l,c){u5(e,t[a],t[r],t[s],t.scale,l,c)}const f5=["x","scaleX","originX"],h5=["y","scaleY","originY"];function d2(e,t,a,r){h2(e.x,t,f5,a?a.x:void 0,r?r.x:void 0),h2(e.y,t,h5,a?a.y:void 0,r?r.y:void 0)}function m2(e,t){e.min=t.min,e.max=t.max}function zr(e,t){m2(e.x,t.x),m2(e.y,t.y)}function p2(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function x2(e){return e.translate===0&&e.scale===1}function K_(e){return x2(e.x)&&x2(e.y)}function g2(e,t){return e.min===t.min&&e.max===t.max}function d5(e,t){return g2(e.x,t.x)&&g2(e.y,t.y)}function v2(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function J_(e,t){return v2(e.x,t.x)&&v2(e.y,t.y)}function y2(e){return Ia(e.x)/Ia(e.y)}function b2(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Nr(e){return[e("x"),e("y")]}function m5(e,t,a){let r="";const s=e.x.translate/t.x,l=e.y.translate/t.y,c=a?.z||0;if((s||l||c)&&(r=`translate3d(${s}px, ${l}px, ${c}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),a){const{transformPerspective:m,rotate:p,rotateX:g,rotateY:y,skewX:b,skewY:_}=a;m&&(r=`perspective(${m}px) ${r}`),p&&(r+=`rotate(${p}deg) `),g&&(r+=`rotateX(${g}deg) `),y&&(r+=`rotateY(${y}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const u=e.x.scale*t.x,h=e.y.scale*t.y;return(u!==1||h!==1)&&(r+=`scale(${u}, ${h})`),r||"none"}const Q_=["TopLeft","TopRight","BottomLeft","BottomRight"],p5=Q_.length,w2=e=>typeof e=="string"?parseFloat(e):e,_2=e=>typeof e=="number"||je.test(e);function x5(e,t,a,r,s,l){s?(e.opacity=Ft(0,a.opacity??1,g5(r)),e.opacityExit=Ft(t.opacity??1,0,v5(r))):l&&(e.opacity=Ft(t.opacity??1,a.opacity??1,r));for(let c=0;c<p5;c++){const u=`border${Q_[c]}Radius`;let h=T2(t,u),m=T2(a,u);if(h===void 0&&m===void 0)continue;h||(h=0),m||(m=0),h===0||m===0||_2(h)===_2(m)?(e[u]=Math.max(Ft(w2(h),w2(m),r),0),(dn.test(m)||dn.test(h))&&(e[u]+="%")):e[u]=m}(t.rotate||a.rotate)&&(e.rotate=Ft(t.rotate||0,a.rotate||0,r))}function T2(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const g5=Z_(0,.5,qw),v5=Z_(.5,.95,Dr);function Z_(e,t,a){return r=>r<e?0:r>t?1:a(uc(e,t,r))}function y5(e,t){const a=Pa.now(),r=({timestamp:s})=>{const l=s-a;l>=t&&(Ns(r),e(l-t))};return At.setup(r,!0),()=>Ns(r)}function mc(e,t,a,r={passive:!0}){return e.addEventListener(t,a,r),()=>e.removeEventListener(t,a)}function N0(e){return Aa(e)?e.get():e}function b5(e,t,a){const r=Aa(e)?e:Ml(e);return r.start(Op("",r,t,a)),r.animation}const w5=(e,t)=>e.depth-t.depth;class _5{constructor(){this.children=[],this.isDirty=!1}add(t){dp(this.children,t),this.isDirty=!0}remove(t){mp(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(w5),this.isDirty=!1,this.children.forEach(t)}}class T5{constructor(){this.members=[]}add(t){dp(this.members,t),t.scheduleRender()}remove(t){if(mp(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(t){const a=this.members.findIndex(s=>t===s);if(a===0)return!1;let r;for(let s=a;s>=0;s--){const l=this.members[s];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(t,a){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,a&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:a,resumingFrom:r}=t;a.onExitComplete&&a.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const C0={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Ud=["","X","Y","Z"],S5=1e3;let E5=0;function zd(e,t,a,r){const{latestValues:s}=t;s[e]&&(a[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function eT(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const a=y_(t);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:s,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",At,!(s||l))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&eT(r)}function tT({attachResizeListener:e,defaultParent:t,measureScroll:a,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(c={},u=t?.()){this.id=E5++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(N5),this.nodes.forEach(j5),this.nodes.forEach(R5),this.nodes.forEach(C5)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=c,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new _5)}addEventListener(c,u){return this.eventHandlers.has(c)||this.eventHandlers.set(c,new gp),this.eventHandlers.get(c).add(u)}notifyListeners(c,...u){const h=this.eventHandlers.get(c);h&&h.notify(...u)}hasListeners(c){return this.eventHandlers.has(c)}mount(c){if(this.instance)return;this.isSVG=D_(c)&&!A6(c),this.instance=c;const{layoutId:u,layout:h,visualElement:m}=this.options;if(m&&!m.current&&m.mount(c),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||u)&&(this.isLayoutDirty=!0),e){let p,g=0;const y=()=>this.root.updateBlockedByResize=!1;At.read(()=>{g=window.innerWidth}),e(c,()=>{const b=window.innerWidth;b!==g&&(g=b,this.root.updateBlockedByResize=!0,p&&p(),p=y5(y,250),C0.hasAnimatedSinceResize&&(C0.hasAnimatedSinceResize=!1,this.nodes.forEach(k2)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&m&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g,hasRelativeLayoutChanged:y,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||m.getDefaultTransition()||I5,{onLayoutAnimationStart:w,onLayoutAnimationComplete:T}=m.getProps(),A=!this.targetLayout||!J_(this.targetLayout,b),k=!g&&y;if(this.options.layoutRoot||this.resumeFrom||k||g&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const S={...Cp(_,"layout"),onPlay:w,onComplete:T};(m.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S),this.setAnimationOrigin(p,k)}else g||k2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const c=this.getStack();c&&c.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ns(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(M5),this.animationId++)}getTransformTemplate(){const{visualElement:c}=this.options;return c&&c.getProps().transformTemplate}willUpdate(c=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&eT(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const g=this.path[p];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:u,layout:h}=this.options;if(u===void 0&&!h)return;const m=this.getTransformTemplate();this.prevTransformTemplateValue=m?m(this.latestValues,""):void 0,this.updateSnapshot(),c&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(S2);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(E2);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(D5),this.nodes.forEach(k5),this.nodes.forEach(A5)):this.nodes.forEach(E2),this.clearAllSnapshots();const u=Pa.now();ga.delta=mn(0,1e3/60,u-ga.timestamp),ga.timestamp=u,ga.isProcessing=!0,jd.update.process(ga),jd.preRender.process(ga),jd.render.process(ga),ga.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Mp.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(O5),this.sharedNodes.forEach(F5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,At.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){At.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ia(this.snapshot.measuredBox.x)&&!Ia(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const c=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=na(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,c?c.layoutBox:void 0)}updateScroll(c="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===c&&(u=!1),u&&this.instance){const h=r(this.instance);this.scroll={animationId:this.root.animationId,phase:c,isRoot:h,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!s)return;const c=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!K_(this.projectionDelta),h=this.getTransformTemplate(),m=h?h(this.latestValues,""):void 0,p=m!==this.prevTransformTemplateValue;c&&this.instance&&(u||si(this.latestValues)||p)&&(s(this.instance,m),this.shouldResetTransform=!1,this.scheduleRender())}measure(c=!0){const u=this.measurePageBox();let h=this.removeElementScroll(u);return c&&(h=this.removeTransform(h)),B5(h),{animationId:this.root.animationId,measuredBox:u,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:c}=this.options;if(!c)return na();const u=c.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(U5))){const{scroll:m}=this.root;m&&(Tl(u.x,m.offset.x),Tl(u.y,m.offset.y))}return u}removeElementScroll(c){const u=na();if(zr(u,c),this.scroll?.wasRoot)return u;for(let h=0;h<this.path.length;h++){const m=this.path[h],{scroll:p,options:g}=m;m!==this.root&&p&&g.layoutScroll&&(p.wasRoot&&zr(u,c),Tl(u.x,p.offset.x),Tl(u.y,p.offset.y))}return u}applyTransform(c,u=!1){const h=na();zr(h,c);for(let m=0;m<this.path.length;m++){const p=this.path[m];!u&&p.options.layoutScroll&&p.scroll&&p!==p.root&&Sl(h,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),si(p.latestValues)&&Sl(h,p.latestValues)}return si(this.latestValues)&&Sl(h,this.latestValues),h}removeTransform(c){const u=na();zr(u,c);for(let h=0;h<this.path.length;h++){const m=this.path[h];if(!m.instance||!si(m.latestValues))continue;Mm(m.latestValues)&&m.updateSnapshot();const p=na(),g=m.measurePageBox();zr(p,g),d2(u,m.latestValues,m.snapshot?m.snapshot.layoutBox:void 0,p)}return si(this.latestValues)&&d2(u,this.latestValues),u}setTargetDelta(c){this.targetDelta=c,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(c){this.options={...this.options,...c,crossfade:c.crossfade!==void 0?c.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ga.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(c=!1){const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(c||h&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:g}=this.options;if(!this.layout||!(p||g))return;this.resolvedRelativeTargetAt=ga.timestamp;const y=this.getClosestProjectingParent();y&&this.linkedParentVersion!==y.layoutVersion&&!y.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(y&&y.layout?this.createRelativeTarget(y,this.layout.layoutBox,y.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=na(),this.targetWithTransforms=na()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),c5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zr(this.target,this.layout.layoutBox),I_(this.target,this.targetDelta)):zr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?this.createRelativeTarget(y,this.target,y.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Mm(this.parent.latestValues)||P_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(c,u,h){this.relativeParent=c,this.linkedParentVersion=c.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=na(),this.relativeTargetOrigin=na(),P0(this.relativeTargetOrigin,u,h),zr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const c=this.getLead(),u=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===ga.timestamp&&(h=!1),h)return;const{layout:m,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(m||p))return;zr(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,y=this.treeScale.y;I6(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=na());const{target:b}=c;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(p2(this.prevProjectionDelta.x,this.projectionDelta.x),p2(this.prevProjectionDelta.y,this.projectionDelta.y)),Yo(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==y||!b2(this.projectionDelta.x,this.prevProjectionDelta.x)||!b2(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(c=!0){if(this.options.visualElement?.scheduleRender(),c){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_l(),this.projectionDelta=_l(),this.projectionDeltaWithTransform=_l()}setAnimationOrigin(c,u=!1){const h=this.snapshot,m=h?h.latestValues:{},p={...this.latestValues},g=_l();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const y=na(),b=h?h.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,T=this.getStack(),A=!T||T.members.length<=1,k=!!(w&&!A&&this.options.crossfade===!0&&!this.path.some(P5));this.animationProgress=0;let S;this.mixTargetDelta=L=>{const V=L/1e3;A2(g.x,c.x,V),A2(g.y,c.y,V),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(P0(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),L5(this.relativeTarget,this.relativeTargetOrigin,y,V),S&&d5(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=na()),zr(S,this.relativeTarget)),w&&(this.animationValues=p,x5(p,m,this.latestValues,V,k,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(c){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ns(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=At.update(()=>{C0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ml(0)),this.currentAnimation=b5(this.motionValue,[0,1e3],{...c,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),c.onUpdate&&c.onUpdate(u)},onStop:()=>{},onComplete:()=>{c.onComplete&&c.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const c=this.getStack();c&&c.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(S5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const c=this.getLead();let{targetWithTransforms:u,target:h,layout:m,latestValues:p}=c;if(!(!u||!h||!m)){if(this!==c&&this.layout&&m&&aT(this.options.animationType,this.layout.layoutBox,m.layoutBox)){h=this.target||na();const g=Ia(this.layout.layoutBox.x);h.x.min=c.target.x.min,h.x.max=h.x.min+g;const y=Ia(this.layout.layoutBox.y);h.y.min=c.target.y.min,h.y.max=h.y.min+y}zr(u,h),Sl(u,p),Yo(this.projectionDeltaWithTransform,this.layoutCorrected,u,p)}}registerSharedNode(c,u){this.sharedNodes.has(c)||this.sharedNodes.set(c,new T5),this.sharedNodes.get(c).add(u);const m=u.options.initialPromotionConfig;u.promote({transition:m?m.transition:void 0,preserveFollowOpacity:m&&m.shouldPreserveFollowOpacity?m.shouldPreserveFollowOpacity(u):void 0})}isLead(){const c=this.getStack();return c?c.lead===this:!0}getLead(){const{layoutId:c}=this.options;return c?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:c}=this.options;return c?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:c}=this.options;if(c)return this.root.sharedNodes.get(c)}promote({needsReset:c,transition:u,preserveFollowOpacity:h}={}){const m=this.getStack();m&&m.promote(this,h),c&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const c=this.getStack();return c?c.relegate(this):!1}resetSkewAndRotation(){const{visualElement:c}=this.options;if(!c)return;let u=!1;const{latestValues:h}=c;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(u=!0),!u)return;const m={};h.z&&zd("z",c,m,this.animationValues);for(let p=0;p<Ud.length;p++)zd(`rotate${Ud[p]}`,c,m,this.animationValues),zd(`skew${Ud[p]}`,c,m,this.animationValues);c.render();for(const p in m)c.setStaticValue(p,m[p]),this.animationValues&&(this.animationValues[p]=m[p]);c.scheduleRender()}applyProjectionStyles(c,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){c.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,c.visibility="",c.opacity="",c.pointerEvents=N0(u?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none";return}const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){this.options.layoutId&&(c.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,c.pointerEvents=N0(u?.pointerEvents)||""),this.hasProjected&&!si(this.latestValues)&&(c.transform=h?h({},""):"none",this.hasProjected=!1);return}c.visibility="";const p=m.animationValues||m.latestValues;this.applyTransformsToTarget();let g=m5(this.projectionDeltaWithTransform,this.treeScale,p);h&&(g=h(p,g)),c.transform=g;const{x:y,y:b}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${b.origin*100}% 0`,m.animationValues?c.opacity=m===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=m===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in Lm){if(p[_]===void 0)continue;const{correct:w,applyTo:T,isCSSVariable:A}=Lm[_],k=g==="none"?p[_]:w(p[_],m);if(T){const S=T.length;for(let L=0;L<S;L++)c[T[L]]=k}else A?this.options.visualElement.renderState.vars[_]=k:c[_]=k}this.options.layoutId&&(c.pointerEvents=m===this?N0(u?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(c=>c.currentAnimation?.stop()),this.root.nodes.forEach(S2),this.root.sharedNodes.clear()}}}function k5(e){e.updateLayout()}function A5(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:r}=e.layout,{animationType:s}=e.options,l=t.source!==e.layout.source;s==="size"?Nr(p=>{const g=l?t.measuredBox[p]:t.layoutBox[p],y=Ia(g);g.min=a[p].min,g.max=g.min+y}):aT(s,t.layoutBox,a)&&Nr(p=>{const g=l?t.measuredBox[p]:t.layoutBox[p],y=Ia(a[p]);g.max=g.min+y,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[p].max=e.relativeTarget[p].min+y)});const c=_l();Yo(c,a,t.layoutBox);const u=_l();l?Yo(u,e.applyTransform(r,!0),t.measuredBox):Yo(u,a,t.layoutBox);const h=!K_(c);let m=!1;if(!e.resumeFrom){const p=e.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:g,layout:y}=p;if(g&&y){const b=na();P0(b,t.layoutBox,g.layoutBox);const _=na();P0(_,a,y.layoutBox),J_(b,_)||(m=!0),p.options.layoutRoot&&(e.relativeTarget=_,e.relativeTargetOrigin=b,e.relativeParent=p)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:u,layoutDelta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:m})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function N5(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function C5(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function O5(e){e.clearSnapshot()}function S2(e){e.clearMeasurements()}function E2(e){e.isLayoutDirty=!1}function D5(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function k2(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function j5(e){e.resolveTargetDelta()}function R5(e){e.calcProjection()}function M5(e){e.resetSkewAndRotation()}function F5(e){e.removeLeadSnapshot()}function A2(e,t,a){e.translate=Ft(t.translate,0,a),e.scale=Ft(t.scale,1,a),e.origin=t.origin,e.originPoint=t.originPoint}function N2(e,t,a,r){e.min=Ft(t.min,a.min,r),e.max=Ft(t.max,a.max,r)}function L5(e,t,a,r){N2(e.x,t.x,a.x,r),N2(e.y,t.y,a.y,r)}function P5(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const I5={duration:.45,ease:[.4,0,.1,1]},C2=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),O2=C2("applewebkit/")&&!C2("chrome/")?Math.round:Dr;function D2(e){e.min=O2(e.min),e.max=O2(e.max)}function B5(e){D2(e.x),D2(e.y)}function aT(e,t,a){return e==="position"||e==="preserve-aspect"&&!o5(y2(t),y2(a),.2)}function U5(e){return e!==e.root&&e.scroll?.wasRoot}const z5=tT({attachResizeListener:(e,t)=>mc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Vd={current:void 0},rT=tT({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Vd.current){const e=new z5({});e.mount(window),e.setOptions({layoutScroll:!0}),Vd.current=e}return Vd.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Up=ie.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function j2(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function V5(...e){return t=>{let a=!1;const r=e.map(s=>{const l=j2(s,t);return!a&&typeof l=="function"&&(a=!0),l});if(a)return()=>{for(let s=0;s<r.length;s++){const l=r[s];typeof l=="function"?l():j2(e[s],null)}}}}function H5(...e){return ie.useCallback(V5(...e),e)}class $5 extends ie.Component{getSnapshotBeforeUpdate(t){const a=this.props.childRef.current;if(a&&t.isPresent&&!this.props.isPresent){const r=a.offsetParent,s=k_(r)&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft,l.right=s-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function G5({children:e,isPresent:t,anchorX:a,root:r}){const s=ie.useId(),l=ie.useRef(null),c=ie.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=ie.useContext(Up),h=e.props?.ref??e?.ref,m=H5(l,h);return ie.useInsertionEffect(()=>{const{width:p,height:g,top:y,left:b,right:_}=c.current;if(t||!l.current||!p||!g)return;const w=a==="left"?`left: ${b}`:`right: ${_}`;l.current.dataset.motionPopId=s;const T=document.createElement("style");u&&(T.nonce=u);const A=r??document.head;return A.appendChild(T),T.sheet&&T.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${g}px !important;
            ${w}px !important;
            top: ${y}px !important;
          }
        `),()=>{A.contains(T)&&A.removeChild(T)}},[t]),d.jsx($5,{isPresent:t,childRef:l,sizeRef:c,children:ie.cloneElement(e,{ref:m})})}const q5=({children:e,initial:t,isPresent:a,onExitComplete:r,custom:s,presenceAffectsLayout:l,mode:c,anchorX:u,root:h})=>{const m=hp(W5),p=ie.useId();let g=!0,y=ie.useMemo(()=>(g=!1,{id:p,initial:t,isPresent:a,custom:s,onExitComplete:b=>{m.set(b,!0);for(const _ of m.values())if(!_)return;r&&r()},register:b=>(m.set(b,!1),()=>m.delete(b))}),[a,m,r]);return l&&g&&(y={...y}),ie.useMemo(()=>{m.forEach((b,_)=>m.set(_,!1))},[a]),ie.useEffect(()=>{!a&&!m.size&&r&&r()},[a]),c==="popLayout"&&(e=d.jsx(G5,{isPresent:a,anchorX:u,root:h,children:e})),d.jsx(af.Provider,{value:y,children:e})};function W5(){return new Map}function nT(e=!0){const t=ie.useContext(af);if(t===null)return[!0,null];const{isPresent:a,onExitComplete:r,register:s}=t,l=ie.useId();ie.useEffect(()=>{if(e)return s(l)},[e]);const c=ie.useCallback(()=>e&&r&&r(l),[l,r,e]);return!a&&r?[!1,c]:[!0]}const o0=e=>e.key||"";function R2(e){const t=[];return ie.Children.forEach(e,a=>{ie.isValidElement(a)&&t.push(a)}),t}const pc=({children:e,custom:t,initial:a=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:l="sync",propagate:c=!1,anchorX:u="left",root:h})=>{const[m,p]=nT(c),g=ie.useMemo(()=>R2(e),[e]),y=c&&!m?[]:g.map(o0),b=ie.useRef(!0),_=ie.useRef(g),w=hp(()=>new Map),T=ie.useRef(new Set),[A,k]=ie.useState(g),[S,L]=ie.useState(g);Fw(()=>{b.current=!1,_.current=g;for(let N=0;N<S.length;N++){const j=o0(S[N]);y.includes(j)?(w.delete(j),T.current.delete(j)):w.get(j)!==!0&&w.set(j,!1)}},[S,y.length,y.join("-")]);const V=[];if(g!==A){let N=[...g];for(let j=0;j<S.length;j++){const I=S[j],z=o0(I);y.includes(z)||(N.splice(j,0,I),V.push(I))}return l==="wait"&&V.length&&(N=V),L(R2(N)),k(g),null}const{forceRender:P}=ie.useContext(fp);return d.jsx(d.Fragment,{children:S.map(N=>{const j=o0(N),I=c&&!m?!1:g===S||y.includes(j),z=()=>{if(T.current.has(j))return;if(T.current.add(j),w.has(j))w.set(j,!0);else return;let X=!0;w.forEach(q=>{q||(X=!1)}),X&&(P?.(),L(_.current),c&&p?.(),r&&r())};return d.jsx(q5,{isPresent:I,initial:!b.current||a?void 0:!1,custom:t,presenceAffectsLayout:s,mode:l,root:h,onExitComplete:I?void 0:z,anchorX:u,children:N},j)})})},sT=ie.createContext({strict:!1}),M2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let F2=!1;function Y5(){if(F2)return;const e={};for(const t in M2)e[t]={isEnabled:a=>M2[t].some(r=>!!a[r])};M_(e),F2=!0}function iT(){return Y5(),M6()}function X5(e){const t=iT();for(const a in e)t[a]={...t[a],...e[a]};M_(t)}const K5=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function I0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||K5.has(e)}let lT=e=>!I0(e);function J5(e){typeof e=="function"&&(lT=t=>t.startsWith("on")?!I0(t):e(t))}try{J5(require("@emotion/is-prop-valid").default)}catch{}function Q5(e,t,a){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(lT(s)||a===!0&&I0(s)||!t&&!I0(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}const sf=ie.createContext({});function Z5(e,t){if(nf(e)){const{initial:a,animate:r}=e;return{initial:a===!1||dc(a)?a:void 0,animate:dc(r)?r:void 0}}return e.inherit!==!1?t:{}}function eD(e){const{initial:t,animate:a}=Z5(e,ie.useContext(sf));return ie.useMemo(()=>({initial:t,animate:a}),[L2(t),L2(a)])}function L2(e){return Array.isArray(e)?e.join(" "):e}const zp=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function oT(e,t,a){for(const r in t)!Aa(t[r])&&!z_(r,a)&&(e[r]=t[r])}function tD({transformTemplate:e},t){return ie.useMemo(()=>{const a=zp();return Ip(a,t,e),Object.assign({},a.vars,a.style)},[t])}function aD(e,t){const a=e.style||{},r={};return oT(r,a,e),Object.assign(r,tD(e,t)),r}function rD(e,t){const a={},r=aD(e,t);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=r,a}const cT=()=>({...zp(),attrs:{}});function nD(e,t,a,r){const s=ie.useMemo(()=>{const l=cT();return V_(l,t,$_(r),e.transformTemplate,e.style),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};oT(l,e.style,e),s.style={...l,...s.style}}return s}const sD=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Vp(e){return typeof e!="string"||e.includes("-")?!1:!!(sD.indexOf(e)>-1||/[A-Z]/u.test(e))}function iD(e,t,a,{latestValues:r},s,l=!1,c){const h=(c??Vp(e)?nD:rD)(t,r,s,e),m=Q5(t,typeof e=="string",l),p=e!==ie.Fragment?{...m,...h,ref:a}:{},{children:g}=t,y=ie.useMemo(()=>Aa(g)?g.get():g,[g]);return ie.createElement(e,{...p,children:y})}function lD({scrapeMotionValuesFromProps:e,createRenderState:t},a,r,s){return{latestValues:oD(a,r,s,e),renderState:t()}}function oD(e,t,a,r){const s={},l=r(e,{});for(const y in l)s[y]=N0(l[y]);let{initial:c,animate:u}=e;const h=nf(e),m=R_(e);t&&m&&!h&&e.inherit!==!1&&(c===void 0&&(c=t.initial),u===void 0&&(u=t.animate));let p=a?a.initial===!1:!1;p=p||c===!1;const g=p?u:c;if(g&&typeof g!="boolean"&&!rf(g)){const y=Array.isArray(g)?g:[g];for(let b=0;b<y.length;b++){const _=Dp(e,y[b]);if(_){const{transitionEnd:w,transition:T,...A}=_;for(const k in A){let S=A[k];if(Array.isArray(S)){const L=p?S.length-1:0;S=S[L]}S!==null&&(s[k]=S)}for(const k in w)s[k]=w[k]}}}return s}const uT=e=>(t,a)=>{const r=ie.useContext(sf),s=ie.useContext(af),l=()=>lD(e,t,r,s);return a?l():hp(l)},cD=uT({scrapeMotionValuesFromProps:Bp,createRenderState:zp}),uD=uT({scrapeMotionValuesFromProps:G_,createRenderState:cT}),fD=Symbol.for("motionComponentSymbol");function hD(e,t,a){const r=ie.useRef(a);ie.useInsertionEffect(()=>{r.current=a});const s=ie.useRef(null);return ie.useCallback(l=>{l&&e.onMount?.(l),t&&(l?t.mount(l):t.unmount());const c=r.current;if(typeof c=="function")if(l){const u=c(l);typeof u=="function"&&(s.current=u)}else s.current?(s.current(),s.current=null):c(l);else c&&(c.current=l)},[t])}const fT=ie.createContext({});function Uo(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function dD(e,t,a,r,s,l){const{visualElement:c}=ie.useContext(sf),u=ie.useContext(sT),h=ie.useContext(af),m=ie.useContext(Up).reducedMotion,p=ie.useRef(null);r=r||u.renderer,!p.current&&r&&(p.current=r(e,{visualState:t,parent:c,props:a,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:m,isSVG:l}));const g=p.current,y=ie.useContext(fT);g&&!g.projection&&s&&(g.type==="html"||g.type==="svg")&&mD(p.current,a,s,y);const b=ie.useRef(!1);ie.useInsertionEffect(()=>{g&&b.current&&g.update(a,h)});const _=a[v_],w=ie.useRef(!!_&&!window.MotionHandoffIsComplete?.(_)&&window.MotionHasOptimisedAnimation?.(_));return Fw(()=>{g&&(b.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),w.current&&g.animationState&&g.animationState.animateChanges())}),ie.useEffect(()=>{g&&(!w.current&&g.animationState&&g.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(_)}),w.current=!1),g.enteringChildren=void 0)}),g}function mD(e,t,a,r){const{layoutId:s,layout:l,drag:c,dragConstraints:u,layoutScroll:h,layoutRoot:m,layoutCrossfade:p}=t;e.projection=new a(e.latestValues,t["data-framer-portal-id"]?void 0:hT(e.parent)),e.projection.setOptions({layoutId:s,layout:l,alwaysMeasureLayout:!!c||u&&Uo(u),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:r,crossfade:p,layoutScroll:h,layoutRoot:m})}function hT(e){if(e)return e.options.allowProjection!==!1?e.projection:hT(e.parent)}function Hd(e,{forwardMotionProps:t=!1,type:a}={},r,s){r&&X5(r);const l=a?a==="svg":Vp(e),c=l?uD:cD;function u(m,p){let g;const y={...ie.useContext(Up),...m,layoutId:pD(m)},{isStatic:b}=y,_=eD(m),w=c(m,b);if(!b&&Mw){xD();const T=gD(y);g=T.MeasureLayout,_.visualElement=dD(e,w,y,s,T.ProjectionNode,l)}return d.jsxs(sf.Provider,{value:_,children:[g&&_.visualElement?d.jsx(g,{visualElement:_.visualElement,...y}):null,iD(e,m,hD(w,_.visualElement,p),w,b,t,l)]})}u.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const h=ie.forwardRef(u);return h[fD]=e,h}function pD({layoutId:e}){const t=ie.useContext(fp).id;return t&&e!==void 0?t+"-"+e:e}function xD(e,t){ie.useContext(sT).strict}function gD(e){const t=iT(),{drag:a,layout:r}=t;if(!a&&!r)return{};const s={...a,...r};return{MeasureLayout:a?.isEnabled(e)||r?.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function vD(e,t){if(typeof Proxy>"u")return Hd;const a=new Map,r=(l,c)=>Hd(l,c,e,t),s=(l,c)=>r(l,c);return new Proxy(s,{get:(l,c)=>c==="create"?r:(a.has(c)||a.set(c,Hd(c,void 0,e,t)),a.get(c))})}const yD=(e,t)=>t.isSVG??Vp(e)?new J6(t):new G6(t,{allowProjection:e!==ie.Fragment});class bD extends js{constructor(t){super(t),t.animationState||(t.animationState=a5(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();rf(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:a}=this.node.prevProps||{};t!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wD=0;class _D extends js{constructor(){super(...arguments),this.id=wD++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:a}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);a&&!t&&s.then(()=>{a(this.id)})}mount(){const{register:t,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const TD={animation:{Feature:bD},exit:{Feature:_D}};function Mc(e){return{point:{x:e.pageX,y:e.pageY}}}const SD=e=>t=>Fp(t)&&e(t,Mc(t));function Xo(e,t,a,r){return mc(e,t,SD(a),r)}const dT=({current:e})=>e?e.ownerDocument.defaultView:null,P2=(e,t)=>Math.abs(e-t);function ED(e,t){const a=P2(e.x,t.x),r=P2(e.y,t.y);return Math.sqrt(a**2+r**2)}const I2=new Set(["auto","scroll"]);class mT{constructor(t,a,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:l=!1,distanceThreshold:c=3,element:u}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=b=>{this.handleScroll(b.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=Gd(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,w=ED(b.offset,{x:0,y:0})>=this.distanceThreshold;if(!_&&!w)return;const{point:T}=b,{timestamp:A}=ga;this.history.push({...T,timestamp:A});const{onStart:k,onMove:S}=this.handlers;_||(k&&k(this.lastMoveEvent,b),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,b)},this.handlePointerMove=(b,_)=>{this.lastMoveEvent=b,this.lastMoveEventInfo=$d(_,this.transformPagePoint),At.update(this.updatePoint,!0)},this.handlePointerUp=(b,_)=>{this.end();const{onEnd:w,onSessionEnd:T,resumeAnimation:A}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&A&&A(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=Gd(b.type==="pointercancel"?this.lastMoveEventInfo:$d(_,this.transformPagePoint),this.history);this.startEvent&&w&&w(b,k),T&&T(b,k)},!Fp(t))return;this.dragSnapToOrigin=l,this.handlers=a,this.transformPagePoint=r,this.distanceThreshold=c,this.contextWindow=s||window;const h=Mc(t),m=$d(h,this.transformPagePoint),{point:p}=m,{timestamp:g}=ga;this.history=[{...p,timestamp:g}];const{onSessionStart:y}=a;y&&y(t,Gd(m,this.history)),this.removeListeners=Dc(Xo(this.contextWindow,"pointermove",this.handlePointerMove),Xo(this.contextWindow,"pointerup",this.handlePointerUp),Xo(this.contextWindow,"pointercancel",this.handlePointerUp)),u&&this.startScrollTracking(u)}startScrollTracking(t){let a=t.parentElement;for(;a;){const r=getComputedStyle(a);(I2.has(r.overflowX)||I2.has(r.overflowY))&&this.scrollPositions.set(a,{x:a.scrollLeft,y:a.scrollTop}),a=a.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const a=this.scrollPositions.get(t);if(!a)return;const r=t===window,s=r?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},l={x:s.x-a.x,y:s.y-a.y};l.x===0&&l.y===0||(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=l.x,this.lastMoveEventInfo.point.y+=l.y):this.history.length>0&&(this.history[0].x-=l.x,this.history[0].y-=l.y),this.scrollPositions.set(t,s),At.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ns(this.updatePoint)}}function $d(e,t){return t?{point:t(e.point)}:e}function B2(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Gd({point:e},t){return{point:e,delta:B2(e,pT(t)),offset:B2(e,kD(t)),velocity:AD(t,.1)}}function kD(e){return e[0]}function pT(e){return e[e.length-1]}function AD(e,t){if(e.length<2)return{x:0,y:0};let a=e.length-1,r=null;const s=pT(e);for(;a>=0&&(r=e[a],!(s.timestamp-r.timestamp>In(t)));)a--;if(!r)return{x:0,y:0};const l=Or(s.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const c={x:(s.x-r.x)/l,y:(s.y-r.y)/l};return c.x===1/0&&(c.x=0),c.y===1/0&&(c.y=0),c}function ND(e,{min:t,max:a},r){return t!==void 0&&e<t?e=r?Ft(t,e,r.min):Math.max(e,t):a!==void 0&&e>a&&(e=r?Ft(a,e,r.max):Math.min(e,a)),e}function U2(e,t,a){return{min:t!==void 0?e.min+t:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function CD(e,{top:t,left:a,bottom:r,right:s}){return{x:U2(e.x,a,s),y:U2(e.y,t,r)}}function z2(e,t){let a=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([a,r]=[r,a]),{min:a,max:r}}function OD(e,t){return{x:z2(e.x,t.x),y:z2(e.y,t.y)}}function DD(e,t){let a=.5;const r=Ia(e),s=Ia(t);return s>r?a=uc(t.min,t.max-r,e.min):r>s&&(a=uc(e.min,e.max-s,t.min)),mn(0,1,a)}function jD(e,t){const a={};return t.min!==void 0&&(a.min=t.min-e.min),t.max!==void 0&&(a.max=t.max-e.min),a}const Pm=.35;function RD(e=Pm){return e===!1?e=0:e===!0&&(e=Pm),{x:V2(e,"left","right"),y:V2(e,"top","bottom")}}function V2(e,t,a){return{min:H2(e,t),max:H2(e,a)}}function H2(e,t){return typeof e=="number"?e:e[t]||0}const MD=new WeakMap;class FD{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=na(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:a=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const l=g=>{a?(this.stopAnimation(),this.snapToCursor(Mc(g).point)):this.pauseAnimation()},c=(g,y)=>{this.stopAnimation();const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=_6(b),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=y,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Nr(A=>{let k=this.getAxisMotionValue(A).get()||0;if(dn.test(k)){const{projection:S}=this.visualElement;if(S&&S.layout){const L=S.layout.layoutBox[A];L&&(k=Ia(L)*(parseFloat(k)/100))}}this.originPoint[A]=k}),w&&At.postRender(()=>w(g,y)),Om(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},u=(g,y)=>{this.latestPointerEvent=g,this.latestPanInfo=y;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:T}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:A}=y;if(_&&this.currentDirection===null){this.currentDirection=LD(A),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",y.point,A),this.updateAxis("y",y.point,A),this.visualElement.render(),T&&T(g,y)},h=(g,y)=>{this.latestPointerEvent=g,this.latestPanInfo=y,this.stop(g,y),this.latestPointerEvent=null,this.latestPanInfo=null},m=()=>Nr(g=>this.getAnimationState(g)==="paused"&&this.getAxisMotionValue(g).animation?.play()),{dragSnapToOrigin:p}=this.getProps();this.panSession=new mT(t,{onSessionStart:l,onStart:c,onMove:u,onSessionEnd:h,resumeAnimation:m},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:r,contextWindow:dT(this.visualElement),element:this.visualElement.current})}stop(t,a){const r=t||this.latestPointerEvent,s=a||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!s||!r)return;const{velocity:c}=s;this.startAnimation(c);const{onDragEnd:u}=this.getProps();u&&At.postRender(()=>u(r,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:a}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(t,a,r){const{drag:s}=this.getProps();if(!r||!c0(t,s,this.currentDirection))return;const l=this.getAxisMotionValue(t);let c=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(c=ND(c,this.constraints[t],this.elastic[t])),l.set(c)}resolveConstraints(){const{dragConstraints:t,dragElastic:a}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Uo(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=CD(r.layoutBox,t):this.constraints=!1,this.elastic=RD(a),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Nr(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=jD(r.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:a}=this.getProps();if(!t||!Uo(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const l=B6(r,s.root,this.visualElement.getTransformPagePoint());let c=OD(s.layout.layoutBox,l);if(a){const u=a(L6(c));this.hasMutatedConstraints=!!u,u&&(c=L_(u))}return c}startAnimation(t){const{drag:a,dragMomentum:r,dragElastic:s,dragTransition:l,dragSnapToOrigin:c,onDragTransitionEnd:u}=this.getProps(),h=this.constraints||{},m=Nr(p=>{if(!c0(p,a,this.currentDirection))return;let g=h&&h[p]||{};c&&(g={min:0,max:0});const y=s?200:1e6,b=s?40:1e7,_={type:"inertia",velocity:r?t[p]:0,bounceStiffness:y,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...g};return this.startAxisValueAnimation(p,_)});return Promise.all(m).then(u)}startAxisValueAnimation(t,a){const r=this.getAxisMotionValue(t);return Om(this.visualElement,t),r.start(Op(t,r,0,a,this.visualElement,!1))}stopAnimation(){Nr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Nr(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const a=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[a];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Nr(a=>{const{drag:r}=this.getProps();if(!c0(a,r,this.currentDirection))return;const{projection:s}=this.visualElement,l=this.getAxisMotionValue(a);if(s&&s.layout){const{min:c,max:u}=s.layout.layoutBox[a],h=l.get()||0;l.set(t[a]-Ft(c,u,.5)+h)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:a}=this.getProps(),{projection:r}=this.visualElement;if(!Uo(a)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Nr(c=>{const u=this.getAxisMotionValue(c);if(u&&this.constraints!==!1){const h=u.get();s[c]=DD({min:h,max:h},this.constraints[c])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Nr(c=>{if(!c0(c,t,null))return;const u=this.getAxisMotionValue(c),{min:h,max:m}=this.constraints[c];u.set(Ft(h,m,s[c]))})}addListeners(){if(!this.visualElement.current)return;MD.set(this.visualElement,this);const t=this.visualElement.current,a=Xo(t,"pointerdown",h=>{const{drag:m,dragListener:p=!0}=this.getProps();m&&p&&!O_(h.target)&&this.start(h)}),r=()=>{const{dragConstraints:h}=this.getProps();Uo(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,l=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),At.read(r);const c=mc(window,"resize",()=>this.scalePositionWithinConstraints()),u=s.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:m})=>{this.isDragging&&m&&(Nr(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=h[p].translate,g.set(g.get()+h[p].translate))}),this.visualElement.render())}));return()=>{c(),a(),l(),u&&u()}}getProps(){const t=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:l=!1,dragElastic:c=Pm,dragMomentum:u=!0}=t;return{...t,drag:a,dragDirectionLock:r,dragPropagation:s,dragConstraints:l,dragElastic:c,dragMomentum:u}}}function c0(e,t,a){return(t===!0||t===e)&&(a===null||a===e)}function LD(e,t=10){let a=null;return Math.abs(e.y)>t?a="y":Math.abs(e.x)>t&&(a="x"),a}class PD extends js{constructor(t){super(t),this.removeGroupControls=Dr,this.removeListeners=Dr,this.controls=new FD(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Dr}update(){const{dragControls:t}=this.node.getProps(),{dragControls:a}=this.node.prevProps||{};t!==a&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const $2=e=>(t,a)=>{e&&At.postRender(()=>e(t,a))};class ID extends js{constructor(){super(...arguments),this.removePointerDownListener=Dr}onPointerDown(t){this.session=new mT(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:dT(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:a,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:$2(t),onStart:$2(a),onMove:r,onEnd:(l,c)=>{delete this.session,s&&At.postRender(()=>s(l,c))}}}mount(){this.removePointerDownListener=Xo(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let qd=!1;class BD extends ie.Component{componentDidMount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:r,layoutId:s}=this.props,{projection:l}=t;l&&(a.group&&a.group.add(l),r&&r.register&&s&&r.register(l),qd&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),C0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:a,visualElement:r,drag:s,isPresent:l}=this.props,{projection:c}=r;return c&&(c.isPresent=l,qd=!0,s||t.layoutDependency!==a||a===void 0||t.isPresent!==l?c.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?c.promote():c.relegate()||At.postRender(()=>{const u=c.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Mp.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:r}=this.props,{projection:s}=t;qd=!0,s&&(s.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function xT(e){const[t,a]=nT(),r=ie.useContext(fp);return d.jsx(BD,{...e,layoutGroup:r,switchLayoutGroup:ie.useContext(fT),isPresent:t,safeToRemove:a})}const UD={pan:{Feature:ID},drag:{Feature:PD,ProjectionNode:rT,MeasureLayout:xT}};function G2(e,t,a){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",a==="Start");const s="onHover"+a,l=r[s];l&&At.postRender(()=>l(t,Mc(t)))}class zD extends js{mount(){const{current:t}=this.node;t&&(this.unmount=T6(t,(a,r)=>(G2(this.node,r,"Start"),s=>G2(this.node,s,"End"))))}unmount(){}}class VD extends js{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Dc(mc(this.node.current,"focus",()=>this.onFocus()),mc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function q2(e,t,a){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",a==="Start");const s="onTap"+(a==="End"?"":a),l=r[s];l&&At.postRender(()=>l(t,Mc(t)))}class HD extends js{mount(){const{current:t}=this.node;t&&(this.unmount=k6(t,(a,r)=>(q2(this.node,r,"Start"),(s,{success:l})=>q2(this.node,s,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Im=new WeakMap,Wd=new WeakMap,$D=e=>{const t=Im.get(e.target);t&&t(e)},GD=e=>{e.forEach($D)};function qD({root:e,...t}){const a=e||document;Wd.has(a)||Wd.set(a,{});const r=Wd.get(a),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(GD,{root:e,...t})),r[s]}function WD(e,t,a){const r=qD(t);return Im.set(e,a),r.observe(e),()=>{Im.delete(e),r.unobserve(e)}}const YD={some:0,all:1};class XD extends js{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:a,margin:r,amount:s="some",once:l}=t,c={root:a?a.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:YD[s]},u=h=>{const{isIntersecting:m}=h;if(this.isInView===m||(this.isInView=m,l&&!m&&this.hasEnteredView))return;m&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",m);const{onViewportEnter:p,onViewportLeave:g}=this.node.getProps(),y=m?p:g;y&&y(h)};return WD(this.node.current,c,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:a}=this.node;["amount","margin","root"].some(KD(t,a))&&this.startObserver()}unmount(){}}function KD({viewport:e={}},{viewport:t={}}={}){return a=>e[a]!==t[a]}const JD={inView:{Feature:XD},tap:{Feature:HD},focus:{Feature:VD},hover:{Feature:zD}},QD={layout:{ProjectionNode:rT,MeasureLayout:xT}},ZD={...TD,...JD,...UD,...QD},va=vD(ZD,yD),El={income:[{id:"inc_salario",name:"Salario",icon:"",color:"#2ecc71"},{id:"inc_freelance",name:"Freelance",icon:"",color:"#27ae60"},{id:"inc_uber",name:"Uber",icon:"",color:"#16a085"},{id:"inc_indrive",name:"Indrive",icon:"",color:"#1abc9c"},{id:"inc_auditoria",name:"Servicios Auditoria",icon:"",color:"#3498db"},{id:"inc_interes",name:"Interes",icon:"",color:"#9b59b6"}],expense:[{id:"exp_super",name:"Super",icon:"",color:"#e74c3c"},{id:"exp_comida",name:"Comida",icon:"",color:"#e67e22"},{id:"exp_restaurantes",name:"Restaurantes",icon:"",color:"#d35400"},{id:"exp_festividades",name:"Festividades",icon:"",color:"#8e44ad"},{id:"exp_gasolina",name:"Gasolina",icon:"",color:"#f1c40f"},{id:"exp_tramites",name:"Tramites",icon:"",color:"#7f8c8d"},{id:"exp_salud",name:"Salud",icon:"",color:"#c0392b"},{id:"exp_donaciones",icon:"",name:"Donaciones",color:"#e84393"},{id:"exp_isss",name:"ISSS",icon:"",color:"#2980b9"},{id:"exp_afp",name:"AFP",icon:"",color:"#16a085"},{id:"exp_impuestos",name:"Impuestos",icon:"",color:"#2c3e50"},{id:"exp_moto",name:"Reparaciones moto",icon:"",color:"#d63031"},{id:"exp_carro",name:"Reparaciones carro",icon:"",color:"#cf6a87"},{id:"exp_casa",name:"Reparaciones Casa",icon:"",color:"#fa983a"},{id:"exp_activos",name:"Activos",icon:"",color:"#6a89cc"}]},ej=({data:e})=>{const t=Math.max(...e.map(a=>Math.max(a.budgeted,a.executed)),100);return d.jsxs("div",{className:"relative h-[250px] w-full pt-10 pb-8 px-4",children:[d.jsx("div",{className:"flex items-end justify-between h-full gap-2 sm:gap-4 overflow-x-auto no-scrollbar",children:e.map((a,r)=>d.jsxs("div",{className:"flex-1 flex flex-col items-center min-w-[60px] group",children:[d.jsxs("div",{className:"relative w-full flex justify-center gap-1 h-[200px] items-end",children:[d.jsx(va.div,{initial:{height:0},animate:{height:`${a.budgeted/t*100}%`},className:"w-3 sm:w-4 bg-slate-200 rounded-t-sm relative group",children:d.jsxs("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-20",children:["Pres: $",a.budgeted.toLocaleString()]})}),d.jsx(va.div,{initial:{height:0},animate:{height:`${a.executed/t*100}%`},className:`w-3 sm:w-4 rounded-t-sm relative group ${a.executed>a.budgeted?"bg-rose-500":"bg-blue-600"}`,children:d.jsxs("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-20",children:["Ejec: $",a.executed.toLocaleString()]})})]}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 mt-3 truncate w-full text-center uppercase tracking-tighter",children:a.label})]},a.label))}),d.jsxs("div",{className:"absolute left-0 right-0 top-10 h-[200px] border-b border-slate-100 flex flex-col justify-between pointer-events-none",children:[d.jsx("div",{className:"border-t border-slate-50 w-full"}),d.jsx("div",{className:"border-t border-slate-50 w-full"}),d.jsx("div",{className:"border-t border-slate-50 w-full"})]})]})},tj=()=>{const[e,t]=ie.useState("config"),[a,r]=ie.useState(yt(new Date,"yyyy-MM")),[s,l]=ie.useState("All"),[c,u]=ie.useState(()=>{const j=localStorage.getItem("finanzas_budgets");return j?JSON.parse(j):{}}),[h,m]=ie.useState(()=>{const j=localStorage.getItem("finanzas_transactions");return j?JSON.parse(j):[]}),[p,g]=ie.useState(!1),[y,b]=ie.useState({name:"",amount:"",type:"expense"});ie.useEffect(()=>{const j=()=>{m(JSON.parse(localStorage.getItem("finanzas_transactions")||"[]")),u(JSON.parse(localStorage.getItem("finanzas_budgets")||"{}"))};return window.addEventListener("storage",j),()=>window.removeEventListener("storage",j)},[]),ie.useEffect(()=>{if(!c[a]){const j=[...El.income.map(I=>({id:I.id,name:I.name,projected:0,actual:0,type:"income"})),...El.expense.map(I=>({id:I.id,name:I.name,projected:0,actual:0,type:"expense"}))];u(I=>({...I,[a]:j}))}},[a,c]),ie.useEffect(()=>{localStorage.setItem("finanzas_budgets",JSON.stringify(c))},[c]);const _=c[a]||[],w=j=>{if(j.preventDefault(),!y.name||!y.amount)return;const I={id:crypto.randomUUID(),name:y.name,projected:parseFloat(y.amount),type:y.type,actual:0};u(z=>({...z,[a]:[...z[a]||[],I]})),b({name:"",amount:"",type:"expense"}),g(!1)},T=j=>{confirm("Ests seguro de eliminar esta categora?")&&u(I=>({...I,[a]:I[a].filter(z=>z.id!==j)}))},A=()=>{const j=yt(V3(or(`${a}-01`)),"yyyy-MM"),I=c[j];if(!I||I.length===0){alert("No se encontr un presupuesto para el mes anterior.");return}if(_.length>0&&!confirm("Deseas sobreescribir el presupuesto actual con el del mes anterior?"))return;const z=I.map(X=>({...X,id:crypto.randomUUID(),actual:0}));u(X=>({...X,[a]:z}))},k=ie.useMemo(()=>{const j=new Set;return Object.values(c).forEach(I=>{I.filter(z=>z.type==="expense").forEach(z=>j.add(z.name))}),Array.from(j).sort()},[c]),S=ie.useMemo(()=>{const j={},I={};return Object.entries(c).forEach(([z,X])=>{const q=z.substring(0,4);j[z]||(j[z]={budgeted:0,executed:0}),I[q]||(I[q]={budgeted:0,executed:0}),X.forEach(Q=>{Q.type==="expense"&&(s==="All"||Q.name===s)&&(j[z].budgeted+=Q.projected||0,I[q].budgeted+=Q.projected||0)})}),h.forEach(z=>{const X=z.date.substring(0,7),q=z.date.substring(0,4);z.type==="expense"&&(s==="All"||z.category===s)&&(j[X]||(j[X]={budgeted:0,executed:0}),I[q]||(I[q]={budgeted:0,executed:0}),j[X].executed+=z.amount,I[q].executed+=z.amount)}),{monthlyStats:j,yearlyStats:I}},[c,h,s]),L=Object.keys(S.monthlyStats).sort().reverse(),V=L.slice(0,6).reverse().map(j=>({label:yt(or(j+"-01"),"MMM yy",{locale:hn}),budgeted:S.monthlyStats[j].budgeted,executed:S.monthlyStats[j].executed})),P=_.reduce((j,I)=>j+(I.type==="expense"&&I.projected||0),0),N=h.filter(j=>j.date.startsWith(a)&&j.type==="expense").reduce((j,I)=>j+I.amount,0);return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Presupuesto"}),d.jsx("p",{className:"text-slate-500 font-medium tracking-tight",children:"Controla y optimiza tu salud financiera mes a mes."})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsxs("div",{className:"flex gap-1 p-1 bg-slate-100 rounded-2xl",children:[d.jsxs("button",{onClick:()=>t("config"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold transition-all ${e==="config"?"bg-white shadow-sm text-blue-600":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(yy,{size:18}),d.jsx("span",{children:"Configuracin"})]}),d.jsxs("button",{onClick:()=>t("analysis"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold transition-all ${e==="analysis"?"bg-white shadow-sm text-blue-600":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(aA,{size:18}),d.jsx("span",{children:"Anlisis"})]})]}),e==="config"&&d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"month",value:a,onChange:j=>r(j.target.value),className:"input-field w-auto min-w-[150px] font-semibold text-slate-700 bg-white"}),d.jsx("button",{onClick:A,className:"btn-secondary !p-3",title:"Clonar Anterior",children:d.jsx(bA,{size:18})}),d.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[d.jsx(zn,{size:18}),d.jsx("span",{className:"hidden sm:inline",children:"Nueva Categora"})]})]})]})]}),e==="config"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"card border-none shadow-sm bg-gradient-to-br from-blue-600 to-blue-700 text-white group overflow-hidden relative",children:[d.jsx("div",{className:"absolute -right-4 -top-4 w-24 h-24 bg-white/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-700"}),d.jsx("p",{className:"text-blue-100 text-[10px] font-bold uppercase tracking-widest mb-1 relative z-10",children:"Lmite de Gastos"}),d.jsxs("div",{className:"flex items-baseline gap-1 relative z-10",children:[d.jsxs("span",{className:"text-3xl font-black",children:["$",P.toLocaleString()]}),d.jsx("span",{className:"text-[10px] font-bold text-blue-200",children:"MXN"})]})]}),d.jsxs("div",{className:"card border-none shadow-sm bg-white",children:[d.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Gasto Real"}),d.jsxs("div",{className:"flex items-baseline gap-1",children:[d.jsxs("span",{className:"text-3xl font-black text-slate-900",children:["$",N.toLocaleString()]}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"MXN"})]})]}),d.jsxs("div",{className:"card border-none shadow-sm bg-white flex items-center justify-between pr-8",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Disponible"}),d.jsxs("p",{className:`text-2xl font-black ${P-N>=0?"text-emerald-600":"text-rose-600"}`,children:["$",(P-N).toLocaleString()]})]}),d.jsxs("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center font-black text-sm shadow-inner ${P>0?N/P>1?"bg-rose-50 text-rose-600":"bg-emerald-50 text-emerald-600":"bg-slate-50 text-slate-300"}`,children:[P>0?(N/P*100).toFixed(0):0,"%"]})]})]}),d.jsxs("div",{className:"card !p-0 overflow-hidden shadow-xl border-slate-200/40",children:[d.jsxs("div",{className:"px-8 py-5 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between",children:[d.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[d.jsx(yy,{size:18,className:"text-slate-400"})," Catlogo Mensual"]}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:yt(or(a+"-01"),"MMMM yyyy",{locale:hn})})]}),d.jsxs("table",{className:"w-full text-left",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50/30",children:[d.jsx("th",{className:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Tipo / Categora"}),d.jsx("th",{className:"px-8 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Monto Proyectado"}),d.jsx("th",{className:"px-8 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Acciones"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:_.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"3",className:"px-8 py-20 text-center text-slate-400 italic font-medium",children:"No has definido categoras para este periodo."})}):_.map(j=>d.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-all",children:[d.jsx("td",{className:"px-8 py-5",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`w-2 h-2 rounded-full ${j.type==="income"?"bg-emerald-500":"bg-rose-500"}`}),d.jsx("span",{className:"font-bold text-slate-800 group-hover:text-blue-600 transition-colors",children:j.name})]})}),d.jsx("td",{className:"px-8 py-5 text-right",children:d.jsxs("div",{className:"flex items-center justify-end gap-2",children:[d.jsx("span",{className:"text-slate-400 text-xs font-bold",children:"$"}),d.jsx("input",{type:"number",value:j.projected,onChange:I=>{const z=parseFloat(I.target.value)||0;u(X=>({...X,[a]:X[a].map(q=>q.id===j.id?{...q,projected:z}:q)}))},className:"w-24 text-right font-black text-slate-900 bg-transparent border-b-2 border-transparent hover:border-slate-200 focus:border-blue-500 focus:outline-none transition-all py-1 px-2"})]})}),d.jsx("td",{className:"px-8 py-5 text-right",children:d.jsx("button",{onClick:()=>T(j.id),className:"p-2.5 text-slate-300 hover:text-rose-600 hover:bg-rose-50 rounded-xl transition-all opacity-0 group-hover:opacity-100 shadow-sm border border-transparent hover:border-rose-100",children:d.jsx(jr,{size:18})})})]},j.id))})]})]})]}):d.jsx("div",{className:"space-y-8 animate-in slide-in-from-bottom-6 duration-700",children:d.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[d.jsxs("div",{className:"lg:w-80 space-y-6",children:[d.jsxs("div",{className:"card border-none shadow-xl shadow-slate-200/50 bg-white",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-6 border-b border-slate-50 pb-4",children:[d.jsx(EA,{size:18,className:"text-blue-600"}),d.jsx("h4",{className:"font-black text-slate-900 text-sm italic uppercase tracking-wider",children:"Filtro Inteligente"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Filtrar por Categora"}),d.jsxs("select",{value:s,onChange:j=>l(j.target.value),className:"input-field w-full font-bold text-sm bg-slate-50 border-slate-100",children:[d.jsx("option",{value:"All",children:"Todas las de Gastos"}),k.map(j=>d.jsx("option",{value:j,children:j},j))]}),d.jsxs("div",{className:"p-4 bg-blue-50/50 rounded-2xl border border-blue-100 flex items-start gap-3",children:[d.jsx(fn,{size:16,className:"text-blue-600 mt-1 shrink-0"}),d.jsx("p",{className:"text-xs text-blue-900 font-medium leading-relaxed",children:"Analiza la tendencia de tus gastos en los ltimos 6 meses para tomar mejores decisiones."})]})]})]}),d.jsxs("div",{className:"card bg-slate-900 text-white border-none shadow-lg",children:[d.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-4",children:"Ahorro Promedio Mensual"}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h4",{className:"text-3xl font-black text-emerald-400",children:["+",(Object.values(S.monthlyStats).reduce((j,I)=>j+(I.budgeted-I.executed),0)/Math.max(1,Object.keys(S.monthlyStats).length)).toLocaleString(void 0,{maximumFractionDigits:0})]}),d.jsx(gy,{className:"text-emerald-500",size:32})]})]})]}),d.jsxs("div",{className:"flex-1 space-y-8",children:[d.jsxs("div",{className:"card border-none shadow-xl shadow-slate-200/50 bg-white",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsxs("h4",{className:"font-black text-slate-900 text-lg uppercase tracking-tight italic flex items-center gap-2",children:[d.jsx(fn,{size:20,className:"text-blue-600"})," Comparativa vs Presupuesto"]}),d.jsxs("div",{className:"flex items-center gap-4 text-[10px] font-bold uppercase tracking-widest",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-slate-200 rounded-sm"})," ",d.jsx("span",{children:"Presupuesto"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-sm"})," ",d.jsx("span",{children:"Real"})]})]})]}),d.jsx(ej,{data:V})]}),d.jsxs("div",{className:"card !p-0 overflow-hidden shadow-xl border-slate-200/20 bg-white/80 backdrop-blur-md",children:[d.jsxs("div",{className:"px-8 py-5 border-b border-slate-50 flex items-center gap-3",children:[d.jsx(lc,{size:18,className:"text-slate-400"}),d.jsx("h4",{className:"font-black text-slate-800 tracking-tight italic uppercase text-sm",children:"Desglose de Ejecucin Mensual"})]}),d.jsxs("table",{className:"w-full text-left",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50/50",children:[d.jsx("th",{className:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Mes"}),d.jsx("th",{className:"px-8 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Presupuesto"}),d.jsx("th",{className:"px-8 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Real"}),d.jsx("th",{className:"px-8 py-4 text-right text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Ahorro / Variacin"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:L.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"4",className:"px-8 py-10 text-center text-slate-400 italic",children:"No hay historial disponible."})}):L.slice(0,12).map(j=>{const I=S.monthlyStats[j],z=I.budgeted-I.executed;return d.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors",children:[d.jsx("td",{className:"px-8 py-5 font-black text-slate-800 capitalize italic",children:yt(or(j+"-01"),"MMMM yyyy",{locale:hn})}),d.jsxs("td",{className:"px-8 py-5 text-right font-bold text-slate-500",children:["$",I.budgeted.toLocaleString()]}),d.jsxs("td",{className:"px-8 py-5 text-right font-black text-slate-900",children:["$",I.executed.toLocaleString()]}),d.jsx("td",{className:`px-8 py-5 text-right font-black ${z>=0?"text-emerald-500":"text-rose-500"}`,children:d.jsxs("div",{className:"flex items-center justify-end gap-1",children:[z>=0?d.jsx(z4,{size:14}):d.jsx(gy,{size:14}),"$",Math.abs(z).toLocaleString()]})})]},j)})})]})]})]})]})}),d.jsx(pc,{children:p&&d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx(va.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md",onClick:()=>g(!1)}),d.jsxs(va.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden border border-slate-100",children:[d.jsxs("div",{className:"px-10 py-8 border-b border-slate-100 flex items-center justify-between",children:[d.jsx("h3",{className:"text-2xl font-black text-slate-900 italic tracking-tight",children:"Nueva Categora"}),d.jsx("button",{onClick:()=>g(!1),className:"p-3 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-2xl transition-all",children:d.jsx(Qr,{size:24})})]}),d.jsxs("form",{onSubmit:w,className:"p-10 space-y-8",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx("button",{type:"button",onClick:()=>b({...y,type:"income"}),className:`py-4 rounded-2xl font-black text-sm uppercase tracking-widest transition-all border-2 ${y.type==="income"?"bg-emerald-500 text-white border-emerald-500 shadow-lg shadow-emerald-200":"bg-slate-50 text-slate-400 border-transparent hover:bg-slate-100"}`,children:"Ingreso"}),d.jsx("button",{type:"button",onClick:()=>b({...y,type:"expense"}),className:`py-4 rounded-2xl font-black text-sm uppercase tracking-widest transition-all border-2 ${y.type==="expense"?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-200":"bg-slate-50 text-slate-400 border-transparent hover:bg-slate-100"}`,children:"Gasto"})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest ml-1",children:"Descripcin"}),d.jsx("input",{type:"text",autoFocus:!0,required:!0,placeholder:"Ej: Supermercado, Renta...",className:"input-field !text-lg !font-bold",value:y.name,onChange:j=>b({...y,name:j.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest ml-1",children:"Meta Mensual ($)"}),d.jsx("input",{type:"number",required:!0,placeholder:"0.00",className:"input-field !text-3xl !font-black !py-4",value:y.amount,onChange:j=>b({...y,amount:j.target.value})})]})]}),d.jsxs("div",{className:"flex gap-4 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 py-4 text-slate-500 font-bold hover:bg-slate-50 rounded-2xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-4 !text-base shadow-xl shadow-blue-200",children:"Guardar"})]})]})]})]})})]})};function lf(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]]);return a}function aj(e,t,a,r){function s(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{m(r.next(p))}catch(g){c(g)}}function h(p){try{m(r.throw(p))}catch(g){c(g)}}function m(p){p.done?l(p.value):s(p.value).then(u,h)}m((r=r.apply(e,t||[])).next())})}const rj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Hp extends Error{constructor(t,a="FunctionsError",r){super(t),this.name=a,this.context=r}}class nj extends Hp{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class W2 extends Hp{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Y2 extends Hp{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Bm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Bm||(Bm={}));class sj{constructor(t,{headers:a={},customFetch:r,region:s=Bm.Any}={}){this.url=t,this.headers=a,this.region=s,this.fetch=rj(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return aj(this,arguments,void 0,function*(a,r={}){var s;let l,c;try{const{headers:u,method:h,body:m,signal:p,timeout:g}=r;let y={},{region:b}=r;b||(b=this.region);const _=new URL(`${this.url}/${a}`);b&&b!=="any"&&(y["x-region"]=b,_.searchParams.set("forceFunctionRegion",b));let w;m&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",w=m):typeof m=="string"?(y["Content-Type"]="text/plain",w=m):typeof FormData<"u"&&m instanceof FormData?w=m:(y["Content-Type"]="application/json",w=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?w=JSON.stringify(m):w=m;let T=p;g&&(c=new AbortController,l=setTimeout(()=>c.abort(),g),p?(T=c.signal,p.addEventListener("abort",()=>c.abort())):T=c.signal);const A=yield this.fetch(_.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:w,signal:T}).catch(V=>{throw new nj(V)}),k=A.headers.get("x-relay-error");if(k&&k==="true")throw new W2(A);if(!A.ok)throw new Y2(A);let S=((s=A.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),L;return S==="application/json"?L=yield A.json():S==="application/octet-stream"||S==="application/pdf"?L=yield A.blob():S==="text/event-stream"?L=A:S==="multipart/form-data"?L=yield A.formData():L=yield A.text(),{data:L,error:null,response:A}}catch(u){return{data:null,error:u,response:u instanceof Y2||u instanceof W2?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var ij=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},lj=class{constructor(e){var t,a;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(a=e.isMaybeSingle)!==null&&a!==void 0?a:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var a=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,u=null,h=null,m=l.status,p=l.statusText;if(l.ok){var g,y;if(a.method!=="HEAD"){var b;const A=await l.text();A===""||(a.headers.get("Accept")==="text/csv"||a.headers.get("Accept")&&(!((b=a.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?u=A:u=JSON.parse(A))}const w=(g=a.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),T=(y=l.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");w&&T&&T.length>1&&(h=parseInt(T[1])),a.isMaybeSingle&&a.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var _;const w=await l.text();try{c=JSON.parse(w),Array.isArray(c)&&l.status===404&&(u=[],c=null,m=200,p="OK")}catch{l.status===404&&w===""?(m=204,p="No Content"):c={message:w}}if(c&&a.isMaybeSingle&&(!(c==null||(_=c.details)===null||_===void 0)&&_.includes("0 rows"))&&(c=null,m=200,p="OK"),c&&a.shouldThrowOnError)throw new ij(c)}return{error:c,data:u,count:h,status:m,statusText:p}});return this.shouldThrowOnError||(s=s.catch(l=>{var c;let u="";const h=l?.cause;if(h){var m,p,g,y;const _=(m=h?.message)!==null&&m!==void 0?m:"",w=(p=h?.code)!==null&&p!==void 0?p:"";u=`${(g=l?.name)!==null&&g!==void 0?g:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(y=h?.name)!==null&&y!==void 0?y:"Error"}: ${_}`,w&&(u+=` (${w})`),h?.stack&&(u+=`
${h.stack}`)}else{var b;u=(b=l?.stack)!==null&&b!==void 0?b:""}return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},oj=class extends lj{select(e){let t=!1;const a=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:a,foreignTable:r,referencedTable:s=r}={}){const l=s?`${s}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${e}.${t?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:a=t}={}){const r=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:a,referencedTable:r=a}={}){const s=typeof r>"u"?"offset":`${r}.offset`,l=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:a=!1,buffers:r=!1,wal:s=!1,format:l="text"}={}){var c;const u=[e?"analyze":null,t?"verbose":null,a?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const X2=new RegExp("[,()]");var gl=class extends oj{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const a=Array.from(new Set(t)).map(r=>typeof r=="string"&&X2.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${a})`),this}notIn(e,t){const a=Array.from(new Set(t)).map(r=>typeof r=="string"&&X2.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`not.in.(${a})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:a,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const l=a===void 0?"":`(${a})`;return this.url.searchParams.append(e,`${s}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,a])=>{this.url.searchParams.append(t,`eq.${a}`)}),this}not(e,t,a){return this.url.searchParams.append(e,`not.${t}.${a}`),this}or(e,{foreignTable:t,referencedTable:a=t}={}){const r=a?`${a}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,a){return this.url.searchParams.append(e,`${t}.${a}`),this}},cj=class{constructor(e,{headers:t={},schema:a,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=a,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:a=!1,count:r}=t??{},s=a?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join(""),{url:u,headers:h}=this.cloneRequestState();return u.searchParams.set("select",c),r&&h.append("Prefer",`count=${r}`),new gl({method:s,url:u,headers:h,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:a=!0}={}){var r;const s="POST",{url:l,headers:c}=this.cloneRequestState();if(t&&c.append("Prefer",`count=${t}`),a||c.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(u.length>0){const h=[...new Set(u)].map(m=>`"${m}"`);l.searchParams.set("columns",h.join(","))}}return new gl({method:s,url:l,headers:c,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:a=!1,count:r,defaultToNull:s=!0}={}){var l;const c="POST",{url:u,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),t!==void 0&&u.searchParams.set("on_conflict",t),r&&h.append("Prefer",`count=${r}`),s||h.append("Prefer","missing=default"),Array.isArray(e)){const m=e.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(m.length>0){const p=[...new Set(m)].map(g=>`"${g}"`);u.searchParams.set("columns",p.join(","))}}return new gl({method:c,url:u,headers:h,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var a;const r="PATCH",{url:s,headers:l}=this.cloneRequestState();return t&&l.append("Prefer",`count=${t}`),new gl({method:r,url:s,headers:l,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:e}={}){var t;const a="DELETE",{url:r,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new gl({method:a,url:r,headers:s,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},uj=class gT{constructor(t,{headers:a={},schema:r,fetch:s}={}){this.url=t,this.headers=new Headers(a),this.schemaName=r,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new cj(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new gT(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,a={},{head:r=!1,get:s=!1,count:l}={}){var c;let u;const h=new URL(`${this.url}/rpc/${t}`);let m;const p=b=>b!==null&&typeof b=="object"&&(!Array.isArray(b)||b.some(p)),g=r&&Object.values(a).some(p);g?(u="POST",m=a):r||s?(u=r?"HEAD":"GET",Object.entries(a).filter(([b,_])=>_!==void 0).map(([b,_])=>[b,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([b,_])=>{h.searchParams.append(b,_)})):(u="POST",m=a);const y=new Headers(this.headers);return g?y.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&y.set("Prefer",`count=${l}`),new gl({method:u,url:h,headers:y,schema:this.schemaName,body:m,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class fj{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const a=globalThis.process;if(a){const r=a.versions;if(r&&r.node){const s=r.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let a=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(a+=`

Suggested solution: ${t.workaround}`),new Error(a)}static createWebSocket(t,a){const r=this.getWebSocketConstructor();return new r(t,a)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const hj="2.90.1",dj=`realtime-js/${hj}`,vT="1.0.0",mj="2.0.0",K2=vT,Um=1e4,pj=1e3,xj=100;var ws;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ws||(ws={}));var ra;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ra||(ra={}));var Wr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Wr||(Wr={}));var zm;(function(e){e.websocket="websocket"})(zm||(zm={}));var li;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(li||(li={}));class gj{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,a){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return a(this._binaryEncodeUserBroadcastPush(t));let r=[t.join_ref,t.ref,t.topic,t.event,t.payload];return a(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(t){var a;return this._isArrayBuffer((a=t.payload)===null||a===void 0?void 0:a.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var a,r;const s=(r=(a=t.payload)===null||a===void 0?void 0:a.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var a,r;const s=(r=(a=t.payload)===null||a===void 0?void 0:a.payload)!==null&&r!==void 0?r:{},c=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,a,r){var s,l;const c=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",m=t.payload.event,p=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+c.length+m.length+g.length,b=new ArrayBuffer(this.HEADER_LENGTH+y);let _=new DataView(b),w=0;_.setUint8(w++,this.KINDS.userBroadcastPush),_.setUint8(w++,h.length),_.setUint8(w++,u.length),_.setUint8(w++,c.length),_.setUint8(w++,m.length),_.setUint8(w++,g.length),_.setUint8(w++,a),Array.from(h,A=>_.setUint8(w++,A.charCodeAt(0))),Array.from(u,A=>_.setUint8(w++,A.charCodeAt(0))),Array.from(c,A=>_.setUint8(w++,A.charCodeAt(0))),Array.from(m,A=>_.setUint8(w++,A.charCodeAt(0))),Array.from(g,A=>_.setUint8(w++,A.charCodeAt(0)));var T=new Uint8Array(b.byteLength+r.byteLength);return T.set(new Uint8Array(b),0),T.set(new Uint8Array(r),b.byteLength),T.buffer}decode(t,a){if(this._isArrayBuffer(t)){let r=this._binaryDecode(t);return a(r)}if(typeof t=="string"){const r=JSON.parse(t),[s,l,c,u,h]=r;return a({join_ref:s,ref:l,topic:c,event:u,payload:h})}return a({})}_binaryDecode(t){const a=new DataView(t),r=a.getUint8(0),s=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,a,s)}_decodeUserBroadcast(t,a,r){const s=a.getUint8(1),l=a.getUint8(2),c=a.getUint8(3),u=a.getUint8(4);let h=this.HEADER_LENGTH+4;const m=r.decode(t.slice(h,h+s));h=h+s;const p=r.decode(t.slice(h,h+l));h=h+l;const g=r.decode(t.slice(h,h+c));h=h+c;const y=t.slice(h,t.byteLength),b=u===this.JSON_ENCODING?JSON.parse(r.decode(y)):y,_={type:this.BROADCAST_EVENT,event:p,payload:b};return c>0&&(_.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:_}}_isArrayBuffer(t){var a;return t instanceof ArrayBuffer||((a=t?.constructor)===null||a===void 0?void 0:a.name)==="ArrayBuffer"}_pick(t,a){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([r])=>a.includes(r)))}}class yT{constructor(t,a){this.callback=t,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(_t||(_t={}));const J2=(e,t,a={})=>{var r;const s=(r=a.skipTypes)!==null&&r!==void 0?r:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=vj(c,e,t,s),l),{}):{}},vj=(e,t,a,r)=>{const s=t.find(u=>u.name===e),l=s?.type,c=a[e];return l&&!r.includes(l)?bT(l,c):Vm(c)},bT=(e,t)=>{if(e.charAt(0)==="_"){const a=e.slice(1,e.length);return _j(t,a)}switch(e){case _t.bool:return yj(t);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return bj(t);case _t.json:case _t.jsonb:return wj(t);case _t.timestamp:return Tj(t);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return Vm(t);default:return Vm(t)}},Vm=e=>e,yj=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},bj=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},wj=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},_j=(e,t)=>{if(typeof e!="string")return e;const a=e.length-1,r=e[a];if(e[0]==="{"&&r==="}"){let l;const c=e.slice(1,a);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>bT(t,u))}return e},Tj=e=>typeof e=="string"?e.replace(" ","T"):e,wT=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Yd{constructor(t,a,r={},s=Um){this.channel=t,this.event=a,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,a){var r;return this._hasReceived(t)&&a((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:a}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(a))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Q2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Q2||(Q2={}));class Ko{constructor(t,a){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=a?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ko.syncState(this.state,s,l,c),this.pendingDiffs.forEach(h=>{this.state=Ko.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(r.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ko.syncDiff(this.state,s,l,c),u())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,a,r,s){const l=this.cloneDeep(t),c=this.transformState(a),u={},h={};return this.map(l,(m,p)=>{c[m]||(h[m]=p)}),this.map(c,(m,p)=>{const g=l[m];if(g){const y=p.map(T=>T.presence_ref),b=g.map(T=>T.presence_ref),_=p.filter(T=>b.indexOf(T.presence_ref)<0),w=g.filter(T=>y.indexOf(T.presence_ref)<0);_.length>0&&(u[m]=_),w.length>0&&(h[m]=w)}else u[m]=p}),this.syncDiff(l,{joins:u,leaves:h},r,s)}static syncDiff(t,a,r,s){const{joins:l,leaves:c}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var m;const p=(m=t[u])!==null&&m!==void 0?m:[];if(t[u]=this.cloneDeep(h),p.length>0){const g=t[u].map(b=>b.presence_ref),y=p.filter(b=>g.indexOf(b.presence_ref)<0);t[u].unshift(...y)}r(u,p,h)}),this.map(c,(u,h)=>{let m=t[u];if(!m)return;const p=h.map(g=>g.presence_ref);m=m.filter(g=>p.indexOf(g.presence_ref)<0),t[u]=m,s(u,m,h),m.length===0&&delete t[u]}),t}static map(t,a){return Object.getOwnPropertyNames(t).map(r=>a(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((a,r)=>{const s=t[r];return"metas"in s?a[r]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):a[r]=s,a},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Z2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Z2||(Z2={}));var Jo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Jo||(Jo={}));var Ln;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ln||(Ln={}));class kl{constructor(t,a={config:{}},r){var s,l;if(this.topic=t,this.params=a,this.socket=r,this.bindings={},this.state=ra.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new Yd(this,Wr.join,this.params,this.timeout),this.rejoinTimer=new yT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ra.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ra.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Wr.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new Ko(this),this.broadcastEndpointURL=wT(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,a=this.timeout){var r,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==ra.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,m=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(b=>b.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[Jo.PRESENCE]&&this.bindings[Jo.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},y={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:m,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(Ln.CHANNEL_ERROR,b)),this._onClose(()=>t?.(Ln.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:b})=>{var _;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t?.(Ln.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,T=(_=w?.length)!==null&&_!==void 0?_:0,A=[];for(let k=0;k<T;k++){const S=w[k],{filter:{event:L,schema:V,table:P,filter:N}}=S,j=b&&b[k];if(j&&j.event===L&&kl.isFilterValueEqual(j.schema,V)&&kl.isFilterValueEqual(j.table,P)&&kl.isFilterValueEqual(j.filter,N))A.push(Object.assign(Object.assign({},S),{id:j.id}));else{this.unsubscribe(),this.state=ra.errored,t?.(Ln.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,t&&t(Ln.SUBSCRIBED);return}}).receive("error",b=>{this.state=ra.errored,t?.(Ln.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ln.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,a={}){return await this.send({type:"presence",event:"track",payload:t},a.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,a,r){return this.state===ra.joined&&t===Jo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,a,r)}async httpSend(t,a,r={}){var s;if(a==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:a,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const m=await u.json();h=m.error||m.message||h}catch{}return Promise.reject(new Error(h))}async send(t,a={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=m.body)===null||s===void 0?void 0:s.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const m=this._push(t.type,t,a.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ra.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Wr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Yd(this,Wr.leave,{},t),r.receive("ok",()=>{a(),s("ok")}).receive("timeout",()=>{a(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ra.closed,this.bindings={}}async _fetchWithTimeout(t,a,r){const s=new AbortController,l=setTimeout(()=>s.abort(),r),c=await this.socket.fetch(t,Object.assign(Object.assign({},a),{signal:s.signal}));return clearTimeout(l),c}_push(t,a,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Yd(this,t,a,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>xj){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(t,a,r){return a}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,a,r){var s,l;const c=t.toLocaleLowerCase(),{close:u,error:h,leave:m,join:p}=Wr;if(r&&[u,h,m,p].indexOf(c)>=0&&r!==this._joinRef())return;let y=this._onMessage(c,a,r);if(a&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(b=>{var _,w,T;return((_=b.filter)===null||_===void 0?void 0:_.event)==="*"||((T=(w=b.filter)===null||w===void 0?void 0:w.event)===null||T===void 0?void 0:T.toLocaleLowerCase())===c}).map(b=>b.callback(y,r)):(l=this.bindings[c])===null||l===void 0||l.filter(b=>{var _,w,T,A,k,S,L,V;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const P=b.id,N=(_=b.filter)===null||_===void 0?void 0:_.event;return P&&((w=a.ids)===null||w===void 0?void 0:w.includes(P))&&(N==="*"||N?.toLocaleLowerCase()===((T=a.data)===null||T===void 0?void 0:T.type.toLocaleLowerCase()))&&(!(!((A=b.filter)===null||A===void 0)&&A.table)||b.filter.table===((k=a.data)===null||k===void 0?void 0:k.table))}else{const P=(L=(S=b?.filter)===null||S===void 0?void 0:S.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return P==="*"||P===((V=a?.event)===null||V===void 0?void 0:V.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof y=="object"&&"ids"in y){const _=y.data,{schema:w,table:T,commit_timestamp:A,type:k,errors:S}=_;y=Object.assign(Object.assign({},{schema:w,table:T,commit_timestamp:A,eventType:k,new:{},old:{},errors:S}),this._getPayloadRecords(_))}b.callback(y,r)})}_isClosed(){return this.state===ra.closed}_isJoined(){return this.state===ra.joined}_isJoining(){return this.state===ra.joining}_isLeaving(){return this.state===ra.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,a,r){const s=t.toLocaleLowerCase(),l={type:s,filter:a,callback:r};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,a){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&kl.isEqual(s.filter,a))})),this}static isEqual(t,a){if(Object.keys(t).length!==Object.keys(a).length)return!1;for(const r in t)if(t[r]!==a[r])return!1;return!0}static isFilterValueEqual(t,a){return(t??void 0)===(a??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Wr.close,{},t)}_onError(t){this._on(Wr.error,{},a=>t(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ra.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const a={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(a.new=J2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(a.old=J2(t.columns,t.old_record)),a}}const Xd=()=>{},u0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Sj=[1e3,2e3,5e3,1e4],Ej=1e4,kj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Aj{constructor(t,a){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Um,this.transport=null,this.heartbeatIntervalMs=u0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xd,this.ref=0,this.reconnectTimer=null,this.vsn=K2,this.logger=Xd,this.conn=null,this.sendBuffer=[],this.serializer=new gj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((r=a?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${t}/${zm.websocket}`,this.httpEndpoint=wT(t),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=fj.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const a=t.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,a??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const a=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const t=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,a,r){this.logger(t,a,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ws.connecting:return li.Connecting;case ws.open:return li.Open;case ws.closing:return li.Closing;default:return li.Closed}}isConnected(){return this.connectionState()===li.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,a={config:{}}){const r=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===r);if(s)return s;{const l=new kl(`realtime:${t}`,a,this);return this.channels.push(l),l}}push(t){const{topic:a,event:r,payload:s,ref:l}=t,c=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${a} ${r} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(pj,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},u0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let a=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${t}"`),a.unsubscribe())}_remove(t){this.channels=this.channels.filter(a=>a.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply"&&a.ref&&a.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error",m)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:s,payload:l,ref:c}=a,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${r} ${s} ${u}`.trim(),l),this.channels.filter(m=>m._isMember(r)).forEach(m=>m._trigger(s,l,c)),this._triggerStateCallbacks("message",a)})}_clearTimer(t){var a;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ws.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ws.open||this.conn.readyState===ws.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this._terminateWorker()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var a;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Wr.error))}_appendParams(t,a){if(Object.keys(a).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(a);return`${t}${r}${s}`}_workerObjectUrl(t){let a;if(t)a=t;else{const r=new Blob([kj],{type:"application/javascript"});a=URL.createObjectURL(r)}return a}_setConnectionState(t,a=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(t=null){let a,r=!1;if(t)a=t,r=!0;else if(this.accessToken)try{a=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),a=this.accessTokenValue}else a=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(s=>{const l={access_token:a,version:dj};a&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(Wr.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(a=>{this.log("error",`Error setting auth in ${t}`,a)})}_triggerStateCallbacks(t,a){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(a)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new yT(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},u0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var a,r,s,l,c,u,h,m,p,g,y,b;switch(this.transport=(a=t?.transport)!==null&&a!==void 0?a:null,this.timeout=(r=t?.timeout)!==null&&r!==void 0?r:Um,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:u0.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Xd,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:K2,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=t?.reconnectAfterMs)!==null&&m!==void 0?m:(_=>Sj[_-1]||Ej),this.vsn){case vT:this.encode=(p=t?.encode)!==null&&p!==void 0?p:((_,w)=>w(JSON.stringify(_))),this.decode=(g=t?.decode)!==null&&g!==void 0?g:((_,w)=>w(JSON.parse(_)));break;case mj:this.encode=(y=t?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(b=t?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var xc=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Nj(e,t,a){const r=new URL(t,e);if(a)for(const[s,l]of Object.entries(a))l!==void 0&&r.searchParams.set(s,l);return r.toString()}async function Cj(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Oj(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:a,path:r,query:s,body:l,headers:c}){const u=Nj(e.baseUrl,r,s),h=await Cj(e.auth),m=await t(u,{method:a,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),p=await m.text(),g=(m.headers.get("content-type")||"").includes("application/json"),y=g&&p?JSON.parse(p):p;if(!m.ok){const b=g?y:void 0,_=b?.error;throw new xc(_?.message??`Request failed with status ${m.status}`,{status:m.status,icebergType:_?.type,icebergCode:_?.code,details:b})}return{status:m.status,headers:m.headers,data:y}}}}function f0(e){return e.join("")}var Dj=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:f0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(e,t){const a={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:a})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${f0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${f0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${f0(e.namespace)}`}),!0}catch(t){if(t instanceof xc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(a){if(a instanceof xc&&a.status===409)return;throw a}}};function ul(e){return e.join("")}var jj=class{constructor(e,t="",a){this.client=e,this.prefix=t,this.accessDelegation=a}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const a={};return this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables`,body:t,headers:a})).data.metadata}async updateTable(e,t){const a=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":a.data["metadata-location"],metadata:a.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ul(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(a){if(a instanceof xc&&a.status===404)return!1;throw a}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(a){if(a instanceof xc&&a.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw a}}},Rj=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const a=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Oj({baseUrl:a,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new Dj(this.client,t),this.tableOps=new jj(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},of=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Mt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Mj=class extends of{constructor(e,t,a){super(e),this.name="StorageApiError",this.status=t,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Hm=class extends of{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const $p=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Fj=()=>Response,$m=e=>{if(Array.isArray(e))return e.map(a=>$m(a));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([a,r])=>{const s=a.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=$m(r)}),t},Lj=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Pj=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function gc(e){"@babel/helpers - typeof";return gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gc(e)}function Ij(e,t){if(gc(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(gc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bj(e){var t=Ij(e,"string");return gc(t)=="symbol"?t:t+""}function Uj(e,t,a){return(t=Bj(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eb(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function ze(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?eb(Object(a),!0).forEach(function(r){Uj(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}const Kd=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},zj=async(e,t,a)=>{e instanceof await Fj()&&!a?.noResolveJson?e.json().then(r=>{const s=e.status||500,l=r?.statusCode||s+"";t(new Mj(Kd(r),s,l))}).catch(r=>{t(new Hm(Kd(r),r))}):t(new Hm(Kd(e),e))},Vj=(e,t,a,r)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!r?s:(Lj(r)?(s.headers=ze({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(r)):s.body=r,t?.duplex&&(s.duplex=t.duplex),ze(ze({},s),a))};async function Fc(e,t,a,r,s,l){return new Promise((c,u)=>{e(a,Vj(t,r,s,l)).then(h=>{if(!h.ok)throw h;return r?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>zj(h,u,r))})}async function vc(e,t,a,r){return Fc(e,"GET",t,a,r)}async function qr(e,t,a,r,s){return Fc(e,"POST",t,r,s,a)}async function Gm(e,t,a,r,s){return Fc(e,"PUT",t,r,s,a)}async function Hj(e,t,a,r){return Fc(e,"HEAD",t,ze(ze({},a),{},{noResolveJson:!0}),r)}async function Gp(e,t,a,r,s){return Fc(e,"DELETE",t,r,s,a)}var $j=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}};let _T;_T=Symbol.toStringTag;var Gj=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[_T]="BlobDownloadBuilder",this.promise=null}asStream(){return new $j(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}};const qj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Wj=class{constructor(e,t={},a,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=a,this.fetch=$p(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,a,r){var s=this;try{let l;const c=ze(ze({},tb),r);let u=ze(ze({},s.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=a,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),r?.headers&&(u=ze(ze({},u),r.headers));const m=s._removeEmptyFolders(t),p=s._getFinalPath(m),g=await(e=="PUT"?Gm:qr)(s.fetch,`${s.url}/object/${p}`,l,ze({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Mt(l))return{data:null,error:l};throw l}}async upload(e,t,a){return this.uploadOrUpdate("POST",e,t,a)}async uploadToSignedUrl(e,t,a,r){var s=this;const l=s._removeEmptyFolders(e),c=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let h;const m=ze({upsert:tb.upsert},r),p=ze(ze({},s.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&a instanceof Blob?(h=new FormData,h.append("cacheControl",m.cacheControl),h.append("",a)):typeof FormData<"u"&&a instanceof FormData?(h=a,h.append("cacheControl",m.cacheControl)):(h=a,p["cache-control"]=`max-age=${m.cacheControl}`,p["content-type"]=m.contentType),{data:{path:l,fullPath:(await Gm(s.fetch,u.toString(),h,{headers:p})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(Mt(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var a=this;try{let r=a._getFinalPath(e);const s=ze({},a.headers);t?.upsert&&(s["x-upsert"]="true");const l=await qr(a.fetch,`${a.url}/object/upload/sign/${r}`,{},{headers:s}),c=new URL(a.url+l.url),u=c.searchParams.get("token");if(!u)throw new of("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}}async update(e,t,a){return this.uploadOrUpdate("PUT",e,t,a)}async move(e,t,a){var r=this;try{return{data:await qr(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:a?.destinationBucket},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}}async copy(e,t,a){var r=this;try{return{data:{path:(await qr(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:a?.destinationBucket},{headers:r.headers})).Key},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,a){var r=this;try{let s=r._getFinalPath(e),l=await qr(r.fetch,`${r.url}/object/sign/${s}`,ze({expiresIn:t},a?.transform?{transform:a.transform}:{}),{headers:r.headers});const c=a?.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${r.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,a){var r=this;try{const s=await qr(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:t,paths:e},{headers:r.headers}),l=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:s.map(c=>ze(ze({},c),{},{signedUrl:c.signedURL?encodeURI(`${r.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}}download(e,t){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(t?.transform||{}),s=r?`?${r}`:"",l=this._getFinalPath(e),c=()=>vc(this.fetch,`${this.url}/${a}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new Gj(c,this.shouldThrowOnError)}async info(e){var t=this;const a=t._getFinalPath(e);try{return{data:$m(await vc(t.fetch,`${t.url}/object/info/${a}`,{headers:t.headers})),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}}async exists(e){var t=this;const a=t._getFinalPath(e);try{return await Hj(t.fetch,`${t.url}/object/${a}`,{headers:t.headers}),{data:!0,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Mt(r)&&r instanceof Hm){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}}getPublicUrl(e,t){const a=this._getFinalPath(e),r=[],s=t?.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&r.push(s);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&r.push(c);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${a}${u}`)}}}async remove(e){var t=this;try{return{data:await Gp(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async list(e,t,a){var r=this;try{const s=ze(ze(ze({},qj),t),{},{prefix:e||""});return{data:await qr(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},a),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}}async listV2(e,t){var a=this;try{const r=ze({},e);return{data:await qr(a.fetch,`${a.url}/object/list-v2/${a.bucketId}`,r,{headers:a.headers},t),error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const TT="2.90.1",ST={"X-Client-Info":`storage-js/${TT}`};var Yj=class{constructor(e,t={},a,r){this.shouldThrowOnError=!1;const s=new URL(e);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=ze(ze({},ST),t),this.fetch=$p(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const a=t.listBucketOptionsToQueryString(e);return{data:await vc(t.fetch,`${t.url}/bucket${a}`,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async getBucket(e){var t=this;try{return{data:await vc(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async createBucket(e,t={public:!1}){var a=this;try{return{data:await qr(a.fetch,`${a.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:a.headers}),error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}}async updateBucket(e,t){var a=this;try{return{data:await Gm(a.fetch,`${a.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:a.headers}),error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}}async emptyBucket(e){var t=this;try{return{data:await qr(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async deleteBucket(e){var t=this;try{return{data:await Gp(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Xj=class{constructor(e,t={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ze(ze({},ST),t),this.fetch=$p(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await qr(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async listBuckets(e){var t=this;try{const a=new URLSearchParams;e?.limit!==void 0&&a.set("limit",e.limit.toString()),e?.offset!==void 0&&a.set("offset",e.offset.toString()),e?.sortColumn&&a.set("sortColumn",e.sortColumn),e?.sortOrder&&a.set("sortOrder",e.sortOrder),e?.search&&a.set("search",e.search);const r=a.toString(),s=r?`${t.url}/bucket?${r}`:`${t.url}/bucket`;return{data:await vc(t.fetch,s,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async deleteBucket(e){var t=this;try{return{data:await Gp(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}from(e){var t=this;if(!Pj(e))throw new of("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const a=new Rj({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(a,{get(s,l){const c=s[l];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(s,u),error:null}}catch(h){if(r)throw h;return{data:null,error:h}}}}})}};const qp={"X-Client-Info":`storage-js/${TT}`,"Content-Type":"application/json"};var ET=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function cr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Jd=class extends ET{constructor(e,t,a){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Kj=class extends ET{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Wp=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Jj=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ab=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qj=async(e,t,a)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!a?.noResolveJson){const r=e.status||500,s=e;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||r+"";t(new Jd(ab(l),r,c))}).catch(()=>{const l=r+"";t(new Jd(s.statusText||`HTTP ${r} error`,r,l))});else{const l=r+"";t(new Jd(s.statusText||`HTTP ${r} error`,r,l))}}else t(new Kj(ab(e),e))},Zj=(e,t,a,r)=>{const s={method:e,headers:t?.headers||{}};return r?(Jj(r)?(s.headers=ze({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(r)):s.body=r,ze(ze({},s),a)):s};async function e8(e,t,a,r,s,l){return new Promise((c,u)=>{e(a,Zj(t,r,s,l)).then(h=>{if(!h.ok)throw h;if(r?.noResolveJson)return h;const m=h.headers.get("content-type");return!m||!m.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>Qj(h,u,r))})}async function ur(e,t,a,r,s){return e8(e,"POST",t,r,s,a)}var t8=class{constructor(e,t={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ze(ze({},qp),t),this.fetch=Wp(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async getIndex(e,t){var a=this;try{return{data:await ur(a.fetch,`${a.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:a.headers}),error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}}async listIndexes(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async deleteIndex(e,t){var a=this;try{return{data:await ur(a.fetch,`${a.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:a.headers})||{},error:null}}catch(r){if(a.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}}},a8=class{constructor(e,t={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ze(ze({},qp),t),this.fetch=Wp(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ur(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async getVectors(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await ur(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async queryVectors(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ur(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}},r8=class{constructor(e,t={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ze(ze({},qp),t),this.fetch=Wp(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async getBucket(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async listBuckets(e={}){var t=this;try{return{data:await ur(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}async deleteBucket(e){var t=this;try{return{data:await ur(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}}},n8=class extends r8{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new s8(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,a=this;return t().call(a,e)}async getBucket(e){var t=()=>super.getBucket,a=this;return t().call(a,e)}async listBuckets(e={}){var t=()=>super.listBuckets,a=this;return t().call(a,e)}async deleteBucket(e){var t=()=>super.deleteBucket,a=this;return t().call(a,e)}},s8=class extends t8{constructor(e,t,a,r){super(e,t,r),this.vectorBucketName=a}async createIndex(e){var t=()=>super.createIndex,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,a=this;return t().call(a,a.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,a=this;return t().call(a,a.vectorBucketName,e)}index(e){return new i8(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},i8=class extends a8{constructor(e,t,a,r,s){super(e,t,s),this.vectorBucketName=a,this.indexName=r}async putVectors(e){var t=()=>super.putVectors,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async getVectors(e){var t=()=>super.getVectors,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,a=this;return t().call(a,ze(ze({},e),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}},l8=class extends Yj{constructor(e,t={},a,r){super(e,t,a,r)}from(e){return new Wj(this.url,this.headers,e,this.fetch)}get vectors(){return new n8(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Xj(this.url+"/iceberg",this.headers,this.fetch)}};const kT="2.90.1",vl=30*1e3,qm=3,Qd=qm*vl,o8="http://localhost:9999",c8="supabase.auth.token",u8={"X-Client-Info":`gotrue-js/${kT}`},Wm="X-Supabase-Api-Version",AT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},f8=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,h8=600*1e3;class yc extends Error{constructor(t,a,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=r}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class d8 extends yc{constructor(t,a,r){super(t,a,r),this.name="AuthApiError",this.status=a,this.code=r}}function m8(e){return Pe(e)&&e.name==="AuthApiError"}class oi extends yc{constructor(t,a){super(t),this.name="AuthUnknownError",this.originalError=a}}class $n extends yc{constructor(t,a,r,s){super(t,r,s),this.name=a,this.status=r}}class ir extends $n{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function p8(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class fl extends $n{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class h0 extends $n{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class d0 extends $n{constructor(t,a=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function x8(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class rb extends $n{constructor(t,a=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class g8 extends $n{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ym extends $n{constructor(t,a){super(t,"AuthRetryableFetchError",a,void 0)}}function Zd(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class nb extends $n{constructor(t,a,r){super(t,"AuthWeakPasswordError",a,"weak_password"),this.reasons=r}}class Xm extends $n{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const B0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sb=`
\r=`.split(""),v8=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<sb.length;t+=1)e[sb[t].charCodeAt(0)]=-2;for(let t=0;t<B0.length;t+=1)e[B0[t].charCodeAt(0)]=t;return e})();function ib(e,t,a){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;a(B0[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;a(B0[r]),t.queuedBits-=6}}function NT(e,t,a){const r=v8[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)a(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function lb(e){const t=[],a=c=>{t.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{w8(c,r,a)};for(let c=0;c<e.length;c+=1)NT(e.charCodeAt(c),s,l);return t.join("")}function y8(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function b8(e,t){for(let a=0;a<e.length;a+=1){let r=e.charCodeAt(a);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(e.charCodeAt(a+1)-56320&65535|s)+65536,a+=1}y8(r,t)}}function w8(e,t,a){if(t.utf8seq===0){if(e<=127){a(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&a(t.codepoint)}}function Ol(e){const t=[],a={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)NT(e.charCodeAt(s),a,r);return new Uint8Array(t)}function _8(e){const t=[];return b8(e,a=>t.push(a)),new Uint8Array(t)}function hi(e){const t=[],a={queue:0,queuedBits:0},r=s=>{t.push(s)};return e.forEach(s=>ib(s,a,r)),ib(null,a,r),t.join("")}function T8(e){return Math.round(Date.now()/1e3)+e}function S8(){return Symbol("auth-callback")}const xa=()=>typeof window<"u"&&typeof document<"u",ai={tested:!1,writable:!1},CT=()=>{if(!xa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ai.tested)return ai.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ai.tested=!0,ai.writable=!0}catch{ai.tested=!0,ai.writable=!1}return ai.writable};function E8(e){const t={},a=new URL(e);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return a.searchParams.forEach((r,s)=>{t[s]=r}),t}const OT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),k8=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",yl=async(e,t,a)=>{await e.setItem(t,JSON.stringify(a))},ri=async(e,t)=>{const a=await e.getItem(t);if(!a)return null;try{return JSON.parse(a)}catch{return a}},pa=async(e,t)=>{await e.removeItem(t)};class cf{constructor(){this.promise=new cf.promiseConstructor((t,a)=>{this.resolve=t,this.reject=a})}}cf.promiseConstructor=Promise;function em(e){const t=e.split(".");if(t.length!==3)throw new Xm("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!f8.test(t[r]))throw new Xm("JWT not in base64url format");return{header:JSON.parse(lb(t[0])),payload:JSON.parse(lb(t[1])),signature:Ol(t[2]),raw:{header:t[0],payload:t[1]}}}async function A8(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function N8(e,t){return new Promise((r,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){r(c);return}}catch(c){if(!t(l,c)){s(c);return}}})()})}function C8(e){return("0"+e.toString(16)).substr(-2)}function O8(){const t=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=a.length;let s="";for(let l=0;l<56;l++)s+=a.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,C8).join("")}async function D8(e){const a=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",a),s=new Uint8Array(r);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function j8(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const a=await D8(e);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hl(e,t,a=!1){const r=O8();let s=r;a&&(s+="/PASSWORD_RECOVERY"),await yl(e,`${t}-code-verifier`,s);const l=await j8(r);return[l,r===l?"plain":"s256"]}const R8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function M8(e){const t=e.headers.get(Wm);if(!t||!t.match(R8))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function F8(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function L8(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const P8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function dl(e){if(!P8.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tm(){const e={};return new Proxy(e,{get:(t,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const r=a.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function I8(e,t){return new Proxy(e,{get:(a,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(a,r,s)}return!t.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(a,r,s)}})}function ob(e){return JSON.parse(JSON.stringify(e))}const ii=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B8=[502,503,504];async function cb(e){var t;if(!k8(e))throw new Ym(ii(e),0);if(B8.includes(e.status))throw new Ym(ii(e),e.status);let a;try{a=await e.json()}catch(l){throw new oi(ii(l),l)}let r;const s=M8(e);if(s&&s.getTime()>=AT["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?r=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(r=a.error_code),r){if(r==="weak_password")throw new nb(ii(a),e.status,((t=a.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new ir}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new nb(ii(a),e.status,a.weak_password.reasons);throw new d8(ii(a),e.status||500,r)}const U8=(e,t,a,r)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),a))};async function Ue(e,t,a,r){var s;const l=Object.assign({},r?.headers);l[Wm]||(l[Wm]=AT["2024-01-01"].name),r?.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await z8(e,t,a+u,{headers:l,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(h):{data:Object.assign({},h),error:null}}async function z8(e,t,a,r,s,l){const c=U8(t,r,s,l);let u;try{u=await e(a,Object.assign({},c))}catch(h){throw console.error(h),new Ym(ii(h),0)}if(u.ok||await cb(u),r?.noResolveJson)return u;try{return await u.json()}catch(h){await cb(h)}}function $r(e){var t;let a=null;$8(e)&&(a=Object.assign({},e),e.expires_at||(a.expires_at=T8(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:a,user:r},error:null}}function ub(e){const t=$r(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((a,r)=>a&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function _s(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function V8(e){return{data:e,error:null}}function H8(e){const{action_link:t,email_otp:a,hashed_token:r,redirect_to:s,verification_type:l}=e,c=lf(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:a,hashed_token:r,redirect_to:s,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function fb(e){return e}function $8(e){return e.access_token&&e.refresh_token&&e.expires_in}const am=["global","local","others"];class G8{constructor({url:t="",headers:a={},fetch:r}){this.url=t,this.headers=a,this.fetch=OT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,a=am[0]){if(am.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${am.join(", ")}`);try{return await Ue(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,a={}){try{return await Ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:_s})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:a}=t,r=lf(t,["options"]),s=Object.assign(Object.assign({},r),a);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await Ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:H8,redirectTo:a?.redirectTo})}catch(a){if(Pe(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_s})}catch(a){if(Pe(a))return{data:{user:null},error:a};throw a}}async listUsers(t){var a,r,s,l,c,u,h;try{const m={nextPage:null,lastPage:0,total:0},p=await Ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(a=t?.page)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:fb});if(p.error)throw p.error;const g=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(_.split(";")[1].split("=")[1]);m[`${T}Page`]=w}),m.total=parseInt(y)),{data:Object.assign(Object.assign({},g),m),error:null}}catch(m){if(Pe(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){dl(t);try{return await Ue(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_s})}catch(a){if(Pe(a))return{data:{user:null},error:a};throw a}}async updateUserById(t,a){dl(t);try{return await Ue(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:a,headers:this.headers,xform:_s})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,a=!1){dl(t);try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:a},xform:_s})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){dl(t.userId);try{const{data:a,error:r}=await Ue(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:a,error:r}}catch(a){if(Pe(a))return{data:null,error:a};throw a}}async _deleteFactor(t){dl(t.userId),dl(t.id);try{return{data:await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(a){if(Pe(a))return{data:null,error:a};throw a}}async _listOAuthClients(t){var a,r,s,l,c,u,h;try{const m={nextPage:null,lastPage:0,total:0},p=await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(a=t?.page)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:fb});if(p.error)throw p.error;const g=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(_.split(";")[1].split("=")[1]);m[`${T}Page`]=w}),m.total=parseInt(y)),{data:Object.assign(Object.assign({},g),m),error:null}}catch(m){if(Pe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Pe(a))return{data:null,error:a};throw a}}async _getOAuthClient(t){try{return await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Pe(a))return{data:null,error:a};throw a}}async _updateOAuthClient(t,a){try{return await Ue(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:a,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Pe(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Pe(a))return{data:null,error:a};throw a}}}function hb(e={}){return{getItem:t=>e[t]||null,setItem:(t,a)=>{e[t]=a},removeItem:t=>{delete e[t]}}}const ml={debug:!!(globalThis&&CT()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class DT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class q8 extends DT{}async function W8(e,t,a){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),ml.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await a()}finally{ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new q8(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ml.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}function Y8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function jT(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function X8(e){return parseInt(e,16)}function K8(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,r=>r.toString(16).padStart(2,"0")).join("")}function J8(e){var t;const{chainId:a,domain:r,expirationTime:s,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:h,resources:m,scheme:p,uri:g,version:y}=e;{if(!Number.isInteger(a))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${a}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const b=jT(e.address),_=p?`${p}://${r}`:r,w=e.statement?`${e.statement}
`:"",T=`${_} wants you to sign in with your Ethereum account:
${b}

${w}`;let A=`URI: ${g}
Version: ${y}
Chain ID: ${a}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(s&&(A+=`
Expiration Time: ${s.toISOString()}`),u&&(A+=`
Not Before: ${u.toISOString()}`),h&&(A+=`
Request ID: ${h}`),m){let k=`
Resources:`;for(const S of m){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);k+=`
- ${S}`}A+=k}return`${T}
${A}`}class ea extends Error{constructor({message:t,code:a,cause:r,name:s}){var l;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=(l=s??(r instanceof Error?r.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=a}}class U0 extends ea{constructor(t,a){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a,message:t}),this.name="WebAuthnUnknownError",this.originalError=a}}function Q8({error:e,options:t}){var a,r,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ea({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.requireResidentKey)===!0)return new ea({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new ea({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new ea({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new ea({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new ea({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new ea({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new ea({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(RT(c)){if(l.rp.id!==c)return new ea({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ea({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new ea({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new ea({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ea({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Z8({error:e,options:t}){const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ea({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new ea({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const r=window.location.hostname;if(RT(r)){if(a.rpId!==r)return new ea({message:`The RP ID "${a.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ea({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new ea({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ea({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class eR{createNewAbortSignal(){if(this.controller){const a=new Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const tR=new eR;function aR(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:a,excludeCredentials:r}=e,s=lf(e,["challenge","user","excludeCredentials"]),l=Ol(t).buffer,c=Object.assign(Object.assign({},a),{id:Ol(a.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:c});if(r&&r.length>0){u.excludeCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const m=r[h];u.excludeCredentials[h]=Object.assign(Object.assign({},m),{id:Ol(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return u}function rR(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:a}=e,r=lf(e,["challenge","allowCredentials"]),s=Ol(t).buffer,l=Object.assign(Object.assign({},r),{challenge:s});if(a&&a.length>0){l.allowCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const u=a[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:Ol(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function nR(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const a=e;return{id:e.id,rawId:e.id,response:{attestationObject:hi(new Uint8Array(e.response.attestationObject)),clientDataJSON:hi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=a.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function sR(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const a=e,r=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:hi(new Uint8Array(s.authenticatorData)),clientDataJSON:hi(new Uint8Array(s.clientDataJSON)),signature:hi(new Uint8Array(s.signature)),userHandle:s.userHandle?hi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(t=a.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function RT(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function db(){var e,t;return!!(xa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function iR(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new U0("Browser returned unexpected credential type",t)}:{data:null,error:new U0("Empty credential response",t)}}catch(t){return{data:null,error:Q8({error:t,options:e})}}}async function lR(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new U0("Browser returned unexpected credential type",t)}:{data:null,error:new U0("Empty credential response",t)}}catch(t){return{data:null,error:Z8({error:t,options:e})}}}const oR={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},cR={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function z0(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),a=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of e)if(s)for(const l in s){const c=s[l];if(c!==void 0)if(Array.isArray(c))r[l]=c;else if(a(c))r[l]=c;else if(t(c)){const u=r[l];t(u)?r[l]=z0(u,c):r[l]=z0(c)}else r[l]=c}return r}function uR(e,t){return z0(oR,e,t||{})}function fR(e,t){return z0(cR,e,t||{})}class hR{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:a,friendlyName:r,signal:s},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:a});if(!c)return{data:null,error:u};const h=s??tR.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${r}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=uR(c.webauthn.credential_options.publicKey,l?.create),{data:p,error:g}=await iR({publicKey:m,signal:h});return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}case"request":{const m=fR(c.webauthn.credential_options.publicKey,l?.request),{data:p,error:g}=await lR(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:h}));return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}}}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new oi("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:a,webauthn:r}){return this.client.mfa.verify({factorId:a,challengeId:t,webauthn:r})}async _authenticate({factorId:t,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!a)return{data:null,error:new yc("rpId is required for WebAuthn authentication")};try{if(!db())return{data:null,error:new oi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:a,rpOrigins:r},signal:s},{request:l});if(!c)return{data:null,error:u};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:a,rpOrigins:r,credential_response:h.credential_response}})}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new oi("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!a)return{data:null,error:new yc("rpId is required for WebAuthn registration")};try{if(!db())return{data:null,error:new oi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(p=>{var g;return(g=p.data)===null||g===void 0?void 0:g.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===t&&y.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:u};const{data:h,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:a,rpOrigins:r},signal:s},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:a,rpOrigins:r,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:m}}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new oi("Unexpected error in register",c)}}}}Y8();const dR={url:o8,storageKey:c8,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:u8,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function mb(e,t,a){return await a()}const pl={};class bc{get jwks(){var t,a;return(a=(t=pl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(t){pl[this.storageKey]=Object.assign(Object.assign({},pl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,a;return(a=(t=pl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){pl[this.storageKey]=Object.assign(Object.assign({},pl[this.storageKey]),{cachedAt:t})}constructor(t){var a,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},dR),t);if(this.storageKey=l.storageKey,this.instanceID=(a=bc.nextInstanceID[this.storageKey])!==null&&a!==void 0?a:0,bc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&xa()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new G8({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=OT(l.fetch),this.lock=l.lock||mb,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&xa()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=W8:this.lock=mb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new hR(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:CT()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hb(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=hb(this.memoryStorage)),xa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${kT}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let a={},r="none";if(xa()&&(a=E8(window.location.href),this._isImplicitGrantCallback(a)?r="implicit":await this._isPKCECallback(a)&&(r="pkce")),xa()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:l}=await this._getSessionFromURL(a,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),x8(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:c,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return Pe(a)?this._returnResult({error:a}):this._returnResult({error:new oi("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var a,r,s;try{const l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(a=t?.options)===null||a===void 0?void 0:a.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:$r}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(l){if(Pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var a,r,s;try{let l;if("email"in t){const{email:p,password:g,options:y}=t;let b=null,_=null;this.flowType==="pkce"&&([b,_]=await hl(this.storage,this.storageKey)),l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:p,password:g,data:(a=y?.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:b,code_challenge_method:_},xform:$r})}else if("phone"in t){const{phone:p,password:g,options:y}=t;l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(r=y?.data)!==null&&r!==void 0?r:{},channel:(s=y?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:$r})}else throw new h0("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return await pa(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(l){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let a;if("email"in t){const{email:l,password:c,options:u}=t;a=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ub})}else if("phone"in t){const{phone:l,password:c,options:u}=t;a=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ub})}else throw new h0("You must provide either an email or phone number and a password");const{data:r,error:s}=a;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const l=new fl;return this._returnResult({data:{user:null,session:null},error:l})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(t){var a,r,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:a}=t;switch(a){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}}async signInWithEthereum(t){var a,r,s,l,c,u,h,m,p,g,y;let b,_;if("message"in t)b=t.message,_=t.signature;else{const{chain:w,wallet:T,statement:A,options:k}=t;let S;if(xa())if(typeof T=="object")S=T;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")S=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=T}const L=new URL((a=k?.url)!==null&&a!==void 0?a:window.location.href),V=await S.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!V||V.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const P=jT(V[0]);let N=(r=k?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!N){const I=await S.request({method:"eth_chainId"});N=X8(I)}const j={domain:L.host,address:P,statement:A,uri:L.href,version:"1",chainId:N,nonce:(s=k?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(l=k?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=k?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=k?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(m=k?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(p=k?.signInWithEthereum)===null||p===void 0?void 0:p.resources};b=J8(j),_=await S.request({method:"personal_sign",params:[K8(b),P]})}try{const{data:w,error:T}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:_},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:$r});if(T)throw T;if(!w||!w.session||!w.user){const A=new fl;return this._returnResult({data:{user:null,session:null},error:A})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:T})}catch(w){if(Pe(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var a,r,s,l,c,u,h,m,p,g,y,b;let _,w;if("message"in t)_=t.message,w=t.signature;else{const{chain:T,wallet:A,statement:k,options:S}=t;let L;if(xa())if(typeof A=="object")L=A;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))L=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=A}const V=new URL((a=S?.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in L&&L.signIn){const P=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),k?{statement:k}:null));let N;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")N=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)N=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)_=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),w=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${V.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(s=(r=S?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=S?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((u=S?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((m=S?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((g=(p=S?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...S.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const P=await L.signMessage(new TextEncoder().encode(_),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=P}}try{const{data:T,error:A}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:hi(w)},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:$r});if(A)throw A;if(!T||!T.session||!T.user){const k=new fl;return this._returnResult({data:{user:null,session:null},error:k})}return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),this._returnResult({data:Object.assign({},T),error:A})}catch(T){if(Pe(T))return this._returnResult({data:{user:null,session:null},error:T});throw T}}async _exchangeCodeForSession(t){const a=await ri(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(a??"").split("/");try{if(!r&&this.flowType==="pkce")throw new g8;const{data:l,error:c}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:$r});if(await pa(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new fl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:a,provider:r,token:s,access_token:l,nonce:c}=t,u=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:$r}),{data:h,error:m}=u;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!h||!h.session||!h.user){const p=new fl;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:m})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(t){var a,r,s,l,c;try{if("email"in t){const{email:u,options:h}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await hl(this.storage,this.storageKey));const{error:g}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(a=h?.data)!==null&&a!==void 0?a:{},create_user:(r=h?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:u,options:h}=t,{data:m,error:p}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:p})}throw new h0("You must provide either an email or phone number.")}catch(u){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var a,r;try{let s,l;"options"in t&&(s=(a=t.options)===null||a===void 0?void 0:a.redirectTo,l=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:u}=await Ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:$r});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,m=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(s){if(Pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var a,r,s,l,c;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await hl(this.storage,this.storageKey));const m=await Ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(a=t.options)===null||a===void 0?void 0:a.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:V8});return!((l=m.data)===null||l===void 0)&&l.url&&xa()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(u){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:a},error:r}=t;if(r)throw r;if(!a)throw new ir;const{error:s}=await Ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const a=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:l}=t,{error:c}=await Ue(this.fetch,"POST",a,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:r,type:s,options:l}=t,{data:c,error:u}=await Ue(this.fetch,"POST",a,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new h0("You must provide either an email or phone number and a type")}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async a=>a))}async _acquireLock(t,a){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await a()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=a();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await t(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const a=await ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?t=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Qd:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const c=await ri(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=tm()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=I8(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const a=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return a.data.user&&(this.suppressGetSessionWarning=!0),a}async _getUser(t){try{return t?await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_s}):await this._useSession(async a=>{var r,s,l;const{data:c,error:u}=a;if(u)throw u;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ir}:await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:_s})})}catch(a){if(Pe(a))return p8(a)&&(await this._removeSession(),await pa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(t,a={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,a))}async _updateUser(t,a={}){try{return await this._useSession(async r=>{const{data:s,error:l}=r;if(l)throw l;if(!s.session)throw new ir;const c=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await hl(this.storage,this.storageKey));const{data:m,error:p}=await Ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:_s});if(p)throw p;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(r){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ir;const a=Date.now()/1e3;let r=a,s=!0,l=null;const{payload:c}=em(t.access_token);if(c.exp&&(r=c.exp,s=r<=a),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:r-a,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(a){if(Pe(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async a=>{var r;if(!t){const{data:c,error:u}=a;if(u)throw u;t=(r=c.session)!==null&&r!==void 0?r:void 0}if(!t?.refresh_token)throw new ir;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(Pe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(t,a){try{if(!xa())throw new d0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new d0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new rb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new d0("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new rb("No code detected.");const{data:k,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:m}=t;if(!l||!u||!c||!m)throw new d0("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(u);let y=p+g;h&&(y=parseInt(h));const b=y-p;b*1e3<=vl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const _=y-g;p-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,y,p):p-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,y,p);const{data:w,error:T}=await this._getUser(l);if(T)throw T;const A={provider_token:r,provider_refresh_token:s,access_token:l,expires_in:g,expires_at:y,refresh_token:c,token_type:m,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:t.type},error:null})}catch(r){if(Pe(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const a=await ri(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&a)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async a=>{var r;const{data:s,error:l}=a;if(l)return this._returnResult({error:l});const c=(r=s.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(m8(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await pa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const a=S8(),r={id:a,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async a=>{var r,s;try{const{data:{session:l},error:c}=a;if(c)throw c;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,a={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await hl(this.storage,this.storageKey,!0));try{return await Ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(l){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:a,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(t=a.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var a;try{const{data:r,error:s}=await this._useSession(async l=>{var c,u,h,m,p;const{data:g,error:y}=l;if(y)throw y;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ue(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(m=g.session)===null||m===void 0?void 0:m.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return xa()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:t.provider,url:r?.url},error:null})}catch(r){if(Pe(r))return this._returnResult({data:{provider:t.provider,url:null},error:r});throw r}}async linkIdentityIdToken(t){return await this._useSession(async a=>{var r;try{const{error:s,data:{session:l}}=a;if(s)throw s;const{options:c,provider:u,token:h,access_token:m,nonce:p}=t,g=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=l?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:u,id_token:h,access_token:m,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:$r}),{data:y,error:b}=g;return b?this._returnResult({data:{user:null,session:null},error:b}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new fl}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:b}))}catch(s){if(await pa(this.storage,`${this.storageKey}-code-verifier`),Pe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async a=>{var r,s;const{data:l,error:c}=a;if(c)throw c;return await Ue(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(t){const a=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{const r=Date.now();return await N8(async s=>(s>0&&await A8(200*Math.pow(2,s-1)),this._debug(a,"refreshing attempt",s),await Ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:$r})),(s,l)=>{const c=200*Math.pow(2,s);return l&&Zd(l)&&Date.now()+c-r<vl})}catch(r){if(this._debug(a,"error",r),Pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(a,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,a){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",a,"url",r),xa()&&!a.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,a;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await ri(this.storage,this.storageKey);if(s&&this.userStorage){let c=await ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await yl(this.userStorage,this.storageKey+"-user",c)),s.user=(t=c?.user)!==null&&t!==void 0?t:tm()}else if(s&&!s.user&&!s.user){const c=await ri(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await pa(this.storage,this.storageKey+"-user"),await yl(this.storage,this.storageKey,s)):s.user=tm()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const l=((a=s.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<Qd;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${Qd}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),Zd(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(s.access_token);!u&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var a,r;if(!t)throw new ir;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new cf;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new ir;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),Pe(l)){const c={data:null,error:l};return Zd(l)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,a,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",a,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:a});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,a)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await pa(this.storage,`${this.storageKey}-code-verifier`);const a=Object.assign({},t),r=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&a.user&&await yl(this.userStorage,this.storageKey+"-user",{user:a.user});const s=Object.assign({},a);delete s.user;const l=ob(s);await yl(this.storage,this.storageKey,l)}else{const s=ob(a);await yl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pa(this.storage,this.storageKey),await pa(this.storage,this.storageKey+"-code-verifier"),await pa(this.storage,this.storageKey+"-user"),this.userStorage&&await pa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&xa()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),vl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const a=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const a=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,a&&clearTimeout(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async a=>{const{data:{session:r}}=a;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/vl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${vl}ms, refresh threshold is ${qm} ticks`),s<=qm&&await this._callRefreshToken(r.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof DT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xa()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const a=`#_onVisibilityChanged(${t})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,a,r){const s=[`provider=${encodeURIComponent(a)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await hl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(u.toString())}if(r?.queryParams){const l=new URLSearchParams(r.queryParams);s.push(l.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async a=>{var r;const{data:s,error:l}=a;return l?this._returnResult({data:null,error:l}):await Ue(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(t){try{return await this._useSession(async a=>{var r,s;const{data:l,error:c}=a;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:m}=await Ue(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(r=l?.session)===null||r===void 0?void 0:r.access_token});return m?this._returnResult({data:null,error:m}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async a=>{var r;const{data:s,error:l}=a;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?nR(t.webauthn.credential_response):sR(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await Ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async a=>{var r;const{data:s,error:l}=a;if(l)return this._returnResult({data:null,error:l});const c=await Ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:aR(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:rR(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(t){const{data:a,error:r}=await this._challenge({factorId:t.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:t.factorId,challengeId:a.id,code:t.code})}async _listFactors(){var t;const{data:{user:a},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=a?.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,a;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=em(r.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((a=(t=r.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(u="aal2");const m=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async a=>{const{data:{session:r},error:s}=a;return s?this._returnResult({data:null,error:s}):r?await Ue(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:r.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ir})})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(t,a){try{return await this._useSession(async r=>{const{data:{session:s},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new ir});const c=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&xa()&&!a?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(t,a){try{return await this._useSession(async r=>{const{data:{session:s},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new ir});const c=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&xa()&&!a?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:a},error:r}=t;return r?this._returnResult({data:null,error:r}):a?await Ue(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ir})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async a=>{const{data:{session:r},error:s}=a;return s?this._returnResult({data:null,error:s}):r?(await Ue(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ir})})}catch(a){if(Pe(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(t,a={keys:[]}){let r=a.keys.find(u=>u.kid===t);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(u=>u.kid===t),r&&this.jwks_cached_at+h8>s)return r;const{data:l,error:c}=await Ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,r=l.keys.find(u=>u.kid===t),!r)?null:r}async getClaims(t,a={}){try{let r=t;if(!r){const{data:b,error:_}=await this.getSession();if(_||!b.session)return this._returnResult({data:null,error:_});r=b.session.access_token}const{header:s,payload:l,signature:c,raw:{header:u,payload:h}}=em(r);a?.allowExpired||F8(l.exp);const m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,a?.keys?{keys:a.keys}:a?.jwks);if(!m){const{error:b}=await this.getUser(r);if(b)throw b;return{data:{claims:l,header:s,signature:c},error:null}}const p=L8(s.alg),g=await crypto.subtle.importKey("jwk",m,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,c,_8(`${u}.${h}`)))throw new Xm("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}}bc.nextInstanceID={};const mR=bc,pR="2.90.1";let zo="";typeof Deno<"u"?zo="deno":typeof document<"u"?zo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zo="react-native":zo="node";const xR={"X-Client-Info":`supabase-js-${zo}/${pR}`},gR={headers:xR},vR={schema:"public"},yR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bR={};function wc(e){"@babel/helpers - typeof";return wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wc(e)}function wR(e,t){if(wc(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(wc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _R(e){var t=wR(e,"string");return wc(t)=="symbol"?t:t+""}function TR(e,t,a){return(t=_R(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pb(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function It(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?pb(Object(a),!0).forEach(function(r){TR(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}const SR=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ER=()=>Headers,kR=(e,t,a)=>{const r=SR(a),s=ER();return async(l,c)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let m=new s(c?.headers);return m.has("apikey")||m.set("apikey",e),m.has("Authorization")||m.set("Authorization",`Bearer ${h}`),r(l,It(It({},c),{},{headers:m}))}};function AR(e){return e.endsWith("/")?e:e+"/"}function NR(e,t){var a,r;const{db:s,auth:l,realtime:c,global:u}=e,{db:h,auth:m,realtime:p,global:g}=t,y={db:It(It({},h),s),auth:It(It({},m),l),realtime:It(It({},p),c),storage:{},global:It(It(It({},g),u),{},{headers:It(It({},(a=g?.headers)!==null&&a!==void 0?a:{}),(r=u?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}function CR(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(AR(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var OR=class extends mR{constructor(e){super(e)}},DR=class{constructor(e,t,a){var r,s;this.supabaseUrl=e,this.supabaseKey=t;const l=CR(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:vR,realtime:bR,auth:It(It({},yR),{},{storageKey:c}),global:gR},h=NR(a??{},u);if(this.storageKey=(r=h.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=h.auth)!==null&&m!==void 0?m:{},this.headers,h.global.fetch)}this.fetch=kR(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(It({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new uj(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new l8(this.storageUrl.href,this.headers,this.fetch,a?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new sj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,a)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,a;if(e.accessToken)return await e.accessToken();const{data:r}=await e.auth.getSession();return(t=(a=r.session)===null||a===void 0?void 0:a.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:a,storage:r,userStorage:s,storageKey:l,flowType:c,lock:u,debug:h,throwOnError:m},p,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new OR({url:this.authUrl.href,headers:It(It({},y),p),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:a,storage:r,userStorage:s,flowType:c,lock:u,debug:h,throwOnError:m,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Aj(this.realtimeUrl.href,It(It({},e),{},{params:It(It({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const jR=(e,t,a)=>new DR(e,t,a);function RR(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const a=t.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}RR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const MR=localStorage.getItem("supabase_url")||"https://illzgrubrstyagmkqfju.supabase.co",FR=localStorage.getItem("supabase_key")||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlsbHpncnVicnN0eWFnbWtxZmp1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNzA5ODksImV4cCI6MjA4Mzg0Njk4OX0.cUnAo_vB6wz6zwSUXrrkpj8w3Mp7EgKeBM3ZiDbHceQ";jR(MR,FR);const LR=(e,t)=>{localStorage.setItem("supabase_url",e),localStorage.setItem("supabase_key",t),window.location.reload()};var MT=1252,PR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Xp=function(e){PR.indexOf(e)!=-1&&(MT=Yp[0]=e)};function IR(){Xp(1252)}var Xr=function(e){Xp(e)};function FT(){Xr(1200),IR()}function xb(e){for(var t=[],a=0,r=e.length;a<r;++a)t[a]=e.charCodeAt(a);return t}function BR(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return t.join("")}function LT(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return t.join("")}var Vo=function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1);return t==255&&a==254?BR(e.slice(2)):t==254&&a==255?LT(e.slice(2)):t==65279?e.slice(1):e},m0=function(t){return String.fromCharCode(t)},gb=function(t){return String.fromCharCode(t)},_c,Es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function vb(e){for(var t="",a=0,r=0,s=0,l=0,c=0,u=0,h=0,m=0;m<e.length;)a=e.charCodeAt(m++),l=a>>2,r=e.charCodeAt(m++),c=(a&3)<<4|r>>4,s=e.charCodeAt(m++),u=(r&15)<<2|s>>6,h=s&63,isNaN(r)?u=h=64:isNaN(s)&&(h=64),t+=Es.charAt(l)+Es.charAt(c)+Es.charAt(u)+Es.charAt(h);return t}function hr(e){var t="",a=0,r=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)l=Es.indexOf(e.charAt(m++)),c=Es.indexOf(e.charAt(m++)),a=l<<2|c>>4,t+=String.fromCharCode(a),u=Es.indexOf(e.charAt(m++)),r=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),h=Es.indexOf(e.charAt(m++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var rt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),bi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,a){return a?new Buffer(t,a):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Os(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yb(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Yr=function(t){return rt?bi(t,"binary"):t.split("").map(function(a){return a.charCodeAt(0)&255})};function wi(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function Kp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Kp(new Uint8Array(e));for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t}var Ts=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:bi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,a=0;for(t=0;t<e.length;++t)a+=e[t].length;var r=new Uint8Array(a),s=0;for(t=0,a=0;t<e.length;a+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],a);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),a)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function UR(e){for(var t=[],a=0,r=e.length+250,s=Os(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[a++]=c;else if(c<2048)s[a++]=192|c>>6&31,s[a++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[a++]=240|c>>8&7,s[a++]=128|c>>2&63,s[a++]=128|u>>6&15|(c&3)<<4,s[a++]=128|u&63}else s[a++]=224|c>>12&15,s[a++]=128|c>>6&63,s[a++]=128|c&63;a>r&&(t.push(s.slice(0,a)),a=0,s=Os(65535),r=65530)}return t.push(s.slice(0,a)),Ts(t)}var Ua=/\u0000/g,Ho=/[\u0001-\u0006]/g;function Dl(e){for(var t="",a=e.length-1;a>=0;)t+=e.charAt(a--);return t}function Kr(e,t){var a=""+e;return a.length>=t?a:Ut("0",t-a.length)+a}function Jp(e,t){var a=""+e;return a.length>=t?a:Ut(" ",t-a.length)+a}function V0(e,t){var a=""+e;return a.length>=t?a:a+Ut(" ",t-a.length)}function zR(e,t){var a=""+Math.round(e);return a.length>=t?a:Ut("0",t-a.length)+a}function VR(e,t){var a=""+e;return a.length>=t?a:Ut("0",t-a.length)+a}var bb=Math.pow(2,32);function xl(e,t){if(e>bb||e<-bb)return zR(e,t);var a=Math.round(e);return VR(a,t)}function H0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var wb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function HR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},_b={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$R={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $0(e,t,a){for(var r=e<0?-1:1,s=e*r,l=0,c=1,u=0,h=1,m=0,p=0,g=Math.floor(s);m<t&&(g=Math.floor(s),u=g*c+l,p=g*m+h,!(s-g<5e-8));)s=1/(s-g),l=c,c=u,h=m,m=p;if(p>t&&(m>t?(p=h,u=l):(p=m,u=c)),!a)return[0,r*u,p];var y=Math.floor(r*u/p);return[y,r*u-y*p,p]}function di(e,t,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),l=0,c=[],u={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++r,++u.D)),r===60)c=a?[1317,10,29]:[1900,2,29],l=3;else if(r===0)c=a?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var h=new Date(1900,0,1);h.setDate(h.getDate()+r-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),r<60&&(l=(l+6)%7),a&&(l=KR(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var PT=new Date(1899,11,31,0,0,0),GR=PT.getTime(),qR=new Date(1900,2,1,0,0,0);function IT(e,t){var a=e.getTime();return t?a-=1461*24*60*60*1e3:e>=qR&&(a+=1440*60*1e3),(a-(GR+(e.getTimezoneOffset()-PT.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Qp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function YR(e){var t=e<0?12:11,a=Qp(e.toFixed(12));return a.length<=t||(a=e.toPrecision(10),a.length<=t)?a:e.toExponential(5)}function XR(e){var t=Qp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Tc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return t>=-4&&t<=-1?a=e.toPrecision(10+t):Math.abs(t)<=9?a=YR(e):t===10?a=e.toFixed(10).substr(0,12):a=XR(e),Qp(WR(a.toUpperCase()))}function gi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Tc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Rr(14,IT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function KR(e,t){t[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function JR(e,t,a,r){var s="",l=0,c=0,u=a.y,h,m=0;switch(e){case 98:u=a.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,m=2;break;default:h=u%1e4,m=4;break}break;case 109:switch(t.length){case 1:case 2:h=a.m,m=t.length;break;case 3:return rm[a.m-1][1];case 5:return rm[a.m-1][0];default:return rm[a.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=a.d,m=t.length;break;case 3:return wb[a.q][0];default:return wb[a.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(a.H+11)%12,m=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=a.H,m=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=a.M,m=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return a.u===0&&(t=="s"||t=="ss")?Kr(a.S,t.length):(r>=2?c=r===3?1e3:100:c=r===1?10:1,l=Math.round(c*(a.S+a.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=Kr(l,2+r),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=a.D*24+a.H;break;case"[m]":case"[mm]":h=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":h=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+t}m=t.length===3?1:2;break;case 101:h=u,m=1;break}var p=m>0?Kr(h,m):"";return p}function ks(e){var t=3;if(e.length<=t)return e;for(var a=e.length%t,r=e.substr(0,a);a!=e.length;a+=t)r+=(r.length>0?",":"")+e.substr(a,t);return r}var BT=/%/g;function QR(e,t,a){var r=t.replace(BT,""),s=t.length-r.length;return Bn(e,r,a*Math.pow(10,2*s))+Ut("%",s)}function ZR(e,t,a){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Bn(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}function UT(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+UT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(t/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),a.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+l):a+="E+"+(c-l);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var zT=/# (\?+)( ?)\/( ?)(\d+)/;function eM(e,t,a){var r=parseInt(e[4],10),s=Math.round(t*r),l=Math.floor(s/r),c=s-l*r,u=r;return a+(l===0?"":""+l)+" "+(c===0?Ut(" ",e[1].length+1+e[4].length):Jp(c,e[1].length)+e[2]+"/"+e[3]+Kr(u,e[4].length))}function tM(e,t,a){return a+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var VT=/^#*0*\.([0#]+)/,HT=/\).*[0#]/,$T=/\(###\) ###\\?-####/;function Fa(e){for(var t="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(a)}return t}function Tb(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}function Sb(e,t){var a=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(a*r)).length?0:Math.round(a*r)}function aM(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function rM(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ar(e,t,a){if(e.charCodeAt(0)===40&&!t.match(HT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Ar("n",r,a):"("+Ar("n",r,-a)+")"}if(t.charCodeAt(t.length-1)===44)return ZR(e,t,a);if(t.indexOf("%")!==-1)return QR(e,t,a);if(t.indexOf("E")!==-1)return UT(t,a);if(t.charCodeAt(0)===36)return"$"+Ar(e,t.substr(t.charAt(1)==" "?2:1),a);var s,l,c,u,h=Math.abs(a),m=a<0?"-":"";if(t.match(/^00+$/))return m+xl(h,t.length);if(t.match(/^[#?]+$/))return s=xl(a,0),s==="0"&&(s=""),s.length>t.length?s:Fa(t.substr(0,t.length-s.length))+s;if(l=t.match(zT))return eM(l,h,m);if(t.match(/^#+0+$/))return m+xl(h,t.length-t.indexOf("0"));if(l=t.match(VT))return s=Tb(a,l[1].length).replace(/^([^\.]+)$/,"$1."+Fa(l[1])).replace(/\.$/,"."+Fa(l[1])).replace(/\.(\d*)$/,function(_,w){return"."+w+Ut("0",Fa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+Tb(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+ks(xl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Ar(e,t,-a):ks(""+(Math.floor(a)+aM(a,l[1].length)))+"."+Kr(Sb(a,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return Ar(e,t.replace(/^#,#*,/,""),a);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Dl(Ar(e,t.replace(/[\\-]/g,""),a)),c=0,Dl(Dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return c<s.length?s.charAt(c++):_==="0"?"0":""}));if(t.match($T))return s=Ar(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=$0(h,Math.pow(10,c)-1,!1),s=""+m,p=Bn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=V0(u[2],c),p.length<l[4].length&&(p=Fa(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=$0(h,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Jp(u[1],c)+l[2]+"/"+l[3]+V0(u[2],c):Ut(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=xl(a,0),t.length<=s.length?s:Fa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var g=t.indexOf(".")-c,y=t.length-s.length-g;return Fa(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=Sb(a,l[1].length),a<0?"-"+Ar(e,t,-a):ks(rM(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Kr(0,3-_.length):"")+_})+"."+Kr(c,l[1].length);switch(t){case"###,##0.00":return Ar(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var b=ks(xl(h,0));return b!=="0"?m+b:"";case"###,###.00":return Ar(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Ar(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function nM(e,t,a){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Bn(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}function sM(e,t,a){var r=t.replace(BT,""),s=t.length-r.length;return Bn(e,r,a*Math.pow(10,2*s))+Ut("%",s)}function GT(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(t/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),!a.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+l):a+="E+"+(c-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function on(e,t,a){if(e.charCodeAt(0)===40&&!t.match(HT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?on("n",r,a):"("+on("n",r,-a)+")"}if(t.charCodeAt(t.length-1)===44)return nM(e,t,a);if(t.indexOf("%")!==-1)return sM(e,t,a);if(t.indexOf("E")!==-1)return GT(t,a);if(t.charCodeAt(0)===36)return"$"+on(e,t.substr(t.charAt(1)==" "?2:1),a);var s,l,c,u,h=Math.abs(a),m=a<0?"-":"";if(t.match(/^00+$/))return m+Kr(h,t.length);if(t.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>t.length?s:Fa(t.substr(0,t.length-s.length))+s;if(l=t.match(zT))return tM(l,h,m);if(t.match(/^#+0+$/))return m+Kr(h,t.length-t.indexOf("0"));if(l=t.match(VT))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Fa(l[1])).replace(/\.$/,"."+Fa(l[1])),s=s.replace(/\.(\d*)$/,function(_,w){return"."+w+Ut("0",Fa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+ks(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+on(e,t,-a):ks(""+a)+"."+Ut("0",l[1].length);if(l=t.match(/^#,#*,#0/))return on(e,t.replace(/^#,#*,/,""),a);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Dl(on(e,t.replace(/[\\-]/g,""),a)),c=0,Dl(Dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return c<s.length?s.charAt(c++):_==="0"?"0":""}));if(t.match($T))return s=on(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=$0(h,Math.pow(10,c)-1,!1),s=""+m,p=Bn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=V0(u[2],c),p.length<l[4].length&&(p=Fa(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=$0(h,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Jp(u[1],c)+l[2]+"/"+l[3]+V0(u[2],c):Ut(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+a,t.length<=s.length?s:Fa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var g=t.indexOf(".")-c,y=t.length-s.length-g;return Fa(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return a<0?"-"+on(e,t,-a):ks(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Kr(0,3-_.length):"")+_})+"."+Kr(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=ks(""+h);return b!=="0"?m+b:"";default:if(t.match(/\.[0#?]*$/))return on(e,t.slice(0,t.lastIndexOf(".")),a)+Fa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Bn(e,t,a){return(a|0)===a?on(e,t,a):Ar(e,t,a)}function iM(e){for(var t=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(s,r-s),s=r+1}if(t[t.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var qT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ul(e){for(var t=0,a="",r="";t<e.length;)switch(a=e.charAt(t)){case"G":H0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=a;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(qT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++t))>-1||a=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===a;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function lM(e,t,a,r){for(var s=[],l="",c=0,u="",h="t",m,p,g,y="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!H0(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(g=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(g);s[s.length]={t:"t",v:l},++c;break;case"\\":var b=e.charAt(++c),_=b==="("||b===")"?b:"t";s[s.length]={t:_,v:b},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(m==null&&(m=di(t,a,e.charAt(c+1)==="2"),m==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||m==null&&(m=di(t,a),m==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(m==null&&(m=di(t,a)),e.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(m!=null&&(w.v=m.H>=12?"":""),w.t="T",c+=5,y="h"):(w.t="t",++c),m==null&&w.t==="T")return"";s[s.length]=w,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(qT)){if(m==null&&(m=di(t,a),m==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ul(e)||(s[s.length]={t:"t",v:l}));break;case".":if(m!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:r===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var T=0,A=0,k;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=y,h="h",T<1&&(T=1);break;case"s":(k=s[c].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&s[c].v.match(/[Hh]/)&&(T=1),T<2&&s[c].v.match(/[Mm]/)&&(T=2),T<3&&s[c].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var S="",L;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=JR(s[c].t.charCodeAt(0),s[c].v,m,A),s[c].t="t";break;case"n":case"?":for(L=c+1;s[L]!=null&&((u=s[L].t)==="?"||u==="D"||(u===" "||u==="t")&&s[L+1]!=null&&(s[L+1].t==="?"||s[L+1].t==="t"&&s[L+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[L].v==="/"||s[L].v===" "&&s[L+1]!=null&&s[L+1].t=="?"));)s[c].v+=s[L].v,s[L]={v:"",t:";"},++L;S+=s[c].v,c=L-1;break;case"G":s[c].t="t",s[c].v=gi(t,a);break}var V="",P,N;if(S.length>0){S.charCodeAt(0)==40?(P=t<0&&S.charCodeAt(0)===45?-t:t,N=Bn("n",S,P)):(P=t<0&&r>1?-t:t,N=Bn("n",S,P),P<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),L=N.length-1;var j=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){j=c;break}var I=s.length;if(j===s.length&&N.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(L>=s[c].v.length-1?(L-=s[c].v.length,s[c].v=N.substr(L+1,s[c].v.length)):L<0?s[c].v="":(s[c].v=N.substr(0,L+1),L=-1),s[c].t="t",I=c);L>=0&&I<s.length&&(s[I].v=N.substr(0,L+1)+s[I].v)}else if(j!==s.length&&N.indexOf("E")===-1){for(L=N.indexOf(".")-1,c=j;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===j?s[c].v.indexOf(".")-1:s[c].v.length-1,V=s[c].v.substr(p+1);p>=0;--p)L>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(V=N.charAt(L--)+V);s[c].v=V,s[c].t="t",I=c}for(L>=0&&I<s.length&&(s[I].v=N.substr(0,L+1)+s[I].v),L=N.indexOf(".")+1,c=j;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==j)){for(p=s[c].v.indexOf(".")>-1&&c===j?s[c].v.indexOf(".")+1:0,V=s[c].v.substr(0,p);p<s[c].v.length;++p)L<N.length&&(V+=N.charAt(L++));s[c].v=V,s[c].t="t",I=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(P=r>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=Bn(s[c].t,s[c].v,P),s[c].t="t");var z="";for(c=0;c!==s.length;++c)s[c]!=null&&(z+=s[c].v);return z}var Eb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kb(e,t){if(t==null)return!1;var a=parseFloat(t[2]);switch(t[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function oM(e,t){var a=iM(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof t!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var l=t>0?a[0]:t<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,l];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var c=a[0].match(Eb),u=a[1].match(Eb);return kb(t,c)?[r,a[0]]:kb(t,u)?[r,a[1]]:[r,a[c!=null&&u!=null?2:1]]}return[r,l]}function Rr(e,t,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:qe)[e],r==null&&(r=a.table&&a.table[_b[e]]||qe[_b[e]]),r==null&&(r=$R[e]||"General");break}if(H0(r,0))return gi(t,a);t instanceof Date&&(t=IT(t,a.date1904));var s=oM(r,t);if(H0(s[1]))return gi(t,a);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return lM(s[1],t,a,s[0])}function pi(e,t){if(typeof t!="number"){t=+t||-1;for(var a=0;a<392;++a){if(qe[a]==null){t<0&&(t=a);continue}if(qe[a]==e){t=a;break}}t<0&&(t=391)}return qe[t]=e,t}function WT(){qe=HR()}var cM={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},YT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function uM(e){var t=typeof e=="number"?qe[e]:e;return t=t.replace(YT,"(\\d+)"),new RegExp("^"+t+"$")}function fM(e,t,a){var r=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(t.match(YT)||[]).forEach(function(g,y){var b=parseInt(a[y+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=b;break;case"d":l=b;break;case"h":c=b;break;case"s":h=b;break;case"m":c>=0?u=b:s=b;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var m=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?m:r==-1&&s==-1&&l==-1?p:m+"T"+p}var hM=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,j=new Array(256),I=0;I!=256;++I)N=I,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,j[I]=N;return typeof Int32Array<"u"?new Int32Array(j):j}var a=t();function r(N){var j=0,I=0,z=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)X[z]=N[z];for(z=0;z!=256;++z)for(I=N[z],j=256+z;j<4096;j+=256)I=X[j]=I>>>8^N[I&255];var q=[];for(z=1;z!=16;++z)q[z-1]=typeof Int32Array<"u"?X.subarray(z*256,z*256+256):X.slice(z*256,z*256+256);return q}var s=r(a),l=s[0],c=s[1],u=s[2],h=s[3],m=s[4],p=s[5],g=s[6],y=s[7],b=s[8],_=s[9],w=s[10],T=s[11],A=s[12],k=s[13],S=s[14];function L(N,j){for(var I=j^-1,z=0,X=N.length;z<X;)I=I>>>8^a[(I^N.charCodeAt(z++))&255];return~I}function V(N,j){for(var I=j^-1,z=N.length-15,X=0;X<z;)I=S[N[X++]^I&255]^k[N[X++]^I>>8&255]^A[N[X++]^I>>16&255]^T[N[X++]^I>>>24]^w[N[X++]]^_[N[X++]]^b[N[X++]]^y[N[X++]]^g[N[X++]]^p[N[X++]]^m[N[X++]]^h[N[X++]]^u[N[X++]]^c[N[X++]]^l[N[X++]]^a[N[X++]];for(z+=15;X<z;)I=I>>>8^a[(I^N[X++])&255];return~I}function P(N,j){for(var I=j^-1,z=0,X=N.length,q=0,Q=0;z<X;)q=N.charCodeAt(z++),q<128?I=I>>>8^a[(I^q)&255]:q<2048?(I=I>>>8^a[(I^(192|q>>6&31))&255],I=I>>>8^a[(I^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,Q=N.charCodeAt(z++)&1023,I=I>>>8^a[(I^(240|q>>8&7))&255],I=I>>>8^a[(I^(128|q>>2&63))&255],I=I>>>8^a[(I^(128|Q>>6&15|(q&3)<<4))&255],I=I>>>8^a[(I^(128|Q&63))&255]):(I=I>>>8^a[(I^(224|q>>12&15))&255],I=I>>>8^a[(I^(128|q>>6&63))&255],I=I>>>8^a[(I^(128|q&63))&255]);return~I}return e.table=a,e.bstr=L,e.buf=V,e.str=P,e})(),nt=(function(){var t={};t.version="1.2.1";function a(C,U){for(var M=C.split("/"),F=U.split("/"),B=0,H=0,le=Math.min(M.length,F.length);B<le;++B){if(H=M[B].length-F[B].length)return H;if(M[B]!=F[B])return M[B]<F[B]?-1:1}return M.length-F.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(0,U+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(U+1)}function l(C,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,C.write_shift(2,M);var F=U.getFullYear()-1980;F=F<<4|U.getMonth()+1,F=F<<5|U.getDate(),C.write_shift(2,F)}function c(C){var U=C.read_shift(2)&65535,M=C.read_shift(2)&65535,F=new Date,B=M&31;M>>>=5;var H=M&15;M>>>=4,F.setMilliseconds(0),F.setFullYear(M+1980),F.setMonth(H-1),F.setDate(B);var le=U&31;U>>>=5;var pe=U&63;return U>>>=6,F.setHours(U),F.setMinutes(pe),F.setSeconds(le<<1),F}function u(C){ya(C,0);for(var U={},M=0;C.l<=C.length-4;){var F=C.read_shift(2),B=C.read_shift(2),H=C.l+B,le={};F===21589&&(M=C.read_shift(1),M&1&&(le.mtime=C.read_shift(4)),B>5&&(M&2&&(le.atime=C.read_shift(4)),M&4&&(le.ctime=C.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3))),C.l=H,U[F]=le}return U}var h;function m(){return h||(h={})}function p(C,U){if(C[0]==80&&C[1]==75)return Fs(C,U);if((C[0]|32)==109&&(C[1]|32)==105)return Ps(C,U);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var M=3,F=512,B=0,H=0,le=0,pe=0,oe=0,ce=[],fe=C.slice(0,512);ya(fe,0);var Te=g(fe);switch(M=Te[0],M){case 3:F=512;break;case 4:F=4096;break;case 0:if(Te[1]==0)return Fs(C,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}F!==512&&(fe=C.slice(0,F),ya(fe,28));var Ae=C.slice(0,F);y(fe,M);var De=fe.read_shift(4,"i");if(M===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);fe.l+=4,le=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),pe=fe.read_shift(4,"i"),B=fe.read_shift(4,"i"),oe=fe.read_shift(4,"i"),H=fe.read_shift(4,"i");for(var ke=-1,Ce=0;Ce<109&&(ke=fe.read_shift(4,"i"),!(ke<0));++Ce)ce[Ce]=ke;var Me=b(C,F);T(oe,H,Me,F,ce);var bt=k(Me,le,ce,F);bt[le].name="!Directory",B>0&&pe!==Q&&(bt[pe].name="!MiniFAT"),bt[ce[0]].name="!FAT",bt.fat_addrs=ce,bt.ssz=F;var wt={},Ot=[],pr=[],Is=[];S(le,bt,Me,Ot,B,wt,pr,pe),_(pr,Is,Ot),Ot.shift();var Wn={FileIndex:pr,FullPaths:Is};return U&&U.raw&&(Wn.raw={header:Ae,sectors:Me}),Wn}function g(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(be,"Header Signature: "),C.l+=16;var U=C.read_shift(2,"u");return[C.read_shift(2,"u"),U]}function y(C,U){var M=9;switch(C.l+=2,M=C.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function b(C,U){for(var M=Math.ceil(C.length/U)-1,F=[],B=1;B<M;++B)F[B-1]=C.slice(B*U,(B+1)*U);return F[M-1]=C.slice(M*U),F}function _(C,U,M){for(var F=0,B=0,H=0,le=0,pe=0,oe=M.length,ce=[],fe=[];F<oe;++F)ce[F]=fe[F]=F,U[F]=M[F];for(;pe<fe.length;++pe)F=fe[pe],B=C[F].L,H=C[F].R,le=C[F].C,ce[F]===F&&(B!==-1&&ce[B]!==B&&(ce[F]=ce[B]),H!==-1&&ce[H]!==H&&(ce[F]=ce[H])),le!==-1&&(ce[le]=F),B!==-1&&F!=ce[F]&&(ce[B]=ce[F],fe.lastIndexOf(B)<pe&&fe.push(B)),H!==-1&&F!=ce[F]&&(ce[H]=ce[F],fe.lastIndexOf(H)<pe&&fe.push(H));for(F=1;F<oe;++F)ce[F]===F&&(H!==-1&&ce[H]!==H?ce[F]=ce[H]:B!==-1&&ce[B]!==B&&(ce[F]=ce[B]));for(F=1;F<oe;++F)if(C[F].type!==0){if(pe=F,pe!=ce[pe])do pe=ce[pe],U[F]=U[pe]+"/"+U[F];while(pe!==0&&ce[pe]!==-1&&pe!=ce[pe]);ce[F]=-1}for(U[0]+="/",F=1;F<oe;++F)C[F].type!==2&&(U[F]+="/")}function w(C,U,M){for(var F=C.start,B=C.size,H=[],le=F;M&&B>0&&le>=0;)H.push(U.slice(le*q,le*q+q)),B-=q,le=ci(M,le*4);return H.length===0?sa(0):Ts(H).slice(0,C.size)}function T(C,U,M,F,B){var H=Q;if(C===Q){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var le=M[C],pe=(F>>>2)-1;if(!le)return;for(var oe=0;oe<pe&&(H=ci(le,oe*4))!==Q;++oe)B.push(H);T(ci(le,F-4),U-1,M,F,B)}}function A(C,U,M,F,B){var H=[],le=[];B||(B=[]);var pe=F-1,oe=0,ce=0;for(oe=U;oe>=0;){B[oe]=!0,H[H.length]=oe,le.push(C[oe]);var fe=M[Math.floor(oe*4/F)];if(ce=oe*4&pe,F<4+ce)throw new Error("FAT boundary crossed: "+oe+" 4 "+F);if(!C[fe])break;oe=ci(C[fe],ce)}return{nodes:H,data:Lb([le])}}function k(C,U,M,F){var B=C.length,H=[],le=[],pe=[],oe=[],ce=F-1,fe=0,Te=0,Ae=0,De=0;for(fe=0;fe<B;++fe)if(pe=[],Ae=fe+U,Ae>=B&&(Ae-=B),!le[Ae]){oe=[];var ke=[];for(Te=Ae;Te>=0;){ke[Te]=!0,le[Te]=!0,pe[pe.length]=Te,oe.push(C[Te]);var Ce=M[Math.floor(Te*4/F)];if(De=Te*4&ce,F<4+De)throw new Error("FAT boundary crossed: "+Te+" 4 "+F);if(!C[Ce]||(Te=ci(C[Ce],De),ke[Te]))break}H[Ae]={nodes:pe,data:Lb([oe])}}return H}function S(C,U,M,F,B,H,le,pe){for(var oe=0,ce=F.length?2:0,fe=U[C].data,Te=0,Ae=0,De;Te<fe.length;Te+=128){var ke=fe.slice(Te,Te+128);ya(ke,64),Ae=ke.read_shift(2),De=rx(ke,0,Ae-ce),F.push(De);var Ce={name:De,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},Me=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Me!==0&&(Ce.ct=L(ke,ke.l-8));var bt=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);bt!==0&&(Ce.mt=L(ke,ke.l-8)),Ce.start=ke.read_shift(4,"i"),Ce.size=ke.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=Q,Ce.name=""),Ce.type===5?(oe=Ce.start,B>0&&oe!==Q&&(U[oe].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",U[Ce.start]===void 0&&(U[Ce.start]=A(M,Ce.start,U.fat_addrs,U.ssz)),U[Ce.start].name=Ce.name,Ce.content=U[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:oe!==Q&&Ce.start!==Q&&U[oe]&&(Ce.content=w(Ce,U[oe].data,(U[pe]||{}).data))),Ce.content&&ya(Ce.content,0),H[De]=Ce,le.push(Ce)}}function L(C,U){return new Date((lr(C,U+4)/1e7*Math.pow(2,32)+lr(C,U)/1e7-11644473600)*1e3)}function V(C,U){return m(),p(h.readFileSync(C),U)}function P(C,U){var M=U&&U.type;switch(M||rt&&Buffer.isBuffer(C)&&(M="buffer"),M||"base64"){case"file":return V(C,U);case"base64":return p(Yr(hr(C)),U);case"binary":return p(Yr(C),U)}return p(C,U)}function N(C,U){var M=U||{},F=M.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),M.CLSID&&(C.FileIndex[0].clsid=M.CLSID),j(C)}function j(C){var U="Sh33tJ5";if(!nt.find(C,"/"+U)){var M=sa(4);M[0]=55,M[1]=M[3]=50,M[2]=54,C.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+U),I(C)}}function I(C,U){N(C);for(var M=!1,F=!1,B=C.FullPaths.length-1;B>=0;--B){var H=C.FileIndex[B];switch(H.type){case 0:F?M=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(H.R*H.L*H.C)&&(M=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var le=new Date(1987,1,19),pe=0,oe=Object.create?Object.create(null):{},ce=[];for(B=0;B<C.FullPaths.length;++B)oe[C.FullPaths[B]]=!0,C.FileIndex[B].type!==0&&ce.push([C.FullPaths[B],C.FileIndex[B]]);for(B=0;B<ce.length;++B){var fe=r(ce[B][0]);F=oe[fe],F||(ce.push([fe,{name:s(fe).replace("/",""),type:1,clsid:R,ct:le,mt:le,content:null}]),oe[fe]=!0)}for(ce.sort(function(De,ke){return a(De[0],ke[0])}),C.FullPaths=[],C.FileIndex=[],B=0;B<ce.length;++B)C.FullPaths[B]=ce[B][0],C.FileIndex[B]=ce[B][1];for(B=0;B<ce.length;++B){var Te=C.FileIndex[B],Ae=C.FullPaths[B];if(Te.name=s(Ae).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||R,B===0)Te.C=ce.length>1?1:-1,Te.size=0,Te.type=5;else if(Ae.slice(-1)=="/"){for(pe=B+1;pe<ce.length&&r(C.FullPaths[pe])!=Ae;++pe);for(Te.C=pe>=ce.length?-1:pe,pe=B+1;pe<ce.length&&r(C.FullPaths[pe])!=r(Ae);++pe);Te.R=pe>=ce.length?-1:pe,Te.type=1}else r(C.FullPaths[B+1]||"")==r(Ae)&&(Te.R=B+1),Te.type=2}}}function z(C,U){var M=U||{};if(M.fileType=="mad")return xf(C,M);if(I(C),M.fileType==="zip")return Ai(C,M);var F=(function(De){for(var ke=0,Ce=0,Me=0;Me<De.FileIndex.length;++Me){var bt=De.FileIndex[Me];if(bt.content){var wt=bt.content.length;wt>0&&(wt<4096?ke+=wt+63>>6:Ce+=wt+511>>9)}}for(var Ot=De.FullPaths.length+3>>2,pr=ke+7>>3,Is=ke+127>>7,Wn=pr+Ce+Ot+Is,tn=Wn+127>>7,ql=tn<=109?0:Math.ceil((tn-109)/127);Wn+tn+ql+127>>7>tn;)ql=++tn<=109?0:Math.ceil((tn-109)/127);var $a=[1,ql,tn,Is,Ot,Ce,ke,0];return De.FileIndex[0].size=ke<<6,$a[7]=(De.FileIndex[0].start=$a[0]+$a[1]+$a[2]+$a[3]+$a[4]+$a[5])+($a[6]+7>>3),$a})(C),B=sa(F[7]<<9),H=0,le=0;{for(H=0;H<8;++H)B.write_shift(1,ve[H]);for(H=0;H<8;++H)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),H=0;H<3;++H)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,F[2]),B.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:Q),B.write_shift(4,F[3]),B.write_shift(-4,F[1]?F[0]-1:Q),B.write_shift(4,F[1]),H=0;H<109;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1)}if(F[1])for(le=0;le<F[1];++le){for(;H<236+le*127;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1);B.write_shift(-4,le===F[1]-1?Q:le+1)}var pe=function(De){for(le+=De;H<le-1;++H)B.write_shift(-4,H+1);De&&(++H,B.write_shift(-4,Q))};for(le=H=0,le+=F[1];H<le;++H)B.write_shift(-4,te.DIFSECT);for(le+=F[2];H<le;++H)B.write_shift(-4,te.FATSECT);pe(F[3]),pe(F[4]);for(var oe=0,ce=0,fe=C.FileIndex[0];oe<C.FileIndex.length;++oe)fe=C.FileIndex[oe],fe.content&&(ce=fe.content.length,!(ce<4096)&&(fe.start=le,pe(ce+511>>9)));for(pe(F[6]+7>>3);B.l&511;)B.write_shift(-4,te.ENDOFCHAIN);for(le=H=0,oe=0;oe<C.FileIndex.length;++oe)fe=C.FileIndex[oe],fe.content&&(ce=fe.content.length,!(!ce||ce>=4096)&&(fe.start=le,pe(ce+63>>6)));for(;B.l&511;)B.write_shift(-4,te.ENDOFCHAIN);for(H=0;H<F[4]<<2;++H){var Te=C.FullPaths[H];if(!Te||Te.length===0){for(oe=0;oe<17;++oe)B.write_shift(4,0);for(oe=0;oe<3;++oe)B.write_shift(4,-1);for(oe=0;oe<12;++oe)B.write_shift(4,0);continue}fe=C.FileIndex[H],H===0&&(fe.start=fe.size?fe.start-1:Q);var Ae=H===0&&M.root||fe.name;if(ce=2*(Ae.length+1),B.write_shift(64,Ae,"utf16le"),B.write_shift(2,ce),B.write_shift(1,fe.type),B.write_shift(1,fe.color),B.write_shift(-4,fe.L),B.write_shift(-4,fe.R),B.write_shift(-4,fe.C),fe.clsid)B.write_shift(16,fe.clsid,"hex");else for(oe=0;oe<4;++oe)B.write_shift(4,0);B.write_shift(4,fe.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,fe.start),B.write_shift(4,fe.size),B.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>=4096)if(B.l=fe.start+1<<9,rt&&Buffer.isBuffer(fe.content))fe.content.copy(B,B.l,0,fe.size),B.l+=fe.size+511&-512;else{for(oe=0;oe<fe.size;++oe)B.write_shift(1,fe.content[oe]);for(;oe&511;++oe)B.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>0&&fe.size<4096)if(rt&&Buffer.isBuffer(fe.content))fe.content.copy(B,B.l,0,fe.size),B.l+=fe.size+63&-64;else{for(oe=0;oe<fe.size;++oe)B.write_shift(1,fe.content[oe]);for(;oe&63;++oe)B.write_shift(1,0)}if(rt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function X(C,U){var M=C.FullPaths.map(function(oe){return oe.toUpperCase()}),F=M.map(function(oe){var ce=oe.split("/");return ce[ce.length-(oe.slice(-1)=="/"?2:1)]}),B=!1;U.charCodeAt(0)===47?(B=!0,U=M[0].slice(0,-1)+U):B=U.indexOf("/")!==-1;var H=U.toUpperCase(),le=B===!0?M.indexOf(H):F.indexOf(H);if(le!==-1)return C.FileIndex[le];var pe=!H.match(Ho);for(H=H.replace(Ua,""),pe&&(H=H.replace(Ho,"!")),le=0;le<M.length;++le)if((pe?M[le].replace(Ho,"!"):M[le]).replace(Ua,"")==H||(pe?F[le].replace(Ho,"!"):F[le]).replace(Ua,"")==H)return C.FileIndex[le];return null}var q=64,Q=-2,be="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],R="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:R,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(C,U,M){m();var F=z(C,M);h.writeFileSync(U,F)}function ae(C){for(var U=new Array(C.length),M=0;M<C.length;++M)U[M]=String.fromCharCode(C[M]);return U.join("")}function Ee(C,U){var M=z(C,U);switch(U&&U.type||"buffer"){case"file":return m(),h.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:ae(M);case"base64":return vb(typeof M=="string"?M:ae(M));case"buffer":if(rt)return Buffer.isBuffer(M)?M:bi(M);case"array":return typeof M=="string"?Yr(M):M}return M}var G;function O(C){try{var U=C.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)G=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function Z(C,U){if(!G)return Vc(C,U);var M=G.InflateRaw,F=new M,B=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,B}function W(C){return G?G.deflateRawSync(C):Ye(C)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(C){var U=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(U>>16|U>>8|U)&255}for(var _e=typeof Uint8Array<"u",Se=_e?new Uint8Array(256):[],Je=0;Je<256;++Je)Se[Je]=Ne(Je);function Y(C,U){var M=Se[C&255];return U<=8?M>>>8-U:(M=M<<8|Se[C>>8&255],U<=16?M>>>16-U:(M=M<<8|Se[C>>16&255],M>>>24-U))}function Nt(C,U){var M=U&7,F=U>>>3;return(C[F]|(M<=6?0:C[F+1]<<8))>>>M&3}function Ke(C,U){var M=U&7,F=U>>>3;return(C[F]|(M<=5?0:C[F+1]<<8))>>>M&7}function ct(C,U){var M=U&7,F=U>>>3;return(C[F]|(M<=4?0:C[F+1]<<8))>>>M&15}function We(C,U){var M=U&7,F=U>>>3;return(C[F]|(M<=3?0:C[F+1]<<8))>>>M&31}function Oe(C,U){var M=U&7,F=U>>>3;return(C[F]|(M<=1?0:C[F+1]<<8))>>>M&127}function Ct(C,U,M){var F=U&7,B=U>>>3,H=(1<<M)-1,le=C[B]>>>F;return M<8-F||(le|=C[B+1]<<8-F,M<16-F)||(le|=C[B+2]<<16-F,M<24-F)||(le|=C[B+3]<<24-F),le&H}function _a(C,U,M){var F=U&7,B=U>>>3;return F<=5?C[B]|=(M&7)<<F:(C[B]|=M<<F&255,C[B+1]=(M&7)>>8-F),U+3}function Va(C,U,M){var F=U&7,B=U>>>3;return M=(M&1)<<F,C[B]|=M,U+1}function Qa(C,U,M){var F=U&7,B=U>>>3;return M<<=F,C[B]|=M&255,M>>>=8,C[B+1]=M,U+8}function Ms(C,U,M){var F=U&7,B=U>>>3;return M<<=F,C[B]|=M&255,M>>>=8,C[B+1]=M&255,C[B+2]=M>>>8,U+16}function en(C,U){var M=C.length,F=2*M>U?2*M:U+5,B=0;if(M>=U)return C;if(rt){var H=yb(F);if(C.copy)C.copy(H);else for(;B<C.length;++B)H[B]=C[B];return H}else if(_e){var le=new Uint8Array(F);if(le.set)le.set(C);else for(;B<M;++B)le[B]=C[B];return le}return C.length=F,C}function gt(C){for(var U=new Array(C),M=0;M<C;++M)U[M]=0;return U}function Fr(C,U,M){var F=1,B=0,H=0,le=0,pe=0,oe=C.length,ce=_e?new Uint16Array(32):gt(32);for(H=0;H<32;++H)ce[H]=0;for(H=oe;H<M;++H)C[H]=0;oe=C.length;var fe=_e?new Uint16Array(oe):gt(oe);for(H=0;H<oe;++H)ce[B=C[H]]++,F<B&&(F=B),fe[H]=0;for(ce[0]=0,H=1;H<=F;++H)ce[H+16]=pe=pe+ce[H-1]<<1;for(H=0;H<oe;++H)pe=C[H],pe!=0&&(fe[H]=ce[pe+16]++);var Te=0;for(H=0;H<oe;++H)if(Te=C[H],Te!=0)for(pe=Y(fe[H],F)>>F-Te,le=(1<<F+4-Te)-1;le>=0;--le)U[pe|le<<Te]=Te&15|H<<4;return F}var Lr=_e?new Uint16Array(512):gt(512),qn=_e?new Uint16Array(32):gt(32);if(!_e){for(var qt=0;qt<512;++qt)Lr[qt]=0;for(qt=0;qt<32;++qt)qn[qt]=0}(function(){for(var C=[],U=0;U<32;U++)C.push(5);Fr(C,qn,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);Fr(M,Lr,288)})();var dr=(function(){for(var U=_e?new Uint8Array(32768):[],M=0,F=0;M<we.length-1;++M)for(;F<we[M+1];++F)U[F]=M;for(;F<32768;++F)U[F]=29;var B=_e?new Uint8Array(259):[];for(M=0,F=0;M<he.length-1;++M)for(;F<he[M+1];++F)B[F]=M;function H(pe,oe){for(var ce=0;ce<pe.length;){var fe=Math.min(65535,pe.length-ce),Te=ce+fe==pe.length;for(oe.write_shift(1,+Te),oe.write_shift(2,fe),oe.write_shift(2,~fe&65535);fe-- >0;)oe[oe.l++]=pe[ce++]}return oe.l}function le(pe,oe){for(var ce=0,fe=0,Te=_e?new Uint16Array(32768):[];fe<pe.length;){var Ae=Math.min(65535,pe.length-fe);if(Ae<10){for(ce=_a(oe,ce,+(fe+Ae==pe.length)),ce&7&&(ce+=8-(ce&7)),oe.l=ce/8|0,oe.write_shift(2,Ae),oe.write_shift(2,~Ae&65535);Ae-- >0;)oe[oe.l++]=pe[fe++];ce=oe.l*8;continue}ce=_a(oe,ce,+(fe+Ae==pe.length)+2);for(var De=0;Ae-- >0;){var ke=pe[fe];De=(De<<5^ke)&32767;var Ce=-1,Me=0;if((Ce=Te[De])&&(Ce|=fe&-32768,Ce>fe&&(Ce-=32768),Ce<fe))for(;pe[Ce+Me]==pe[fe+Me]&&Me<250;)++Me;if(Me>2){ke=B[Me],ke<=22?ce=Qa(oe,ce,Se[ke+1]>>1)-1:(Qa(oe,ce,3),ce+=5,Qa(oe,ce,Se[ke-23]>>5),ce+=3);var bt=ke<8?0:ke-4>>2;bt>0&&(Ms(oe,ce,Me-he[ke]),ce+=bt),ke=U[fe-Ce],ce=Qa(oe,ce,Se[ke]>>3),ce-=3;var wt=ke<4?0:ke-2>>1;wt>0&&(Ms(oe,ce,fe-Ce-we[ke]),ce+=wt);for(var Ot=0;Ot<Me;++Ot)Te[De]=fe&32767,De=(De<<5^pe[fe])&32767,++fe;Ae-=Me-1}else ke<=143?ke=ke+48:ce=Va(oe,ce,1),ce=Qa(oe,ce,Se[ke]),Te[De]=fe&32767,++fe}ce=Qa(oe,ce,0)-1}return oe.l=(ce+7)/8|0,oe.l}return function(oe,ce){return oe.length<8?H(oe,ce):le(oe,ce)}})();function Ye(C){var U=sa(50+Math.floor(C.length*1.1)),M=dr(C,U);return U.slice(0,M)}var Rt=_e?new Uint16Array(32768):gt(32768),Ha=_e?new Uint16Array(32768):gt(32768),St=_e?new Uint16Array(128):gt(128),Vt=1,Pr=1;function Ra(C,U){var M=We(C,U)+257;U+=5;var F=We(C,U)+1;U+=5;var B=ct(C,U)+4;U+=4;for(var H=0,le=_e?new Uint8Array(19):gt(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ce=_e?new Uint8Array(8):gt(8),fe=_e?new Uint8Array(8):gt(8),Te=le.length,Ae=0;Ae<B;++Ae)le[J[Ae]]=H=Ke(C,U),oe<H&&(oe=H),ce[H]++,U+=3;var De=0;for(ce[0]=0,Ae=1;Ae<=oe;++Ae)fe[Ae]=De=De+ce[Ae-1]<<1;for(Ae=0;Ae<Te;++Ae)(De=le[Ae])!=0&&(pe[Ae]=fe[De]++);var ke=0;for(Ae=0;Ae<Te;++Ae)if(ke=le[Ae],ke!=0){De=Se[pe[Ae]]>>8-ke;for(var Ce=(1<<7-ke)-1;Ce>=0;--Ce)St[De|Ce<<ke]=ke&7|Ae<<3}var Me=[];for(oe=1;Me.length<M+F;)switch(De=St[Oe(C,U)],U+=De&7,De>>>=3){case 16:for(H=3+Nt(C,U),U+=2,De=Me[Me.length-1];H-- >0;)Me.push(De);break;case 17:for(H=3+Ke(C,U),U+=3;H-- >0;)Me.push(0);break;case 18:for(H=11+Oe(C,U),U+=7;H-- >0;)Me.push(0);break;default:Me.push(De),oe<De&&(oe=De);break}var bt=Me.slice(0,M),wt=Me.slice(M);for(Ae=M;Ae<286;++Ae)bt[Ae]=0;for(Ae=F;Ae<30;++Ae)wt[Ae]=0;return Vt=Fr(bt,Rt,286),Pr=Fr(wt,Ha,30),U}function mf(C,U){if(C[0]==3&&!(C[1]&3))return[Os(U),2];for(var M=0,F=0,B=yb(U||1<<18),H=0,le=B.length>>>0,pe=0,oe=0;(F&1)==0;){if(F=Ke(C,M),M+=3,F>>>1)F>>1==1?(pe=9,oe=5):(M=Ra(C,M),pe=Vt,oe=Pr);else{M&7&&(M+=8-(M&7));var ce=C[M>>>3]|C[(M>>>3)+1]<<8;if(M+=32,ce>0)for(!U&&le<H+ce&&(B=en(B,H+ce),le=B.length);ce-- >0;)B[H++]=C[M>>>3],M+=8;continue}for(;;){!U&&le<H+32767&&(B=en(B,H+32767),le=B.length);var fe=Ct(C,M,pe),Te=F>>>1==1?Lr[fe]:Rt[fe];if(M+=Te&15,Te>>>=4,(Te>>>8&255)===0)B[H++]=Te;else{if(Te==256)break;Te-=257;var Ae=Te<8?0:Te-4>>2;Ae>5&&(Ae=0);var De=H+he[Te];Ae>0&&(De+=Ct(C,M,Ae),M+=Ae),fe=Ct(C,M,oe),Te=F>>>1==1?qn[fe]:Ha[fe],M+=Te&15,Te>>>=4;var ke=Te<4?0:Te-2>>1,Ce=we[Te];for(ke>0&&(Ce+=Ct(C,M,ke),M+=ke),!U&&le<De&&(B=en(B,De+100),le=B.length);H<De;)B[H]=B[H-Ce],++H}}}return U?[B,M+7>>>3]:[B.slice(0,H),M+7>>>3]}function Vc(C,U){var M=C.slice(C.l||0),F=mf(M,U);return C.l+=F[1],F[0]}function Hc(C,U){if(C)typeof console<"u"&&console.error(U);else throw new Error(U)}function Fs(C,U){var M=C;ya(M,0);var F=[],B=[],H={FileIndex:F,FullPaths:B};N(H,{root:U.root});for(var le=M.length-4;(M[le]!=80||M[le+1]!=75||M[le+2]!=5||M[le+3]!=6)&&le>=0;)--le;M.l=le+4,M.l+=4;var pe=M.read_shift(2);M.l+=6;var oe=M.read_shift(4);for(M.l=oe,le=0;le<pe;++le){M.l+=20;var ce=M.read_shift(4),fe=M.read_shift(4),Te=M.read_shift(2),Ae=M.read_shift(2),De=M.read_shift(2);M.l+=8;var ke=M.read_shift(4),Ce=u(M.slice(M.l+Te,M.l+Te+Ae));M.l+=Te+Ae+De;var Me=M.l;M.l=ke+4,ki(M,ce,fe,H,Ce),M.l=Me}return H}function ki(C,U,M,F,B){C.l+=2;var H=C.read_shift(2),le=C.read_shift(2),pe=c(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var oe=C.read_shift(4),ce=C.read_shift(4),fe=C.read_shift(4),Te=C.read_shift(2),Ae=C.read_shift(2),De="",ke=0;ke<Te;++ke)De+=String.fromCharCode(C[C.l++]);if(Ae){var Ce=u(C.slice(C.l,C.l+Ae));(Ce[21589]||{}).mt&&(pe=Ce[21589].mt),((B||{})[21589]||{}).mt&&(pe=B[21589].mt)}C.l+=Ae;var Me=C.slice(C.l,C.l+ce);switch(le){case 8:Me=Z(C,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var bt=!1;H&8&&(oe=C.read_shift(4),oe==134695760&&(oe=C.read_shift(4),bt=!0),ce=C.read_shift(4),fe=C.read_shift(4)),ce!=U&&Hc(bt,"Bad compressed size: "+U+" != "+ce),fe!=M&&Hc(bt,"Bad uncompressed size: "+M+" != "+fe),Ci(F,De,Me,{unsafe:!0,mt:pe})}function Ai(C,U){var M=U||{},F=[],B=[],H=sa(1),le=M.compression?8:0,pe=0,oe=0,ce=0,fe=0,Te=0,Ae=C.FullPaths[0],De=Ae,ke=C.FileIndex[0],Ce=[],Me=0;for(oe=1;oe<C.FullPaths.length;++oe)if(De=C.FullPaths[oe].slice(Ae.length),ke=C.FileIndex[oe],!(!ke.size||!ke.content||De=="Sh33tJ5")){var bt=fe,wt=sa(De.length);for(ce=0;ce<De.length;++ce)wt.write_shift(1,De.charCodeAt(ce)&127);wt=wt.slice(0,wt.l),Ce[Te]=hM.buf(ke.content,0);var Ot=ke.content;le==8&&(Ot=W(Ot)),H=sa(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,pe),H.write_shift(2,le),ke.mt?l(H,ke.mt):H.write_shift(4,0),H.write_shift(-4,Ce[Te]),H.write_shift(4,Ot.length),H.write_shift(4,ke.content.length),H.write_shift(2,wt.length),H.write_shift(2,0),fe+=H.length,F.push(H),fe+=wt.length,F.push(wt),fe+=Ot.length,F.push(Ot),H=sa(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,pe),H.write_shift(2,le),H.write_shift(4,0),H.write_shift(-4,Ce[Te]),H.write_shift(4,Ot.length),H.write_shift(4,ke.content.length),H.write_shift(2,wt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,bt),Me+=H.l,B.push(H),Me+=wt.length,B.push(wt),++Te}return H=sa(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Te),H.write_shift(2,Te),H.write_shift(4,Me),H.write_shift(4,fe),H.write_shift(2,0),Ts([Ts(F),Ts(B),H])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ni(C,U){if(C.ctype)return C.ctype;var M=C.name||"",F=M.match(/\.([^\.]+)$/);return F&&mr[F[1]]||U&&(F=(M=U).match(/[\.\\]([^\.\\])+$/),F&&mr[F[1]])?mr[F[1]]:"application/octet-stream"}function Ls(C){for(var U=vb(C),M=[],F=0;F<U.length;F+=76)M.push(U.slice(F,F+76));return M.join(`\r
`)+`\r
`}function pf(C){var U=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var fe=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],F=U.split(`\r
`),B=0;B<F.length;++B){var H=F[B];if(H.length==0){M.push("");continue}for(var le=0;le<H.length;){var pe=76,oe=H.slice(le,le+pe);oe.charAt(pe-1)=="="?pe--:oe.charAt(pe-2)=="="?pe-=2:oe.charAt(pe-3)=="="&&(pe-=3),oe=H.slice(le,le+pe),le+=pe,le<H.length&&(oe+="="),M.push(oe)}}return M.join(`\r
`)}function $c(C){for(var U=[],M=0;M<C.length;++M){for(var F=C[M];M<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++M];U.push(F)}for(var B=0;B<U.length;++B)U[B]=U[B].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Yr(U.join(`\r
`))}function Hl(C,U,M){for(var F="",B="",H="",le,pe=0;pe<10;++pe){var oe=U[pe];if(!oe||oe.match(/^\s*$/))break;var ce=oe.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":F=ce[2].trim();break;case"content-type":H=ce[2].trim();break;case"content-transfer-encoding":B=ce[2].trim();break}}switch(++pe,B.toLowerCase()){case"base64":le=Yr(hr(U.slice(pe).join("")));break;case"quoted-printable":le=$c(U.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var fe=Ci(C,F.slice(M.length),le,{unsafe:!0});H&&(fe.ctype=H)}function Ps(C,U){if(ae(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",F=(rt&&Buffer.isBuffer(C)?C.toString("binary"):ae(C)).split(`\r
`),B=0,H="";for(B=0;B<F.length;++B)if(H=F[B],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),M||(M=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),H.slice(0,M.length)!=M););var le=(F[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var pe="--"+(le[1]||""),oe=[],ce=[],fe={FileIndex:oe,FullPaths:ce};N(fe);var Te,Ae=0;for(B=0;B<F.length;++B){var De=F[B];De!==pe&&De!==pe+"--"||(Ae++&&Hl(fe,F.slice(Te,B),M),Te=B)}return fe}function xf(C,U){var M=U||{},F=M.boundary||"SheetJS";F="------="+F;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],H=C.FullPaths[0],le=H,pe=C.FileIndex[0],oe=1;oe<C.FullPaths.length;++oe)if(le=C.FullPaths[oe].slice(H.length),pe=C.FileIndex[oe],!(!pe.size||!pe.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var ce=pe.content,fe=rt&&Buffer.isBuffer(ce)?ce.toString("binary"):ae(ce),Te=0,Ae=Math.min(1024,fe.length),De=0,ke=0;ke<=Ae;++ke)(De=fe.charCodeAt(ke))>=32&&De<128&&++Te;var Ce=Te>=Ae*4/5;B.push(F),B.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+le),B.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),B.push("Content-Type: "+Ni(pe,le)),B.push(""),B.push(Ce?pf(fe):Ls(fe))}return B.push(F+`--\r
`),B.join(`\r
`)}function Gc(C){var U={};return N(U,C),U}function Ci(C,U,M,F){var B=F&&F.unsafe;B||N(C);var H=!B&&nt.find(C,U);if(!H){var le=C.FullPaths[0];U.slice(0,le.length)==le?le=U:(le.slice(-1)!="/"&&(le+="/"),le=(le+U).replace("//","/")),H={name:s(U),type:2},C.FileIndex.push(H),C.FullPaths.push(le),B||nt.utils.cfb_gc(C)}return H.content=M,H.size=M?M.length:0,F&&(F.CLSID&&(H.clsid=F.CLSID),F.mt&&(H.mt=F.mt),F.ct&&(H.ct=F.ct)),H}function qc(C,U){N(C);var M=nt.find(C,U);if(M){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==M)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function $l(C,U,M){N(C);var F=nt.find(C,U);if(F){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==F)return C.FileIndex[B].name=s(M),C.FullPaths[B]=M,!0}return!1}function Gl(C){I(C,!0)}return t.find=X,t.read=P,t.parse=p,t.write=Ee,t.writeFile=ye,t.utils={cfb_new:Gc,cfb_add:Ci,cfb_del:qc,cfb_mov:$l,cfb_gc:Gl,ReadShift:Qo,CheckField:xS,prep_blob:ya,bconcat:Ts,use_zlib:O,_deflateRaw:Ye,_inflateRaw:Vc,consts:te},t})();function dM(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var a=t.read();return t.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function pn(e){for(var t=Object.keys(e),a=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&a.push(t[r]);return a}function Zp(e){for(var t=[],a=pn(e),r=0;r!==a.length;++r)t[e[a[r]]]=a[r];return t}var G0=new Date(1899,11,30,0,0,0);function za(e,t){var a=e.getTime(),r=G0.getTime()+(e.getTimezoneOffset()-G0.getTimezoneOffset())*6e4;return(a-r)/(1440*60*1e3)}var XT=new Date,mM=G0.getTime()+(XT.getTimezoneOffset()-G0.getTimezoneOffset())*6e4,Ab=XT.getTimezoneOffset();function uf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+mM),t.getTimezoneOffset()!==Ab&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ab)*6e4),t}function pM(e){var t=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(a=1,l>3&&(r=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=a*parseInt(s[l],10)}return t}var Nb=new Date("2017-02-19T19:06:09.000Z"),KT=isNaN(Nb.getFullYear())?new Date("2/19/17"):Nb,xM=KT.getFullYear()==2017;function ua(e,t){var a=new Date(e);if(xM)return t>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):t<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(KT.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function vi(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Go(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Go(LT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Go(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Go(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return a[l]||l})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function ba(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=ba(e[a]));return t}function Ut(e,t){for(var a="";a.length<t;)a+=e;return a}function Jr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,l){return a=-a,l}),!isNaN(t=Number(r)))?t/a:t}var gM=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fl(e){var t=new Date(e),a=new Date(NaN),r=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return a;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&gM.indexOf(c)==-1)return a}else if(c.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||l>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?a:t}var vM=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var l=a.split(r),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function JT(e){return e?e.content&&e.type?vi(e.content,!0):e.data?Vo(e.data):e.asNodeBuffer&&rt?Vo(e.asNodeBuffer().toString("binary")):e.asBinary?Vo(e.asBinary()):e._data&&e._data.getContent?Vo(vi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function QT(e){if(!e)return null;if(e.data)return xb(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?xb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function yM(e){return e&&e.name.slice(-4)===".bin"?QT(e):JT(e)}function Cr(e,t){for(var a=e.FullPaths||pn(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),l=0;l<a.length;++l){var c=a[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==c||s==c)return e.files?e.files[a[l]]:e.FileIndex[l]}return null}function ex(e,t){var a=Cr(e,t);if(a==null)throw new Error("Cannot find file "+t+" in zip");return a}function Qt(e,t,a){if(!a)return yM(ex(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function fr(e,t,a){if(!a)return JT(ex(e,t));if(!t)return null;try{return fr(e,t)}catch{return null}}function bM(e,t,a){return QT(ex(e,t))}function Cb(e){for(var t=e.FullPaths||pn(e.files),a=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&a.push(t[r].replace(/^Root Entry[\/]/,""));return a.sort()}function wM(e,t,a){if(e.FullPaths){if(typeof a=="string"){var r;return rt?r=bi(a):r=UR(a),nt.utils.cfb_add(e,t,r)}nt.utils.cfb_add(e,t,a)}else e.file(t,a)}function ZT(e,t){switch(t.type){case"base64":return nt.read(e,{type:"base64"});case"binary":return nt.read(e,{type:"binary"});case"buffer":case"array":return nt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function $o(e,t){if(e.charAt(0)=="/")return e.slice(1);var a=t.split("/");t.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var eS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_M=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ob=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,TM=/<[^>]*>/g,ja=eS.match(Ob)?Ob:TM,SM=/<\w*:/,EM=/<(\/?)\w+:/;function Ve(e,t,a){for(var r={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(r[0]=e.slice(0,s)),s===e.length)return r;var c=e.match(_M),u=0,h="",m=0,p="",g="",y=1;if(c)for(m=0;m!=c.length;++m){for(g=c[m],l=0;l!=g.length&&g.charCodeAt(l)!==61;++l);for(p=g.slice(0,l).trim();g.charCodeAt(l+1)==32;)++l;for(y=(s=g.charCodeAt(l+1))==34||s==39?1:0,h=g.slice(l+1+y,g.length-y),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=h,r[p.toLowerCase()]=h;else{var b=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(r[b]&&p.slice(u-3,u)=="ext")continue;r[b]=h,r[b.toLowerCase()]=h}}return r}function xn(e){return e.replace(EM,"<$1")}var tS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kM=Zp(tS),it=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return tS[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return a(s.slice(0,l))+s.slice(l+9,c)+a(s.slice(c+3))}})(),AM=/[&<>'"]/g,NM=/[\u0000-\u001f]/g;function tx(e){var t=e+"";return t.replace(AM,function(a){return kM[a]}).replace(/\n/g,"<br/>").replace(NM,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var Db=(function(){var e=/&#(\d+);/g;function t(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}})();function jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nm(e){for(var t="",a=0,r=0,s=0,l=0,c=0,u=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){t+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){c=(r&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(a++),r<240){t+=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(a++),u=((r&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function jb(e){var t=Os(2*e.length),a,r,s=1,l=0,c=0,u;for(r=0;r<e.length;r+=s)s=1,(u=e.charCodeAt(r))<128?a=u:u<224?(a=(u&31)*64+(e.charCodeAt(r+1)&63),s=2):u<240?(a=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,c=55296+(a>>>10&1023),a=56320+(a&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=a%256,t[l++]=a>>>8;return t.slice(0,l).toString("ucs2")}function Rb(e){return bi(e,"binary").toString("utf8")}var p0="foo bar baz",Tt=rt&&(Rb(p0)==nm(p0)&&Rb||jb(p0)==nm(p0)&&jb)||nm,Go=rt?function(e){return bi(e,"utf8").toString("binary")}:function(e){for(var t=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Sc=(function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}})(),aS=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),CM=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),OM=/<\/?(?:vt:)?variant>/g,DM=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mb(e,t){var a=Ve(e),r=e.match(CM(a.baseType))||[],s=[];if(r.length!=a.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(l){var c=l.replace(OM,"").match(DM);c&&s.push({v:Tt(c[2]),t:c[1]})}),s}var jM=/(^\s|\s$|\n)/;function RM(e){return pn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function MM(e,t,a){return"<"+e+(a!=null?RM(a):"")+(t!=null?(t.match(jM)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ax(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Tt(wi(Kp(e)));throw new Error("Bad input format: expected Buffer or string")}var Ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,FM={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},LM=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function PM(e,t){for(var a=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function IM(e,t,a){var r=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=r?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[a+u]=l&255;e[a+6]=(s&15)<<4|l&15,e[a+7]=s>>4|r}var Fb=function(e){for(var t=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,l=e[0][r].length;s<l;s+=a)t.push.apply(t,e[0][r].slice(s,s+a));return t},Lb=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:bi(t)})):Fb(e)}:Fb,Pb=function(e,t,a){for(var r=[],s=t;s<a;s+=2)r.push(String.fromCharCode(Pn(e,s)));return r.join("").replace(Ua,"")},rx=rt?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf16le",t,a).replace(Ua,""):Pb(e,t,a)}:Pb,Ib=function(e,t,a){for(var r=[],s=t;s<t+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},rS=rt?function(e,t,a){return Buffer.isBuffer(e)?e.toString("hex",t,t+a):Ib(e,t,a)}:Ib,Bb=function(e,t,a){for(var r=[],s=t;s<a;s++)r.push(String.fromCharCode(bl(e,s)));return r.join("")},Lc=rt?function(t,a,r){return Buffer.isBuffer(t)?t.toString("utf8",a,r):Bb(t,a,r)}:Bb,nS=function(e,t){var a=lr(e,t);return a>0?Lc(e,t+4,t+4+a-1):""},sS=nS,iS=function(e,t){var a=lr(e,t);return a>0?Lc(e,t+4,t+4+a-1):""},lS=iS,oS=function(e,t){var a=2*lr(e,t);return a>0?Lc(e,t+4,t+4+a-1):""},cS=oS,uS=function(t,a){var r=lr(t,a);return r>0?rx(t,a+4,a+4+r):""},fS=uS,hS=function(e,t){var a=lr(e,t);return a>0?Lc(e,t+4,t+4+a):""},dS=hS,mS=function(e,t){return PM(e,t)},q0=mS,pS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(sS=function(t,a){if(!Buffer.isBuffer(t))return nS(t,a);var r=t.readUInt32LE(a);return r>0?t.toString("utf8",a+4,a+4+r-1):""},lS=function(t,a){if(!Buffer.isBuffer(t))return iS(t,a);var r=t.readUInt32LE(a);return r>0?t.toString("utf8",a+4,a+4+r-1):""},cS=function(t,a){if(!Buffer.isBuffer(t))return oS(t,a);var r=2*t.readUInt32LE(a);return t.toString("utf16le",a+4,a+4+r-1)},fS=function(t,a){if(!Buffer.isBuffer(t))return uS(t,a);var r=t.readUInt32LE(a);return t.toString("utf16le",a+4,a+4+r)},dS=function(t,a){if(!Buffer.isBuffer(t))return hS(t,a);var r=t.readUInt32LE(a);return t.toString("utf8",a+4,a+4+r)},q0=function(t,a){return Buffer.isBuffer(t)?t.readDoubleLE(a):mS(t,a)},pS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var bl=function(e,t){return e[t]},Pn=function(e,t){return e[t+1]*256+e[t]},BM=function(e,t){var a=e[t+1]*256+e[t];return a<32768?a:(65535-a+1)*-1},lr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ci=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},UM=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Qo(e,t){var a="",r,s,l=[],c,u,h,m;switch(t){case"dbcs":if(m=this.l,rt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)a+=String.fromCharCode(Pn(this,m)),m+=2;e*=2;break;case"utf8":a=Lc(this,this.l,this.l+e);break;case"utf16le":e*=2,a=rx(this,this.l,this.l+e);break;case"wstr":return Qo.call(this,e,"dbcs");case"lpstr-ansi":a=sS(this,this.l),e=4+lr(this,this.l);break;case"lpstr-cp":a=lS(this,this.l),e=4+lr(this,this.l);break;case"lpwstr":a=cS(this,this.l),e=4+2*lr(this,this.l);break;case"lpp4":e=4+lr(this,this.l),a=fS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+lr(this,this.l),a=dS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(c=bl(this,this.l+e++))!==0;)l.push(m0(c));a=l.join("");break;case"_wstr":for(e=0,a="";(c=Pn(this,this.l+e))!==0;)l.push(m0(c)),e+=2;e+=2,a=l.join("");break;case"dbcs-cont":for(a="",m=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=bl(this,m),this.l=m+1,u=Qo.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(m0(Pn(this,m))),m+=2}a=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",m=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=bl(this,m),this.l=m+1,u=Qo.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(m0(bl(this,m))),m+=1}a=l.join("");break;default:switch(e){case 1:return r=bl(this,this.l),this.l++,r;case 2:return r=(t==="i"?BM:Pn)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?ci:UM)(this,this.l),this.l+=4,r):(s=lr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=q0(this,this.l):s=q0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=rS(this,this.l,e);break}}return this.l+=e,a}var zM=function(e,t,a){e[a]=t&255,e[a+1]=t>>>8&255,e[a+2]=t>>>16&255,e[a+3]=t>>>24&255},VM=function(e,t,a){e[a]=t&255,e[a+1]=t>>8&255,e[a+2]=t>>16&255,e[a+3]=t>>24&255},HM=function(e,t,a){e[a]=t&255,e[a+1]=t>>>8&255};function $M(e,t,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=t.length;++s)HM(this,t.charCodeAt(s),this.l+2*s);r=2*t.length}else if(a==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;r=t.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,zM(this,t,this.l);break;case 8:if(r=8,a==="f"){IM(this,t,this.l);break}case 16:break;case-4:r=4,VM(this,t,this.l);break}return this.l+=r,this}function xS(e,t){var a=rS(this,this.l,e.length>>1);if(a!==e)throw new Error(t+"Expected "+e+" saw "+a);this.l+=e.length>>1}function ya(e,t){e.l=t,e.read_shift=Qo,e.chk=xS,e.write_shift=$M}function Da(e,t){e.l+=t}function sa(e){var t=Os(e);return ya(t,0),t}function Gn(e,t,a){if(e){var r,s,l;ya(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var m=Q0[u]||Q0[65535];for(r=e.read_shift(1),l=r&127,s=1;s<4&&r&128;++s)l+=((r=e.read_shift(1))&127)<<7*s;h=e.l+l;var p=m.f&&m.f(e,l,a);if(e.l=h,t(p,m,u))return}}}function Km(){var e=[],t=rt?256:2048,a=function(m){var p=sa(m);return ya(p,0),p},r=a(t),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(m){return r&&m<r.length-r.l?r:(s(),r=a(Math.max(m+1,t)))},c=function(){return s(),Ts(e)},u=function(m){s(),r=m,r.l==null&&(r.l=r.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Zo(e,t,a){var r=ba(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ub(e,t,a){var r=ba(e);return r.s=Zo(r.s,t.s,a),r.e=Zo(r.e,t.s,a),r}function ec(e,t){if(e.cRel&&e.c<0)for(e=ba(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ba(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var a=$e(e);return!e.cRel&&e.cRel!=null&&(a=WM(a)),!e.rRel&&e.rRel!=null&&(a=GM(a)),a}function sm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ia(e.s.c)+":"+(e.e.cRel?"":"$")+ia(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wa(e.s.r)+":"+(e.e.rRel?"":"$")+wa(e.e.r):ec(e.s,t.biff)+":"+ec(e.e,t.biff)}function nx(e){return parseInt(qM(e),10)-1}function wa(e){return""+(e+1)}function GM(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qM(e){return e.replace(/\$(\d+)$/,"$1")}function sx(e){for(var t=YM(e),a=0,r=0;r!==t.length;++r)a=26*a+t.charCodeAt(r)-64;return a-1}function ia(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function WM(e){return e.replace(/^([A-Z])/,"$$$1")}function YM(e){return e.replace(/^\$([A-Z])/,"$1")}function XM(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ba(e){for(var t=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:t-1}}function $e(e){for(var t=e.c+1,a="";t;t=(t-1)/26|0)a=String.fromCharCode((t-1)%26+65)+a;return a+(e.r+1)}function zl(e){var t=e.indexOf(":");return t==-1?{s:Ba(e),e:Ba(e)}:{s:Ba(e.slice(0,t)),e:Ba(e.slice(t+1))}}function st(e,t){return typeof t>"u"||typeof t=="number"?st(e.s,e.e):(typeof e!="string"&&(e=$e(e)),typeof t!="string"&&(t=$e(t)),e==t?e:e+":"+t)}function zt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,l=e.length;for(a=0;r<l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(t.s.c=--a,a=0;r<l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(t.s.r=--a,r===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,a=0;r!=l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(t.e.c=--a,a=0;r!=l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return t.e.r=--a,t}function zb(e,t){var a=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Rr(e.z,a?za(t):t)}catch{}try{return e.w=Rr((e.XF||{}).numFmtId||(a?14:0),a?za(t):t)}catch{return""+t}}function Hn(e,t,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?Si[e.v]||e.v:t==null?zb(e,e.v):zb(e,t))}function Rs(e,t){var a=t&&t.sheet?t.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function gS(e,t,a){var r=a||{},s=e?Array.isArray(e):r.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&r.origin!=null){if(typeof r.origin=="number")c=r.origin;else{var h=typeof r.origin=="string"?Ba(r.origin):r.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=zt(l["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),c==-1&&(m.e.r=c=p.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[g].length;++y)if(!(typeof t[g][y]>"u")){var b={v:t[g][y]},_=c+g,w=u+y;if(m.s.r>_&&(m.s.r=_),m.s.c>w&&(m.s.c=w),m.e.r<_&&(m.e.r=_),m.e.c<w&&(m.e.c=w),t[g][y]&&typeof t[g][y]=="object"&&!Array.isArray(t[g][y])&&!(t[g][y]instanceof Date))b=t[g][y];else if(Array.isArray(b.v)&&(b.f=t[g][y][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(r.nullError)b.t="e",b.v=0;else if(r.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=r.dateNF||qe[14],r.cellDates?(b.t="d",b.w=Rr(b.z,za(b.v))):(b.t="n",b.v=za(b.v),b.w=Rr(b.z,b.v))):b.t="s";if(s)l[_]||(l[_]=[]),l[_][w]&&l[_][w].z&&(b.z=l[_][w].z),l[_][w]=b;else{var T=$e({c:w,r:_});l[T]&&l[T].z&&(b.z=l[T].z),l[T]=b}}}return m.s.c<1e7&&(l["!ref"]=st(m)),l}function Vl(e,t){return gS(null,e,t)}function KM(e){return e.read_shift(4,"i")}function Ca(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function JM(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ix(e,t){var a=e.l,r=e.read_shift(1),s=Ca(e),l=[],c={t:s,h:s};if((r&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(JM(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=a+t,c}var QM=ix;function Mr(e){var t=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:a}}function _i(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var ZM=Ca;function lx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var eF=Ca,Jm=lx;function ox(e){var t=e.slice(e.l,e.l+4),a=t[0]&1,r=t[0]&2;e.l+=4;var s=r===0?q0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ci(t,0)>>2;return a?s/100:s}function vS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ti=vS;function ka(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function tF(e){var t={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=s;var m=xi[s];m&&(t.rgb=Ac(m));break;case 2:t.rgb=Ac([c,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function aF(e){var t=e.read_shift(1);e.l++;var a={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return a}function yS(e,t){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function rF(e){return yS(e,1)}function nF(e){return yS(e,2)}var cx=2,Ja=3,x0=11,Vb=12,W0=19,g0=64,sF=65,iF=71,lF=4108,oF=4126,ca=80,bS=81,cF=[ca,bS],uF={1:{n:"CodePage",t:cx},2:{n:"Category",t:ca},3:{n:"PresentationFormat",t:ca},4:{n:"ByteCount",t:Ja},5:{n:"LineCount",t:Ja},6:{n:"ParagraphCount",t:Ja},7:{n:"SlideCount",t:Ja},8:{n:"NoteCount",t:Ja},9:{n:"HiddenCount",t:Ja},10:{n:"MultimediaClipCount",t:Ja},11:{n:"ScaleCrop",t:x0},12:{n:"HeadingPairs",t:lF},13:{n:"TitlesOfParts",t:oF},14:{n:"Manager",t:ca},15:{n:"Company",t:ca},16:{n:"LinksUpToDate",t:x0},17:{n:"CharacterCount",t:Ja},19:{n:"SharedDoc",t:x0},22:{n:"HyperlinksChanged",t:x0},23:{n:"AppVersion",t:Ja,p:"version"},24:{n:"DigSig",t:sF},26:{n:"ContentType",t:ca},27:{n:"ContentStatus",t:ca},28:{n:"Language",t:ca},29:{n:"Version",t:ca},255:{},2147483648:{n:"Locale",t:W0},2147483651:{n:"Behavior",t:W0},1919054434:{}},fF={1:{n:"CodePage",t:cx},2:{n:"Title",t:ca},3:{n:"Subject",t:ca},4:{n:"Author",t:ca},5:{n:"Keywords",t:ca},6:{n:"Comments",t:ca},7:{n:"Template",t:ca},8:{n:"LastAuthor",t:ca},9:{n:"RevNumber",t:ca},10:{n:"EditTime",t:g0},11:{n:"LastPrinted",t:g0},12:{n:"CreatedDate",t:g0},13:{n:"ModifiedDate",t:g0},14:{n:"PageCount",t:Ja},15:{n:"WordCount",t:Ja},16:{n:"CharCount",t:Ja},17:{n:"Thumbnail",t:iF},18:{n:"Application",t:ca},19:{n:"DocSecurity",t:Ja},255:{},2147483648:{n:"Locale",t:W0},2147483651:{n:"Behavior",t:W0},1919054434:{}},Hb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},hF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function dF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var mF=dF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xi=ba(mF),Si={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},wS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$b={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function pF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xF(e){var t=pF();if(!e||!e.match)return t;var a={};if((e.match(ja)||[]).forEach(function(r){var s=Ve(r);switch(s[0].replace(SM,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":t[$b[s.ContentType]]!==void 0&&t[$b[s.ContentType]].push(s.PartName);break}}),t.xmlns!==FM.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=a,delete t.calcchains,t}var Al={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function tc(e,t){var a={"!id":{}};if(!e)return a;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(ja)||[]).forEach(function(s){var l=Ve(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:$o(l.Target,t);a[u]=c,r[l.Id]=c}}),a["!id"]=r,a}var gF="application/vnd.oasis.opendocument.spreadsheet";function vF(e,t){for(var a=ax(e),r,s;r=Ec.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=Ve(r[0],!1),s.path=="/"&&s.type!==gF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var ac=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yF=(function(){for(var e=new Array(ac.length),t=0;t<ac.length;++t){var a=ac[t],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function _S(e){var t={};e=Tt(e);for(var a=0;a<ac.length;++a){var r=ac[a],s=e.match(yF[a]);s!=null&&s.length>0&&(t[r[1]]=it(s[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=ua(t[r[1]]))}return t}var bF=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function TS(e,t,a,r){var s=[];if(typeof e=="string")s=Mb(e,r);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(p){return{v:p}}));var c=typeof t=="string"?Mb(t,r).map(function(p){return p.v}):t,u=0,h=0;if(c.length>0)for(var m=0;m!==s.length;m+=2){switch(h=+s[m+1].v,s[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=h,a.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=h,a.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":a.Chartsheets=h,a.ChartNames=c.slice(u,u+h);break}u+=h}}function wF(e,t,a){var r={};return t||(t={}),e=Tt(e),bF.forEach(function(s){var l=(e.match(Sc(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=it(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(r[s[1]]=c[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&TS(r.HeadingPairs,r.TitlesOfParts,t,a),t}var _F=/<[^>]+>[^<]*/g;function TF(e,t){var a={},r="",s=e.match(_F);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=Ve(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=it(u.name);break;case"</property>":r=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),m=h[0].slice(4),p=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":a[r]=it(p);break;case"bool":a[r]=jt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(p);break;case"filetime":case"date":a[r]=ua(p);break;case"cy":case"error":a[r]=it(p);break;default:if(m.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,m,h)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return a}var SF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},im;function EF(e,t,a){im||(im=Zp(SF)),t=im[t]||t,e[t]=a}function ux(e){var t=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function SS(e,t,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function ES(e,t,a){var r=e.read_shift(0,"lpwstr");return r}function kS(e,t,a){return t===31?ES(e):SS(e,t,a)}function Zm(e,t,a){return kS(e,t,a===!1?0:4)}function kF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return kS(e,t,0)}function AF(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Ua,""),e.l-s&2&&(e.l+=2)}return a}function NF(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Ua,"");return a}function CF(e){var t=e.l,a=Y0(e,bS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=Y0(e,Ja);return[a,r]}function OF(e){for(var t=e.read_shift(4),a=[],r=0;r<t/2;++r)a.push(CF(e));return a}function Gb(e,t){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var l=e.read_shift(4),c=e.read_shift(4);r[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(Ua,"").replace(Ho,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function AS(e){var t=e.read_shift(4),a=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),a}function DF(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Y0(e,t,a){var r=e.read_shift(2),s,l=a||{};if(e.l+=2,t!==Vb&&r!==t&&cF.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===Vb?r:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return SS(e,r,4).replace(Ua,"");case 31:return ES(e);case 64:return ux(e);case 65:return AS(e);case 71:return DF(e);case 80:return Zm(e,r,!l.raw).replace(Ua,"");case 81:return kF(e,r).replace(Ua,"");case 4108:return OF(e);case 4126:case 4127:return r==4127?AF(e):NF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function qb(e,t){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,m={};for(c=0;c!=s;++c){var p=e.read_shift(4),g=e.read_shift(4);l[c]=[p,g+a]}l.sort(function(k,S){return k[1]-S[1]});var y={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var b=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,b=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],b=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],b=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(b=!1,e.l=l[c][1]),b)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var _=t[l[c][0]];if(y[_.n]=Y0(e,_.t,{raw:!0}),_.p==="version"&&(y[_.n]=String(y[_.n]>>16)+"."+("0000"+String(y[_.n]&65535)).slice(-4)),_.n=="CodePage")switch(y[_.n]){case 0:y[_.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xr(u=y[_.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[_.n])}}else if(l[c][0]===1){if(u=y.CodePage=Y0(e,cx),Xr(u),h!==-1){var w=e.l;e.l=l[h][1],m=Gb(e,u),e.l=w}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}m=Gb(e,u)}else{var T=m[l[c][0]],A;switch(e[e.l]){case 65:e.l+=4,A=AS(e);break;case 30:e.l+=4,A=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=Gt(e,4);break;case 64:e.l+=4,A=ua(ux(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[T]=A}}return e.l=a+r,y}function Wb(e,t,a){var r=e.content;if(!r)return{};ya(r,0);var s,l,c,u,h=0;r.chk("feff","Byte Order: "),r.read_shift(2);var m=r.read_shift(4),p=r.read_shift(16);if(p!==nt.utils.consts.HEADER_CLSID&&p!==a)throw new Error("Bad PropertySet CLSID "+p);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=r.read_shift(16),u=r.read_shift(4),s===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);s===2&&(c=r.read_shift(16),h=r.read_shift(4));var g=qb(r,t),y={SystemIdentifier:m};for(var b in g)y[b]=g[b];if(y.FMTID=l,s===1)return y;if(h-r.l==2&&(r.l+=2),r.l!==h)throw new Error("Length mismatch 2: "+r.l+" !== "+h);var _;try{_=qb(r,null)}catch{}for(b in _)y[b]=_[b];return y.FMTID=[l,c],y}function vs(e,t){return e.read_shift(t),null}function jF(e,t,a){for(var r=[],s=e.l+t;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function Gt(e,t){return e.read_shift(t)===1}function Zt(e){return e.read_shift(2,"u")}function NS(e,t){return jF(e,t,Zt)}function RF(e){var t=e.read_shift(1),a=e.read_shift(1);return a===1?t:t===1}function Pc(e,t,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var c=r?e.read_shift(r,s):"";return c}function MF(e){var t=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,l=1+(a&1),c=0,u,h={};s&&(c=e.read_shift(2)),r&&(u=e.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,m);return s&&(e.l+=4*c),r&&(e.l+=u),h.t=p,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function yi(e,t,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(t,"cpstr");if(a.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function Ic(e,t,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):yi(e,r,a)}function Ei(e,t,a){if(a.biff>5)return Ic(e,t,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function FF(e){var t=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[t,a]}function LF(e){var t=e.read_shift(4),a=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Ua,"");return r&&(e.l+=24),s}function PF(e){for(var t=e.read_shift(2),a="";t-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(Ua,"");return a+c}function IF(e,t){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return LF(e);case"0303000000000000c000000000000046":return PF(e);default:throw new Error("Unsupported Moniker "+a)}}function v0(e){var t=e.read_shift(4),a=t>0?e.read_shift(t,"utf16le").replace(Ua,""):"";return a}function BF(e,t){var a=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var l,c,u,h,m="",p,g;s&16&&(l=v0(e,a-e.l)),s&128&&(c=v0(e,a-e.l)),(s&257)===257&&(u=v0(e,a-e.l)),(s&257)===1&&(h=IF(e,a-e.l)),s&8&&(m=v0(e,a-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(g=ux(e)),e.l=a;var y=c||u||h||"";y&&m&&(y+="#"+m),y||(y="#"+m),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var b={Target:y};return p&&(b.guid=p),g&&(b.time=g),l&&(b.Tooltip=l),b}function CS(e){var t=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[t,a,r,s]}function OS(e,t){var a=CS(e);return a[3]=0,a}function gn(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:t,c:a,ixfe:r}}function UF(e){var t=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:t,flags:a}}function zF(e,t,a){return t===0?"":Ei(e,t,a)}function VF(e,t,a){var r=a.biff>8?4:2,s=e.read_shift(r),l=e.read_shift(r,"i"),c=e.read_shift(r,"i");return[s,l,c]}function DS(e){var t=e.read_shift(2),a=ox(e);return[t,a]}function HF(e,t,a){e.l+=4,t-=4;var r=e.l+t,s=Pc(e,t,a),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,s}function ff(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:t},e:{c:s,r:a}}}function jS(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:t},e:{c:s,r:a}}}var $F=jS;function RS(e){e.l+=4;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,t,r]}function GF(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function qF(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Sa(e){e.l+=2,e.l+=e.read_shift(2)}var WF={0:Sa,4:Sa,5:Sa,6:Sa,7:qF,8:Sa,9:Sa,10:Sa,11:Sa,12:Sa,13:GF,14:Sa,15:Sa,16:Sa,17:Sa,18:Sa,19:Sa,20:Sa,21:RS};function YF(e,t){for(var a=e.l+t,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(WF[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function y0(e,t){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),t-=2,t>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(t),a}function XF(e,t){return t===0||e.read_shift(2),1200}function KF(e,t,a){if(a.enc)return e.l+=t,"";var r=e.l,s=Ei(e,0,a);return e.read_shift(t+r-e.l),s}function JF(e,t,a){var r=a&&a.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function QF(e,t,a){var r=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=Pc(e,0,a);return c.length===0&&(c="Sheet1"),{pos:r,hs:s,dt:l,name:c}}function ZF(e,t){for(var a=e.l+t,r=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<a;++c)l.push(MF(e));return l.Count=r,l.Unique=s,l}function eL(e,t){var a={};return a.dsst=e.read_shift(2),e.l+=t-2,a}function tL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=a/20),t}function aL(e){var t=UF(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var a=e.read_shift(4);return a!==0}function rL(e){return e.read_shift(2),e.read_shift(4)}function Yb(e,t,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,s]}function nL(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),m=e.read_shift(2);return{Pos:[t,a],Dim:[r,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:m}}function sL(e,t,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function iL(){}function lL(e,t,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Pc(e,0,a),r}function oL(e){var t=gn(e);return t.isst=e.read_shift(4),t}function cL(e,t,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+t,s=gn(e);a.biff==2&&e.l++;var l=Ic(e,r-e.l,a);return s.val=l,s}function uL(e,t,a){var r=e.read_shift(2),s=Ei(e,0,a);return[r,s]}var fL=Ei;function Xb(e,t,a){var r=e.l+t,s=a.biff==8||!a.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=r,{s:{r:l,c:u},e:{r:c,c:h}}}function hL(e){var t=e.read_shift(2),a=e.read_shift(2),r=DS(e);return{r:t,c:a,ixfe:r[0],rknum:r[1]}}function dL(e,t){for(var a=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(DS(e));if(e.l!==a)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:c,rkrec:l}}function mL(e,t){for(var a=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:c,ixfe:l}}function pL(e,t,a,r){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=hF[u>>26],r.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function xL(e,t,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=pL(e,t,r.fStyle,a),r}function gL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Kb(e,t,a){var r=gn(e);(a.biff==2||t==9)&&++e.l;var s=RF(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function vL(e,t,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=gn(e),s=ka(e);return r.val=s,r}var Jb=zF;function yL(e,t,a){var r=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(a.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=yi(e,l),u=[];r>e.l;)u.push(Ic(e));return[l,s,c,u]}function Qb(e,t,a){var r=e.read_shift(2),s,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=HF(e,t-2,a)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var bL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Zb(e,t,a){var r=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(a&&a.biff==2?1:2),h=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),h=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var m=yi(e,c,a);s&32&&(m=bL[m.charCodeAt(0)]);var p=r-e.l;a&&a.biff==2&&--p;var g=r==e.l||u===0||!(p>0)?[]:t7(e,p,a,u);return{chKey:l,Name:m,itab:h,rgce:g}}function MS(e,t,a){if(a.biff<8)return wL(e,t,a);for(var r=[],s=e.l+t,l=e.read_shift(a.biff>8?4:2);l--!==0;)r.push(VF(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function wL(e,t,a){e[e.l+1]==3&&e[e.l]++;var r=Pc(e,t,a);return r.charCodeAt(0)==3?r.slice(1):r}function _L(e,t,a){if(a.biff<8){e.l+=t;return}var r=e.read_shift(2),s=e.read_shift(2),l=yi(e,r,a),c=yi(e,s,a);return[l,c]}function TL(e,t,a){var r=jS(e);e.l++;var s=e.read_shift(1);return t-=8,[a7(e,t,a),s,r]}function ew(e,t,a){var r=$F(e);switch(a.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,ZI(e,t,a)]}function SL(e){var t=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[t,a,r]}function EL(e,t,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=Ei(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},u,c,l]}}function kL(e,t,a){return EL(e,t,a)}function AL(e,t){for(var a=[],r=e.read_shift(2);r--;)a.push(ff(e));return a}function NL(e,t,a){if(a&&a.biff<8)return OL(e,t,a);var r=RS(e),s=YF(e,t-22,r[1]);return{cmo:r,ft:s}}var CL={8:function(e,t){var a=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function OL(e,t,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((CL[r]||Da)(e,t,a)),{cmo:[s,r,l],ft:c}}function DL(e,t,a){var r=e.l,s="";try{e.l+=4;var l=(a.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=FF(e,6,a);var u=e.read_shift(2);e.read_shift(2),Zt(e,2);var h=e.read_shift(2);e.l+=h;for(var m=1;m<e.lens.length-1;++m){if(e.l-r!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],g=yi(e,e.lens[m+1]-e.lens[m]-1);if(s+=g,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=r+t,{t:s}}catch{return e.l=r+t,{t:s}}}function jL(e,t){var a=ff(e);e.l+=16;var r=BF(e,t-24);return[a,r]}function RL(e,t){e.read_shift(2);var a=ff(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Ua,""),[a,r]}function ML(e){var t=[0,0],a;return a=e.read_shift(2),t[0]=Hb[a]||a,a=e.read_shift(2),t[1]=Hb[a]||a,t}function FL(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(OS(e));return a}function LL(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(OS(e));return a}function PL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function FS(e,t,a){if(!a.cellStyles)return Da(e,t);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),u=e.read_shift(r),h=e.read_shift(2);r==2&&(e.l+=2);var m={s,e:l,w:c,ixfe:u,flags:h};return(a.biff>=5||!a.biff)&&(m.level=h>>8&7),m}function IL(e,t){var a={};return t<32||(e.l+=16,a.header=ka(e),a.footer=ka(e),e.l+=2),a}function BL(e,t,a){var r={area:!1};if(a.biff!=5)return e.l+=t,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}var UL=gn,zL=NS,VL=Ic;function HL(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:t,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function $L(e,t,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=gn(e);++e.l;var s=Ei(e,t-7,a);return r.t="str",r.val=s,r}function GL(e){var t=gn(e);++e.l;var a=ka(e);return t.t="n",t.val=a,t}function qL(e){var t=gn(e);++e.l;var a=e.read_shift(2);return t.t="n",t.val=a,t}function WL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function YL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function XL(e,t,a){var r=e.l+t,s=gn(e),l=e.read_shift(2),c=yi(e,l,a);return e.l=r,s.t="str",s.val=c,s}var KL=[2,3,48,49,131,139,140,245],tw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Zp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(u,h){var m=[],p=Os(1);switch(h.type){case"base64":p=Yr(hr(u));break;case"binary":p=Yr(u);break;case"buffer":case"array":p=u;break}ya(p,0);var g=p.read_shift(1),y=!!(g&136),b=!1,_=!1;switch(g){case 2:break;case 3:break;case 48:b=!0,y=!0;break;case 49:b=!0,y=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var w=0,T=521;g==2&&(w=p.read_shift(2)),p.l+=3,g!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),g!=2&&(T=p.read_shift(2));var A=p.read_shift(2),k=h.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=e[p[p.l]]),p.l+=1,p.l+=2),_&&(p.l+=36);for(var S=[],L={},V=Math.min(p.length,g==2?521:T-10-(b?264:0)),P=_?32:11;p.l<V&&p[p.l]!=13;)switch(L={},L.name=_c.utils.decode(k,p.slice(p.l,p.l+P)).replace(/[\u0000\r\n].*$/g,""),p.l+=P,L.type=String.fromCharCode(p.read_shift(1)),g!=2&&!_&&(L.offset=p.read_shift(4)),L.len=p.read_shift(1),g==2&&(L.offset=p.read_shift(2)),L.dec=p.read_shift(1),L.name.length&&S.push(L),g!=2&&(p.l+=_?13:14),L.type){case"B":(!b||L.len!=8)&&h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var N=0,j=0;for(m[0]=[],j=0;j!=S.length;++j)m[0][j]=S[j].name;for(;w-- >0;){if(p[p.l]===42){p.l+=A;continue}for(++p.l,m[++N]=[],j=0,j=0;j!=S.length;++j){var I=p.slice(p.l,p.l+S[j].len);p.l+=S[j].len,ya(I,0);var z=_c.utils.decode(k,I);switch(S[j].type){case"C":z.trim().length&&(m[N][j]=z.replace(/\s+$/,""));break;case"D":z.length===8?m[N][j]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):m[N][j]=z;break;case"F":m[N][j]=parseFloat(z.trim());break;case"+":case"I":m[N][j]=_?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":m[N][j]=!0;break;case"N":case"F":m[N][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));m[N][j]="##MEMO##"+(_?parseInt(z.trim(),10):I.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(m[N][j]=+z||0);break;case"@":m[N][j]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":m[N][j]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":m[N][j]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[N][j]=-I.read_shift(-8,"f");break;case"B":if(b&&S[j].len==8){m[N][j]=I.read_shift(8,"f");break}case"G":case"P":I.l+=S[j].len;break;case"0":if(S[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[j].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=S,m}function r(u,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var p=Vl(a(u,m),m);return p["!cols"]=m.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete m.DBF,p}function s(u,h){try{return Rs(r(u,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var m=h||{};if(+m.codepage>=0&&Xr(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Km(),g=ip(u,{header:1,raw:!0,cellDates:!0}),y=g[0],b=g.slice(1),_=u["!cols"]||[],w=0,T=0,A=0,k=1;for(w=0;w<y.length;++w){if(((_[w]||{}).DBF||{}).name){y[w]=_[w].DBF.name,++A;continue}if(y[w]!=null){if(++A,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(T=0;T<1024;++T)if(y.indexOf(y[w]+"_"+T)==-1){y[w]+="_"+T;break}}}}var S=zt(u["!ref"]),L=[],V=[],P=[];for(w=0;w<=S.e.c-S.s.c;++w){var N="",j="",I=0,z=[];for(T=0;T<b.length;++T)b[T][w]!=null&&z.push(b[T][w]);if(z.length==0||y[w]==null){L[w]="?";continue}for(T=0;T<z.length;++T){switch(typeof z[T]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=z[T]instanceof Date?"D":"C";break;default:j="C"}I=Math.max(I,String(z[T]).length),N=N&&N!=j?"C":j}I>250&&(I=250),j=((_[w]||{}).DBF||{}).type,j=="C"&&_[w].DBF.len>I&&(I=_[w].DBF.len),N=="B"&&j=="N"&&(N="N",P[w]=_[w].DBF.dec,I=_[w].DBF.len),V[w]=N=="C"||j=="N"?I:l[N]||0,k+=V[w],L[w]=N}var X=p.next(32);for(X.write_shift(4,318902576),X.write_shift(4,b.length),X.write_shift(2,296+32*A),X.write_shift(2,k),w=0;w<4;++w)X.write_shift(4,0);for(X.write_shift(4,0|(+t[MT]||3)<<8),w=0,T=0;w<y.length;++w)if(y[w]!=null){var q=p.next(32),Q=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,Q,"sbcs"),q.write_shift(1,L[w]=="?"?"C":L[w],"sbcs"),q.write_shift(4,T),q.write_shift(1,V[w]||l[L[w]]||0),q.write_shift(1,P[w]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),T+=V[w]||l[L[w]]||0}var be=p.next(264);for(be.write_shift(4,13),w=0;w<65;++w)be.write_shift(4,0);for(w=0;w<b.length;++w){var ve=p.next(k);for(ve.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(L[T]){case"L":ve.write_shift(1,b[w][T]==null?63:b[w][T]?84:70);break;case"B":ve.write_shift(8,b[w][T]||0,"f");break;case"N":var R="0";for(typeof b[w][T]=="number"&&(R=b[w][T].toFixed(P[T]||0)),A=0;A<V[T]-R.length;++A)ve.write_shift(1,32);ve.write_shift(1,R,"sbcs");break;case"D":b[w][T]?(ve.write_shift(4,("0000"+b[w][T].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(b[w][T].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+b[w][T].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var te=String(b[w][T]!=null?b[w][T]:"").slice(0,V[T]);for(ve.write_shift(1,te,"sbcs"),A=0;A<V[T]-te.length;++A)ve.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:r,from_sheet:c}})(),JL=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(y,b){var _=e[b];return typeof _=="number"?gb(_):_},r=function(y,b,_){var w=b.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return w==59?y:gb(w)};e["|"]=254;function s(y,b){switch(b.type){case"base64":return l(hr(y),b);case"binary":return l(y,b);case"buffer":return l(rt&&Buffer.isBuffer(y)?y.toString("binary"):wi(y),b);case"array":return l(vi(y),b)}throw new Error("Unrecognized type "+b.type)}function l(y,b){var _=y.split(/[\n\r]+/),w=-1,T=-1,A=0,k=0,S=[],L=[],V=null,P={},N=[],j=[],I=[],z=0,X;for(+b.codepage>=0&&Xr(+b.codepage);A!==_.length;++A){z=0;var q=_[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,a),Q=q.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),be=Q[0],ve;if(q.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&L.push(q.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,te=!1,ye=!1,ae=!1,Ee=-1,G=-1;for(k=1;k<Q.length;++k)switch(Q[k].charAt(0)){case"A":break;case"X":T=parseInt(Q[k].slice(1))-1,te=!0;break;case"Y":for(w=parseInt(Q[k].slice(1))-1,te||(T=0),X=S.length;X<=w;++X)S[X]=[];break;case"K":ve=Q[k].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Jr(ve))?isNaN(Fl(ve).getDate())||(ve=ua(ve)):(ve=Jr(ve),V!==null&&Ul(V)&&(ve=uf(ve))),R=!0;break;case"E":ae=!0;var O=jl(Q[k].slice(1),{r:w,c:T});S[w][T]=[S[w][T],O];break;case"S":ye=!0,S[w][T]=[S[w][T],"S5S"];break;case"G":break;case"R":Ee=parseInt(Q[k].slice(1))-1;break;case"C":G=parseInt(Q[k].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+q)}if(R&&(S[w][T]&&S[w][T].length==2?S[w][T][0]=ve:S[w][T]=ve,V=null),ye){if(ae)throw new Error("SYLK shared formula cannot have own formula");var Z=Ee>-1&&S[Ee][G];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");S[w][T][1]=GS(Z[1],{r:w-Ee,c:T-G})}break;case"F":var W=0;for(k=1;k<Q.length;++k)switch(Q[k].charAt(0)){case"X":T=parseInt(Q[k].slice(1))-1,++W;break;case"Y":for(w=parseInt(Q[k].slice(1))-1,X=S.length;X<=w;++X)S[X]=[];break;case"M":z=parseInt(Q[k].slice(1))/20;break;case"F":break;case"G":break;case"P":V=L[parseInt(Q[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=Q[k].slice(1).split(" "),X=parseInt(I[0],10);X<=parseInt(I[1],10);++X)z=parseInt(I[2],10),j[X-1]=z===0?{hidden:!0}:{wch:z},Ll(j[X-1]);break;case"C":T=parseInt(Q[k].slice(1))-1,j[T]||(j[T]={});break;case"R":w=parseInt(Q[k].slice(1))-1,N[w]||(N[w]={}),z>0?(N[w].hpt=z,N[w].hpx=Nc(z)):z===0&&(N[w].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+q)}W<1&&(V=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+q)}}return N.length>0&&(P["!rows"]=N),j.length>0&&(P["!cols"]=j),b&&b.sheetRows&&(S=S.slice(0,b.sheetRows)),[S,P]}function c(y,b){var _=s(y,b),w=_[0],T=_[1],A=Vl(w,b);return pn(T).forEach(function(k){A[k]=T[k]}),A}function u(y,b){return Rs(c(y,b),b)}function h(y,b,_,w){var T="C;Y"+(_+1)+";X"+(w+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+P9(y.f,{r:_,c:w}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(y,b){b.forEach(function(_,w){var T="F;W"+(w+1)+" "+(w+1)+" ";_.hidden?T+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=K0(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=J0(_.wpx)),typeof _.wch=="number"&&(T+=Math.round(_.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function p(y,b){b.forEach(function(_,w){var T="F;";_.hidden?T+="M0;":_.hpt?T+="M"+20*_.hpt+";":_.hpx&&(T+="M"+20*VS(_.hpx)+";"),T.length>2&&y.push(T+"R"+(w+1))})}function g(y,b){var _=["ID;PWXL;N;E"],w=[],T=zt(y["!ref"]),A,k=Array.isArray(y),S=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),y["!cols"]&&m(_,y["!cols"]),y["!rows"]&&p(_,y["!rows"]),_.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var L=T.s.r;L<=T.e.r;++L)for(var V=T.s.c;V<=T.e.c;++V){var P=$e({r:L,c:V});A=k?(y[L]||[])[V]:y[P],!(!A||A.v==null&&(!A.f||A.F))&&w.push(h(A,y,L,V))}return _.join(S)+S+w.join(S)+S+"E"+S}return{to_workbook:u,to_sheet:c,from_sheet:g}})(),QL=(function(){function e(l,c){switch(c.type){case"base64":return t(hr(l),c);case"binary":return t(l,c);case"buffer":return t(rt&&Buffer.isBuffer(l)?l.toString("binary"):wi(l),c);case"array":return t(vi(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),h=-1,m=-1,p=0,g=[];p!==u.length;++p){if(u[p].trim()==="BOT"){g[++h]=[],m=0;continue}if(!(h<0)){var y=u[p].trim().split(","),b=y[0],_=y[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+b){case-1:if(w==="BOT"){g[++h]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?g[h][m]=!0:w==="FALSE"?g[h][m]=!1:isNaN(Jr(_))?isNaN(Fl(_).getDate())?g[h][m]=_:g[h][m]=ua(_):g[h][m]=Jr(_),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),g[h][m++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(g=g.slice(0,c.sheetRows)),g}function a(l,c){return Vl(e(l,c),c)}function r(l,c){return Rs(a(l,c),c)}var s=(function(){var l=function(h,m,p,g,y){h.push(m),h.push(p+","+g),h.push('"'+y.replace(/"/g,'""')+'"')},c=function(h,m,p,g){h.push(m+","+p),h.push(m==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var m=[],p=zt(h["!ref"]),g,y=Array.isArray(h);l(m,"TABLE",0,1,"sheetjs"),l(m,"VECTORS",0,p.e.r-p.s.r+1,""),l(m,"TUPLES",0,p.e.c-p.s.c+1,""),l(m,"DATA",0,0,"");for(var b=p.s.r;b<=p.e.r;++b){c(m,-1,0,"BOT");for(var _=p.s.c;_<=p.e.c;++_){var w=$e({r:b,c:_});if(g=y?(h[b]||[])[_]:h[w],!g){c(m,1,0,"");continue}switch(g.t){case"n":var T=g.w;!T&&g.v!=null&&(T=g.v),T==null?g.f&&!g.F?c(m,1,0,"="+g.f):c(m,1,0,""):c(m,0,T,"V");break;case"b":c(m,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Rr(g.z||qe[14],za(ua(g.v)))),c(m,0,g.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var A=`\r
`,k=m.join(A);return k}})();return{to_workbook:r,to_sheet:a,from_sheet:s}})(),ZL=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(g,y){for(var b=g.split(`
`),_=-1,w=-1,T=0,A=[];T!==b.length;++T){var k=b[T].trim().split(":");if(k[0]==="cell"){var S=Ba(k[1]);if(A.length<=S.r)for(_=A.length;_<=S.r;++_)A[_]||(A[_]=[]);switch(_=S.r,w=S.c,k[2]){case"t":A[_][w]=e(k[3]);break;case"v":A[_][w]=+k[3];break;case"vtf":var L=k[k.length-1];case"vtc":k[3]==="nl"?A[_][w]=!!+k[4]:A[_][w]=+k[4],k[2]=="vtf"&&(A[_][w]=[A[_][w],L])}}}return y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),A}function r(g,y){return Vl(a(g,y),y)}function s(g,y){return Rs(r(g,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(g){if(!g||!g["!ref"])return"";for(var y=[],b=[],_,w="",T=zl(g["!ref"]),A=Array.isArray(g),k=T.s.r;k<=T.e.r;++k)for(var S=T.s.c;S<=T.e.c;++S)if(w=$e({r:k,c:S}),_=A?(g[k]||[])[S]:g[w],!(!_||_.v==null||_.t==="z")){switch(b=["cell",w,"t"],_.t){case"s":case"str":b.push(t(_.v));break;case"n":_.f?(b[2]="vtf",b[3]="n",b[4]=_.v,b[5]=t(_.f)):(b[2]="v",b[3]=_.v);break;case"b":b[2]="vt"+(_.f?"f":"c"),b[3]="nl",b[4]=_.v?"1":"0",b[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var L=za(ua(_.v));b[2]="vtc",b[3]="nd",b[4]=""+L,b[5]=_.w||Rr(_.z||qe[14],L);break;case"e":continue}y.push(b.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(g){return[l,c,u,c,m(g),h].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:p}})(),kc=(function(){function e(p,g,y,b,_){_.raw?g[y][b]=p:p===""||(p==="TRUE"?g[y][b]=!0:p==="FALSE"?g[y][b]=!1:isNaN(Jr(p))?isNaN(Fl(p).getDate())?g[y][b]=p:g[y][b]=ua(p):g[y][b]=Jr(p))}function t(p,g){var y=g||{},b=[];if(!p||p.length===0)return b;for(var _=p.split(/[\r\n]/),w=_.length-1;w>=0&&_[w].length===0;)--w;for(var T=10,A=0,k=0;k<=w;++k)A=_[k].indexOf(" "),A==-1?A=_[k].length:A++,T=Math.max(T,A);for(k=0;k<=w;++k){b[k]=[];var S=0;for(e(_[k].slice(0,T).trim(),b,k,S,y),S=1;S<=(_[k].length-T)/10+1;++S)e(_[k].slice(T+(S-1)*10,T+S*10).trim(),b,k,S,y)}return y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(p){for(var g={},y=!1,b=0,_=0;b<p.length;++b)(_=p.charCodeAt(b))==34?y=!y:!y&&_ in a&&(g[_]=(g[_]||0)+1);_=[];for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&_.push([g[b],b]);if(!_.length){g=r;for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&_.push([g[b],b])}return _.sort(function(w,T){return w[0]-T[0]||r[w[1]]-r[T[1]]}),a[_.pop()[1]]||44}function l(p,g){var y=g||{},b="",_=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(b=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(b=p.charAt(4),p=p.slice(6)):b=s(p.slice(0,1024)):y&&y.FS?b=y.FS:b=s(p.slice(0,1024));var T=0,A=0,k=0,S=0,L=0,V=b.charCodeAt(0),P=!1,N=0,j=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var I=y.dateNF!=null?uM(y.dateNF):null;function z(){var X=p.slice(S,L),q={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)q.t="z";else if(y.raw)q.t="s",q.v=X;else if(X.trim().length===0)q.t="s",q.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(q.t="s",q.v=X.slice(2,-1).replace(/""/g,'"')):B9(X)?(q.t="n",q.f=X.slice(1)):(q.t="s",q.v=X);else if(X=="TRUE")q.t="b",q.v=!0;else if(X=="FALSE")q.t="b",q.v=!1;else if(!isNaN(k=Jr(X)))q.t="n",y.cellText!==!1&&(q.w=X),q.v=k;else if(!isNaN(Fl(X).getDate())||I&&X.match(I)){q.z=y.dateNF||qe[14];var Q=0;I&&X.match(I)&&(X=fM(X,y.dateNF,X.match(I)||[]),Q=1),y.cellDates?(q.t="d",q.v=ua(X,Q)):(q.t="n",q.v=za(ua(X,Q))),y.cellText!==!1&&(q.w=Rr(q.z,q.v instanceof Date?za(q.v):q.v)),y.cellNF||delete q.z}else q.t="s",q.v=X;if(q.t=="z"||(y.dense?(_[T]||(_[T]=[]),_[T][A]=q):_[$e({c:A,r:T})]=q),S=L+1,j=p.charCodeAt(S),w.e.c<A&&(w.e.c=A),w.e.r<T&&(w.e.r=T),N==V)++A;else if(A=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;L<p.length;++L)switch(N=p.charCodeAt(L)){case 34:j===34&&(P=!P);break;case V:case 10:case 13:if(!P&&z())break e;break}return L-S>0&&z(),_["!ref"]=st(w),_}function c(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,g):Vl(t(p,g),g)}function u(p,g){var y="",b=g.type=="string"?[0,0,0,0]:vx(p,g);switch(g.type){case"base64":y=hr(p);break;case"binary":y=p;break;case"buffer":g.codepage==65001?y=p.toString("utf8"):g.codepage&&typeof _c<"u"||(y=rt&&Buffer.isBuffer(p)?p.toString("binary"):wi(p));break;case"array":y=vi(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+g.type)}return b[0]==239&&b[1]==187&&b[2]==191?y=Tt(y.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?y=Tt(y):g.type=="binary"&&typeof _c<"u",y.slice(0,19)=="socialcalc:version:"?ZL.to_sheet(g.type=="string"?y:Tt(y),g):c(y,g)}function h(p,g){return Rs(u(p,g),g)}function m(p){for(var g=[],y=zt(p["!ref"]),b,_=Array.isArray(p),w=y.s.r;w<=y.e.r;++w){for(var T=[],A=y.s.c;A<=y.e.c;++A){var k=$e({r:w,c:A});if(b=_?(p[w]||[])[A]:p[k],!b||b.v==null){T.push("          ");continue}for(var S=(b.w||(Hn(b),b.w)||"").slice(0,10);S.length<10;)S+=" ";T.push(S+(A===0?" ":""))}g.push(T.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:m}})();function eP(e,t){var a=t||{},r=!!a.WTF;a.WTF=!0;try{var s=JL.to_workbook(e,a);return a.WTF=r,s}catch(l){if(a.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return kc.to_workbook(e,t)}}var rc=(function(){function e(O,Z,W){if(O){ya(O,O.l||0);for(var J=W.Enum||Ee;O.l<O.length;){var he=O.read_shift(2),we=J[he]||J[65535],Ne=O.read_shift(2),_e=O.l+Ne,Se=we.f&&we.f(O,Ne,W);if(O.l=_e,Z(Se,we,he))return}}}function t(O,Z){switch(Z.type){case"base64":return a(Yr(hr(O)),Z);case"binary":return a(Yr(O),Z);case"buffer":case"array":return a(O,Z)}throw"Unsupported type "+Z.type}function a(O,Z){if(!O)return O;var W=Z||{},J=W.dense?[]:{},he="Sheet1",we="",Ne=0,_e={},Se=[],Je=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Nt=W.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)W.Enum=Ee,e(O,function(Oe,Ct,_a){switch(_a){case 0:W.vers=Oe,Oe>=4096&&(W.qpro=!0);break;case 6:Y=Oe;break;case 204:Oe&&(we=Oe);break;case 222:we=Oe;break;case 15:case 51:W.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:_a==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=W.dateNF||qe[14],W.cellDates&&(Oe[1].t="d",Oe[1].v=uf(Oe[1].v))),W.qpro&&Oe[3]>Ne&&(J["!ref"]=st(Y),_e[he]=J,Se.push(he),J=W.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Ne=Oe[3],he=we||"Sheet"+(Ne+1),we="");var Va=W.dense?(J[Oe[0].r]||[])[Oe[0].c]:J[$e(Oe[0])];if(Va){Va.t=Oe[1].t,Va.v=Oe[1].v,Oe[1].z!=null&&(Va.z=Oe[1].z),Oe[1].f!=null&&(Va.f=Oe[1].f);break}W.dense?(J[Oe[0].r]||(J[Oe[0].r]=[]),J[Oe[0].r][Oe[0].c]=Oe[1]):J[$e(Oe[0])]=Oe[1];break}},W);else if(O[2]==26||O[2]==14)W.Enum=G,O[2]==14&&(W.qpro=!0,O.l=0),e(O,function(Oe,Ct,_a){switch(_a){case 204:he=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>Ne&&(J["!ref"]=st(Y),_e[he]=J,Se.push(he),J=W.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Ne=Oe[3],he="Sheet"+(Ne+1)),Nt>0&&Oe[0].r>=Nt)break;W.dense?(J[Oe[0].r]||(J[Oe[0].r]=[]),J[Oe[0].r][Oe[0].c]=Oe[1]):J[$e(Oe[0])]=Oe[1],Y.e.c<Oe[0].c&&(Y.e.c=Oe[0].c),Y.e.r<Oe[0].r&&(Y.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Je[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Je[Oe[0]]=Oe[1],Oe[0]==Ne&&(he=Oe[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(J["!ref"]=st(Y),_e[we||he]=J,Se.push(we||he),!Je.length)return{SheetNames:Se,Sheets:_e};for(var Ke={},ct=[],We=0;We<Je.length;++We)_e[Se[We]]?(ct.push(Je[We]||Se[We]),Ke[Je[We]]=_e[Je[We]]||_e[Se[We]]):(ct.push(Je[We]),Ke[Je[We]]={"!ref":"A1"});return{SheetNames:ct,Sheets:Ke}}function r(O,Z){var W=Z||{};if(+W.codepage>=0&&Xr(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Km(),he=zt(O["!ref"]),we=Array.isArray(O),Ne=[];Hr(J,0,l(1030)),Hr(J,6,h(he));for(var _e=Math.min(he.e.r,8191),Se=he.s.r;Se<=_e;++Se)for(var Je=wa(Se),Y=he.s.c;Y<=he.e.c;++Y){Se===he.s.r&&(Ne[Y]=ia(Y));var Nt=Ne[Y]+Je,Ke=we?(O[Se]||[])[Y]:O[Nt];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Hr(J,13,b(Se,Y,Ke.v)):Hr(J,14,w(Se,Y,Ke.v));else{var ct=Hn(Ke);Hr(J,15,g(Se,Y,ct.slice(0,239)))}}return Hr(J,1),J.end()}function s(O,Z){var W=Z||{};if(+W.codepage>=0&&Xr(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Km();Hr(J,0,c(O));for(var he=0,we=0;he<O.SheetNames.length;++he)(O.Sheets[O.SheetNames[he]]||{})["!ref"]&&Hr(J,27,ae(O.SheetNames[he],we++));var Ne=0;for(he=0;he<O.SheetNames.length;++he){var _e=O.Sheets[O.SheetNames[he]];if(!(!_e||!_e["!ref"])){for(var Se=zt(_e["!ref"]),Je=Array.isArray(_e),Y=[],Nt=Math.min(Se.e.r,8191),Ke=Se.s.r;Ke<=Nt;++Ke)for(var ct=wa(Ke),We=Se.s.c;We<=Se.e.c;++We){Ke===Se.s.r&&(Y[We]=ia(We));var Oe=Y[We]+ct,Ct=Je?(_e[Ke]||[])[We]:_e[Oe];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")Hr(J,23,z(Ke,We,Ne,Ct.v));else{var _a=Hn(Ct);Hr(J,22,N(Ke,We,Ne,_a.slice(0,239)))}}++Ne}}return Hr(J,1),J.end()}function l(O){var Z=sa(2);return Z.write_shift(2,O),Z}function c(O){var Z=sa(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var W=0,J=0,he=0,we=0;we<O.SheetNames.length;++we){var Ne=O.SheetNames[we],_e=O.Sheets[Ne];if(!(!_e||!_e["!ref"])){++he;var Se=zl(_e["!ref"]);W<Se.e.r&&(W=Se.e.r),J<Se.e.c&&(J=Se.e.c)}}return W>8191&&(W=8191),Z.write_shift(2,W),Z.write_shift(1,he),Z.write_shift(1,J),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function u(O,Z,W){var J={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&W.qpro?(J.s.c=O.read_shift(1),O.l++,J.s.r=O.read_shift(2),J.e.c=O.read_shift(1),O.l++,J.e.r=O.read_shift(2),J):(J.s.c=O.read_shift(2),J.s.r=O.read_shift(2),Z==12&&W.qpro&&(O.l+=2),J.e.c=O.read_shift(2),J.e.r=O.read_shift(2),Z==12&&W.qpro&&(O.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function h(O){var Z=sa(8);return Z.write_shift(2,O.s.c),Z.write_shift(2,O.s.r),Z.write_shift(2,O.e.c),Z.write_shift(2,O.e.r),Z}function m(O,Z,W){var J=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(J[0].c=O.read_shift(1),J[3]=O.read_shift(1),J[0].r=O.read_shift(2),O.l+=2):(J[2]=O.read_shift(1),J[0].c=O.read_shift(2),J[0].r=O.read_shift(2)),J}function p(O,Z,W){var J=O.l+Z,he=m(O,Z,W);if(he[1].t="s",W.vers==20768){O.l++;var we=O.read_shift(1);return he[1].v=O.read_shift(we,"utf8"),he}return W.qpro&&O.l++,he[1].v=O.read_shift(J-O.l,"cstr"),he}function g(O,Z,W){var J=sa(7+W.length);J.write_shift(1,255),J.write_shift(2,Z),J.write_shift(2,O),J.write_shift(1,39);for(var he=0;he<J.length;++he){var we=W.charCodeAt(he);J.write_shift(1,we>=128?95:we)}return J.write_shift(1,0),J}function y(O,Z,W){var J=m(O,Z,W);return J[1].v=O.read_shift(2,"i"),J}function b(O,Z,W){var J=sa(7);return J.write_shift(1,255),J.write_shift(2,Z),J.write_shift(2,O),J.write_shift(2,W,"i"),J}function _(O,Z,W){var J=m(O,Z,W);return J[1].v=O.read_shift(8,"f"),J}function w(O,Z,W){var J=sa(13);return J.write_shift(1,255),J.write_shift(2,Z),J.write_shift(2,O),J.write_shift(8,W,"f"),J}function T(O,Z,W){var J=O.l+Z,he=m(O,Z,W);if(he[1].v=O.read_shift(8,"f"),W.qpro)O.l=J;else{var we=O.read_shift(2);L(O.slice(O.l,O.l+we),he),O.l+=we}return he}function A(O,Z,W){var J=Z&32768;return Z&=-32769,Z=(J?O:0)+(Z>=8192?Z-16384:Z),(J?"":"$")+(W?ia(Z):wa(Z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(O,Z){ya(O,0);for(var W=[],J=0,he="",we="",Ne="",_e="";O.l<O.length;){var Se=O[O.l++];switch(Se){case 0:W.push(O.read_shift(8,"f"));break;case 1:we=A(Z[0].c,O.read_shift(2),!0),he=A(Z[0].r,O.read_shift(2),!1),W.push(we+he);break;case 2:{var Je=A(Z[0].c,O.read_shift(2),!0),Y=A(Z[0].r,O.read_shift(2),!1);we=A(Z[0].c,O.read_shift(2),!0),he=A(Z[0].r,O.read_shift(2),!1),W.push(Je+Y+":"+we+he)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(O.read_shift(2));break;case 6:{for(var Nt="";Se=O[O.l++];)Nt+=String.fromCharCode(Se);W.push('"'+Nt.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:_e=W.pop(),Ne=W.pop(),W.push(["AND","OR"][Se-20]+"("+Ne+","+_e+")");break;default:if(Se<32&&S[Se])_e=W.pop(),Ne=W.pop(),W.push(Ne+S[Se]+_e);else if(k[Se]){if(J=k[Se][1],J==69&&(J=O[O.l++]),J>W.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+W.join("|")+"|");return}var Ke=W.slice(-J);W.length-=J,W.push(k[Se][0]+"("+Ke.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}W.length==1?Z[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function V(O){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=O.read_shift(2),Z[3]=O[O.l++],Z[0].c=O[O.l++],Z}function P(O,Z){var W=V(O);return W[1].t="s",W[1].v=O.read_shift(Z-4,"cstr"),W}function N(O,Z,W,J){var he=sa(6+J.length);he.write_shift(2,O),he.write_shift(1,W),he.write_shift(1,Z),he.write_shift(1,39);for(var we=0;we<J.length;++we){var Ne=J.charCodeAt(we);he.write_shift(1,Ne>=128?95:Ne)}return he.write_shift(1,0),he}function j(O,Z){var W=V(O);W[1].v=O.read_shift(2);var J=W[1].v>>1;if(W[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return W[1].v=J,W}function I(O,Z){var W=V(O),J=O.read_shift(4),he=O.read_shift(4),we=O.read_shift(2);if(we==65535)return J===0&&he===3221225472?(W[1].t="e",W[1].v=15):J===0&&he===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var Ne=we&32768;return we=(we&32767)-16446,W[1].v=(1-Ne*2)*(he*Math.pow(2,we+32)+J*Math.pow(2,we)),W}function z(O,Z,W,J){var he=sa(14);if(he.write_shift(2,O),he.write_shift(1,W),he.write_shift(1,Z),J==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var we=0,Ne=0,_e=0,Se=0;return J<0&&(we=1,J=-J),Ne=Math.log2(J)|0,J/=Math.pow(2,Ne-31),Se=J>>>0,(Se&2147483648)==0&&(J/=2,++Ne,Se=J>>>0),J-=Se,Se|=2147483648,Se>>>=0,J*=Math.pow(2,32),_e=J>>>0,he.write_shift(4,_e),he.write_shift(4,Se),Ne+=16383+(we?32768:0),he.write_shift(2,Ne),he}function X(O,Z){var W=I(O);return O.l+=Z-14,W}function q(O,Z){var W=V(O),J=O.read_shift(4);return W[1].v=J>>6,W}function Q(O,Z){var W=V(O),J=O.read_shift(8,"f");return W[1].v=J,W}function be(O,Z){var W=Q(O);return O.l+=Z-10,W}function ve(O,Z){return O[O.l+Z-1]==0?O.read_shift(Z,"cstr"):""}function R(O,Z){var W=O[O.l++];W>Z-1&&(W=Z-1);for(var J="";J.length<W;)J+=String.fromCharCode(O[O.l++]);return J}function te(O,Z,W){if(!(!W.qpro||Z<21)){var J=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var he=O.read_shift(Z-21,"cstr");return[J,he]}}function ye(O,Z){for(var W={},J=O.l+Z;O.l<J;){var he=O.read_shift(2);if(he==14e3){for(W[he]=[0,""],W[he][0]=O.read_shift(2);O[O.l];)W[he][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return W}function ae(O,Z){var W=sa(5+O.length);W.write_shift(2,14e3),W.write_shift(2,Z);for(var J=0;J<O.length;++J){var he=O.charCodeAt(J);W[W.l++]=he>127?95:he}return W[W.l++]=0,W}var Ee={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:R},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:t}})();function tP(e){var t={},a=e.match(ja),r=0,s=!1;if(a)for(;r!=a.length;++r){var l=Ve(a[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Yp[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var aP=(function(){var e=Sc("t"),t=Sc("rPr");function a(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:it(c[1])},h=l.match(t);return h&&(u.s=tP(h[1])),u}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(r,"").split(s).map(a).filter(function(u){return u.v})}})(),rP=(function(){var t=/(\r\n|\n)/g;function a(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function r(s){var l=[[],s.v,[]];return s.v?(s.s&&a(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}})(),nP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sP=/<(?:\w+:)?r>/,iP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fx(e,t){var a=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=it(Tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Tt(e),a&&(r.h=tx(r.t))):e.match(sP)&&(r.r=Tt(e),r.t=it(Tt((e.replace(iP,"").match(nP)||[]).join("").replace(ja,""))),a&&(r.h=rP(aP(r.r)))),r):{t:""}}var lP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,oP=/<(?:\w+:)?(?:si|sstItem)>/g,cP=/<\/(?:\w+:)?(?:si|sstItem)>/;function uP(e,t){var a=[],r="";if(!e)return a;var s=e.match(lP);if(s){r=s[2].replace(oP,"").split(cP);for(var l=0;l!=r.length;++l){var c=fx(r[l].trim(),t);c!=null&&(a[a.length]=c)}s=Ve(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}function fP(e){return[e.read_shift(4),e.read_shift(4)]}function hP(e,t){var a=[],r=!1;return Gn(e,function(l,c,u){switch(u){case 159:a.Count=l[0],a.Unique=l[1];break;case 19:a.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(c.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function LS(e){for(var t=[],a=e.split(""),r=0;r<a.length;++r)t[r]=a[r].charCodeAt(0);return t}function Un(e,t){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),a}function dP(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Un(e,4),t.U=Un(e,4),t.W=Un(e,4),t}function mP(e){for(var t=e.read_shift(4),a=e.l+t-4,r={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function pP(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(mP(e));return t}function xP(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function gP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Un(e,4),t.U=Un(e,4),t.W=Un(e,4),t}function vP(e){var t=gP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function PS(e,t){var a=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function IS(e,t){var a={},r=e.l+t;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function yP(e){var t=Un(e);switch(t.Minor){case 2:return[t.Minor,bP(e)];case 3:return[t.Minor,wP()];case 4:return[t.Minor,_P(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function bP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=PS(e,a),s=IS(e,e.length-e.l);return{t:"Std",h:r,v:s}}function wP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _P(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(ja,function(l){var c=Ve(l);switch(xn(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=c[u]});break;case"<dataIntegrity":r.encryptedHmacKey=c.encryptedHmacKey,r.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(c);break;default:throw c[0]}}),r}function TP(e,t){var a={},r=a.EncryptionVersionInfo=Un(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,a.EncryptionHeader=PS(e,s),t-=s,a.EncryptionVerifier=IS(e,t),a}function SP(e){var t={},a=t.EncryptionVersionInfo=Un(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function EP(e){var t=0,a,r=LS(e),s=r.length+1,l,c,u,h,m;for(a=Os(s),a[0]=r.length,l=1;l!=s;++l)a[l]=r[l-1];for(l=s-1;l>=0;--l)c=a[l],u=(t&16384)===0?0:1,h=t<<1&32767,m=u|h,t=m^c;return t^52811}var BS=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(c){return(c/2|c*128)&255},s=function(c,u){return r(c^u)},l=function(c){for(var u=t[c.length-1],h=104,m=c.length-1;m>=0;--m)for(var p=c[m],g=0;g!=7;++g)p&64&&(u^=a[h]),p*=2,--h;return u};return function(c){for(var u=LS(c),h=l(u),m=u.length,p=Os(16),g=0;g!=16;++g)p[g]=0;var y,b,_;for((m&1)===1&&(y=h>>8,p[m]=s(e[0],y),--m,y=h&255,b=u[u.length-1],p[m]=s(b,y));m>0;)--m,y=h>>8,p[m]=s(u[m],y),--m,y=h&255,p[m]=s(u[m],y);for(m=15,_=15-u.length;_>0;)y=h>>8,p[m]=s(e[_],y),--m,--_,y=h&255,p[m]=s(u[m],y),--m,--_;return p}})(),kP=function(e,t,a,r,s){s||(s=t),r||(r=BS(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=r[a],c=(c>>5|c<<3)&255,s[l]=c,++a;return[s,a,r]},AP=function(e){var t=0,a=BS(e);return function(r){var s=kP("",r,t,a);return t=s[1],s[0]}};function NP(e,t,a,r){var s={key:Zt(e),verificationBytes:Zt(e)};return a.password&&(s.verifier=EP(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=AP(a.password)),s}function CP(e,t,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=SP(e):r.Data=TP(e,t),r}function OP(e,t,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?CP(e,t-2,r):NP(e,a.biff>=8?t:t-2,a,r),r}var DP=(function(){function e(s,l){switch(l.type){case"base64":return t(hr(s),l);case"binary":return t(s,l);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):wi(s),l);case"array":return t(vi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,g){Array.isArray(u)&&(u[g]=[]);for(var y=/\\\w+\b/g,b=0,_,w=-1;_=y.exec(p);){switch(_[0]){case"\\cell":var T=p.slice(b,y.lastIndex-_[0].length);if(T[0]==" "&&(T=T.slice(1)),++w,T.length){var A={v:T,t:"s"};Array.isArray(u)?u[g][w]=A:u[$e({r:g,c:w})]=A}break}b=y.lastIndex}w>m.e.c&&(m.e.c=w)}),u["!ref"]=st(m),u}function a(s,l){return Rs(e(s,l),l)}function r(s){for(var l=["{\\rtf1\\ansi"],c=zt(s["!ref"]),u,h=Array.isArray(s),m=c.s.r;m<=c.e.r;++m){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var g=$e({r:m,c:p});u=h?(s[m]||[])[p]:s[g],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Hn(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}})();function jP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ac(e){for(var t=0,a=1;t!=3;++t)a=a*256+(e[t]>255?255:e[t]<0?0:e[t]);return a.toString(16).toUpperCase().slice(1)}function RP(e){var t=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(t,a,r),l=Math.min(t,a,r),c=s-l;if(c===0)return[0,0,t];var u=0,h=0,m=s+l;switch(h=c/(m>1?2-m:m),s){case t:u=((a-r)/c+6)%6;break;case a:u=(r-t)/c+2;break;case r:u=(t-a)/c+4;break}return[u/6,h,m/2]}function MP(e){var t=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),l=r-s/2,c=[l,l,l],u=6*t,h;if(a!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var m=0;m!=3;++m)c[m]=Math.round(c[m]*255);return c}function X0(e,t){if(t===0)return e;var a=RP(jP(e));return t<0?a[2]=a[2]*(1+t):a[2]=1-(1-a[2])*(1-t),Ac(MP(a))}var US=6,FP=15,LP=1,La=US;function K0(e){return Math.floor((e+Math.round(128/La)/256)*La)}function J0(e){return Math.floor((e-5)/La*100+.5)/100}function ep(e){return Math.round((e*La+5)/La*256)/256}function lm(e){return ep(J0(K0(e)))}function hx(e){var t=Math.abs(e-lm(e)),a=La;if(t>.005)for(La=LP;La<FP;++La)Math.abs(e-lm(e))<=t&&(t=Math.abs(e-lm(e)),a=La);La=a}function Ll(e){e.width?(e.wpx=K0(e.width),e.wch=J0(e.wpx),e.MDW=La):e.wpx?(e.wch=J0(e.wpx),e.width=ep(e.wch),e.MDW=La):typeof e.wch=="number"&&(e.width=ep(e.wch),e.wpx=K0(e.width),e.MDW=La),e.customWidth&&delete e.customWidth}var PP=96,zS=PP;function VS(e){return e*96/zS}function Nc(e){return e*zS/96}var IP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function BP(e,t,a,r){t.Borders=[];var s={},l=!1;(e[0].match(ja)||[]).forEach(function(c){var u=Ve(c);switch(xn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=jt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=jt(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function UP(e,t,a,r){t.Fills=[];var s={},l=!1;(e[0].match(ja)||[]).forEach(function(c){var u=Ve(c);switch(xn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function zP(e,t,a,r){t.Fonts=[];var s={},l=!1;(e[0].match(ja)||[]).forEach(function(c){var u=Ve(c);switch(xn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Tt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?jt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?jt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?jt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?jt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?jt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?jt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?jt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Yp[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=jt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=xi[s.color.index];s.color.index==81&&(h=xi[1]),h||(h=xi[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=X0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function VP(e,t,a){t.NumberFmt=[];for(var r=pn(qe),s=0;s<r.length;++s)t.NumberFmt[r[s]]=qe[r[s]];var l=e[0].match(ja);if(l)for(s=0;s<l.length;++s){var c=Ve(l[s]);switch(xn(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=it(Tt(c.formatCode)),h=parseInt(c.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}pi(u,h)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var b0=["numFmtId","fillId","fontId","borderId","xfId"],w0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function HP(e,t,a){t.CellXf=[];var r,s=!1;(e[0].match(ja)||[]).forEach(function(l){var c=Ve(l),u=0;switch(xn(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=c,delete r[0],u=0;u<b0.length;++u)r[b0[u]]&&(r[b0[u]]=parseInt(r[b0[u]],10));for(u=0;u<w0.length;++u)r[w0[u]]&&(r[w0[u]]=jt(r[w0[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=jt(c.wrapText)),r.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var $P=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,m){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=u.match(t))&&VP(g,p,m),(g=u.match(s))&&zP(g,p,h,m),(g=u.match(r))&&UP(g,p,h,m),(g=u.match(l))&&BP(g,p,h,m),(g=u.match(a))&&HP(g,p,m),p}})();function GP(e,t){var a=e.read_shift(2),r=Ca(e);return[a,r]}function qP(e,t,a){var r={};r.sz=e.read_shift(2)/20;var s=aF(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(r.underline=c);var u=e.read_shift(1);u>0&&(r.family=u);var h=e.read_shift(1);switch(h>0&&(r.charset=h),e.l++,r.color=tF(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Ca(e),r}var WP=Da;function YP(e,t){var a=e.l+t,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}var XP=Da;function KP(e,t,a){var r={};r.NumberFmt=[];for(var s in qe)r.NumberFmt[s]=qe[s];r.CellXf=[],r.Fonts=[];var l=[],c=!1;return Gn(e,function(h,m,p){switch(p){case 44:r.NumberFmt[h[0]]=h[1],pi(h[1],h[0]);break;case 43:r.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=X0(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(m.T>0)l.push(p);else if(m.T<0)l.pop();else if(!c||a.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var JP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QP(e,t,a){t.themeElements.clrScheme=[];var r={};(e[0].match(ja)||[]).forEach(function(s){var l=Ve(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[JP.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function ZP(){}function e9(){}var t9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,a9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,r9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function n9(e,t,a){t.themeElements={};var r;[["clrScheme",t9,QP],["fontScheme",a9,ZP],["fmtScheme",r9,e9]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,t,a)})}var s9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function HS(e,t){(!e||e.length===0)&&(e=i9());var a,r={};if(!(a=e.match(s9)))throw new Error("themeElements not found in theme");return n9(a[0],r,t),r.raw=e,r}function i9(e,t){var a=[eS];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function l9(e,t,a){var r=e.l+t,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var c;try{c=ZT(l,{type:"array"})}catch{return}var u=fr(c,"theme/theme/theme1.xml",!0);if(u)return HS(u,a)}}function o9(e){return e.read_shift(4)}function c9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=u9(e,4);break;case 2:t.xclrValue=CS(e);break;case 3:t.xclrValue=o9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function u9(e,t){return Da(e,t)}function f9(e,t){return Da(e,t)}function h9(e){var t=e.read_shift(2),a=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=c9(e);break;case 6:r[1]=f9(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+a)}return r}function d9(e,t){var a=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(h9(e,a-e.l));return{ixfe:r,ext:l}}function m9(e,t){t.forEach(function(a){a[0]})}function p9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ca(e)}}function x9(e){for(var t=[],a=e.read_shift(4);a-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function g9(e){return e.l+=4,e.read_shift(4)!=0}function v9(e,t,a){var r={Types:[],Cell:[],Value:[]},s=a||{},l=[],c=!1,u=2;return Gn(e,function(h,m,p){switch(p){case 335:r.Types.push({name:h.name});break;case 51:h.forEach(function(g){u==1?r.Cell.push({type:r.Types[g[0]-1].name,index:g[1]}):u==0&&r.Value.push({type:r.Types[g[0]-1].name,index:g[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!m.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function y9(e,t,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,l=2,c;return e.replace(ja,function(u){var h=Ve(u);switch(xn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<r.Types.length;++m)r.Types[m].name==h.name&&(c=r.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[h.t-1].name,index:+h.v}):l==0&&r.Value.push({type:r.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),r}function b9(e){var t=[];if(!e)return t;var a=1;return(e.match(ja)||[]).forEach(function(r){var s=Ve(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,t.push(s);break}}),t}function w9(e){var t={};t.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),t.r=$e(a);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function _9(e,t,a){var r=[];return Gn(e,function(l,c,u){switch(u){case 63:r.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function T9(e,t,a,r){if(!e)return e;var s=r||{},l=!1;Gn(e,function(u,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function S9(e,t){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][a].Target}function aw(e,t,a,r){var s=Array.isArray(e),l;t.forEach(function(c){var u=Ba(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=zt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var m=st(h);m!==e["!ref"]&&(e["!ref"]=m)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:a};c.h&&(p.h=c.h);for(var g=l.c.length-1;g>=0;--g){if(!a&&l.c[g].T)return;a&&!l.c[g].T&&l.c.splice(g,1)}if(a&&r){for(g=0;g<r.length;++g)if(p.a==r[g].id){p.a=r[g].name||p.a;break}}l.c.push(p)})}function E9(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&a.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=Ve(u[0]),m={author:h.authorId&&a[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Ba(h.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var g=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!g&&!!g[1]&&fx(g[1])||{r:"",t:"",h:""};m.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),m.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(m.h=y.h),r.push(m)}}}}),r}function k9(e,t){var a=[],r=!1,s={},l=0;return e.replace(ja,function(u,h){var m=Ve(u);switch(xn(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),a}function A9(e,t){var a=[],r=!1;return e.replace(ja,function(l){var c=Ve(l);switch(xn(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),a}function N9(e){var t={};t.iauthor=e.read_shift(4);var a=Ti(e);return t.rfx=a.s,t.ref=$e(a.s),e.l+=16,t}var C9=Ca;function O9(e,t){var a=[],r=[],s={},l=!1;return Gn(e,function(u,h,m){switch(m){case 632:r.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}var D9="application/vnd.ms-office.vbaProject";function j9(e){var t=nt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(t,s,e.FileIndex[r].content)}}),nt.write(t)}function R9(){return{"!type":"dialog"}}function M9(){return{"!type":"dialog"}}function F9(){return{"!type":"macro"}}function L9(){return{"!type":"macro"}}var jl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function a(r,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var m=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return u?p+=t.c:--p,h?m+=t.r:--m,s+(u?"":"$")+ia(p)+(h?"":"$")+wa(m)}return function(s,l){return t=l,s.replace(e,a)}})(),$S=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,P9=(function(){return function(t,a){return t.replace($S,function(r,s,l,c,u,h){var m=sx(c)-(l?0:a.c),p=nx(h)-(u?0:a.r),g=p==0?"":u?p+1:"["+p+"]",y=m==0?"":l?m+1:"["+m+"]";return s+"R"+g+"C"+y})}})();function GS(e,t){return e.replace($S,function(a,r,s,l,c,u){return r+(s=="$"?s+l:ia(sx(l)+t.c))+(c=="$"?c+u:wa(nx(u)+t.r))})}function I9(e,t,a){var r=zl(t),s=r.s,l=Ba(a),c={r:l.r-s.r,c:l.c-s.c};return GS(e,c)}function B9(e){return e.length!=1}function rw(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function Ds(e,t){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function qS(e,t,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return WS(e);a.biff==12&&(r=4)}var s=e.read_shift(r),l=e.read_shift(r),c=Ds(e),u=Ds(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function WS(e){var t=Ds(e),a=Ds(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function U9(e,t,a){if(a.biff<8)return WS(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),l=Ds(e),c=Ds(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function YS(e,t,a){if(a&&a.biff>=2&&a.biff<=5)return z9(e);var r=e.read_shift(a&&a.biff==12?4:2),s=Ds(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function z9(e){var t=Ds(e),a=e.read_shift(1);return{r:t[0],c:a,cRel:t[1],rRel:t[2]}}function V9(e){var t=e.read_shift(2),a=e.read_shift(2);return{r:t,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function H9(e,t,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return $9(e);var s=e.read_shift(r>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function $9(e){var t=e.read_shift(2),a=e.read_shift(1),r=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),s==1&&a>=128&&(a=a-256),{r:t,c:a,cRel:s,rRel:r}}function G9(e,t,a){var r=(e[e.l++]&96)>>5,s=qS(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function q9(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=qS(e,l,a);return[r,s,c]}function W9(e,t,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function Y9(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,s]}function X9(e,t,a){var r=(e[e.l++]&96)>>5,s=U9(e,t-1,a);return[r,s]}function K9(e,t,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function nw(e){var t=e[e.l+1]&1,a=1;return e.l+=4,[t,a]}function J9(e,t,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],l=0;l<=r;++l)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function Q9(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function Z9(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function eI(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tI(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function XS(e){var t=e.read_shift(1),a=e.read_shift(1);return[t,a]}function aI(e){return e.read_shift(2),XS(e)}function rI(e){return e.read_shift(2),XS(e)}function nI(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=YS(e,0,a);return[r,s]}function sI(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=H9(e,0,a);return[r,s]}function iI(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var l=YS(e,0,a);return[r,s,l]}function lI(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[o7[s],QS[s],r]}function oI(e,t,a){var r=e[e.l++],s=e.read_shift(1),l=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:cI(e);return[s,(l[0]===0?QS:l7)[l[1]]]}function cI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uI(e,t,a){e.l+=a&&a.biff==2?3:4}function fI(e,t,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function hI(e){return e.l++,Si[e.read_shift(1)]}function dI(e){return e.l++,e.read_shift(2)}function mI(e){return e.l++,e.read_shift(1)!==0}function pI(e){return e.l++,ka(e)}function xI(e,t,a){return e.l++,Pc(e,t-1,a)}function gI(e,t){var a=[e.read_shift(1)];if(t==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Gt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:a[1]=Si[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=ka(e);break;case 2:a[1]=Ei(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function vI(e,t,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],l=0;l!=r;++l)s.push((a.biff==12?Ti:ff)(e));return s}function yI(e,t,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var l=0,c=[];l!=r&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=gI(e,a.biff);return c}function bI(e,t,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,l=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function wI(e,t,a){if(a.biff==5)return _I(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[r,s,l]}function _I(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,a,r]}function TI(e,t,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function SI(e,t,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function EI(e,t,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function kI(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(a)switch(a.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,s]}var AI=Da,NI=Da,CI=Da;function Bc(e,t,a){return e.l+=2,[V9(e)]}function dx(e){return e.l+=6,[]}var OI=Bc,DI=dx,jI=dx,RI=Bc;function KS(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var MI=Bc,FI=KS,LI=dx,PI=Bc,II=Bc,BI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function UI(e){e.l+=2;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=BI[a>>2&31];return{ixti:t,coltype:a&3,rt:c,idx:r,c:s,C:l}}function zI(e){return e.l+=2,[e.read_shift(4)]}function VI(e,t,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function HI(e,t,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function $I(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[t,a]}function GI(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[t,a]}function qI(e){return e.l+=4,[0,0]}var sw={1:{n:"PtgExp",f:fI},2:{n:"PtgTbl",f:CI},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:xI},26:{n:"PtgSheet",f:VI},27:{n:"PtgEndSheet",f:HI},28:{n:"PtgErr",f:hI},29:{n:"PtgBool",f:mI},30:{n:"PtgInt",f:dI},31:{n:"PtgNum",f:pI},32:{n:"PtgArray",f:K9},33:{n:"PtgFunc",f:lI},34:{n:"PtgFuncVar",f:oI},35:{n:"PtgName",f:bI},36:{n:"PtgRef",f:nI},37:{n:"PtgArea",f:G9},38:{n:"PtgMemArea",f:TI},39:{n:"PtgMemErr",f:AI},40:{n:"PtgMemNoMem",f:NI},41:{n:"PtgMemFunc",f:SI},42:{n:"PtgRefErr",f:EI},43:{n:"PtgAreaErr",f:W9},44:{n:"PtgRefN",f:sI},45:{n:"PtgAreaN",f:X9},46:{n:"PtgMemAreaN",f:$I},47:{n:"PtgMemNoMemN",f:GI},57:{n:"PtgNameX",f:wI},58:{n:"PtgRef3d",f:iI},59:{n:"PtgArea3d",f:q9},60:{n:"PtgRefErr3d",f:kI},61:{n:"PtgAreaErr3d",f:Y9},255:{}},WI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YI={1:{n:"PtgElfLel",f:KS},2:{n:"PtgElfRw",f:PI},3:{n:"PtgElfCol",f:OI},6:{n:"PtgElfRwV",f:II},7:{n:"PtgElfColV",f:RI},10:{n:"PtgElfRadical",f:MI},11:{n:"PtgElfRadicalS",f:LI},13:{n:"PtgElfColS",f:DI},15:{n:"PtgElfColSV",f:jI},16:{n:"PtgElfRadicalLel",f:FI},25:{n:"PtgList",f:UI},29:{n:"PtgSxName",f:zI},255:{}},XI={0:{n:"PtgAttrNoop",f:qI},1:{n:"PtgAttrSemi",f:tI},2:{n:"PtgAttrIf",f:Z9},4:{n:"PtgAttrChoose",f:J9},8:{n:"PtgAttrGoto",f:Q9},16:{n:"PtgAttrSum",f:uI},32:{n:"PtgAttrBaxcel",f:nw},33:{n:"PtgAttrBaxcel",f:nw},64:{n:"PtgAttrSpace",f:aI},65:{n:"PtgAttrSpaceSemi",f:rI},128:{n:"PtgAttrIfError",f:eI},255:{}};function Uc(e,t,a,r){if(r.biff<8)return Da(e,t);for(var s=e.l+t,l=[],c=0;c!==a.length;++c)switch(a[c][0]){case"PtgArray":a[c][1]=yI(e,0,r),l.push(a[c][1]);break;case"PtgMemArea":a[c][2]=vI(e,a[c][1],r),l.push(a[c][2]);break;case"PtgExp":r&&r.biff==12&&(a[c][1][1]=e.read_shift(4),l.push(a[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[c][0]}return t=s-e.l,t!==0&&l.push(Da(e,t)),l}function zc(e,t,a){for(var r=e.l+t,s,l,c=[];r!=e.l;)t=r-e.l,l=e[e.l],s=sw[l]||sw[WI[l]],(l===24||l===25)&&(s=(l===24?YI:XI)[e[e.l+1]]),!s||!s.f?Da(e,t):c.push([s.n,s.f(e,t,a)]);return c}function KI(e){for(var t=[],a=0;a<e.length;++a){for(var r=e[a],s=[],l=0;l<r.length;++l){var c=r[l];c?c[0]===2?s.push('"'+c[1].replace(/"/g,'""')+'"'):s.push(c[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var JI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function QI(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function JS(e,t,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(a.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function iw(e,t,a){var r=JS(e,t,a);return r=="#REF"?r:QI(r,a)}function Ea(e,t,a,r,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,m,p,g=0,y=0,b,_="";if(!e[0]||!e[0][0])return"";for(var w=-1,T="",A=0,k=e[0].length;A<k;++A){var S=e[0][A];switch(S[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),m=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:T=Ut(" ",e[0][w][1][1]);break;case 1:T=Ut("\r",e[0][w][1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}m=m+T,w=-1}u.push(m+JI[S[0]]+h);break;case"PtgIsect":h=u.pop(),m=u.pop(),u.push(m+" "+h);break;case"PtgUnion":h=u.pop(),m=u.pop(),u.push(m+","+h);break;case"PtgRange":h=u.pop(),m=u.pop(),u.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Zo(S[1][1],c,s),u.push(ec(p,l));break;case"PtgRefN":p=a?Zo(S[1][1],a,s):S[1][1],u.push(ec(p,l));break;case"PtgRef3d":g=S[1][1],p=Zo(S[1][2],c,s),_=iw(r,g,s),u.push(_+"!"+ec(p,l));break;case"PtgFunc":case"PtgFuncVar":var L=S[1][0],V=S[1][1];L||(L=0),L&=127;var P=L==0?[]:u.slice(-L);u.length-=L,V==="User"&&(V=P.shift()),u.push(V+"("+P.join(",")+")");break;case"PtgBool":u.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(S[1]);break;case"PtgNum":u.push(String(S[1]));break;case"PtgStr":u.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(S[1]);break;case"PtgAreaN":b=Ub(S[1][1],a?{s:a}:c,s),u.push(sm(b,s));break;case"PtgArea":b=Ub(S[1][1],c,s),u.push(sm(b,s));break;case"PtgArea3d":g=S[1][1],b=S[1][2],_=iw(r,g,s),u.push(_+"!"+sm(b,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=S[1][2];var N=(r.names||[])[y-1]||(r[0]||[])[y],j=N?N.Name:"SH33TJSNAME"+String(y);j&&j.slice(0,6)=="_xlfn."&&!s.xlfn&&(j=j.slice(6)),u.push(j);break;case"PtgNameX":var I=S[1][1];y=S[1][2];var z;if(s.biff<=5)I<0&&(I=-I),r[I]&&(z=r[I][y]);else{var X="";if(((r[I]||[])[0]||[])[0]==14849||(((r[I]||[])[0]||[])[0]==1025?r[I][y]&&r[I][y].itab>0&&(X=r.SheetNames[r[I][y].itab-1]+"!"):X=r.SheetNames[y-1]+"!"),r[I]&&r[I][y])X+=r[I][y].Name;else if(r[0]&&r[0][y])X+=r[0][y].Name;else{var q=(JS(r,I,s)||"").split(";;");q[y-1]?X=q[y-1]:X+="SH33TJSERRX"}u.push(X);break}z||(z={Name:"SH33TJSERRY"}),u.push(z.Name);break;case"PtgParen":var Q="(",be=")";if(w>=0){switch(T="",e[0][w][1][0]){case 2:Q=Ut(" ",e[0][w][1][1])+Q;break;case 3:Q=Ut("\r",e[0][w][1][1])+Q;break;case 4:be=Ut(" ",e[0][w][1][1])+be;break;case 5:be=Ut("\r",e[0][w][1][1])+be;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(Q+u.pop()+be);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var ve={c:a.c,r:a.r};if(r.sharedf[$e(p)]){var R=r.sharedf[$e(p)];u.push(Ea(R,c,ve,r,s))}else{var te=!1;for(h=0;h!=r.arrayf.length;++h)if(m=r.arrayf[h],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(Ea(m[1],c,ve,r,s)),te=!0;break}te||u.push(S[1])}break;case"PtgArray":u.push("{"+KI(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&ye.indexOf(e[0][A][0])==-1){S=e[0][w];var ae=!0;switch(S[1][0]){case 4:ae=!1;case 0:T=Ut(" ",S[1][1]);break;case 5:ae=!1;case 1:T=Ut("\r",S[1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}u.push((ae?T:"")+u.pop()+(ae?"":T)),w=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function ZI(e,t,a){var r=e.l+t,s=a.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Da(e,t-2)];var u=zc(e,c,a);return t!==c+s&&(l=Uc(e,t-c-s,u,a)),e.l=r,[u,l]}function e7(e,t,a){var r=e.l+t,s=a.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Da(e,t-2)];var u=zc(e,c,a);return t!==c+s&&(l=Uc(e,t-c-s,u,a)),e.l=r,[u,l]}function t7(e,t,a,r){var s=e.l+t,l=zc(e,r,a),c;return s!==e.l&&(c=Uc(e,s-e.l,l,a)),[l,c]}function a7(e,t,a){var r=e.l+t,s,l=e.read_shift(2),c=zc(e,l,a);return l==65535?[[],Da(e,t-2)]:(t!==l+2&&(s=Uc(e,r-l-2,c,a)),[c,s])}function r7(e){var t;if(Pn(e,e.l+6)!==65535)return[ka(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function om(e,t,a){var r=e.l+t,s=gn(e);a.biff==2&&++e.l;var l=r7(e),c=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var u=e7(e,r-e.l,a);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function hf(e,t,a){var r=e.read_shift(4),s=zc(e,r,a),l=e.read_shift(4),c=l>0?Uc(e,l,s,a):null;return[s,c]}var n7=hf,df=hf,s7=hf,i7=hf,l7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},QS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},o7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function cm(e){var t=e.split(":"),a=t[0].split(".")[0];return[a,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var nc={},Rl={};function sc(e,t){if(e){var a=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function ZS(e,t,a,r,s,l){try{r.cellNF&&(e.z=qe[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ua(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(qe[t]==null&&pi(cM[t]||"General",t),e.t==="e")e.w=e.w||Si[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Tc(e.v);else if(e.t==="d"){var c=za(e.v);(c|0)===c?e.w=c.toString(10):e.w=Tc(c)}else{if(e.v===void 0)return"";e.w=gi(e.v,Rl)}else e.t==="d"?e.w=Rr(t,za(e.v),Rl):e.w=Rr(t,e.v,Rl)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&a!=null)try{e.s=l.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=X0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=X0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&l.Fills)throw u}}}function c7(e,t){var a=zt(t);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=st(a))}var u7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,f7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,h7=/<(?:\w:)?hyperlink [^>]*>/mg,d7=/"(\w*:\w*)"/,m7=/<(?:\w:)?col\b[^>]*[\/]?>/g,p7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,x7=/<(?:\w:)?pageMargins[^>]*\/>/g,eE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,g7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,v7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function y7(e,t,a,r,s,l,c){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",g=e.match(f7);g?(m=e.slice(0,g.index),p=e.slice(g.index+g[0].length)):m=p=e;var y=m.match(eE);y?mx(y[0],u,s,a):(y=m.match(g7))&&b7(y[0],y[1]||"",u,s,a);var b=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var _=m.slice(b,b+50).match(d7);_&&c7(u,_[1])}var w=m.match(v7);w&&w[1]&&k7(w[1],s);var T=[];if(t.cellStyles){var A=m.match(m7);A&&T7(T,A)}g&&A7(g[1],u,t,h,l,c);var k=p.match(p7);k&&(u["!autofilter"]=S7(k[0]));var S=[],L=p.match(u7);if(L)for(b=0;b!=L.length;++b)S[b]=zt(L[b].slice(L[b].indexOf('"')+1));var V=p.match(h7);V&&w7(u,V,r);var P=p.match(x7);if(P&&(u["!margins"]=_7(Ve(P[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=st(h)),t.sheetRows>0&&u["!ref"]){var N=zt(u["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>h.e.r&&(N.e.r=h.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>h.e.c&&(N.e.c=h.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),u["!fullref"]=u["!ref"],u["!ref"]=st(N))}return T.length>0&&(u["!cols"]=T),S.length>0&&(u["!merges"]=S),u}function mx(e,t,a,r){var s=Ve(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=it(Tt(s.codeName)))}function b7(e,t,a,r,s){mx(e.slice(0,e.indexOf(">")),a,r,s)}function w7(e,t,a){for(var r=Array.isArray(e),s=0;s!=t.length;++s){var l=Ve(Tt(t[s]),!0);if(!l.ref)return;var c=((a||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+it(l.location))):(l.Target="#"+it(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=zt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var m=u.s.c;m<=u.e.c;++m){var p=$e({c:m,r:h});r?(e[h]||(e[h]=[]),e[h][m]||(e[h][m]={t:"z",v:void 0}),e[h][m].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function _7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(t[a]=parseFloat(e[a]))}),t}function T7(e,t){for(var a=!1,r=0;r!=t.length;++r){var s=Ve(t[r],!0);s.hidden&&(s.hidden=jt(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,hx(s.width)),Ll(s);l<=c;)e[l++]=ba(s)}}function S7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var E7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function k7(e,t){t.Views||(t.Views=[{}]),(e.match(E7)||[]).forEach(function(a,r){var s=Ve(a);t.Views[r]||(t.Views[r]={}),+s.zoomScale&&(t.Views[r].zoom=+s.zoomScale),jt(s.rightToLeft)&&(t.Views[r].RTL=!0)})}var A7=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Sc("v"),c=Sc("f");return function(h,m,p,g,y,b){for(var _=0,w="",T=[],A=[],k=0,S=0,L=0,V="",P,N,j=0,I=0,z,X,q=0,Q=0,be=Array.isArray(b.CellXf),ve,R=[],te=[],ye=Array.isArray(m),ae=[],Ee={},G=!1,O=!!p.sheetStubs,Z=h.split(t),W=0,J=Z.length;W!=J;++W){w=Z[W].trim();var he=w.length;if(he!==0){var we=0;e:for(_=0;_<he;++_)switch(w[_]){case">":if(w[_-1]!="/"){++_;break e}if(p&&p.cellStyles){if(N=Ve(w.slice(we,_),!0),j=N.r!=null?parseInt(N.r,10):j+1,I=-1,p.sheetRows&&p.sheetRows<j)continue;Ee={},G=!1,N.ht&&(G=!0,Ee.hpt=parseFloat(N.ht),Ee.hpx=Nc(Ee.hpt)),N.hidden=="1"&&(G=!0,Ee.hidden=!0),N.outlineLevel!=null&&(G=!0,Ee.level=+N.outlineLevel),G&&(ae[j-1]=Ee)}break;case"<":we=_;break}if(we>=_)break;if(N=Ve(w.slice(we,_),!0),j=N.r!=null?parseInt(N.r,10):j+1,I=-1,!(p.sheetRows&&p.sheetRows<j)){g.s.r>j-1&&(g.s.r=j-1),g.e.r<j-1&&(g.e.r=j-1),p&&p.cellStyles&&(Ee={},G=!1,N.ht&&(G=!0,Ee.hpt=parseFloat(N.ht),Ee.hpx=Nc(Ee.hpt)),N.hidden=="1"&&(G=!0,Ee.hidden=!0),N.outlineLevel!=null&&(G=!0,Ee.level=+N.outlineLevel),G&&(ae[j-1]=Ee)),T=w.slice(_).split(e);for(var Ne=0;Ne!=T.length&&T[Ne].trim().charAt(0)=="<";++Ne);for(T=T.slice(Ne),_=0;_!=T.length;++_)if(w=T[_].trim(),w.length!==0){if(A=w.match(a),k=_,S=0,L=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,A!=null&&A.length===2){for(k=0,V=A[1],S=0;S!=V.length&&!((L=V.charCodeAt(S)-64)<1||L>26);++S)k=26*k+L;--k,I=k}else++I;for(S=0;S!=w.length&&w.charCodeAt(S)!==62;++S);if(++S,N=Ve(w.slice(0,S),!0),N.r||(N.r=$e({r:j-1,c:I})),V=w.slice(S),P={t:""},(A=V.match(l))!=null&&A[1]!==""&&(P.v=it(A[1])),p.cellFormula){if((A=V.match(c))!=null&&A[1]!==""){if(P.f=it(Tt(A[1])).replace(/\r\n/g,`
`),p.xlfn||(P.f=rw(P.f)),A[0].indexOf('t="array"')>-1)P.F=(V.match(s)||[])[1],P.F.indexOf(":")>-1&&R.push([zt(P.F),P.F]);else if(A[0].indexOf('t="shared"')>-1){X=Ve(A[0]);var _e=it(Tt(A[1]));p.xlfn||(_e=rw(_e)),te[parseInt(X.si,10)]=[X,_e,N.r]}}else(A=V.match(/<f[^>]*\/>/))&&(X=Ve(A[0]),te[X.si]&&(P.f=I9(te[X.si][1],te[X.si][2],N.r)));var Se=Ba(N.r);for(S=0;S<R.length;++S)Se.r>=R[S][0].s.r&&Se.r<=R[S][0].e.r&&Se.c>=R[S][0].s.c&&Se.c<=R[S][0].e.c&&(P.F=R[S][1])}if(N.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(O)P.t="z";else continue;else P.t=N.t||"n";switch(g.s.c>I&&(g.s.c=I),g.e.c<I&&(g.e.c=I),P.t){case"n":if(P.v==""||P.v==null){if(!O)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!O)continue;P.t="z"}else z=nc[parseInt(P.v,10)],P.v=z.t,P.r=z.r,p.cellHTML&&(P.h=z.h);break;case"str":P.t="s",P.v=P.v!=null?Tt(P.v):"",p.cellHTML&&(P.h=tx(P.v));break;case"inlineStr":A=V.match(r),P.t="s",A!=null&&(z=fx(A[1]))?(P.v=z.t,p.cellHTML&&(P.h=z.h)):P.v="";break;case"b":P.v=jt(P.v);break;case"d":p.cellDates?P.v=ua(P.v,1):(P.v=za(ua(P.v,1)),P.t="n");break;case"e":(!p||p.cellText!==!1)&&(P.w=P.v),P.v=wS[P.v];break}if(q=Q=0,ve=null,be&&N.s!==void 0&&(ve=b.CellXf[N.s],ve!=null&&(ve.numFmtId!=null&&(q=ve.numFmtId),p.cellStyles&&ve.fillId!=null&&(Q=ve.fillId))),ZS(P,q,Q,p,y,b),p.cellDates&&be&&P.t=="n"&&Ul(qe[q])&&(P.t="d",P.v=uf(P.v)),N.cm&&p.xlmeta){var Je=(p.xlmeta.Cell||[])[+N.cm-1];Je&&Je.type=="XLDAPR"&&(P.D=!0)}if(ye){var Y=Ba(N.r);m[Y.r]||(m[Y.r]=[]),m[Y.r][Y.c]=P}else m[N.r]=P}}}}ae.length>0&&(m["!rows"]=ae)}})();function N7(e,t){var a={},r=e.l+t;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(a.level=l&7),l&16&&(a.hidden=!0),l&32&&(a.hpt=s/20),a}var C7=Ti;function O7(){}function D7(e,t){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=ZM(e),a}function j7(e){var t=Mr(e);return[t]}function R7(e){var t=_i(e);return[t]}function M7(e){var t=Mr(e),a=e.read_shift(1);return[t,a,"b"]}function F7(e){var t=_i(e),a=e.read_shift(1);return[t,a,"b"]}function L7(e){var t=Mr(e),a=e.read_shift(1);return[t,a,"e"]}function P7(e){var t=_i(e),a=e.read_shift(1);return[t,a,"e"]}function I7(e){var t=Mr(e),a=e.read_shift(4);return[t,a,"s"]}function B7(e){var t=_i(e),a=e.read_shift(4);return[t,a,"s"]}function U7(e){var t=Mr(e),a=ka(e);return[t,a,"n"]}function tE(e){var t=_i(e),a=ka(e);return[t,a,"n"]}function z7(e){var t=Mr(e),a=ox(e);return[t,a,"n"]}function V7(e){var t=_i(e),a=ox(e);return[t,a,"n"]}function H7(e){var t=Mr(e),a=ix(e);return[t,a,"is"]}function $7(e){var t=Mr(e),a=Ca(e);return[t,a,"str"]}function G7(e){var t=_i(e),a=Ca(e);return[t,a,"str"]}function q7(e,t,a){var r=e.l+t,s=Mr(e);s.r=a["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(a.cellFormula){e.l+=2;var u=df(e,r-e.l,a);c[3]=Ea(u,null,s,a.supbooks,a)}else e.l=r;return c}function W7(e,t,a){var r=e.l+t,s=Mr(e);s.r=a["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(a.cellFormula){e.l+=2;var u=df(e,r-e.l,a);c[3]=Ea(u,null,s,a.supbooks,a)}else e.l=r;return c}function Y7(e,t,a){var r=e.l+t,s=Mr(e);s.r=a["!row"];var l=ka(e),c=[s,l,"n"];if(a.cellFormula){e.l+=2;var u=df(e,r-e.l,a);c[3]=Ea(u,null,s,a.supbooks,a)}else e.l=r;return c}function X7(e,t,a){var r=e.l+t,s=Mr(e);s.r=a["!row"];var l=Ca(e),c=[s,l,"str"];if(a.cellFormula){e.l+=2;var u=df(e,r-e.l,a);c[3]=Ea(u,null,s,a.supbooks,a)}else e.l=r;return c}var K7=Ti;function J7(e,t){var a=e.l+t,r=Ti(e),s=lx(e),l=Ca(e),c=Ca(e),u=Ca(e);e.l=a;var h={rfx:r,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function Q7(){}function Z7(e,t,a){var r=e.l+t,s=vS(e),l=e.read_shift(1),c=[s];if(c[2]=l,a.cellFormula){var u=n7(e,r-e.l,a);c[1]=u}else e.l=r;return c}function eB(e,t,a){var r=e.l+t,s=Ti(e),l=[s];if(a.cellFormula){var c=i7(e,r-e.l,a);l[1]=c,e.l=r}else e.l=r;return l}var tB=["left","right","top","bottom","header","footer"];function aB(e){var t={};return tB.forEach(function(a){t[a]=ka(e)}),t}function rB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nB(){}function sB(){}function iB(e,t,a,r,s,l,c){if(!e)return e;var u=t||{};r||(r={"!id":{}});var h=u.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,y=!1,b,_,w,T,A,k,S,L,V,P=[];u.biff=12,u["!row"]=0;var N=0,j=!1,I=[],z={},X=u.supbooks||s.supbooks||[[]];if(X.sharedf=z,X.arrayf=I,X.SheetNames=s.SheetNames||s.Sheets.map(function(ye){return ye.name}),!u.supbooks&&(u.supbooks=X,s.Names))for(var q=0;q<s.Names.length;++q)X[0][q+1]=s.Names[q];var Q=[],be=[],ve=!1;Q0[16]={n:"BrtShortReal",f:tE};var R;if(Gn(e,function(ae,Ee,G){if(!y)switch(G){case 148:m=ae;break;case 0:b=ae,u.sheetRows&&u.sheetRows<=b.r&&(y=!0),L=wa(T=b.r),u["!row"]=b.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Nc(ae.hpt)),be[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:ae[2]},ae[2]){case"n":_.v=ae[1];break;case"s":S=nc[ae[1]],_.v=S.t,_.r=S.r;break;case"b":_.v=!!ae[1];break;case"e":_.v=ae[1],u.cellText!==!1&&(_.w=Si[_.v]);break;case"str":_.t="s",_.v=ae[1];break;case"is":_.t="s",_.v=ae[1].t;break}if((w=c.CellXf[ae[0].iStyleRef])&&ZS(_,w.numFmtId,null,u,l,c),A=ae[0].c==-1?A+1:ae[0].c,u.dense?(h[T]||(h[T]=[]),h[T][A]=_):h[ia(A)+L]=_,u.cellFormula){for(j=!1,N=0;N<I.length;++N){var O=I[N];b.r>=O[0].s.r&&b.r<=O[0].e.r&&A>=O[0].s.c&&A<=O[0].e.c&&(_.F=st(O[0]),j=!0)}!j&&ae.length>3&&(_.f=ae[3])}if(p.s.r>b.r&&(p.s.r=b.r),p.s.c>A&&(p.s.c=A),p.e.r<b.r&&(p.e.r=b.r),p.e.c<A&&(p.e.c=A),u.cellDates&&w&&_.t=="n"&&Ul(qe[w.numFmtId])){var Z=di(_.v);Z&&(_.t="d",_.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}R&&(R.type=="XLDAPR"&&(_.D=!0),R=void 0);break;case 1:case 12:if(!u.sheetStubs||g)break;_={t:"z",v:void 0},A=ae[0].c==-1?A+1:ae[0].c,u.dense?(h[T]||(h[T]=[]),h[T][A]=_):h[ia(A)+L]=_,p.s.r>b.r&&(p.s.r=b.r),p.s.c>A&&(p.s.c=A),p.e.r<b.r&&(p.e.r=b.r),p.e.c<A&&(p.e.c=A),R&&(R.type=="XLDAPR"&&(_.D=!0),R=void 0);break;case 176:P.push(ae);break;case 49:R=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var W=r["!id"][ae.relId];for(W?(ae.Target=W.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=W):ae.relId==""&&(ae.Target="#"+ae.loc),T=ae.rfx.s.r;T<=ae.rfx.e.r;++T)for(A=ae.rfx.s.c;A<=ae.rfx.e.c;++A)u.dense?(h[T]||(h[T]=[]),h[T][A]||(h[T][A]={t:"z",v:void 0}),h[T][A].l=ae):(k=$e({c:A,r:T}),h[k]||(h[k]={t:"z",v:void 0}),h[k].l=ae);break;case 426:if(!u.cellFormula)break;I.push(ae),V=u.dense?h[T][A]:h[ia(A)+L],V.f=Ea(ae[1],p,{r:b.r,c:A},X,u),V.F=st(ae[0]);break;case 427:if(!u.cellFormula)break;z[$e(ae[0].s)]=ae[1],V=u.dense?h[T][A]:h[ia(A)+L],V.f=Ea(ae[1],p,{r:b.r,c:A},X,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)Q[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},ve||(ve=!0,hx(ae.w/256)),Ll(Q[ae.e+1]);break;case 161:h["!autofilter"]={ref:st(ae)};break;case 476:h["!margins"]=ae;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),ae.name&&(s.Sheets[a].CodeName=ae.name),(ae.above||ae.left)&&(h["!outline"]={above:ae.above,left:ae.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ae.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Ee.T){if(!g||u.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=st(m||p)),u.sheetRows&&h["!ref"]){var te=zt(h["!ref"]);u.sheetRows<=+te.e.r&&(te.e.r=u.sheetRows-1,te.e.r>p.e.r&&(te.e.r=p.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>p.e.c&&(te.e.c=p.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),h["!fullref"]=h["!ref"],h["!ref"]=st(te))}return P.length>0&&(h["!merges"]=P),Q.length>0&&(h["!cols"]=Q),be.length>0&&(h["!rows"]=be),h}function lB(e){var t=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=a?+c[2]:c[2])});var s=it((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[t,s,r]}function oB(e,t,a,r,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var y=lB(g);p.s.r=p.s.c=0,p.e.c=u,m=ia(u),y[0].forEach(function(b,_){c[m+wa(_)]={t:"n",v:b,z:y[1]},h=_}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(c["!ref"]=st(p)),c}function cB(e,t,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(eE);return u&&mx(u[0],l,s,a),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function uB(e,t){e.l+=10;var a=Ca(e);return{name:a}}function fB(e,t,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Gn(e,function(h,m,p){switch(p){case 550:l["!rel"]=h;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),h.name&&(s.Sheets[a].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var aE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],hB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],dB=[],mB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ow(e,t){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=t.length;++s){var l=t[s];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=jt(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function cw(e,t){for(var a=0;a!=t.length;++a){var r=t[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=jt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function rE(e){cw(e.WBProps,aE),cw(e.CalcPr,mB),ow(e.WBView,hB),ow(e.Sheets,dB),Rl.date1904=jt(e.WBProps.date1904)}var pB="][*?/\\".split("");function xB(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return pB.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}var gB=/<\w+:workbook/;function vB(e,t){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",l={},c=0;if(e.replace(ja,function(h,m){var p=Ve(h);switch(xn(p[0])){case"<?xml":break;case"<workbook":h.match(gB)&&(s="xmlns"+h.match(/<(\w+):/)[1]),a.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],a.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":aE.forEach(function(g){if(p[g[0]]!=null)switch(g[2]){case"bool":a.WBProps[g[0]]=jt(p[g[0]]);break;case"int":a.WBProps[g[0]]=parseInt(p[g[0]],10);break;default:a.WBProps[g[0]]=p[g[0]]}}),p.codeName&&(a.WBProps.CodeName=Tt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],a.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=it(Tt(p.name)),delete p[0],a.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Tt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),jt(p.hidden||"0")&&(l.Hidden=!0),c=m+h.length;break;case"</definedName>":l.Ref=it(Tt(e.slice(c,m))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],a.CalcPr=p;break;case"<calcPr/>":delete p[0],a.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),LM.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return rE(a),a}function yB(e,t){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=Jm(e),a.name=Ca(e),a}function bB(e,t){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=t>8?Ca(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function wB(e,t){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=t-8,a}function _B(e,t,a){var r=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=eF(e),c=s7(e,0,a),u=lx(e);e.l=r;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function TB(e,t){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Q0[16]={n:"BrtFRTArchID$",f:wB},Gn(e,function(h,m,p){switch(p){case 156:c.SheetNames.push(h.name),a.Sheets.push(h);break;case 153:a.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=Ea(h.Ptg,null,null,c,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,h]):c[0]=[p,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(p),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),rE(a),a.Names=l,a.supbooks=c,a}function SB(e,t,a){return t.slice(-4)===".bin"?TB(e,a):vB(e,a)}function EB(e,t,a,r,s,l,c,u){return t.slice(-4)===".bin"?iB(e,r,a,s,l,c,u):y7(e,r,a,s,l,c,u)}function kB(e,t,a,r,s,l,c,u){return t.slice(-4)===".bin"?fB(e,r,a,s,l):cB(e,r,a,s,l)}function AB(e,t,a,r,s,l,c,u){return t.slice(-4)===".bin"?F9():L9()}function NB(e,t,a,r,s,l,c,u){return t.slice(-4)===".bin"?R9():M9()}function CB(e,t,a,r){return t.slice(-4)===".bin"?KP(e,a,r):$P(e,a,r)}function OB(e,t,a){return HS(e,a)}function DB(e,t,a){return t.slice(-4)===".bin"?hP(e,a):uP(e,a)}function jB(e,t,a){return t.slice(-4)===".bin"?O9(e,a):E9(e,a)}function RB(e,t,a){return t.slice(-4)===".bin"?_9(e):b9(e)}function MB(e,t,a,r){return a.slice(-4)===".bin"?T9(e,t,a,r):void 0}function FB(e,t,a){return t.slice(-4)===".bin"?v9(e,t,a):y9(e,t,a)}var nE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vr(e,t){var a=e.split(/\s+/),r=[];if(r[0]=a[0],a.length===1)return r;var s=e.match(nE),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(sE),(c=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),r[u]=l[2].slice(1,l[2].length-1));return r}function LB(e){var t=e.split(/\s+/),a={};if(t.length===1)return a;var r=e.match(nE),s,l,c,u;if(r)for(u=0;u!=r.length;++u)s=r[u].match(sE),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),a[c]=s[2].slice(1,s[2].length-1));return a}var ic;function PB(e,t){var a=ic[e]||it(e);return a==="General"?gi(t):Rr(a,t)}function IB(e,t,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=jt(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=ua(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[it(t)]=s}function BB(e,t,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||Si[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Tc(e.v):e.w=gi(e.v):e.w=PB(t||"General",e.v)}catch(l){if(a.WTF)throw l}try{var r=ic[t]||t||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Ul(r)){var s=di(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(a.WTF)throw l}}}function UB(e,t,a){if(a.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=IP[r.Pattern]||r.Pattern)}e[t.ID]=t}function zB(e,t,a,r,s,l,c,u,h,m){var p="General",g=r.StyleID,y={};m=m||{};var b=[],_=0;for(g===void 0&&u&&(g=u.StyleID),g===void 0&&c&&(g=c.StyleID);l[g]!==void 0&&(l[g].nf&&(p=l[g].nf),l[g].Interior&&b.push(l[g].Interior),!!l[g].Parent);)g=l[g].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=jt(e);break;case"String":r.t="s",r.r=Db(it(e)),r.v=e.indexOf("<")>-1?it(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(ua(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=it(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=wS[e],m.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=Db(t||e));break}if(BB(r,p,m),m.cellFormula!==!1)if(r.Formula){var w=it(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=jl(w,s),delete r.Formula,r.ArrayRange=="RC"?r.F=jl("RC:RC",s):r.ArrayRange&&(r.F=jl(r.ArrayRange,s),h.push([zt(r.F),r.F]))}else for(_=0;_<h.length;++_)s.r>=h[_][0].s.r&&s.r<=h[_][0].e.r&&s.c>=h[_][0].s.c&&s.c<=h[_][0].e.c&&(r.F=h[_][1]);m.cellStyles&&(b.forEach(function(T){!y.patternType&&T.patternType&&(y.patternType=T.patternType)}),r.s=y),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function VB(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function um(e,t){var a=t||{};WT();var r=Vo(ax(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=Tt(r));var s=r.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=ba(a);return c.type="string",kc.to_workbook(r,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){s.indexOf("<"+Ct)>=0&&(l=!0)}),l)return JB(r,a);ic={"General Number":"General","General Date":qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qe[15],"Short Date":qe[14],"Long Time":qe[19],"Medium Time":qe[18],"Short Time":qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qe[2],Standard:qe[4],Percent:qe[10],Scientific:qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],m,p={},g=[],y=a.dense?[]:{},b="",_={},w={},T=Vr('<Data ss:Type="String">'),A=0,k=0,S=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},P={},N="",j=0,I=[],z={},X={},q=0,Q=[],be=[],ve={},R=[],te,ye=!1,ae=[],Ee=[],G={},O=0,Z=0,W={Sheets:[],WBProps:{date1904:!1}},J={};Ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";u=Ec.exec(r);)switch(u[3]=(he=u[3]).toLowerCase()){case"data":if(he=="data"){if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?zB(r.slice(A,u.index),N,T,h[h.length-1][0]=="comment"?ve:_,{c:k,r:S},V,R[k],w,ae,a):(N="",T=Vr(u[0]),A=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(be.length>0&&(_.c=be),(!a.sheetRows||a.sheetRows>S)&&_.v!==void 0&&(a.dense?(y[S]||(y[S]=[]),y[S][k]=_):y[ia(k)+wa(S)]=_),_.HRef&&(_.l={Target:it(_.HRef)},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(O=k+(parseInt(_.MergeAcross,10)|0),Z=S+(parseInt(_.MergeDown,10)|0),I.push({s:{c:k,r:S},e:{c:O,r:Z}})),!a.sheetStubs)_.MergeAcross?k=O+1:++k;else if(_.MergeAcross||_.MergeDown){for(var we=k;we<=O;++we)for(var Ne=S;Ne<=Z;++Ne)(we>k||Ne>S)&&(a.dense?(y[Ne]||(y[Ne]=[]),y[Ne][we]={t:"z"}):y[ia(we)+wa(Ne)]={t:"z"});k=O+1}else++k;else _=LB(u[0]),_.Index&&(k=+_.Index-1),k<L.s.c&&(L.s.c=k),k>L.e.c&&(L.e.c=k),u[0].slice(-2)==="/>"&&++k,be=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(S<L.s.r&&(L.s.r=S),S>L.e.r&&(L.e.r=S),u[0].slice(-2)==="/>"&&(w=Vr(u[0]),w.Index&&(S=+w.Index-1)),k=0,++S):(w=Vr(u[0]),w.Index&&(S=+w.Index-1),G={},(w.AutoFitHeight=="0"||w.Height)&&(G.hpx=parseInt(w.Height,10),G.hpt=VS(G.hpx),Ee[S]=G),w.Hidden=="1"&&(G.hidden=!0,Ee[S]=G));break;case"worksheet":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));g.push(b),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(y["!ref"]=st(L),a.sheetRows&&a.sheetRows<=L.e.r&&(y["!fullref"]=y["!ref"],L.e.r=a.sheetRows-1,y["!ref"]=st(L))),I.length&&(y["!merges"]=I),R.length>0&&(y["!cols"]=R),Ee.length>0&&(y["!rows"]=Ee),p[b]=y}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=k=0,h.push([u[3],!1]),m=Vr(u[0]),b=it(m.Name),y=a.dense?[]:{},I=[],ae=[],Ee=[],J={name:b,Hidden:0},W.Sheets.push(J);break;case"table":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),R=[],ye=!1}break;case"style":u[1]==="/"?UB(V,P,a):P=Vr(u[0]);break;case"numberformat":P.nf=it(Vr(u[0]).Format||"General"),ic[P.nf]&&(P.nf=ic[P.nf]);for(var _e=0;_e!=392&&qe[_e]!=P.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(qe[_e]==null){pi(P.nf,_e);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(te=Vr(u[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!ye&&te.wpx>10){ye=!0,La=US;for(var Se=0;Se<R.length;++Se)R[Se]&&Ll(R[Se])}ye&&Ll(te),R[te.Index-1||R.length]=te;for(var Je=0;Je<+te.Span;++Je)R[R.length]=ba(te);break;case"namedrange":if(u[1]==="/")break;W.Names||(W.Names=[]);var Y=Ve(u[0]),Nt={Name:Y.Name,Ref:jl(Y.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Nt.Sheet=W.Sheets.length-1),W.Names.push(Nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?N+=r.slice(j,u.index):j=u.index+u[0].length;break;case"interior":if(!a.cellStyles)break;P.Interior=Vr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?EF(z,he,r.slice(q,u.index)):q=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));VB(ve),be.push(ve)}else h.push([u[3],!1]),m=Vr(u[0]),ve={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ke=Vr(u[0]);y["!autofilter"]={ref:jl(Ke.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return pw(r,a);var ct=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ct=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ct=!1}break;case"excelworkbook":switch(u[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ct=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ct=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(q,u.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else q=u.index+u[0].length;break;case"header":y["!margins"]||sc(y["!margins"]={},"xlml"),isNaN(+Ve(u[0]).Margin)||(y["!margins"].header=+Ve(u[0]).Margin);break;case"footer":y["!margins"]||sc(y["!margins"]={},"xlml"),isNaN(+Ve(u[0]).Margin)||(y["!margins"].footer=+Ve(u[0]).Margin);break;case"pagemargins":var We=Ve(u[0]);y["!margins"]||sc(y["!margins"]={},"xlml"),isNaN(+We.Top)||(y["!margins"].top=+We.Top),isNaN(+We.Left)||(y["!margins"].left=+We.Left),isNaN(+We.Right)||(y["!margins"].right=+We.Right),isNaN(+We.Bottom)||(y["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ct=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ct=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ct=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ct=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ct=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ct=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ct=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ct=!1}break;case"smarttags":break;default:ct=!1;break}if(ct||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?IB(X,he,Q,r.slice(q,u.index)):(Q=u,q=u.index+u[0].length);break}if(a.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Oe={};return!a.bookSheets&&!a.bookProps&&(Oe.Sheets=p),Oe.SheetNames=g,Oe.Workbook=W,Oe.SSF=ba(qe),Oe.Props=z,Oe.Custprops=X,Oe}function tp(e,t){switch(gx(t=t||{}),t.type||"base64"){case"base64":return um(hr(e),t);case"binary":case"buffer":case"file":return um(e,t);case"array":return um(wi(e),t)}}function HB(e){var t={},a=e.content;if(a.l=28,t.AnsiUserType=a.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=rF(a),a.length-a.l<=4)return t;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,t.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=nF(a),r=a.read_shift(4),r==0||r>40))return t;a.l-=4,t.Reserved2=a.read_shift(0,"lpwstr")}var $B=[60,1084,2066,2165,2175];function GB(e,t,a,r,s){var l=r,c=[],u=a.slice(a.l,a.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),a.l+=l;for(var h=Pn(a,a.l),m=ap[h],p=0;m!=null&&$B.indexOf(h)>-1;)l=Pn(a,a.l+2),p=a.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=a.slice(p,a.l+4+l),c.push(u),a.l+=4+l,m=ap[h=Pn(a,a.l)];var g=Ts(c);ya(g,0);var y=0;g.lens=[];for(var b=0;b<c.length;++b)g.lens.push(y),y+=c[b].length;if(g.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+r;return t.f(g,g.length,s)}function ln(e,t,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=qe[r])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Si[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Tc(e.v):e.w=gi(e.v):e.w=Rr(r,e.v,{date1904:!!a,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&r&&e.t=="n"&&Ul(qe[r]||String(r))){var s=di(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function _0(e,t,a){return{v:e,ixfe:t,t:a}}function qB(e,t){var a={opts:{}},r={},s=t.dense?[]:{},l={},c={},u=null,h=[],m="",p={},g,y="",b,_,w,T,A={},k=[],S,L,V=[],P=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},I=function(Ye){return Ye<8?xi[Ye]:Ye<64&&P[Ye-8]||xi[Ye]},z=function(Ye,Rt,Ha){var St=Rt.XF.data;if(!(!St||!St.patternType||!Ha||!Ha.cellStyles)){Rt.s={},Rt.s.patternType=St.patternType;var Vt;(Vt=Ac(I(St.icvFore)))&&(Rt.s.fgColor={rgb:Vt}),(Vt=Ac(I(St.icvBack)))&&(Rt.s.bgColor={rgb:Vt})}},X=function(Ye,Rt,Ha){if(!(G>1)&&!(Ha.sheetRows&&Ye.r>=Ha.sheetRows)){if(Ha.cellStyles&&Rt.XF&&Rt.XF.data&&z(Ye,Rt,Ha),delete Rt.ixfe,delete Rt.XF,g=Ye,y=$e(Ye),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<c.s.r&&(c.s.r=Ye.r),Ye.c<c.s.c&&(c.s.c=Ye.c),Ye.r+1>c.e.r&&(c.e.r=Ye.r+1),Ye.c+1>c.e.c&&(c.e.c=Ye.c+1),Ha.cellFormula&&Rt.f){for(var St=0;St<k.length;++St)if(!(k[St][0].s.c>Ye.c||k[St][0].s.r>Ye.r)&&!(k[St][0].e.c<Ye.c||k[St][0].e.r<Ye.r)){Rt.F=st(k[St][0]),(k[St][0].s.c!=Ye.c||k[St][0].s.r!=Ye.r)&&delete Rt.f,Rt.f&&(Rt.f=""+Ea(k[St][1],c,Ye,ae,q));break}}Ha.dense?(s[Ye.r]||(s[Ye.r]=[]),s[Ye.r][Ye.c]=Rt):s[y]=Rt}},q={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(q.password=t.password);var Q,be=[],ve=[],R=[],te=[],ye=!1,ae=[];ae.SheetNames=q.snames,ae.sharedf=q.sharedf,ae.arrayf=q.arrayf,ae.names=[],ae.XTI=[];var Ee=0,G=0,O=0,Z=[],W=[],J;q.codepage=1200,Xr(1200);for(var he=!1;e.l<e.length-1;){var we=e.l,Ne=e.read_shift(2);if(Ne===0&&Ee===10)break;var _e=e.l===e.length?0:e.read_shift(2),Se=ap[Ne];if(Se&&Se.f){if(t.bookSheets&&Ee===133&&Ne!==133)break;if(Ee=Ne,Se.r===2||Se.r==12){var Je=e.read_shift(2);if(_e-=2,!q.enc&&Je!==Ne&&((Je&255)<<8|Je>>8)!==Ne)throw new Error("rt mismatch: "+Je+"!="+Ne);Se.r==12&&(e.l+=10,_e-=10)}var Y={};if(Ne===10?Y=Se.f(e,_e,q):Y=GB(Ne,Se,e,_e,q),G==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(Ne){case 34:a.opts.Date1904=N.WBProps.date1904=Y;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(q.enc||(e.l=0),q.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=Y;break;case 66:var Nt=Number(Y);switch(Nt){case 21010:Nt=1200;break;case 32768:Nt=1e4;break;case 32769:Nt=1252;break}Xr(q.codepage=Nt),he=!0;break;case 317:q.rrtabid=Y;break;case 25:q.winlocked=Y;break;case 439:a.opts.RefreshAll=Y;break;case 12:a.opts.CalcCount=Y;break;case 16:a.opts.CalcDelta=Y;break;case 17:a.opts.CalcIter=Y;break;case 13:a.opts.CalcMode=Y;break;case 14:a.opts.CalcPrecision=Y;break;case 95:a.opts.CalcSaveRecalc=Y;break;case 15:q.CalcRefMode=Y;break;case 2211:a.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:V.push(Y);break;case 430:ae.push([Y]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(Y);break;case 24:case 536:J={Name:Y.Name,Ref:Ea(Y.rgce,c,null,ae,q)},Y.itab>0&&(J.Sheet=Y.itab-1),ae.names.push(J),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(W[Y.itab-1]={ref:st(Y.rgce[0][0][1][2])});break;case 22:q.ExternCount=Y;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(Y),ae.XTI=ae.XTI.concat(Y);break;case 2196:if(q.biff<8)break;J!=null&&(J.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&q.WTF&&console.error("Password verifier: "+Y);break;case 133:l[Y.pos]=Y,q.snames.push(Y.name);break;case 10:{if(--G)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=st(c),t.sheetRows&&t.sheetRows<=c.e.r){var Ke=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=st(c),c.e.r=Ke}c.e.r++,c.e.c++}be.length>0&&(s["!merges"]=be),ve.length>0&&(s["!objects"]=ve),R.length>0&&(s["!cols"]=R),te.length>0&&(s["!rows"]=te),N.Sheets.push(j)}m===""?p=s:r[m]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),q.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(q.biff=5,he=!0,Xr(q.codepage=28591)),q.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(q.biff=2),G++)break;if(s=t.dense?[]:{},q.biff<8&&!he&&(he=!0,Xr(q.codepage=t.codepage||1252)),q.biff<5||Y.BIFFVer==0&&Y.dt==4096){m===""&&(m="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var ct={pos:e.l-_e,name:m};l[ct.pos]=ct,q.snames.push(m)}else m=(l[we]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),be=[],ve=[],q.arrayf=k=[],R=[],te=[],ye=!1,j={Hidden:(l[we]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[Y.r]||[])[Y.c]:s[$e({c:Y.c,r:Y.r})])&&++Y.c,S={ixfe:Y.ixfe,XF:V[Y.ixfe]||{},v:Y.val,t:"n"},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t);break;case 5:case 517:S={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.val,t:Y.t},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t);break;case 638:S={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.rknum,t:"n"},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t);break;case 189:for(var We=Y.c;We<=Y.C;++We){var Oe=Y.rkrec[We-Y.c][0];S={ixfe:Oe,XF:V[Oe],v:Y.rkrec[We-Y.c][1],t:"n"},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:We,r:Y.r},S,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){u=Y;break}if(S=_0(Y.val,Y.cell.ixfe,Y.tt),S.XF=V[S.ixfe],t.cellFormula){var Ct=Y.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var _a=Ct[0][0][1][0],Va=Ct[0][0][1][1],Qa=$e({r:_a,c:Va});A[Qa]?S.f=""+Ea(Y.formula,c,Y.cell,ae,q):S.F=((t.dense?(s[_a]||[])[Va]:s[Qa])||{}).F}else S.f=""+Ea(Y.formula,c,Y.cell,ae,q)}O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X(Y.cell,S,t),u=Y}break;case 7:case 519:if(u)u.val=Y,S=_0(Y,u.cell.ixfe,"s"),S.XF=V[S.ixfe],t.cellFormula&&(S.f=""+Ea(u.formula,c,u.cell,ae,q)),O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X(u.cell,S,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(Y);var Ms=$e(Y[0].s);if(b=t.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Ms],t.cellFormula&&b){if(!u||!Ms||!b)break;b.f=""+Ea(Y[1],c,Y[0],ae,q),b.F=st(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;A[$e(u.cell)]=Y[0],b=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[$e(u.cell)],(b||{}).f=""+Ea(Y[0],c,g,ae,q)}}break;case 253:S=_0(h[Y.isst].t,Y.ixfe,"s"),h[Y.isst].h&&(S.h=h[Y.isst].h),S.XF=V[S.ixfe],O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:Y.ixfe,XF:V[Y.ixfe],t:"z"},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t));break;case 190:if(t.sheetStubs)for(var en=Y.c;en<=Y.C;++en){var gt=Y.ixfe[en-Y.c];S={ixfe:gt,XF:V[gt],t:"z"},O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:en,r:Y.r},S,t)}break;case 214:case 516:case 4:S=_0(Y.val,Y.ixfe,"s"),S.XF=V[S.ixfe],O>0&&(S.z=Z[S.ixfe>>8&63]),ln(S,t,a.opts.Date1904),X({c:Y.c,r:Y.r},S,t);break;case 0:case 512:G===1&&(c=Y);break;case 252:h=Y;break;case 1054:if(q.biff==4){Z[O++]=Y[1];for(var Fr=0;Fr<O+163&&qe[Fr]!=Y[1];++Fr);Fr>=163&&pi(Y[1],O+163)}else pi(Y[1],Y[0]);break;case 30:{Z[O++]=Y;for(var Lr=0;Lr<O+163&&qe[Lr]!=Y;++Lr);Lr>=163&&pi(Y,O+163)}break;case 229:be=be.concat(Y);break;case 93:ve[Y.cmo[0]]=q.lastobj=Y;break;case 438:q.lastobj.TxO=Y;break;case 127:q.lastobj.ImData=Y;break;case 440:for(T=Y[0].s.r;T<=Y[0].e.r;++T)for(w=Y[0].s.c;w<=Y[0].e.c;++w)b=t.dense?(s[T]||[])[w]:s[$e({c:w,r:T})],b&&(b.l=Y[1]);break;case 2048:for(T=Y[0].s.r;T<=Y[0].e.r;++T)for(w=Y[0].s.c;w<=Y[0].e.c;++w)b=t.dense?(s[T]||[])[w]:s[$e({c:w,r:T})],b&&b.l&&(b.l.Tooltip=Y[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;b=t.dense?(s[Y[0].r]||[])[Y[0].c]:s[$e(Y[0])];var qn=ve[Y[2]];b||(t.dense?(s[Y[0].r]||(s[Y[0].r]=[]),b=s[Y[0].r][Y[0].c]={t:"z"}):b=s[$e(Y[0])]={t:"z"},c.e.r=Math.max(c.e.r,Y[0].r),c.s.r=Math.min(c.s.r,Y[0].r),c.e.c=Math.max(c.e.c,Y[0].c),c.s.c=Math.min(c.s.c,Y[0].c)),b.c||(b.c=[]),_={a:Y[1],t:qn.TxO.t},b.c.push(_)}break;case 2173:m9(V[Y.ixfe],Y.ext);break;case 125:{if(!q.cellStyles)break;for(;Y.e>=Y.s;)R[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},ye||(ye=!0,hx(Y.w/256)),Ll(R[Y.e+1])}break;case 520:{var qt={};Y.level!=null&&(te[Y.r]=qt,qt.level=Y.level),Y.hidden&&(te[Y.r]=qt,qt.hidden=!0),Y.hpt&&(te[Y.r]=qt,qt.hpt=Y.hpt,qt.hpx=Nc(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||sc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=Y;break;case 161:s["!margins"]||sc(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(N.Views[0].RTL=!0);break;case 146:P=Y;break;case 2198:Q=Y;break;case 140:L=Y;break;case 442:m?j.CodeName=Y||j.name:N.WBProps.CodeName=Y||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),e.l+=_e}return a.SheetNames=pn(l).sort(function(dr,Ye){return Number(dr)-Number(Ye)}).map(function(dr){return l[dr].name}),t.bookSheets||(a.Sheets=r),!a.SheetNames.length&&p["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=p)):a.Preamble=p,a.Sheets&&W.forEach(function(dr,Ye){a.Sheets[a.SheetNames[Ye]]["!autofilter"]=dr}),a.Strings=h,a.SSF=ba(qe),q.enc&&(a.Encryption=q.enc),Q&&(a.Themes=Q),a.Metadata={},L!==void 0&&(a.Metadata.Country=L),ae.names.length>0&&(N.Names=ae.names),a.Workbook=N,a}var uw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function WB(e,t,a){var r=nt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=Wb(r,uF,uw.DSI);for(var l in s)t[l]=s[l]}catch(m){if(a.WTF)throw m}var c=nt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=Wb(c,fF,uw.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(m){if(a.WTF)throw m}t.HeadingPairs&&t.TitlesOfParts&&(TS(t.HeadingPairs,t.TitlesOfParts,t,a),delete t.HeadingPairs,delete t.TitlesOfParts)}function iE(e,t){t||(t={}),gx(t),FT(),t.codepage&&Xp(t.codepage);var a,r;if(e.FullPaths){if(nt.find(e,"/encryption"))throw new Error("File is password-protected");a=nt.find(e,"!CompObj"),r=nt.find(e,"/Workbook")||nt.find(e,"/Book")}else{switch(t.type){case"base64":e=Yr(hr(e));break;case"binary":e=Yr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ya(e,0),r={content:e}}var s,l;if(a&&HB(a),t.bookProps&&!t.bookSheets)s={};else{var c=rt?"buffer":"array";if(r&&r.content)s=qB(r.content,t);else if((l=nt.find(e,"PerfectOffice_MAIN"))&&l.content)s=rc.to_workbook(l.content,(t.type=c,t));else if((l=nt.find(e,"NativeContent_MAIN"))&&l.content)s=rc.to_workbook(l.content,(t.type=c,t));else throw(l=nt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&nt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=j9(e))}var u={};return e.FullPaths&&WB(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}var Q0={0:{f:N7},1:{f:j7},2:{f:z7},3:{f:L7},4:{f:M7},5:{f:U7},6:{f:$7},7:{f:I7},8:{f:X7},9:{f:Y7},10:{f:q7},11:{f:W7},12:{f:R7},13:{f:V7},14:{f:P7},15:{f:F7},16:{f:tE},17:{f:G7},18:{f:B7},19:{f:ix},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_B},40:{},42:{},43:{f:qP},44:{f:GP},45:{f:WP},46:{f:XP},47:{f:YP},48:{},49:{f:KM},50:{},51:{f:x9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FS},62:{f:H7},63:{f:w9},64:{f:nB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Da,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:D7},148:{f:C7,p:16},151:{f:Q7},152:{},153:{f:bB},154:{},155:{},156:{f:yB},157:{},158:{},159:{T:1,f:fP},160:{T:-1},161:{T:1,f:Ti},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:K7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:p9},336:{T:-1},337:{f:g9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:MS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Z7},427:{f:eB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:aB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:O7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:J7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:C9},633:{T:1},634:{T:-1},635:{T:1,f:N9},636:{T:-1},637:{f:QM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ap={6:{f:om},10:{f:vs},12:{f:Zt},13:{f:Zt},14:{f:Gt},15:{f:Gt},16:{f:ka},17:{f:Gt},18:{f:Gt},19:{f:Zt},20:{f:Jb},21:{f:Jb},23:{f:MS},24:{f:Zb},25:{f:Gt},26:{},27:{},28:{f:kL},29:{},34:{f:Gt},35:{f:Qb},38:{f:ka},39:{f:ka},40:{f:ka},41:{f:ka},42:{f:Gt},43:{f:Gt},47:{f:OP},49:{f:lL},51:{f:Zt},60:{},61:{f:nL},64:{f:Gt},65:{f:iL},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:KF},93:{f:NL},94:{},95:{f:Gt},96:{},97:{},99:{f:Gt},125:{f:FS},128:{f:gL},129:{f:JF},130:{f:Zt},131:{f:Gt},132:{f:Gt},133:{f:QF},134:{},140:{f:ML},141:{f:Zt},144:{},146:{f:LL},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:zL},161:{f:IL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:dL},190:{f:mL},193:{f:vs},197:{},198:{},199:{},200:{},201:{},202:{f:Gt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Gt},222:{},224:{f:xL},225:{f:XF},226:{f:vs},227:{},229:{f:AL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ZF},253:{f:oL},255:{f:eL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Gt},353:{f:vs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yL},431:{f:Gt},432:{},433:{},434:{},437:{},438:{f:DL},439:{f:Gt},440:{f:jL},441:{},442:{f:Ic},443:{},444:{f:Zt},445:{},446:{},448:{f:vs},449:{f:rL,r:2},450:{f:vs},512:{f:Xb},513:{f:UL},515:{f:vL},516:{f:cL},517:{f:Kb},519:{f:VL},520:{f:tL},523:{},545:{f:ew},549:{f:Yb},566:{},574:{f:sL},638:{f:hL},659:{},1048:{},1054:{f:uL},1084:{},1212:{f:TL},2048:{f:RL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:y0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:vs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:PL,r:12},2173:{f:d9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Gt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_L,r:12},2197:{},2198:{f:l9,r:12},2199:{},2200:{},2201:{},2202:{f:SL,r:12},2203:{f:vs},2204:{},2205:{},2206:{},2207:{},2211:{f:aL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:BL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:FL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Xb},1:{},2:{f:qL},3:{f:GL},4:{f:$L},5:{f:Kb},7:{f:WL},8:{},9:{f:y0},11:{},22:{f:Zt},30:{f:fL},31:{},32:{},33:{f:ew},36:{},37:{f:Yb},50:{f:YL},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:HL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:XL},223:{},234:{},354:{},421:{},518:{f:om},521:{f:y0},536:{f:Zb},547:{f:Qb},561:{},579:{},1030:{f:om},1033:{f:y0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hr(e,t,a,r){var s=t;if(!isNaN(s)){var l=(a||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&pS(a)&&e.push(a)}}function fw(e,t){var a=t||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=vM(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,g=0,y=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(c=0;c<h.length;++c){var w=h[c].trim(),T=w.slice(0,3).toLowerCase();if(T=="<tr"){if(++m,a.sheetRows&&a.sheetRows<=m){--m;break}p=0;continue}if(!(T!="<td"&&T!="<th")){var A=w.split(/<\/t[dh]>/i);for(u=0;u<A.length;++u){var k=A[u].trim();if(k.match(/<t[dh]/i)){for(var S=k,L=0;S.charAt(0)=="<"&&(L=S.indexOf(">"))>-1;)S=S.slice(L+1);for(var V=0;V<_.length;++V){var P=_[V];P.s.c==p&&P.s.r<m&&m<=P.e.r&&(p=P.e.c+1,V=-1)}var N=Ve(k.slice(0,k.indexOf(">")));y=N.colspan?+N.colspan:1,((g=+N.rowspan)>1||y>1)&&_.push({s:{r:m,c:p},e:{r:m+(g||1)-1,c:p+y-1}});var j=N.t||N["data-t"]||"";if(!S.length){p+=y;continue}if(S=aS(S),b.s.r>m&&(b.s.r=m),b.e.r<m&&(b.e.r=m),b.s.c>p&&(b.s.c=p),b.e.c<p&&(b.e.c=p),!S.length){p+=y;continue}var I={t:"s",v:S};a.raw||!S.trim().length||j=="s"||(S==="TRUE"?I={t:"b",v:!0}:S==="FALSE"?I={t:"b",v:!1}:isNaN(Jr(S))?isNaN(Fl(S).getDate())||(I={t:"d",v:ua(S)},a.cellDates||(I={t:"n",v:za(I.v)}),I.z=a.dateNF||qe[14]):I={t:"n",v:Jr(S)}),a.dense?(r[m]||(r[m]=[]),r[m][p]=I):r[$e({r:m,c:p})]=I,p+=y}}}}return r["!ref"]=st(b),_.length&&(r["!merges"]=_),r}function YB(e,t,a,r){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,h=0,m=0;m<s.length;++m)if(!(s[m].s.r>a||s[m].s.c>c)&&!(s[m].e.r<a||s[m].e.c<c)){if(s[m].s.r<a||s[m].s.c<c){u=-1;break}u=s[m].e.r-s[m].s.r+1,h=s[m].e.c-s[m].s.c+1;break}if(!(u<0)){var p=$e({r:a,c}),g=r.dense?(e[a]||[])[c]:e[p],y=g&&g.v!=null&&(g.h||tx(g.w||(Hn(g),g.w)||""))||"",b={};u>1&&(b.rowspan=u),h>1&&(b.colspan=h),r.editable?y='<span contenteditable="true">'+y+"</span>":g&&(b["data-t"]=g&&g.t||"z",g.v!=null&&(b["data-v"]=g.v),g.z!=null&&(b["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+g.l.Target+'">'+y+"</a>")),b.id=(r.id||"sjs")+"-"+p,l.push(MM("td",y,b))}}var _="<tr>";return _+l.join("")+"</tr>"}var XB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KB="</body></html>";function JB(e,t){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return Rs(fw(a[0],t),t);var r=yx();return a.forEach(function(s,l){bx(r,fw(s,t),"Sheet"+(l+1))}),r}function QB(e,t,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function ZB(e,t){var a=t||{},r=a.header!=null?a.header:XB,s=a.footer!=null?a.footer:KB,l=[r],c=zl(e["!ref"]);a.dense=Array.isArray(e),l.push(QB(e,c,a));for(var u=c.s.r;u<=c.e.r;++u)l.push(YB(e,c,u,a));return l.push("</table>"+s),l.join("")}function lE(e,t,a){var r=a||{},s=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var c=typeof r.origin=="string"?Ba(r.origin):r.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),h=Math.min(r.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=zl(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),s==-1&&(m.e.r=s=p.e.r+1)}var g=[],y=0,b=e["!rows"]||(e["!rows"]=[]),_=0,w=0,T=0,A=0,k=0,S=0;for(e["!cols"]||(e["!cols"]=[]);_<u.length&&w<h;++_){var L=u[_];if(hw(L)){if(r.display)continue;b[w]={hidden:!0}}var V=L.children;for(T=A=0;T<V.length;++T){var P=V[T];if(!(r.display&&hw(P))){var N=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):aS(P.innerHTML),j=P.getAttribute("data-z")||P.getAttribute("z");for(y=0;y<g.length;++y){var I=g[y];I.s.c==A+l&&I.s.r<w+s&&w+s<=I.e.r&&(A=I.e.c+1-l,y=-1)}S=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||S>1)&&g.push({s:{r:w+s,c:A+l},e:{r:w+s+(k||1)-1,c:A+l+(S||1)-1}});var z={t:"s",v:N},X=P.getAttribute("data-t")||P.getAttribute("t")||"";N!=null&&(N.length==0?z.t=X||"z":r.raw||N.trim().length==0||X=="s"||(N==="TRUE"?z={t:"b",v:!0}:N==="FALSE"?z={t:"b",v:!1}:isNaN(Jr(N))?isNaN(Fl(N).getDate())||(z={t:"d",v:ua(N)},r.cellDates||(z={t:"n",v:za(z.v)}),z.z=r.dateNF||qe[14]):z={t:"n",v:Jr(N)})),z.z===void 0&&j!=null&&(z.z=j);var q="",Q=P.getElementsByTagName("A");if(Q&&Q.length)for(var be=0;be<Q.length&&!(Q[be].hasAttribute("href")&&(q=Q[be].getAttribute("href"),q.charAt(0)!="#"));++be);q&&q.charAt(0)!="#"&&(z.l={Target:q}),r.dense?(e[w+s]||(e[w+s]=[]),e[w+s][A+l]=z):e[$e({c:A+l,r:w+s})]=z,m.e.c<A+l&&(m.e.c=A+l),A+=S}}++w}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),m.e.r=Math.max(m.e.r,w-1+s),e["!ref"]=st(m),w>=h&&(e["!fullref"]=st((m.e.r=u.length-_+w-1+s,m))),e}function oE(e,t){var a=t||{},r=a.dense?[]:{};return lE(r,e,t)}function eU(e,t){return Rs(oE(e,t),t)}function hw(e){var t="",a=tU(e);return a&&(t=a(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function tU(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aU(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=it(t.replace(/<[^>]*>/g,""));return[a]}var dw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function cE(e,t){var a=t||{},r=ax(e),s=[],l,c,u={name:""},h="",m=0,p,g,y={},b=[],_=a.dense?[]:{},w,T,A={value:""},k="",S=0,L=[],V=-1,P=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,I={},z=[],X={},q=0,Q=0,be=[],ve=1,R=1,te=[],ye={Names:[]},ae={},Ee=["",""],G=[],O={},Z="",W=0,J=!1,he=!1,we=0;for(Ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Ec.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?_["!ref"]=st(N):_["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=N.e.r&&(_["!fullref"]=_["!ref"],N.e.r=a.sheetRows-1,_["!ref"]=st(N)),z.length&&(_["!merges"]=z),be.length&&(_["!rows"]=be),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),b.push(p.name),y[p.name]=_,he=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=Ve(w[0],!1),V=P=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,_=a.dense?[]:{},z=[],be=[],he=!0);break;case"table-row-group":w[1]==="/"?--j:++j;break;case"table-row":case"":if(w[1]==="/"){V+=ve,ve=1;break}if(g=Ve(w[0],!1),g.?V=g.-1:V==-1&&(V=0),ve=+g["number-rows-repeated"]||1,ve<10)for(we=0;we<ve;++we)j>0&&(be[V+we]={level:j});P=-1;break;case"covered-table-cell":w[1]!=="/"&&++P,a.sheetStubs&&(a.dense?(_[V]||(_[V]=[]),_[V][P]={t:"z"}):_[$e({r:V,c:P})]={t:"z"}),k="",L=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++P,A=Ve(w[0],!1),R=parseInt(A["number-columns-repeated"]||"1",10),T={t:"z",v:null},A.formula&&a.cellFormula!=!1&&(T.f=lw(it(A.formula))),(A.||A["value-type"])=="string"&&(T.t="s",T.v=it(A["string-value"]||""),a.dense?(_[V]||(_[V]=[]),_[V][P]=T):_[$e({r:V,c:P})]=T),P+=R-1;else if(w[1]!=="/"){++P,k="",S=0,L=[],R=1;var Ne=ve?V+ve-1:V;if(P>N.e.c&&(N.e.c=P),P<N.s.c&&(N.s.c=P),V<N.s.r&&(N.s.r=V),Ne>N.e.r&&(N.e.r=Ne),A=Ve(w[0],!1),G=[],O={},T={t:A.||A["value-type"],v:null},a.cellFormula)if(A.formula&&(A.formula=it(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(q=parseInt(A["number-matrix-rows-spanned"],10)||0,Q=parseInt(A["number-matrix-columns-spanned"],10)||0,X={s:{r:V,c:P},e:{r:V+q-1,c:P+Q-1}},T.F=st(X),te.push([X,T.F])),A.formula)T.f=lw(A.formula);else for(we=0;we<te.length;++we)V>=te[we][0].s.r&&V<=te[we][0].e.r&&P>=te[we][0].s.c&&P<=te[we][0].e.c&&(T.F=te[we][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(q=parseInt(A["number-rows-spanned"],10)||0,Q=parseInt(A["number-columns-spanned"],10)||0,X={s:{r:V,c:P},e:{r:V+q-1,c:P+Q-1}},z.push(X)),A["number-columns-repeated"]&&(R=parseInt(A["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=jt(A["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(A.value);break;case"percentage":T.t="n",T.v=parseFloat(A.value);break;case"currency":T.t="n",T.v=parseFloat(A.value);break;case"date":T.t="d",T.v=ua(A["date-value"]),a.cellDates||(T.t="n",T.v=za(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=pM(A["time-value"])/86400,a.cellDates&&(T.t="d",T.v=uf(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(A.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",A["string-value"]!=null&&(k=it(A["string-value"]),L=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(J=!1,T.t==="s"&&(T.v=k||"",L.length&&(T.R=L),J=S==0),ae.Target&&(T.l=ae),G.length>0&&(T.c=G,G=[]),k&&a.cellText!==!1&&(T.w=k),J&&(T.t="z",delete T.v),(!J||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=V))for(var _e=0;_e<ve;++_e){if(R=parseInt(A["number-columns-repeated"]||"1",10),a.dense)for(_[V+_e]||(_[V+_e]=[]),_[V+_e][P]=_e==0?T:ba(T);--R>0;)_[V+_e][P+R]=ba(T);else for(_[$e({r:V+_e,c:P})]=T;--R>0;)_[$e({r:V+_e,c:P+R})]=ba(T);N.e.c<=P&&(N.e.c=P)}R=parseInt(A["number-columns-repeated"]||"1",10),P+=R-1,R=0,T={},k="",L=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l;O.t=k,L.length&&(O.R=L),O.a=Z,G.push(O)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);Z="",W=0,k="",S=0,L=[];break;case"creator":w[1]==="/"?Z=r.slice(W,w.index):W=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);k="",S=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(I[u.name]=h,(l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=Ve(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=Ve(w[0],!1),h+=dw[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=Ve(w[0],!1),h+=dw[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=r.slice(m,w.index);break}else m=w.index+w[0].length;break;case"named-range":c=Ve(w[0],!1),Ee=cm(c["cell-range-address"]);var Se={Name:c.name,Ref:Ee[0]+"!"+Ee[1]};he&&(Se.Sheet=b.length),ye.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!A||!A["string-value"])){var Je=aU(r.slice(S,w.index));k=(k.length>0?k+`
`:"")+Je[0]}else Ve(w[0],!1),S=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Ee=cm(Ve(w[0])["target-range-address"]),y[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ae=Ve(w[0],!1),!ae.href)break;ae.Target=it(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Ee=cm(ae.Target.slice(1)),ae.Target="#"+Ee[0]+"!"+Ee[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(w)}}var Y={Sheets:y,SheetNames:b,Workbook:ye};return a.bookSheets&&delete Y.Sheets,Y}function mw(e,t){t=t||{},Cr(e,"META-INF/manifest.xml")&&vF(Qt(e,"META-INF/manifest.xml"),t);var a=fr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=cE(Tt(a),t);return Cr(e,"meta.xml")&&(r.Props=_S(Qt(e,"meta.xml"))),r}function pw(e,t){return cE(e,t)}function px(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Tt(wi(e))}function np(e){var t=e.reduce(function(s,l){return s+l.length},0),a=new Uint8Array(t),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function xw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function rU(e,t){for(var a=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,s=t+13;s>=t;--s)r=r*256+e[s];return(e[t+15]&128?-r:r)*Math.pow(10,a-6176)}function Cc(e,t){var a=t?t[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return t&&(t[0]=a),r}function la(e){var t=0,a=e[t]&127;e:if(e[t++]>=128){if(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128))break e;a|=(e[t]&127)<<28}return a}function Na(e){for(var t=[],a=[0];a[0]<e.length;){var r=a[0],s=Cc(e,a),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=a[0];e[a[0]++]>=128;);u=e.slice(h,a[0])}break;case 5:c=4,u=e.slice(a[0],a[0]+c),a[0]+=c;break;case 1:c=8,u=e.slice(a[0],a[0]+c),a[0]+=c;break;case 2:c=Cc(e,a),u=e.slice(a[0],a[0]+c),a[0]+=c;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(r))}var m={data:u,type:l};t[s]==null?t[s]=[m]:t[s].push(m)}return t}function xx(e,t){return e?.map(function(a){return t(a.data)})||[]}function nU(e){for(var t,a=[],r=[0];r[0]<e.length;){var s=Cc(e,r),l=Na(e.slice(r[0],r[0]+s));r[0]+=s;var c={id:la(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Na(u.data),m=la(h[3][0].data);c.messages.push({meta:h,data:e.slice(r[0],r[0]+m)}),r[0]+=m}),(t=l[3])!=null&&t[0]&&(c.merge=la(l[3][0].data)>>>0>0),a.push(c)}return a}function sU(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=Cc(t,a),s=[];a[0]<t.length;){var l=t[a[0]]&3;if(l==0){var c=t[a[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[a[0]],u>1&&(c|=t[a[0]+1]<<8),u>2&&(c|=t[a[0]+2]<<16),u>3&&(c|=t[a[0]+3]<<24),c>>>=0,c++,a[0]+=u}s.push(t.slice(a[0],a[0]+c)),a[0]+=c;continue}else{var h=0,m=0;if(l==1?(m=(t[a[0]]>>2&7)+4,h=(t[a[0]++]&224)<<3,h|=t[a[0]++]):(m=(t[a[0]++]>>2)+1,l==2?(h=t[a[0]]|t[a[0]+1]<<8,a[0]+=2):(h=(t[a[0]]|t[a[0]+1]<<8|t[a[0]+2]<<16|t[a[0]+3]<<24)>>>0,a[0]+=4)),s=[np(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(s.push(s[0].slice(-h)),m-=h;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-h,-h+m))}}var p=np(s);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function iU(e){for(var t=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,t.push(sU(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return np(t)}function lU(e,t,a,r){var s=px(e),l=s.getUint32(4,!0),c=(r>1?12:8)+xw(l&(r>1?3470:398))*4,u=-1,h=-1,m=NaN,p=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=xw(l&(r>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(m=s.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:m};break;case 3:g={t:"s",v:t[h]};break;case 5:g={t:"d",v:p};break;case 6:g={t:"b",v:m>0};break;case 7:g={t:"n",v:m/86400};break;case 8:g={t:"e",v:0};break;case 9:if(u>-1)g={t:"s",v:a[u]};else if(h>-1)g={t:"s",v:t[h]};else if(!isNaN(m))g={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function oU(e,t,a){var r=px(e),s=r.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,m=NaN,p=new Date(2001,0,1);s&1&&(h=rU(e,l),l+=16),s&2&&(m=r.getFloat64(l,!0),l+=8),s&4&&(p.setTime(p.getTime()+r.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=r.getUint32(l,!0),l+=4),s&16&&(c=r.getUint32(l,!0),l+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:p};break;case 6:g={t:"b",v:m>0};break;case 7:g={t:"n",v:m/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:a[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return g}function cU(e,t,a){switch(e[0]){case 0:case 1:case 2:case 3:return lU(e,t,a,e[0]);case 5:return oU(e,t,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function As(e){var t=Na(e);return Cc(t[1][0].data)}function gw(e,t){var a=Na(t.data),r=la(a[1][0].data),s=a[3],l=[];return(s||[]).forEach(function(c){var u=Na(c.data),h=la(u[1][0].data)>>>0;switch(r){case 1:l[h]=rp(u[3][0].data);break;case 8:{var m=e[As(u[9][0].data)][0],p=Na(m.data),g=e[As(p[1][0].data)][0],y=la(g.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var b=Na(g.data);l[h]=b[3].map(function(_){return rp(_.data)}).join("")}break}}),l}function uU(e,t){var a,r,s,l,c,u,h,m,p,g,y,b,_,w,T=Na(e),A=la(T[1][0].data)>>>0,k=la(T[2][0].data)>>>0,S=((r=(a=T[8])==null?void 0:a[0])==null?void 0:r.data)&&la(T[8][0].data)>0||!1,L,V;if((l=(s=T[7])==null?void 0:s[0])!=null&&l.data&&t!=0)L=(u=(c=T[7])==null?void 0:c[0])==null?void 0:u.data,V=(m=(h=T[6])==null?void 0:h[0])==null?void 0:m.data;else if((g=(p=T[4])==null?void 0:p[0])!=null&&g.data&&t!=1)L=(b=(y=T[4])==null?void 0:y[0])==null?void 0:b.data,V=(w=(_=T[3])==null?void 0:_[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=S?4:1,N=px(L),j=[],I=0;I<L.length/2;++I){var z=N.getUint16(I*2,!0);z<65535&&j.push([I,z])}if(j.length!=k)throw"Expected ".concat(k," cells, found ").concat(j.length);var X=[];for(I=0;I<j.length-1;++I)X[j[I][0]]=V.subarray(j[I][1]*P,j[I+1][1]*P);return j.length>=1&&(X[j[j.length-1][0]]=V.subarray(j[j.length-1][1]*P)),{R:A,cells:X}}function fU(e,t){var a,r=Na(t.data),s=(a=r?.[7])!=null&&a[0]?la(r[7][0].data)>>>0>0?1:0:-1,l=xx(r[5],function(c){return uU(c,s)});return{nrows:la(r[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,m){if(c[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));c[u.R][m]=h}),c},[])}}function hU(e,t,a){var r,s=Na(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(la(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(la(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=st(l);var c=Na(s[4][0].data),u=gw(e,e[As(c[4][0].data)][0]),h=(r=c[17])!=null&&r[0]?gw(e,e[As(c[17][0].data)][0]):[],m=Na(c[3][0].data),p=0;m[1].forEach(function(g){var y=Na(g.data),b=e[As(y[2][0].data)][0],_=la(b.meta[1][0].data);if(_!=6002)throw new Error("6001 unexpected reference to ".concat(_));var w=fU(e,b);w.data.forEach(function(T,A){T.forEach(function(k,S){var L=$e({r:p+A,c:S}),V=cU(k,u,h);V&&(a[L]=V)})}),p+=w.nrows})}function dU(e,t){var a=Na(t.data),r={"!ref":"A1"},s=e[As(a[2][0].data)],l=la(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return hU(e,s[0],r),r}function mU(e,t){var a,r=Na(t.data),s={name:(a=r[1])!=null&&a[0]?rp(r[1][0].data):"",sheets:[]},l=xx(r[2],As);return l.forEach(function(c){e[c].forEach(function(u){var h=la(u.meta[1][0].data);h==6e3&&s.sheets.push(dU(e,u))})}),s}function pU(e,t){var a=yx(),r=Na(t.data),s=xx(r[1],As);if(s.forEach(function(l){e[l].forEach(function(c){var u=la(c.meta[1][0].data);if(u==2){var h=mU(e,c);h.sheets.forEach(function(m,p){bx(a,m,p==0?h.name:h.name+"_"+p,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function fm(e){var t,a,r,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=iU(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var p;try{p=nU(m)}catch(g){return console.log("## "+(g.message||g))}p.forEach(function(g){l[g.id]=g.messages,c.push(g.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(r=(a=(t=l?.[1])==null?void 0:t[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&la(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(m){var p=la(m.meta[1][0].data)>>>0;if(p==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return pU(l,u)}function xU(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function gx(e){xU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function gU(e){return Al.WS.indexOf(e)>-1?"sheet":e==Al.CS?"chart":e==Al.DS?"dialog":e==Al.MS?"macro":e&&e.length?e:"sheet"}function vU(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,gU(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function yU(e,t,a,r,s,l,c,u,h,m,p,g){try{l[r]=tc(fr(e,a,!0),t);var y=Qt(e,t),b;switch(u){case"sheet":b=EB(y,t,s,h,l[r],m,p,g);break;case"chart":if(b=kB(y,t,s,h,l[r],m,p,g),!b||!b["!drawel"])break;var _=$o(b["!drawel"].Target,t),w=Qm(_),T=S9(fr(e,_,!0),tc(fr(e,w,!0),_)),A=$o(T,_),k=Qm(A);b=oB(fr(e,A,!0),A,h,tc(fr(e,k,!0),A),m,b);break;case"macro":b=AB(y,t,s,h,l[r],m,p,g);break;case"dialog":b=NB(y,t,s,h,l[r],m,p,g);break;default:throw new Error("Unrecognized sheet type "+u)}c[r]=b;var S=[];l&&l[r]&&pn(l[r]).forEach(function(L){var V="";if(l[r][L].Type==Al.CMNT){V=$o(l[r][L].Target,t);var P=jB(Qt(e,V,!0),V,h);if(!P||!P.length)return;aw(b,P,!1)}l[r][L].Type==Al.TCMNT&&(V=$o(l[r][L].Target,t),S=S.concat(k9(Qt(e,V,!0),h)))}),S&&S.length&&aw(b,S,!0,h.people||[])}catch(L){if(h.WTF)throw L}}function kr(e){return e.charAt(0)=="/"?e.slice(1):e}function bU(e,t){if(WT(),t=t||{},gx(t),Cr(e,"META-INF/manifest.xml")||Cr(e,"objectdata.xml"))return mw(e,t);if(Cr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fm<"u"){if(e.FileIndex)return fm(e);var a=nt.utils.cfb_new();return Cb(e).forEach(function(be){wM(a,be,bM(e,be))}),fm(a)}throw new Error("Unsupported NUMBERS file")}if(!Cr(e,"[Content_Types].xml"))throw Cr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Cb(e),s=xF(fr(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Qt(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Qt(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},m={};if(!t.bookSheets&&!t.bookProps){if(nc=[],s.sst)try{nc=DB(Qt(e,kr(s.sst)),s.sst,t)}catch(be){if(t.WTF)throw be}t.cellStyles&&s.themes.length&&(h=OB(fr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(m=CB(Qt(e,kr(s.style)),s.style,h,t))}s.links.map(function(be){try{var ve=tc(fr(e,Qm(kr(be))),be);return MB(Qt(e,kr(be)),ve,be,t)}catch{}});var p=SB(Qt(e,kr(s.workbooks[0])),s.workbooks[0],t),g={},y="";s.coreprops.length&&(y=Qt(e,kr(s.coreprops[0]),!0),y&&(g=_S(y)),s.extprops.length!==0&&(y=Qt(e,kr(s.extprops[0]),!0),y&&wF(y,g,t)));var b={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(y=fr(e,kr(s.custprops[0]),!0),y&&(b=TF(y,t)));var _={};if((t.bookSheets||t.bookProps)&&(p.Sheets?c=p.Sheets.map(function(ve){return ve.name}):g.Worksheets&&g.SheetNames.length>0&&(c=g.SheetNames),t.bookProps&&(_.Props=g,_.Custprops=b),t.bookSheets&&typeof c<"u"&&(_.SheetNames=c),t.bookSheets?_.SheetNames:t.bookProps))return _;c={};var w={};t.bookDeps&&s.calcchain&&(w=RB(Qt(e,kr(s.calcchain)),s.calcchain));var T=0,A={},k,S;{var L=p.Sheets;g.Worksheets=L.length,g.SheetNames=[];for(var V=0;V!=L.length;++V)g.SheetNames[V]=L[V].name}var P=l?"bin":"xml",N=s.workbooks[0].lastIndexOf("/"),j=(s.workbooks[0].slice(0,N+1)+"_rels/"+s.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Cr(e,j)||(j="xl/_rels/workbook."+P+".rels");var I=tc(fr(e,j,!0),j.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=FB(Qt(e,kr(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=A9(Qt(e,kr(s.people[0])),t)),I&&(I=vU(I,p.Sheets));var z=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=g.Worksheets;++T){var X="sheet";if(I&&I[T]?(k="xl/"+I[T][1].replace(/[\/]?xl\//,""),Cr(e,k)||(k=I[T][1]),Cr(e,k)||(k=j.replace(/_rels\/.*$/,"")+I[T][1]),X=I[T][2]):(k="xl/worksheets/sheet"+(T+1-z)+"."+P,k=k.replace(/sheet0\./,"sheet.")),S=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(g.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var q=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==T&&(q=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==g.SheetNames[T].toLowerCase()&&(q=1);if(!q)continue e}}yU(e,k,S,g.SheetNames[T],T,A,c,X,t,p,h,m)}return _={Directory:s,Workbook:p,Props:g,Custprops:b,Deps:w,Sheets:c,SheetNames:g.SheetNames,Strings:nc,Styles:m,Themes:h,SSF:ba(qe)},t&&t.bookFiles&&(e.files?(_.keys=r,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(be,ve){be=be.replace(/^Root Entry[\/]/,""),_.keys.push(be),_.files[be]=e.FileIndex[ve]}))),t&&t.bookVBA&&(s.vba.length>0?_.vbaraw=Qt(e,kr(s.vba[0]),!0):s.defaults&&s.defaults.bin===D9&&(_.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),_}function wU(e,t){var a=t||{},r="Workbook",s=nt.find(e,r);try{if(r="/!DataSpaces/Version",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(dP(s.content),r="/!DataSpaces/DataSpaceMap",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=pP(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=xP(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);vP(s.content)}catch{}if(r="/EncryptionInfo",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=yP(s.content);if(r="/EncryptedPackage",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,a.password||"",a);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function vx(e,t){var a="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=hr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function _U(e,t){return nt.find(e,"EncryptedPackage")?wU(e,t):iE(e,t)}function TU(e,t){var a,r=e,s=t||{};return s.type||(s.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),a=ZT(r,s),bU(a,s)}function uE(e,t){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return tp(e.slice(a),t);default:break e}return kc.to_workbook(e,t)}function SU(e,t){var a="",r=vx(e,t);switch(t.type){case"base64":a=hr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=vi(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=Tt(a)),t.type="binary",uE(a,t)}function EU(e,t){var a=e;return t.type=="base64"&&(a=hr(a)),a=_c.utils.decode(1200,a.slice(2),"str"),t.type="binary",uE(a,t)}function kU(e){return e.match(/[^\x00-\x7F]/)?Go(e):e}function hm(e,t,a,r){return r?(a.type="string",kc.to_workbook(e,a)):kc.to_workbook(t,a)}function sp(e,t){FT();var a=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return sp(new Uint8Array(e),(a=ba(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],l=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),Rl={},a.dateNF&&(Rl.dateNF=a.dateNF),a.type||(a.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=rt?"buffer":"binary",r=dM(e),typeof Uint8Array<"u"&&!rt&&(a.type="array")),a.type=="string"&&(l=!0,a.type="binary",a.codepage=65001,r=kU(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return a=ba(a),a.type="array",sp(Kp(r),a)}switch((s=vx(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return _U(nt.read(r,a),a);break;case 9:if(s[1]<=8)return iE(r,a);break;case 60:return tp(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return eP(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return QL.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?TU(r,a):hm(e,r,a,l);case 239:return s[3]===60?tp(r,a):hm(e,r,a,l);case 255:if(s[1]===254)return EU(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return rc.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return rc.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return tw.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return DP.to_workbook(r,a);break;case 10:case 13:case 32:return SU(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?tw.to_workbook(r,a):hm(e,r,a,l)}function AU(e,t,a,r,s,l,c,u){var h=wa(a),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),g=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:a,enumerable:!1})}catch{y.__rowNum__=a}else y.__rowNum__=a;if(!c||e[a])for(var b=t.s.c;b<=t.e.c;++b){var _=c?e[a][b]:e[r[b]+h];if(_===void 0||_.t===void 0){if(m===void 0)continue;l[b]!=null&&(y[l[b]]=m);continue}var w=_.v;switch(_.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(l[b]!=null){if(w==null)if(_.t=="e"&&w===null)y[l[b]]=null;else if(m!==void 0)y[l[b]]=m;else if(p&&w===null)y[l[b]]=null;else continue;else y[l[b]]=p&&(_.t!=="n"||_.t==="n"&&u.rawNumbers!==!1)?w:Hn(_,w,u);w!=null&&(g=!1)}}return{row:y,isempty:g}}function ip(e,t){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},m=t||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?r=1:m.header==="A"?r=2:Array.isArray(m.header)?r=3:m.header==null&&(r=0),typeof p){case"string":h=zt(p);break;case"number":h=zt(e["!ref"]),h.s.r=p;break;default:h=p}r>0&&(s=0);var g=wa(h.s.r),y=[],b=[],_=0,w=0,T=Array.isArray(e),A=h.s.r,k=0,S={};T&&!e[A]&&(e[A]=[]);var L=m.skipHidden&&e["!cols"]||[],V=m.skipHidden&&e["!rows"]||[];for(k=h.s.c;k<=h.e.c;++k)if(!(L[k]||{}).hidden)switch(y[k]=ia(k),a=T?e[A][k]:e[y[k]+g],r){case 1:l[k]=k-h.s.c;break;case 2:l[k]=y[k];break;case 3:l[k]=m.header[k-h.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),u=c=Hn(a,null,m),w=S[c]||0,!w)S[c]=1;else{do u=c+"_"+w++;while(S[u]);S[c]=w,S[u]=1}l[k]=u}for(A=h.s.r+s;A<=h.e.r;++A)if(!(V[A]||{}).hidden){var P=AU(e,h,A,y,r,l,T,m);(P.isempty===!1||(r===1?m.blankrows!==!1:m.blankrows))&&(b[_++]=P.row)}return b.length=_,b}var vw=/"/g;function NU(e,t,a,r,s,l,c,u){for(var h=!0,m=[],p="",g=wa(a),y=t.s.c;y<=t.e.c;++y)if(r[y]){var b=u.dense?(e[a]||[])[y]:e[r[y]+g];if(b==null)p="";else if(b.v!=null){h=!1,p=""+(u.rawNumbers&&b.t=="n"?b.v:Hn(b,null,u));for(var _=0,w=0;_!==p.length;++_)if((w=p.charCodeAt(_))===s||w===l||w===34||u.forceQuotes){p='"'+p.replace(vw,'""')+'"';break}p=="ID"&&(p='"ID"')}else b.f!=null&&!b.F?(h=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(vw,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&h?null:m.join(c)}function fE(e,t){var a=[],r=t??{};if(e==null||e["!ref"]==null)return"";var s=zt(e["!ref"]),l=r.FS!==void 0?r.FS:",",c=l.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,h=u.charCodeAt(0),m=new RegExp((l=="|"?"\\|":l)+"+$"),p="",g=[];r.dense=Array.isArray(e);for(var y=r.skipHidden&&e["!cols"]||[],b=r.skipHidden&&e["!rows"]||[],_=s.s.c;_<=s.e.c;++_)(y[_]||{}).hidden||(g[_]=ia(_));for(var w=0,T=s.s.r;T<=s.e.r;++T)(b[T]||{}).hidden||(p=NU(e,s,T,g,c,h,l,r),p!=null&&(r.strip&&(p=p.replace(m,"")),(p||r.blankrows!==!1)&&a.push((w++?u:"")+p)));return delete r.dense,a.join("")}function CU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var a=fE(e,t);return a}function OU(e){var t="",a,r="";if(e==null||e["!ref"]==null)return[];var s=zt(e["!ref"]),l="",c=[],u,h=[],m=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=ia(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=wa(p),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,a=m?(e[p]||[])[u]:e[t],r="",a!==void 0){if(a.F!=null){if(t=a.F,!a.f)continue;r=a.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}h[h.length]=t+"="+r}return h}function hE(e,t,a){var r=a||{},s=+!r.skipHeader,l=e||{},c=0,u=0;if(l&&r.origin!=null)if(typeof r.origin=="number")c=r.origin;else{var h=typeof r.origin=="string"?Ba(r.origin):r.origin;c=h.r,u=h.c}var m,p={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var g=zt(l["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),c==-1&&(c=g.e.r+1,p.e.r=c+t.length-1+s)}else c==-1&&(c=0,p.e.r=t.length-1+s);var y=r.header||[],b=0;t.forEach(function(w,T){pn(w).forEach(function(A){(b=y.indexOf(A))==-1&&(y[b=y.length]=A);var k=w[A],S="z",L="",V=$e({c:u+b,r:c+T+s});m=Oc(l,V),k&&typeof k=="object"&&!(k instanceof Date)?l[V]=k:(typeof k=="number"?S="n":typeof k=="boolean"?S="b":typeof k=="string"?S="s":k instanceof Date?(S="d",r.cellDates||(S="n",k=za(k)),L=r.dateNF||qe[14]):k===null&&r.nullError&&(S="e",k=0),m?(m.t=S,m.v=k,delete m.w,delete m.R,L&&(m.z=L)):l[V]=m={t:S,v:k},L&&(m.z=L))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var _=wa(c);if(s)for(b=0;b<y.length;++b)l[ia(b+u)+_]={t:"s",v:y[b]};return l["!ref"]=st(p),l}function DU(e,t){return hE(null,e,t)}function Oc(e,t,a){if(typeof t=="string"){if(Array.isArray(e)){var r=Ba(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Oc(e,$e(t)):Oc(e,$e({r:t,c:a||0}))}function jU(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var a=e.SheetNames.indexOf(t);if(a>-1)return a;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yx(){return{SheetNames:[],Sheets:{}}}function bx(e,t,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var l=a.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=c+s)!=-1;++s);}if(xB(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=t,a}function RU(e,t,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=jU(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function MU(e,t){return e.z=t,e}function dE(e,t,a){return t?(e.l={Target:t},a&&(e.l.Tooltip=a)):delete e.l,e}function FU(e,t,a){return dE(e,"#"+t,a)}function LU(e,t,a){e.c||(e.c=[]),e.c.push({t,a:a||"SheetJS"})}function PU(e,t,a,r){for(var s=typeof t!="string"?t:zt(t),l=typeof t=="string"?t:st(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=Oc(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=a,r&&(h.D=!0))}return e}var IU={encode_col:ia,encode_row:wa,encode_cell:$e,encode_range:st,decode_col:sx,decode_row:nx,split_cell:XM,decode_cell:Ba,decode_range:zl,format_cell:Hn,sheet_add_aoa:gS,sheet_add_json:hE,sheet_add_dom:lE,aoa_to_sheet:Vl,json_to_sheet:DU,table_to_sheet:oE,table_to_book:eU,sheet_to_csv:fE,sheet_to_txt:CU,sheet_to_json:ip,sheet_to_html:ZB,sheet_to_formulae:OU,sheet_to_row_object_array:ip,sheet_get_cell:Oc,book_new:yx,book_append_sheet:bx,book_set_sheet_visibility:RU,cell_set_number_format:MU,cell_set_hyperlink:dE,cell_set_internal_link:FU,cell_add_comment:LU,sheet_set_array_formula:PU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const BU=()=>{const[e,t]=ie.useState(localStorage.getItem("supabase_url")||""),[a,r]=ie.useState(localStorage.getItem("supabase_key")||""),[s,l]=ie.useState(localStorage.getItem("gemini_api_key")||""),[c,u]=ie.useState({type:"",message:""}),h=()=>{if(!e||!a){u({type:"error",message:"Por favor completa ambos campos."});return}LR(e,a),u({type:"success",message:"Configuracin guardada. Recargando..."})},m=()=>{if(!s){u({type:"error",message:"Por favor pega una clave de API vlida."});return}localStorage.setItem("gemini_api_key",s),u({type:"success",message:"IA Activada con xito!"}),setTimeout(()=>u({type:"",message:""}),3e3)},p=()=>{const y=window.prompt("Introduce la contrasea para borrar todos los datos:");y==="admin123"?window.confirm("ESTS TOTALMENTE SEGURO? Esta accin borrar permanentemente todos tus registros locales.")&&(localStorage.clear(),window.location.reload()):y!==null&&alert("Contrasea incorrecta. Accin cancelada.")},g=y=>{const b=y.target.files[0];if(!b)return;const _=new FileReader;_.onload=w=>{try{const T=w.target.result,A=sp(T,{type:"binary"}),k=A.SheetNames[0],S=A.Sheets[k],V=IU.sheet_to_json(S).map(N=>({id:crypto.randomUUID(),date:N.Fecha||new Date().toISOString().split("T")[0],accountId:N.CuentaID||"default",type:N.Tipo==="Ingreso"?"income":"expense",amount:parseFloat(N.Monto)||0,note:N.Nota||"",categoryId:N.CategoriaID||"other"})),P=JSON.parse(localStorage.getItem("finanzas_transactions")||"[]");localStorage.setItem("finanzas_transactions",JSON.stringify([...P,...V])),u({type:"success",message:`Se importaron ${V.length} registros con xito!`})}catch(T){console.error("Error importing Excel:",T),u({type:"error",message:"Error al procesar el archivo Excel."})}},_.readAsBinaryString(b)};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("header",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Configuracin"}),d.jsx("p",{className:"text-slate-500 mt-1",children:"Gestiona tu conexin a la nube y tus datos locales."})]}),c.message&&d.jsxs("div",{className:`p-4 rounded-xl flex items-center gap-3 animate-in fade-in slide-in-from-top-2 ${c.type==="success"?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-rose-50 text-rose-700 border border-rose-100"}`,children:[c.type==="success"?d.jsx(fA,{size:20}):d.jsx(op,{size:20}),d.jsx("span",{className:"text-sm font-medium",children:c.message})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200/60 shadow-sm space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600",children:d.jsx(Sw,{size:20})}),d.jsx("h3",{className:"font-semibold text-slate-800",children:"IA de Bienestar (Gratis)"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("p",{className:"text-sm text-slate-500",children:["Usa la IA de Google para refutar tus pensamientos. Puedes obtener una clave",d.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",className:"text-violet-600 font-bold hover:underline ml-1",children:"GRATIS aqu"}),"."]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Gemini API Key"}),d.jsx("input",{type:"password",value:s,onChange:y=>l(y.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all text-sm",placeholder:"Pega tu clave de Google AI Studio"})]}),d.jsxs("button",{onClick:m,className:"w-full bg-violet-600 hover:bg-violet-700 text-white font-semibold py-2.5 rounded-xl transition-all shadow-lg shadow-violet-200 flex items-center justify-center gap-2 text-sm",children:[d.jsx(by,{size:18}),"Activar IA Refutadora"]})]})]}),d.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200/60 shadow-sm space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600",children:d.jsx(cp,{size:20})}),d.jsx("h3",{className:"font-semibold text-slate-800",children:"Conexin Supabase"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"URL del Proyecto"}),d.jsx("input",{type:"text",value:e,onChange:y=>t(y.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all text-sm",placeholder:"https://your-project.supabase.co"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Anon Key"}),d.jsx("input",{type:"password",value:a,onChange:y=>r(y.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all text-sm",placeholder:"your-anon-key"})]}),d.jsxs("button",{onClick:h,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 rounded-xl transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-2 text-sm",children:[d.jsx(by,{size:18}),"Guardar Configuracin Supabase"]})]})]}),d.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200/60 shadow-sm space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center text-slate-600",children:d.jsx(jr,{size:20})}),d.jsx("h3",{className:"font-semibold text-slate-800",children:"Gestin de Datos"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("p",{className:"text-sm text-slate-500",children:"Importa tus registros desde un archivo Excel o limpia la base de datos local para empezar de cero."}),d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:g,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),d.jsxs("button",{className:"w-full bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 font-semibold py-2.5 rounded-xl transition-all flex items-center justify-center gap-2 text-sm",children:[d.jsx(fN,{size:18}),"Importar desde Excel"]})]}),d.jsxs("button",{onClick:p,className:"w-full bg-rose-50 hover:bg-rose-100 text-rose-600 font-semibold py-2.5 rounded-xl transition-all flex items-center justify-center gap-2 text-sm border border-rose-200",children:[d.jsx(jr,{size:18}),"Limpiar Base de Datos"]})]})]})]})]})},UU=()=>{const[e,t]=ie.useState(()=>{const h=localStorage.getItem("finanzas_accounts");return h?JSON.parse(h):[]}),[a,r]=ie.useState(!1),[s,l]=ie.useState({name:"",type:"Ahorros",balance:0,color:"#3b82f6",loanDetails:{loanAmount:0,interestRate:0,term:12,grantingDate:new Date().toISOString().split("T")[0],firstPaymentDate:new Date().toISOString().split("T")[0],commissions:0,insurance:0,paymentFrequency:"monthly"}});ie.useEffect(()=>{localStorage.setItem("finanzas_accounts",JSON.stringify(e))},[e]);const c=h=>{h.preventDefault(),{id:crypto.randomUUID(),...s,balance:parseFloat(s.balance),loanDetails:s.type==="Prstamo"&&{...s.loanDetails,loanAmount:parseFloat(s.loanDetails.loanAmount),interestRate:parseFloat(s.interestRate),term:parseInt(s.loanDetails.term),commissions:parseFloat(s.loanDetails.commissions),insurance:parseFloat(s.loanDetails.insurance)}};const m={id:crypto.randomUUID(),name:s.name,type:s.type,balance:parseFloat(s.balance),color:s.color,loanDetails:s.type==="Prstamo"?{...s.loanDetails,loanAmount:parseFloat(s.loanDetails.loanAmount),interestRate:parseFloat(s.loanDetails.interestRate),term:parseInt(s.loanDetails.term),commissions:parseFloat(s.loanDetails.commissions),insurance:parseFloat(s.loanDetails.insurance)}:null,paidInstallments:[]};t([...e,m]),r(!1),l({name:"",type:"Ahorros",balance:0,color:"#3b82f6",loanDetails:{loanAmount:0,interestRate:0,term:12,grantingDate:new Date().toISOString().split("T")[0],firstPaymentDate:new Date().toISOString().split("T")[0],commissions:0,insurance:0,paymentFrequency:"monthly"}})},u=h=>{window.confirm("Eliminar esta cuenta?")&&t(e.filter(m=>m.id!==h))};return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Mis Cuentas"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Gestiona tus bancos, efectivo y tarjetas."})]}),d.jsxs("button",{onClick:()=>r(!0),className:"btn-primary",children:[d.jsx(zn,{size:18}),d.jsx("span",{children:"Nueva Cuenta"})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.length===0?d.jsxs("div",{className:"col-span-full card py-20 text-center border-dashed border-2",children:[d.jsx(O0,{className:"mx-auto text-slate-300 mb-4",size:48}),d.jsx("p",{className:"text-slate-400 font-medium",children:"No tienes cuentas registradas."})]}):e.map(h=>d.jsxs("div",{className:"card relative group overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:h.color}}),d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("div",{className:"p-2 bg-slate-50 rounded-lg text-slate-600",children:d.jsx(Z0,{size:20})}),d.jsx("button",{onClick:()=>u(h.id),className:"p-1.5 text-slate-300 hover:text-rose-600 hover:bg-rose-50 rounded-md transition-all opacity-0 group-hover:opacity-100",children:d.jsx(jr,{size:16})})]}),d.jsx("h4",{className:"font-bold text-slate-900 mb-1",children:h.name}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:h.type}),d.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:["$",h.balance.toLocaleString("es-MX",{minimumFractionDigits:2})]})]},h.id))}),a&&d.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>r(!1)}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsx("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Nueva Cuenta"})}),d.jsxs("form",{onSubmit:c,className:"p-8 space-y-4 max-h-[75vh] overflow-y-auto",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Nombre"}),d.jsx("input",{type:"text",required:!0,placeholder:"Ej. Banco Agrcola",className:"input-field",value:s.name,onChange:h=>l({...s,name:h.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Tipo"}),d.jsxs("select",{className:"input-field",value:s.type,onChange:h=>l({...s,type:h.target.value}),children:[d.jsx("option",{children:"Ahorros"}),d.jsx("option",{children:"Corriente"}),d.jsx("option",{children:"Efectivo"}),d.jsx("option",{children:"Tarjeta de Crdito"}),d.jsx("option",{children:"Inversin"}),d.jsx("option",{children:"Prstamo"})]})]})]}),s.type==="Prstamo"?d.jsxs("div",{className:"space-y-4 p-4 bg-slate-50 rounded-xl border border-slate-200",children:[d.jsx("h4",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Detalles del Prstamo"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Monto Principal"}),d.jsx("input",{type:"number",step:"0.01",required:!0,className:"input-field",value:s.loanDetails.loanAmount,onChange:h=>l({...s,balance:h.target.value,loanDetails:{...s.loanDetails,loanAmount:h.target.value}})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Tasa Inters Anual (%)"}),d.jsx("input",{type:"number",step:"0.01",required:!0,className:"input-field",value:s.loanDetails.interestRate,onChange:h=>l({...s,loanDetails:{...s.loanDetails,interestRate:h.target.value}})})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Plazo (Meses)"}),d.jsx("input",{type:"number",required:!0,className:"input-field",value:s.loanDetails.term,onChange:h=>l({...s,loanDetails:{...s.loanDetails,term:h.target.value}})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Comisiones (Total)"}),d.jsx("input",{type:"number",step:"0.01",className:"input-field",value:s.loanDetails.commissions,onChange:h=>l({...s,loanDetails:{...s.loanDetails,commissions:h.target.value}})})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Seguros (Mensual)"}),d.jsx("input",{type:"number",step:"0.01",className:"input-field",value:s.loanDetails.insurance,onChange:h=>l({...s,loanDetails:{...s.loanDetails,insurance:h.target.value}})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Fecha Otorgamiento"}),d.jsx("input",{type:"date",required:!0,className:"input-field",value:s.loanDetails.grantingDate,onChange:h=>l({...s,loanDetails:{...s.loanDetails,grantingDate:h.target.value}})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Fecha Primer Pago"}),d.jsx("input",{type:"date",required:!0,className:"input-field",value:s.loanDetails.firstPaymentDate,onChange:h=>l({...s,loanDetails:{...s.loanDetails,firstPaymentDate:h.target.value}})})]})]}):d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Saldo Inicial"}),d.jsx("input",{type:"number",step:"0.01",required:!0,placeholder:"0.00",className:"input-field",value:s.balance,onChange:h=>l({...s,balance:h.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Color Identificador"}),d.jsx("input",{type:"color",className:"w-full h-10 rounded-lg cursor-pointer mt-1",value:s.color,onChange:h=>l({...s,color:h.target.value})})]}),d.jsxs("div",{className:"flex gap-4 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 py-3 font-bold text-slate-500 hover:bg-slate-50 rounded-xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-3",children:"Crear Cuenta"})]})]})]})]})]})},zU=()=>{const[e,t]=ie.useState(()=>{const k=localStorage.getItem("finanzas_transactions");return k?JSON.parse(k):[]}),[a,r]=ie.useState(()=>{const k=localStorage.getItem("finanzas_accounts");return k?JSON.parse(k):[]}),[s,l]=ie.useState(!1),[c,u]=ie.useState(""),[h,m]=ie.useState("all"),[p,g]=ie.useState({date:yt(new Date,"yyyy-MM-dd"),accountId:"",categoryId:"",amount:"",type:"expense",note:"",attachment:null}),y=k=>new Promise(S=>{const L=new FileReader;L.readAsDataURL(k),L.onload=V=>{const P=new Image;P.src=V.target.result,P.onload=()=>{const N=document.createElement("canvas"),j=800,I=800;let z=P.width,X=P.height;z>X?z>j&&(X*=j/z,z=j):X>I&&(z*=I/X,X=I),N.width=z,N.height=X,N.getContext("2d").drawImage(P,0,0,z,X),S(N.toDataURL("image/jpeg",.6))}}}),b=async k=>{const S=k.target.files[0];if(S){const L=await y(S);g({...p,attachment:L})}};ie.useEffect(()=>{localStorage.setItem("finanzas_transactions",JSON.stringify(e))},[e]),ie.useEffect(()=>{s&&a.length>0&&!p.accountId&&g(k=>({...k,accountId:a[0].id}))},[s,a]);const _=k=>{if(k.preventDefault(),!p.accountId){alert("Por favor selecciona una cuenta.");return}const S={id:crypto.randomUUID(),...p,amount:parseFloat(p.amount)},L=[S,...e];t(L),localStorage.setItem("finanzas_transactions",JSON.stringify(L));const V=a.map(P=>{if(P.id===p.accountId){let N=P.balance;return P.type==="Prstamo"?N=p.type==="income"?P.balance-S.amount:P.balance+S.amount:N=p.type==="income"?P.balance+S.amount:P.balance-S.amount,{...P,balance:N}}return P});r(V),localStorage.setItem("finanzas_accounts",JSON.stringify(V)),l(!1),g({date:yt(new Date,"yyyy-MM-dd"),accountId:a[0]?.id||"",categoryId:"",amount:"",type:"expense",note:"",attachment:null})},w=k=>{if(window.confirm("Eliminar esta transaccin?")){const S=e.find(V=>V.id===k);if(S){const V=a.map(P=>{if(P.id===S.accountId){let N=P.balance;return P.type==="Prstamo"?N=S.type==="income"?P.balance+S.amount:P.balance-S.amount:N=S.type==="income"?P.balance-S.amount:P.balance+S.amount,{...P,balance:N}}return P});r(V),localStorage.setItem("finanzas_accounts",JSON.stringify(V))}const L=e.filter(V=>V.id!==k);t(L),localStorage.setItem("finanzas_transactions",JSON.stringify(L))}},T=e.filter(k=>{const S=k.note.toLowerCase().includes(c.toLowerCase()),L=h==="all"||k.type===h;return S&&L}),A=p.type==="income"?El.income:El.expense;return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Movimientos"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Registra y revisa todos tus ingresos y gastos."})]}),d.jsxs("button",{onClick:()=>l(!0),className:"btn-primary",children:[d.jsx(zn,{size:18}),d.jsx("span",{children:"Nuevo Movimiento"})]})]}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(ef,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),d.jsx("input",{type:"text",placeholder:"Buscar por nota...",className:"input-field pl-10",value:c,onChange:k=>u(k.target.value)})]}),d.jsx("div",{className:"flex gap-2",children:d.jsxs("select",{className:"input-field w-auto",value:h,onChange:k=>m(k.target.value),children:[d.jsx("option",{value:"all",children:"Todos"}),d.jsx("option",{value:"income",children:"Ingresos"}),d.jsx("option",{value:"expense",children:"Gastos"})]})})]}),d.jsx("div",{className:"card !p-0 overflow-hidden border-slate-200/60 shadow-md",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{className:"bg-slate-50 border-b border-slate-200/60",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Fecha"}),d.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Cuenta"}),d.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Categora"}),d.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Nota"}),d.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Monto"}),d.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Acciones"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:T.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"6",className:"px-6 py-20 text-center text-slate-400",children:"No se encontraron movimientos."})}):T.map(k=>{const S=a.find(V=>V.id===k.accountId),L=[...El.income,...El.expense].find(V=>V.id===k.categoryId);return d.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 font-medium",children:k.date}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:S?.color||"#cbd5e1"}}),d.jsx("span",{className:"text-sm font-semibold text-slate-700",children:S?.name||"---"})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-slate-100 text-slate-600 text-xs font-bold uppercase transition-colors group-hover:bg-white border border-transparent group-hover:border-slate-200",children:[L?.icon," ",L?.name||"Sin cat."]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsx("span",{className:"text-sm text-slate-600",children:k.note||"---"}),k.attachment&&d.jsxs("button",{onClick:()=>{window.open().document.write(`<img src="${k.attachment}" style="max-width:100%"/>`)},className:"flex items-center gap-1 text-[10px] font-bold text-blue-500 hover:text-blue-700",children:[d.jsx(AA,{size:12})," VER COMPROBANTE"]})]})}),d.jsxs("td",{className:`px-6 py-4 text-right font-bold ${k.type==="income"?"text-emerald-600":"text-rose-600"}`,children:[k.type==="income"?"+":"-","$",k.amount.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsx("td",{className:"px-6 py-4 text-right",children:d.jsx("button",{onClick:()=>w(k.id),className:"p-2 text-slate-300 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:d.jsx(jr,{size:16})})})]},k.id)})})]})})}),s&&d.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>l(!1)}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsx("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Nuevo Movimiento"})}),d.jsxs("form",{onSubmit:_,className:"p-8 space-y-5 max-h-[70vh] overflow-y-auto",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("button",{type:"button",onClick:()=>g({...p,type:"income",categoryId:""}),className:`py-3 rounded-xl font-bold transition-all border flex items-center justify-center gap-2 ${p.type==="income"?"bg-emerald-50 text-emerald-600 border-emerald-200":"bg-slate-50 text-slate-400 border-transparent hover:bg-slate-100"}`,children:[d.jsx(cA,{size:18})," Ingreso"]}),d.jsxs("button",{type:"button",onClick:()=>g({...p,type:"expense",categoryId:""}),className:`py-3 rounded-xl font-bold transition-all border flex items-center justify-center gap-2 ${p.type==="expense"?"bg-rose-50 text-rose-600 border-rose-200":"bg-slate-50 text-slate-400 border-transparent hover:bg-slate-100"}`,children:[d.jsx(lA,{size:18})," Gasto"]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Fecha"}),d.jsx("input",{type:"date",required:!0,className:"input-field",value:p.date,onChange:k=>g({...p,date:k.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Monto ($)"}),d.jsx("input",{type:"number",step:"0.01",required:!0,placeholder:"0.00",className:"input-field",value:p.amount,onChange:k=>g({...p,amount:k.target.value})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Cuenta"}),d.jsxs("select",{required:!0,className:"input-field",value:p.accountId,onChange:k=>g({...p,accountId:k.target.value}),children:[d.jsx("option",{value:"",children:"Selecciona una cuenta"}),a.map(k=>d.jsx("option",{value:k.id,children:k.name},k.id))]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Categora"}),d.jsxs("select",{required:!0,className:"input-field",value:p.categoryId,onChange:k=>g({...p,categoryId:k.target.value}),children:[d.jsx("option",{value:"",children:"Selecciona una categora"}),A.map(k=>d.jsxs("option",{value:k.id,children:[k.icon," ",k.name]},k.id))]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Nota / Descripcin"}),d.jsx("input",{type:"text",placeholder:"Ej. Pago de internet",className:"input-field",value:p.note,onChange:k=>g({...p,note:k.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Comprobante (Opcional)"}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:b,className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full z-10"}),d.jsxs("div",{className:"btn-secondary !w-full flex items-center justify-center gap-2 !py-2.5",children:[d.jsx(pm,{size:18}),d.jsx("span",{children:p.attachment?"Cambiar Foto":"Tomar Foto / Subir"})]})]}),p.attachment&&d.jsxs("div",{className:"relative w-12 h-12 rounded-lg overflow-hidden border border-slate-200",children:[d.jsx("img",{src:p.attachment,className:"w-full h-full object-cover"}),d.jsx("button",{type:"button",onClick:()=>g({...p,attachment:null}),className:"absolute top-0 right-0 bg-rose-500 text-white rounded-bl-lg p-0.5",children:d.jsx(Qr,{size:10})})]})]})]}),d.jsxs("div",{className:"flex gap-4 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 py-3 font-bold text-slate-500 hover:bg-slate-50 rounded-xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-3",children:"Guardar"})]})]})]})]})]})},VU=()=>{const[e,t]=ie.useState(()=>{const g=localStorage.getItem("finanzas_vehicles");return g?JSON.parse(g):[]}),[a,r]=ie.useState(!1),[s,l]=ie.useState({name:"",plate:"",type:"Carro",currentMileage:"",maintenanceItems:[{id:1,label:"Cambio de Aceite",lastMileage:"",interval:5e3,estimatedCost:0},{id:2,label:"Pastillas de Freno",lastMileage:"",interval:2e4,estimatedCost:0}]});ie.useEffect(()=>{localStorage.setItem("finanzas_vehicles",JSON.stringify(e))},[e]);const c=g=>{g.preventDefault();const y={id:crypto.randomUUID(),...s,currentMileage:parseInt(s.currentMileage),maintenanceItems:s.maintenanceItems.map(b=>({...b,lastMileage:parseInt(b.lastMileage),interval:parseInt(b.interval),estimatedCost:parseFloat(b.estimatedCost)||0}))};t([...e,y]),r(!1),l({name:"",plate:"",type:"Carro",currentMileage:"",maintenanceItems:[{id:1,label:"Cambio de Aceite",lastMileage:"",interval:5e3,estimatedCost:0},{id:2,label:"Pastillas de Freno",lastMileage:"",interval:2e4,estimatedCost:0}]})},u=g=>{window.confirm("Eliminar este vehculo?")&&t(e.filter(y=>y.id!==g))},h=(g,y)=>{t(e.map(b=>b.id===g?{...b,currentMileage:parseInt(y)||0}:b))},m=(g,y)=>{t(e.map(b=>b.id===g?{...b,maintenanceItems:b.maintenanceItems.map(_=>_.id===y?{..._,lastMileage:b.currentMileage}:_)}:b))},p=(g,y,b)=>{const _=y+b-g;return _<=0?{label:"VENCIDO",color:"text-rose-600 bg-rose-50",icon:cN}:_<500?{label:"PRXIMO",color:"text-amber-600 bg-amber-50",icon:lc}:{label:"AL DA",color:"text-emerald-600 bg-emerald-50",icon:xm}};return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Mis Vehculos"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Control de mantenimientos y costos de operacin."})]}),d.jsxs("button",{onClick:()=>r(!0),className:"btn-primary",children:[d.jsx(zn,{size:18}),d.jsx("span",{children:"Agregar Vehculo"})]})]}),d.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:e.length===0?d.jsxs("div",{className:"col-span-full card py-20 text-center border-dashed border-2",children:[d.jsx(T0,{className:"mx-auto text-slate-300 mb-4",size:48}),d.jsx("p",{className:"text-slate-400 font-medium",children:"No has registrado vehculos."})]}):e.map(g=>d.jsxs("div",{className:"card overflow-hidden !p-0",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 bg-slate-100/30",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-blue-200",children:d.jsx(T0,{size:24})}),d.jsxs("div",{children:[d.jsxs("h4",{className:"font-bold text-slate-900 text-lg",children:[g.name," ",d.jsxs("span",{className:"text-slate-400 font-medium text-sm",children:["[",g.plate,"]"]})]}),d.jsx("p",{className:"text-xs font-bold text-blue-600 uppercase tracking-widest",children:g.type})]})]}),d.jsx("button",{onClick:()=>u(g.id),className:"p-2 text-slate-300 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-all",children:d.jsx(jr,{size:18})})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"Kilometraje Actual"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"number",value:g.currentMileage,onChange:y=>h(g.id,y.target.value),className:"w-full bg-white border border-slate-200 rounded-lg px-3 py-2 font-bold text-slate-700 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"}),d.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs font-bold text-slate-400",children:"KM"})]})]}),d.jsxs("div",{className:"bg-white p-2 rounded-xl border border-slate-200 min-w-[120px]",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-0.5",children:"Total Mantenimientos"}),d.jsxs("div",{className:"text-sm font-bold text-emerald-600 flex items-center",children:[d.jsx(_w,{size:14}),g.maintenanceItems.reduce((y,b)=>y+b.estimatedCost,0).toLocaleString()]})]})]})]}),d.jsx("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:g.maintenanceItems.map(y=>{const b=p(g.currentMileage,y.lastMileage,y.interval),_=Math.min(100,Math.max(0,(g.currentMileage-y.lastMileage)/y.interval*100));return d.jsxs("div",{className:"p-4 rounded-2xl border border-slate-100 space-y-3 hover:border-blue-100 transition-colors group",children:[d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"space-y-0.5",children:[d.jsx("span",{className:"text-sm font-bold text-slate-700 block",children:y.label}),d.jsxs("span",{className:"text-[10px] font-bold text-emerald-600 flex items-center",children:["Est: $",y.estimatedCost.toLocaleString()]})]}),d.jsxs("span",{className:`flex items-center gap-1 px-2 py-0.5 rounded-md text-[10px] font-bold ${b.color}`,children:[d.jsx(b.icon,{size:12}),b.label]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"flex items-end justify-between",children:[d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Uso"}),d.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[g.currentMileage-y.lastMileage," / ",y.interval," KM"]})]}),d.jsx("div",{className:"h-1.5 bg-slate-100 rounded-full overflow-hidden text-[0px]",children:d.jsx("div",{className:`h-full transition-all duration-1000 ${_>90?"bg-rose-500":"bg-blue-600"}`,style:{width:`${_}%`}})})]}),d.jsx("button",{onClick:()=>m(g.id,y.id),className:"w-full py-1.5 text-[10px] font-bold text-slate-400 hover:text-blue-600 hover:bg-blue-50 bg-slate-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:"MARCAR COMO REALIZADO"})]},y.id)})})]},g.id))}),a&&d.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>r(!1)}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Agregar Vehculo"}),d.jsx("button",{onClick:()=>r(!1),className:"text-slate-400 hover:text-slate-600",children:d.jsx(Qr,{})})]}),d.jsxs("form",{onSubmit:c,className:"p-8 max-h-[80vh] overflow-y-auto",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h5",{className:"font-bold text-slate-900 border-b pb-2 flex items-center gap-2",children:[d.jsx(T0,{size:18,className:"text-blue-600"})," Datos Generales"]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Nombre"}),d.jsx("input",{type:"text",required:!0,className:"input-field",value:s.name,onChange:g=>l({...s,name:g.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Placa"}),d.jsx("input",{type:"text",required:!0,className:"input-field",value:s.plate,onChange:g=>l({...s,plate:g.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"KM Actual"}),d.jsx("input",{type:"number",required:!0,className:"input-field",value:s.currentMileage,onChange:g=>l({...s,currentMileage:g.target.value})})]})]}),d.jsxs("div",{className:"md:col-span-2 space-y-4",children:[d.jsxs("h5",{className:"font-bold text-slate-900 border-b pb-2 flex items-center gap-2 justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(up,{size:18,className:"text-blue-600"})," Mantenimientos y Costos"]}),d.jsx("button",{type:"button",onClick:()=>l({...s,maintenanceItems:[...s.maintenanceItems,{id:Date.now(),label:"",lastMileage:"",interval:"",estimatedCost:0}]}),className:"text-[10px] bg-blue-50 text-blue-600 px-2 py-1 rounded-md hover:bg-blue-100 font-bold",children:"+ AADIR PARMETRO"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[400px] overflow-y-auto pr-2",children:s.maintenanceItems.map((g,y)=>d.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl space-y-3 relative group border border-slate-100",children:[d.jsx("button",{type:"button",onClick:()=>l({...s,maintenanceItems:s.maintenanceItems.filter(b=>b.id!==g.id)}),className:"absolute top-2 right-2 text-slate-300 hover:text-rose-500 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(Qr,{size:14})}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Nombre"}),d.jsx("input",{type:"text",required:!0,className:"input-field !py-1.5",placeholder:"Ej. Llantas",value:g.label,onChange:b=>{const _=[...s.maintenanceItems];_[y].label=b.target.value,l({...s,maintenanceItems:_})}})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"ltimo KM"}),d.jsx("input",{type:"number",required:!0,className:"input-field !py-1.5",value:g.lastMileage,onChange:b=>{const _=[...s.maintenanceItems];_[y].lastMileage=b.target.value,l({...s,maintenanceItems:_})}})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Frecuencia"}),d.jsx("input",{type:"number",required:!0,className:"input-field !py-1.5",value:g.interval,onChange:b=>{const _=[...s.maintenanceItems];_[y].interval=b.target.value,l({...s,maintenanceItems:_})}})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Costo Est."}),d.jsx("input",{type:"number",step:"0.01",required:!0,className:"input-field !py-1.5 border-emerald-100 focus:border-emerald-500",value:g.estimatedCost,onChange:b=>{const _=[...s.maintenanceItems];_[y].estimatedCost=b.target.value,l({...s,maintenanceItems:_})}})]})]})]},g.id))})]})]}),d.jsxs("div",{className:"flex gap-4 border-t pt-8",children:[d.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 py-3 font-bold text-slate-500 hover:bg-slate-50 rounded-xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-3 shadow-lg shadow-blue-200",children:"Guardar Vehculo"})]})]})]})]})]})},HU=()=>{const[e,t]=ie.useState("records"),[a,r]=ie.useState(()=>{const Q=localStorage.getItem("finanzas_medical_records");return Q?JSON.parse(Q):[]}),[s,l]=ie.useState(()=>{const Q=localStorage.getItem("finanzas_patients");return Q?JSON.parse(Q):[]}),[c,u]=ie.useState(!1),[h,m]=ie.useState(!1),[p,g]=ie.useState(""),[y,b]=ie.useState(!1),_=ie.useRef(null),w=ie.useRef([]),[T,A]=ie.useState({date:yt(new Date,"yyyy-MM-dd"),personName:"",reason:"",medications:"",hasFollowUp:!1,followUpDate:"",doctorName:"",doctorComments:"",height:"",weight:"",recipeImage:"",audioNote:""}),[k,S]=ie.useState({name:"",age:"",bloodType:"",allergies:"",notes:""});ie.useEffect(()=>{localStorage.setItem("finanzas_medical_records",JSON.stringify(a))},[a]),ie.useEffect(()=>{localStorage.setItem("finanzas_patients",JSON.stringify(s))},[s]);const L=async()=>{try{const Q=await navigator.mediaDevices.getUserMedia({audio:!0});_.current=new MediaRecorder(Q),w.current=[],_.current.ondataavailable=be=>w.current.push(be.data),_.current.onstop=()=>{const be=new Blob(w.current,{type:"audio/webm"}),ve=new FileReader;ve.readAsDataURL(be),ve.onloadend=()=>{A(R=>({...R,audioNote:ve.result}))}},_.current.start(),b(!0)}catch(Q){alert("No se pudo acceder al micrfono: "+Q.message)}},V=()=>{_.current&&y&&(_.current.stop(),b(!1),_.current.stream.getTracks().forEach(Q=>Q.stop()))},P=Q=>{const be=Q.target.files[0];if(be){const ve=new FileReader;ve.onloadend=()=>{A(R=>({...R,recipeImage:ve.result}))},ve.readAsDataURL(be)}},N=Q=>{Q.preventDefault();const be={id:crypto.randomUUID(),...T,medicationsList:T.medications.split(",").map(ve=>ve.trim()).filter(ve=>ve!=="")};if(r([be,...a]),!s.find(ve=>ve.name.toLowerCase()===T.personName.toLowerCase())&&T.personName!=="__new__"){const ve={id:crypto.randomUUID(),name:T.personName,age:"",bloodType:"",allergies:"",notes:"Paciente agregado desde consulta"};l([...s,ve])}u(!1),A({date:yt(new Date,"yyyy-MM-dd"),personName:"",reason:"",medications:"",hasFollowUp:!1,followUpDate:"",doctorName:"",doctorComments:"",height:"",weight:"",recipeImage:"",audioNote:""})},j=Q=>{Q.preventDefault();const be={id:crypto.randomUUID(),...k};l([...s,be]),m(!1),S({name:"",age:"",bloodType:"",allergies:"",notes:""})},I=Q=>{window.confirm("Eliminar este registro mdico?")&&r(a.filter(be=>be.id!==Q))},z=Q=>{window.confirm("Eliminar este paciente?")&&l(s.filter(be=>be.id!==Q))},X=a.filter(Q=>Q.personName.toLowerCase().includes(p.toLowerCase())||Q.reason.toLowerCase().includes(p.toLowerCase())),q=a.filter(Q=>Q.hasFollowUp&&Q.followUpDate&&k3(or(Q.followUpDate),new Date)).sort((Q,be)=>or(Q.followUpDate)-or(be.followUpDate))[0];return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-20",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 p-1.5 rounded-2xl w-fit",children:[d.jsxs("button",{onClick:()=>t("records"),className:`flex items-center gap-2 px-6 py-2.5 rounded-xl font-bold text-sm transition-all ${e==="records"?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(E0,{size:18})," Consultas"]}),d.jsxs("button",{onClick:()=>t("patients"),className:`flex items-center gap-2 px-6 py-2.5 rounded-xl font-bold text-sm transition-all ${e==="patients"?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(Ty,{size:18})," Pacientes"]})]}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:e==="records"?"Historial Mdico":"Gestin de Pacientes"}),d.jsx("p",{className:"text-slate-500 font-medium",children:e==="records"?"Control de consultas, diagnsticos y recetas.":"Directorio de personas y perfiles clnicos."})]})]}),d.jsxs("button",{onClick:()=>e==="records"?u(!0):m(!0),className:"btn-primary",children:[d.jsx(zn,{size:18})," ",d.jsx("span",{children:e==="records"?"Nueva Consulta":"Nuevo Paciente"})]})]}),e==="records"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"card bg-gradient-to-br from-blue-600 to-indigo-700 text-white border-none shadow-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-md",children:d.jsx(J4,{size:24})}),d.jsx("span",{className:"text-xs font-bold uppercase tracking-widest opacity-80",children:"Prxima Cita"})]}),q?d.jsxs("div",{children:[d.jsx("p",{className:"text-lg font-bold",children:q.personName}),d.jsx("p",{className:"text-sm opacity-90",children:yt(or(q.followUpDate),"d 'de' MMMM",{locale:hn})})]}):d.jsx("p",{className:"text-sm font-medium opacity-80",children:"No hay citas programadas."})]}),d.jsxs("div",{className:"card bg-white border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"p-3 bg-emerald-50 text-emerald-600 rounded-xl",children:d.jsx(E0,{size:24})}),d.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Total Consultas"})]}),d.jsx("div",{className:"text-3xl font-bold text-slate-900",children:a.length})]}),d.jsxs("div",{className:"card bg-white border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"p-3 bg-amber-50 text-amber-600 rounded-xl",children:d.jsx(ef,{size:24})}),d.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Buscar"})]}),d.jsx("input",{type:"text",placeholder:"Nombre o motivo...",className:"w-full bg-slate-50 border-none rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 transition-all",value:p,onChange:Q=>g(Q.target.value)})]})]}),d.jsx("div",{className:"space-y-6",children:X.length===0?d.jsxs("div",{className:"card py-20 text-center border-dashed border-2",children:[d.jsx(xA,{className:"mx-auto text-slate-300 mb-4",size:48}),d.jsx("p",{className:"text-slate-400 font-medium",children:"No hay registros mdicos."})]}):X.map(Q=>d.jsxs("div",{className:"card bg-white border-slate-100 shadow-sm hover:shadow-md transition-all group overflow-hidden",children:[d.jsxs("div",{className:"bg-slate-50/50 px-6 py-3 border-b border-slate-100 flex items-center justify-between",children:[d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("time",{className:"text-xs font-bold text-blue-600 uppercase tracking-widest",children:yt(or(Q.date),"dd MMMM, yyyy",{locale:hn})})}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsx("button",{onClick:()=>I(Q.id),className:"p-1.5 text-slate-300 hover:text-rose-500 transition-all opacity-0 group-hover:opacity-100",children:d.jsx(jr,{size:16})})})]}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[d.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[d.jsxs("div",{children:[d.jsxs("h4",{className:"font-bold text-slate-900 text-xl flex items-center gap-2 mb-1",children:[d.jsx(_y,{size:20,className:"text-blue-500"})," ",Q.personName]}),d.jsx("p",{className:"text-sm text-slate-500 font-medium italic",children:Q.reason})]}),d.jsxs("div",{className:"flex gap-2",children:[Q.height&&d.jsxs("div",{className:"px-3 py-1.5 bg-blue-50 rounded-xl text-blue-600 text-[10px] font-bold border border-blue-100 flex items-center gap-1",children:[d.jsx(qA,{size:14}),Q.height," cm"]}),Q.weight&&d.jsxs("div",{className:"px-3 py-1.5 bg-indigo-50 rounded-xl text-indigo-600 text-[10px] font-bold border border-indigo-100 flex items-center gap-1",children:[d.jsx(xN,{size:14}),Q.weight," kg"]})]}),Q.medicationsList?.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2",children:Q.medicationsList.map((be,ve)=>d.jsxs("span",{className:"px-2 py-1 bg-emerald-50 text-emerald-600 text-[10px] font-bold rounded-lg border border-emerald-100 flex items-center gap-1",children:[d.jsx(Tw,{size:12}),be]},ve))})]}),d.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[Q.doctorComments&&d.jsxs("div",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-100 relative",children:[d.jsx(FA,{className:"absolute -top-3 -left-3 text-blue-500 bg-white rounded-full p-1 border shadow-sm",size:24}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"Comentarios del Doctor"}),d.jsxs("p",{className:"text-sm text-slate-700 leading-relaxed italic",children:['"',Q.doctorComments,'"']})]}),Q.audioNote&&d.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-2xl border border-blue-100 flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white",children:d.jsx(VA,{size:14})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("span",{className:"text-[10px] font-bold text-blue-600 uppercase block leading-none",children:"Nota de Audio"}),d.jsx("audio",{controls:!0,src:Q.audioNote,className:"h-8 w-full mt-1"})]})]})]}),d.jsx("div",{className:"lg:col-span-3",children:Q.recipeImage?d.jsxs("div",{className:"relative group/img rounded-2xl overflow-hidden border-2 border-slate-100 shadow-sm",children:[d.jsx("img",{src:Q.recipeImage,alt:"Receta",className:"w-full h-32 object-cover cursor-pointer hover:scale-105 transition-transform",onClick:()=>window.open(Q.recipeImage)}),d.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-black/50 p-1 text-center opacity-0 group-hover/img:opacity-100 transition-opacity",children:d.jsx("span",{className:"text-[10px] text-white font-bold uppercase",children:"Ver Receta"})})]}):d.jsxs("div",{className:"w-full h-32 rounded-2xl border-2 border-dashed border-slate-100 flex flex-col items-center justify-center text-slate-300",children:[d.jsx(pm,{size:24}),d.jsx("span",{className:"text-[10px] font-bold mt-1 uppercase",children:"Sin Foto"})]})})]})})]},Q.id))})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.length===0?d.jsxs("div",{className:"card py-20 text-center border-dashed border-2 col-span-full",children:[d.jsx(Ty,{className:"mx-auto text-slate-200 mb-4",size:64}),d.jsx("p",{className:"text-slate-400 font-medium",children:"No hay pacientes."})]}):s.map(Q=>d.jsxs("div",{className:"card bg-white transition-all group",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-2xl flex items-center justify-center font-bold text-xl uppercase",children:Q.name.charAt(0)}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-slate-900 group-hover:text-blue-600 uppercase tracking-tight",children:Q.name}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:Q.age?`${Q.age} aos`:"Sin edad"})]})]}),d.jsx("button",{onClick:()=>z(Q.id),className:"p-2 text-slate-300 hover:text-rose-500 opacity-0 group-hover:opacity-100",children:d.jsx(jr,{size:16})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between text-xs font-bold",children:[d.jsx("span",{className:"text-slate-400 uppercase tracking-widest",children:"Tipo Sangre"}),d.jsx("span",{className:"text-rose-600 bg-rose-50 px-2 py-0.5 rounded-lg border border-rose-100",children:Q.bloodType||"-"})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-xl border border-slate-100 overflow-hidden",children:[d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase block mb-1",children:"Alergias"}),d.jsx("p",{className:"text-[11px] text-slate-600 font-medium italic truncate",children:Q.allergies||"Ninguna"})]}),d.jsx("div",{className:"pt-2 flex justify-center",children:d.jsxs("button",{onClick:()=>{g(Q.name),t("records")},className:"text-[10px] font-bold text-blue-600 hover:underline uppercase flex items-center gap-1",children:["Ver Historial ",d.jsx(G4,{size:10})]})})]})]},Q.id))}),c&&d.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>u(!1)}),d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-4xl overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[d.jsxs("h3",{className:"text-xl font-bold text-slate-900 flex items-center gap-2",children:[d.jsx(E0,{className:"text-blue-600"})," Nueva Consulta Mdica"]}),d.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600",children:d.jsx(Qr,{size:20})})]}),d.jsxs("form",{onSubmit:N,className:"p-8 max-h-[85vh] overflow-y-auto",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h5",{className:"font-bold text-slate-900 border-b pb-2 flex items-center gap-2 text-[10px] uppercase tracking-wider text-blue-600",children:"Paciente y Vitales"}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest pl-1 mb-1 block",children:"Nombre"}),d.jsxs("select",{required:!0,className:"input-field",value:T.personName,onChange:Q=>A({...T,personName:Q.target.value}),children:[d.jsx("option",{value:"",children:"Seleccionar..."}),s.map(Q=>d.jsx("option",{value:Q.name,children:Q.name},Q.id)),d.jsx("option",{value:"__new__",children:"+ Nuevo Paciente (Escribir abajo)"})]}),T.personName==="__new__"&&d.jsx("input",{type:"text",required:!0,className:"input-field mt-2",placeholder:"Nombre completo",autoFocus:!0,onChange:Q=>A({...T,personName:Q.target.value})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase pl-1 mb-1 block",children:"Altura (cm)"}),d.jsx("input",{type:"number",className:"input-field",value:T.height,onChange:Q=>A({...T,height:Q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase pl-1 mb-1 block",children:"Peso (kg)"}),d.jsx("input",{type:"number",step:"0.1",className:"input-field",value:T.weight,onChange:Q=>A({...T,weight:Q.target.value})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase pl-1 mb-1 block",children:"Motivo"}),d.jsx("input",{type:"text",required:!0,className:"input-field",value:T.reason,onChange:Q=>A({...T,reason:Q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase pl-1 mb-1 block",children:"Fecha"}),d.jsx("input",{type:"date",required:!0,className:"input-field",value:T.date,onChange:Q=>A({...T,date:Q.target.value})})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h5",{className:"font-bold text-slate-900 border-b pb-2 flex items-center gap-2 text-[10px] uppercase tracking-wider text-emerald-600",children:"Diagnstico y Recetas"}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Medicamentos (Comas)"}),d.jsx("textarea",{className:"input-field min-h-[80px]",value:T.medications,onChange:Q=>A({...T,medications:Q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Comentarios del Doctor"}),d.jsx("textarea",{className:"input-field min-h-[80px]",placeholder:"Instrucciones especiales...",value:T.doctorComments,onChange:Q=>A({...T,doctorComments:Q.target.value})})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h5",{className:"font-bold text-slate-900 border-b pb-2 flex items-center gap-2 text-[10px] uppercase tracking-wider text-amber-600",children:"Multimedia / Evidencia"}),d.jsxs("div",{className:"relative",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2 block",children:"Foto de la Receta"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center p-4 bg-slate-50 border-2 border-dashed border-slate-200 rounded-2xl cursor-pointer hover:bg-slate-100 transition-all",children:[d.jsx(pm,{className:"text-slate-400 mb-1",size:24}),d.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Subir Foto"}),d.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:P})]}),T.recipeImage&&d.jsx("div",{className:"w-16 h-16 rounded-xl border border-slate-200 overflow-hidden shrink-0",children:d.jsx("img",{src:T.recipeImage,className:"w-full h-full object-cover"})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Nota de Voz (Doctor)"}),d.jsxs("div",{className:"flex items-center gap-3 bg-blue-50 p-3 rounded-2xl border border-blue-100",children:[y?d.jsxs("button",{type:"button",onClick:V,className:"w-10 h-10 bg-slate-900 text-white rounded-full flex items-center justify-center animate-pulse shadow-md relative",children:[d.jsx(ZA,{size:18,fill:"currentColor"}),d.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-rose-500 rounded-full border-2 border-white"})]}):d.jsx("button",{type:"button",onClick:L,className:"w-10 h-10 bg-rose-500 hover:bg-rose-600 text-white rounded-full flex items-center justify-center transition-transform hover:scale-105 shadow-md",children:d.jsx(PA,{size:20})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-[9px] font-bold text-blue-600 uppercase tracking-tighter",children:y?"Grabando Audio...":T.audioNote?"Audio Grabado!":"Pulsa para grabar"}),T.audioNote&&d.jsx("audio",{src:T.audioNote,className:"h-4 w-full mt-1",controls:!0})]})]})]}),d.jsxs("div",{className:"pt-2",children:[d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",className:"sr-only",checked:T.hasFollowUp,onChange:Q=>A({...T,hasFollowUp:Q.target.checked})}),d.jsx("div",{className:`w-10 h-6 rounded-full transition-colors ${T.hasFollowUp?"bg-blue-600":"bg-slate-200"}`,children:d.jsx("div",{className:`w-4 h-4 bg-white rounded-full mt-1 ml-1 transition-transform ${T.hasFollowUp?"translate-x-4":""}`})}),d.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-widest",children:"Hay Seguimiento?"})]}),T.hasFollowUp&&d.jsx("input",{type:"date",required:!0,className:"input-field mt-3 border-blue-100",value:T.followUpDate,onChange:Q=>A({...T,followUpDate:Q.target.value})})]})]})]}),d.jsxs("div",{className:"flex gap-4 pt-4 border-t border-slate-100",children:[d.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 py-3 font-bold text-slate-500 hover:bg-slate-50 rounded-2xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-3 !rounded-2xl shadow-lg shadow-blue-200",children:"Guardar Historial"})]})]})]})]}),h&&d.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>m(!1)}),d.jsxs("div",{className:"relative bg-white rounded-3xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-blue-50/50",children:[d.jsxs("h3",{className:"text-xl font-bold text-slate-900 flex items-center gap-2",children:[d.jsx(_y,{size:20,className:"text-blue-600"})," Nuevo Perfil"]}),d.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600",children:d.jsx(Qr,{size:20})})]}),d.jsxs("form",{onSubmit:j,className:"p-8 space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Nombre Completo"}),d.jsx("input",{type:"text",required:!0,className:"input-field",value:k.name,onChange:Q=>S({...k,name:Q.target.value})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Edad"}),d.jsx("input",{type:"number",className:"input-field",value:k.age,onChange:Q=>S({...k,age:Q.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Sangre"}),d.jsx("input",{type:"text",className:"input-field",placeholder:"O+",value:k.bloodType,onChange:Q=>S({...k,bloodType:Q.target.value})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 block",children:"Alergias"}),d.jsx("textarea",{className:"input-field",value:k.allergies,onChange:Q=>S({...k,allergies:Q.target.value})})]}),d.jsx("button",{type:"submit",className:"w-full btn-primary mt-2",children:"Crear Perfil"})]})]})]})]})},$U=()=>{const[e,t]=ie.useState("tcc"),[a,r]=ie.useState(""),[s,l]=ie.useState(!1),[c,u]=ie.useState(!1),[h,m]=ie.useState(()=>{const R=localStorage.getItem("finanzas_journal_med_list");return R?JSON.parse(R):["Sertralina","Quetiapina","Magnesium","Ashwaganda","Ansiovit","Somit"]}),[p,g]=ie.useState(""),[y,b]=ie.useState(()=>{const R=localStorage.getItem("finanzas_journal_cbt");return R?JSON.parse(R):[]}),[_,w]=ie.useState(()=>{const R=localStorage.getItem("finanzas_journal_health_log");return R?JSON.parse(R):[]}),[T,A]=ie.useState({date:yt(new Date,"yyyy-MM-dd'T'HH:mm"),situation:"",emotions:"",automaticThought:"",distortion:"",refutation:"",reevaluation:""}),[k,S]=ie.useState({date:yt(new Date,"yyyy-MM-dd"),anxietyLevel:5,insomniaLevel:0,medications:{},meditation:{morning:0,afternoon:0,night:0},diary_note:"",symptoms:""});ie.useEffect(()=>{const R={};h.forEach(te=>{R[te]=!1}),S(te=>({...te,medications:R}))},[h]),ie.useEffect(()=>{localStorage.setItem("finanzas_journal_cbt",JSON.stringify(y))},[y]),ie.useEffect(()=>{localStorage.setItem("finanzas_journal_health_log",JSON.stringify(_))},[_]),ie.useEffect(()=>{localStorage.setItem("finanzas_journal_med_list",JSON.stringify(h))},[h]);const L=()=>{p.trim()&&(h.includes(p.trim())||(m([...h,p.trim()]),g("")))},V=R=>{confirm(`Eliminar "${R}" del catlogo?`)&&m(h.filter(te=>te!==R))},P=async R=>{const te=localStorage.getItem("gemini_api_key");if(!te)return await new Promise(ae=>setTimeout(ae,800)),` **DISTORSIN**: Posible Catastrofismo.

 **ANLISIS RACIONAL**: Los pensamientos no son hechos. Busca evidencia real.

 **NUEVA PERSPECTIVA**: Esto tambin pasar.`;l(!0);const ye=[{ver:"v1",mod:"gemini-1.5-flash"},{ver:"v1beta",mod:"gemini-1.5-flash"}];for(const ae of ye)try{const Ee=`Acta como un terapeuta cognitivo conductual experto. El usuario tuvo este pensamiento automtico: "${R}". Analzalo y devuelve SIEMPRE la respuesta con este formato exacto:

 **DISTORSIONES IDENTIFICADAS**: (Enumera las distorsiones)

 **ANLISIS RACIONAL**: (Explicacin detallada)

 **NUEVA PERSPECTIVA**: (Frase corta)`,O=await(await fetch(`https://generativelanguage.googleapis.com/${ae.ver}/models/${ae.mod}:generateContent?key=${te}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:Ee}]}]})})).json();if(O.candidates?.[0])return l(!1),O.candidates[0].content.parts[0].text}catch(Ee){console.error(Ee)}return l(!1),"No se pudo conectar con la IA. Intenta completar el desafo manualmente."},N=async R=>{R.preventDefault();let te=T.refutation;te||(te=await P(T.automaticThought));const ye={id:crypto.randomUUID(),...T,refutation:te};b([ye,...y]),u(!1),A({date:yt(new Date,"yyyy-MM-dd'T'HH:mm"),situation:"",emotions:"",automaticThought:"",distortion:"",refutation:"",reevaluation:""})},j=R=>{R.preventDefault();const te={id:crypto.randomUUID(),...k};w([te,..._]),u(!1);const ye={};h.forEach(ae=>{ye[ae]=!1}),S({date:yt(new Date,"yyyy-MM-dd"),anxietyLevel:5,insomniaLevel:0,medications:ye,meditation:{morning:0,afternoon:0,night:0},diary_note:"",symptoms:""})},I=R=>{confirm("Eliminar este registro TCC?")&&b(y.filter(te=>te.id!==R))},z=R=>{confirm("Eliminar este registro de bitcora?")&&w(_.filter(te=>te.id!==R))},X=(R,te)=>{b(y.map(ye=>ye.id===R?{...ye,reevaluation:te}:ye))},q=y.filter(R=>R.situation.toLowerCase().includes(a.toLowerCase())||R.automaticThought.toLowerCase().includes(a.toLowerCase())),Q=_.filter(R=>R.diary_note.toLowerCase().includes(a.toLowerCase())||R.symptoms.toLowerCase().includes(a.toLowerCase())),be=()=>{const te=Array.from({length:7},(ye,ae)=>{const Ee=new Date;return Ee.setDate(Ee.getDate()-ae),yt(Ee,"yyyy-MM-dd")}).reverse().map(ye=>{const ae=_.find(Ee=>Ee.date===ye);return{label:yt(or(ye),"EEE",{locale:hn}),value:ae?ae.anxietyLevel:null}});return d.jsx("div",{className:"flex items-end justify-between h-20 gap-2 px-1",children:te.map((ye,ae)=>d.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1 group",children:[d.jsx("div",{className:"w-full bg-slate-50/50 rounded-lg relative h-16 flex items-end overflow-hidden border border-slate-100/30",children:ye.value!==null&&d.jsx(va.div,{initial:{height:0},animate:{height:`${ye.value/10*100}%`},className:`w-full transition-all duration-700 rounded-t-sm shadow-sm ${ye.value>=7?"bg-rose-500":ye.value>=4?"bg-orange-400":"bg-emerald-400"}`})}),d.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-tighter",children:ye.label})]},ae))})},ve=["Pensamiento Todo o Nada","Sobregeneralizacin","Filtro Mental","Descalificar lo Positivo","Conclusin Precipitada","Magnificacin (Catastrofismo)","Razonamiento Emocional","Enunciaciones 'Debera'","Etiquetado","Personalizacin"];return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700 pb-20",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-3xl font-black text-slate-900 tracking-tight flex items-center gap-3",children:[e==="tcc"?"Registro de Pensamientos":"Bitcora de Salud"," ",d.jsx(mm,{className:"text-violet-500"})]}),d.jsx("p",{className:"text-slate-500 font-medium italic",children:"Gestin profesional de bienestar mental y salud."})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"flex p-1 bg-slate-100 rounded-2xl overflow-x-auto no-scrollbar",children:[d.jsxs("button",{onClick:()=>t("tcc"),className:`flex items-center gap-2 px-6 py-2 rounded-xl text-sm font-bold transition-all whitespace-nowrap ${e==="tcc"?"bg-white shadow-sm text-violet-600":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(wy,{size:18}),d.jsx("span",{children:"TCC"})]}),d.jsxs("button",{onClick:()=>t("log"),className:`flex items-center gap-2 px-6 py-2 rounded-xl text-sm font-bold transition-all whitespace-nowrap ${e==="log"?"bg-white shadow-sm text-emerald-600":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(n0,{size:18}),d.jsx("span",{children:"Bitcora"})]})]}),d.jsxs("button",{onClick:()=>u(!0),className:"btn-primary !p-3 flex items-center gap-2 shadow-xl shadow-blue-200",children:[d.jsx(zn,{size:20}),d.jsx("span",{className:"hidden sm:inline",children:"Nuevo Registro"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[d.jsx("div",{className:"lg:col-span-1",children:d.jsxs("div",{className:"card shadow-sm border-slate-100 bg-white",children:[d.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[d.jsx(n0,{size:12,className:"text-rose-500"})," Tendencia Ansiedad"]}),d.jsx(be,{})]})}),d.jsx("div",{className:"lg:col-span-3 flex items-end",children:d.jsxs("div",{className:"relative group w-full",children:[d.jsx(ef,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-blue-500 transition-colors",size:20}),d.jsx("input",{type:"text",placeholder:"Buscar en mis registros...",className:"input-field pl-16 py-5 bg-white border-slate-100 shadow-sm text-lg font-bold",value:a,onChange:R=>r(R.target.value)})]})})]}),d.jsx(pc,{mode:"wait",children:e==="tcc"?d.jsx(va.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"space-y-8",children:q.length===0?d.jsxs("div",{className:"py-20 text-center bg-white rounded-[3rem] border-2 border-dashed border-slate-100",children:[d.jsx(mm,{className:"mx-auto text-violet-100 mb-4",size:64}),d.jsx("p",{className:"text-slate-400 font-bold text-lg",children:"No hay registros cognitivos an."})]}):q.map(R=>d.jsxs("div",{className:"bg-white rounded-[3rem] border-none shadow-xl shadow-slate-100 overflow-hidden group",children:[d.jsxs("div",{className:"px-10 py-6 border-b border-slate-50 bg-slate-50/20 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-5",children:[d.jsx("div",{className:"w-12 h-12 bg-violet-600 text-white rounded-[1.25rem] flex items-center justify-center shadow-lg shadow-violet-200",children:d.jsx(wy,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-0.5 italic",children:yt(or(R.date),"EEEE d 'de' MMMM",{locale:hn})}),d.jsx("h4",{className:"font-black text-slate-800 text-base",children:"Reestructuracin Cognitiva"})]})]}),d.jsx("button",{onClick:()=>I(R.id),className:"p-3 text-slate-200 hover:text-rose-500 transition-colors bg-white rounded-2xl shadow-sm",children:d.jsx(jr,{size:20})})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 divide-y lg:divide-y-0 lg:divide-x divide-slate-50",children:[d.jsxs("div",{className:"p-10 space-y-8",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1 italic",children:"Situacin"}),d.jsx("p",{className:"text-sm text-slate-900 font-black",children:R.situation})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-[10px] font-black text-violet-400 uppercase tracking-widest block mb-1 italic",children:"Sentir"}),d.jsxs("p",{className:"text-xs text-slate-600 font-bold italic",children:['"',R.emotions,'"']})]})]}),d.jsxs("div",{className:"p-10 bg-rose-50/10",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d.jsx(op,{className:"text-rose-500",size:18}),d.jsx("span",{className:"text-[10px] font-black text-rose-500 uppercase tracking-widest italic",children:"Pensamiento"})]}),d.jsxs("p",{className:"text-base text-rose-950 font-black italic",children:['"',R.automaticThought,'"']}),R.distortion&&d.jsx("div",{className:"mt-4 p-3 bg-white/50 rounded-xl border border-rose-100 text-[10px] font-black text-rose-600 uppercase tracking-tighter shadow-inner",children:R.distortion})]}),d.jsxs("div",{className:"p-10 bg-indigo-50/10",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d.jsx(Sw,{className:"text-indigo-500",size:18}),d.jsx("span",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-widest italic",children:"IA Anlisis"})]}),d.jsx("p",{className:"text-xs text-indigo-900 font-bold whitespace-pre-line leading-relaxed",children:R.refutation})]}),d.jsxs("div",{className:"p-10",children:[d.jsx("span",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest block mb-4 italic",children:"Reevaluacin"}),R.reevaluation?d.jsx("div",{className:"p-6 bg-emerald-500 text-white rounded-[2rem] shadow-xl shadow-emerald-100",children:d.jsxs("p",{className:"text-sm font-black italic",children:['"',R.reevaluation,'"']})}):d.jsx("textarea",{placeholder:"Conclusin...",className:"w-full h-32 bg-slate-50 border-none rounded-2xl p-4 text-xs font-black outline-none focus:ring-4 focus:ring-emerald-100 transition-all shadow-inner",onKeyDown:te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),X(R.id,te.target.value))}})]})]})]},R.id))},"tcc-view"):d.jsx(va.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"space-y-8 w-full",children:d.jsx("div",{className:"card !p-0 overflow-hidden shadow-xl border-none bg-white rounded-[2.5rem] w-full",children:d.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{className:"bg-slate-900 text-white text-[9px] font-black uppercase tracking-widest whitespace-nowrap",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-6 border-r border-white/10 sticky left-0 bg-slate-900 z-10 min-w-[180px]",children:"Fecha"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-rose-600",children:"Ansiedad"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-rose-800",children:"Insomnio"}),h.map(R=>d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-blue-600 min-w-[120px]",children:R},R)),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-amber-500",children:"M. MAANA"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-amber-500",children:"M. TARDE"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center bg-amber-500",children:"M. NOCHE"}),d.jsx("th",{className:"px-8 py-6 font-black bg-slate-800 min-w-[300px]",children:"Registros y Sntomas"}),d.jsx("th",{className:"px-4 py-6"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 italic font-bold text-slate-800",children:Q.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:10+h.length,className:"px-8 py-20 text-center text-slate-400 italic font-bold",children:"Sin bitcora registrada."})}):Q.map(R=>d.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors text-xs whitespace-nowrap",children:[d.jsx("td",{className:"px-8 py-5 border-r border-slate-100 capitalize sticky left-0 bg-white group-hover:bg-slate-50 z-10 font-black",children:yt(or(R.date),"EEEE d MMM, yyyy",{locale:hn})}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center",children:d.jsx("span",{className:`px-2 py-1 rounded-md ${R.anxietyLevel>=7?"text-rose-600 bg-rose-50":"text-slate-400 bg-slate-50"}`,children:R.anxietyLevel})}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center",children:d.jsx("span",{className:`px-2 py-1 rounded-md ${R.insomniaLevel>=7?"text-rose-800 bg-slate-100":"text-slate-400 bg-slate-50"}`,children:R.insomniaLevel})}),h.map(te=>d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center font-black text-blue-600",children:R.medications?.[te]?"1":"-"},te)),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center bg-amber-50/20",children:R.meditation?.morning>0?`${R.meditation.morning}'`:"-"}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center bg-amber-50/20",children:R.meditation?.afternoon>0?`${R.meditation.afternoon}'`:"-"}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center bg-amber-50/20",children:R.meditation?.night>0?`${R.meditation.night}'`:"-"}),d.jsx("td",{className:"px-8 py-5 whitespace-normal min-w-[300px]",children:d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("p",{className:"italic text-slate-500 font-medium leading-relaxed",children:['"',R.diary_note||"Sin notas.",'"']}),R.symptoms&&d.jsx("p",{className:"text-rose-400 text-[10px] font-black uppercase tracking-tighter mt-1",children:R.symptoms})]})}),d.jsx("td",{className:"px-4 py-5 text-center",children:d.jsx("button",{onClick:()=>z(R.id),className:"p-2 text-slate-200 hover:text-rose-500 transition-colors bg-white rounded-xl shadow-sm border border-slate-50",children:d.jsx(jr,{size:16})})})]},R.id))})]})})})},"log-view")}),d.jsx(pc,{children:c&&d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx(va.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-slate-900/80 backdrop-blur-xl",onClick:()=>u(!1)}),d.jsxs(va.div,{initial:{opacity:0,scale:.95,y:40},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:40},className:"relative bg-white rounded-[4rem] shadow-2xl w-full max-w-6xl overflow-hidden max-h-[90vh] flex flex-col",children:[d.jsxs("div",{className:"px-12 py-8 border-b border-slate-50 flex items-center justify-between shrink-0 bg-slate-50/50",children:[d.jsxs("div",{className:"flex gap-4 p-2 bg-slate-200/50 rounded-[2rem]",children:[d.jsx("button",{onClick:()=>t("tcc"),className:`px-10 py-3 rounded-[1.5rem] text-sm font-black transition-all ${e==="tcc"?"bg-white shadow-lg text-violet-600":"text-slate-500"}`,children:"Desafo TCC"}),d.jsx("button",{onClick:()=>t("log"),className:`px-10 py-3 rounded-[1.5rem] text-sm font-black transition-all ${e==="log"?"bg-white shadow-lg text-emerald-600":"text-slate-500"}`,children:"Bitcora Mdica"})]}),d.jsx("button",{onClick:()=>u(!1),className:"p-4 text-slate-400 hover:bg-white rounded-full transition-all shadow-sm",children:d.jsx(Qr,{size:32})})]}),d.jsx("div",{className:"p-12 overflow-y-auto custom-scrollbar flex-1 bg-white",children:e==="tcc"?d.jsxs("form",{onSubmit:N,className:"space-y-12",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[d.jsxs("div",{className:"space-y-10",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Situacin"}),d.jsx("input",{type:"text",required:!0,placeholder:"Ej: Mi jefe me pidi una reunin a ltima hora sin decir el motivo...",className:"input-field !bg-slate-50 !border-none !font-black !py-6 !px-8 !rounded-[2.5rem] !text-base shadow-inner",value:T.situation,onChange:R=>A({...T,situation:R.target.value})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-violet-500 uppercase px-2 italic",children:"Afectacin Emocional"}),d.jsx("textarea",{required:!0,placeholder:"Ej: Ansiedad (9/10), taquicardia y mucha presin en el pecho...",className:"input-field !bg-violet-50/30 !border-none !min-h-[160px] !font-black !py-8 !px-10 !rounded-[3rem] shadow-inner",value:T.emotions,onChange:R=>A({...T,emotions:R.target.value})})]})]}),d.jsxs("div",{className:"space-y-10",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-rose-500 uppercase px-2 italic",children:"Pensamiento Negativo"}),d.jsx("textarea",{required:!0,placeholder:"Ej: Seguro me van a despedir por el error del martes, soy un fracaso...",className:"input-field !bg-rose-50/30 !border-none !min-h-[160px] !font-black !py-8 !px-10 !rounded-[3rem] italic shadow-inner",value:T.automaticThought,onChange:R=>A({...T,automaticThought:R.target.value})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Distorsin"}),d.jsxs("select",{className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-8 !rounded-[2rem] shadow-inner",value:T.distortion,onChange:R=>A({...T,distortion:R.target.value}),children:[d.jsx("option",{value:"",children:"Cul detectas?"}),ve.map(R=>d.jsx("option",{value:R,children:R},R))]})]})]})]}),d.jsx("button",{type:"submit",disabled:s,className:"w-full bg-violet-600 text-white font-black py-8 rounded-[3rem] shadow-2xl transition-all text-2xl flex items-center justify-center gap-4",children:s?d.jsx(cp,{className:"animate-spin"}):"Guardar y Analizar"})]}):d.jsxs("form",{onSubmit:j,className:"space-y-12",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-10",children:[d.jsxs("div",{className:"card shadow-lg border-none bg-rose-50/10 p-10 space-y-10 lg:col-span-1 rounded-[3rem]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(n0,{className:"text-rose-600",size:24}),d.jsx("h4",{className:"font-black text-base uppercase tracking-widest text-rose-900 italic",children:"Escala Salud"})]}),d.jsxs("div",{className:"space-y-10",children:[d.jsxs("div",{className:"space-y-4",children:[" ",d.jsx("label",{className:"text-xs font-black text-rose-600 uppercase block italic",children:"Ansiedad"})," ",d.jsx("input",{type:"range",min:"0",max:"10",className:"w-full h-3 bg-rose-200 rounded-lg appearance-none cursor-pointer accent-rose-600",value:k.anxietyLevel,onChange:R=>S({...k,anxietyLevel:parseInt(R.target.value)})}),d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("span",{className:"text-rose-600 text-5xl font-black",children:k.anxietyLevel})})," "]}),d.jsxs("div",{className:"space-y-4",children:[" ",d.jsx("label",{className:"text-xs font-black text-slate-700 uppercase block italic",children:"Insomnio"})," ",d.jsx("input",{type:"range",min:"0",max:"10",className:"w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-slate-800",value:k.insomniaLevel,onChange:R=>S({...k,insomniaLevel:parseInt(R.target.value)})}),d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("span",{className:"text-slate-900 text-5xl font-black",children:k.insomniaLevel})})," "]})]})]}),d.jsxs("div",{className:"card shadow-lg border-none bg-blue-50/10 p-10 space-y-8 lg:col-span-2 rounded-[3rem]",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Tw,{className:"text-blue-600",size:24}),d.jsx("h4",{className:"font-black text-base uppercase tracking-widest text-blue-900 italic",children:"Farmacologa"})]}),d.jsxs("div",{className:"flex items-center gap-2 bg-white/80 p-1 rounded-2xl shadow-sm border border-blue-50 focus-within:ring-2 focus-within:ring-blue-500 transition-all",children:[d.jsx("input",{type:"text",placeholder:"Nuevo medica...",className:"bg-transparent border-none text-[10px] font-bold px-3 py-2 outline-none w-24",value:p,onChange:R=>g(R.target.value),onKeyDown:R=>R.key==="Enter"&&(R.preventDefault(),L())}),d.jsx("button",{type:"button",onClick:L,className:"p-2 bg-blue-600 text-white rounded-xl hover:bg-slate-900 transition-colors",children:d.jsx(zn,{size:14})})]})]}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 max-h-[300px] overflow-y-auto no-scrollbar pr-2",children:h.map(R=>d.jsxs("div",{className:"relative group",children:[d.jsx("button",{type:"button",onClick:()=>S({...k,medications:{...k.medications,[R]:!k.medications[R]}}),className:`w-full py-5 rounded-[1.5rem] text-[10px] font-black uppercase transition-all border-4 ${k.medications[R]?"bg-blue-600 text-white border-blue-600 shadow-xl":"bg-white text-blue-200 border-slate-50"}`,children:R}),d.jsx("button",{type:"button",onClick:()=>V(R),className:"absolute -top-2 -right-2 p-1 bg-white shadow-md text-rose-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-rose-50 border border-slate-50",children:d.jsx(Qr,{size:10})})]},R))})]}),d.jsxs("div",{className:"card shadow-lg border-none bg-amber-50/10 p-10 space-y-10 lg:col-span-1 rounded-[3rem]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(vN,{className:"text-amber-600",size:24}),d.jsx("h4",{className:"font-black text-base uppercase tracking-widest text-amber-900 italic",children:"Mente (min)"})]}),d.jsx("div",{className:"space-y-6",children:["morning","afternoon","night"].map(R=>d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex justify-between items-center px-2",children:[d.jsx("span",{className:"text-[9px] font-black uppercase text-amber-700 italic",children:R==="morning"?"Maana":R==="afternoon"?"Tarde":"Noche"}),d.jsx(nN,{size:12,className:"text-amber-400"})]}),d.jsx("input",{type:"number",min:"0",placeholder:"0 min",className:"w-full bg-white border-4 border-slate-50 rounded-[1.5rem] py-4 px-6 text-sm font-black text-amber-900 outline-none focus:border-amber-400 transition-all shadow-inner",value:k.meditation[R]||"",onChange:te=>S({...k,meditation:{...k.meditation,[R]:parseInt(te.target.value)||0}})})]},R))})]}),d.jsxs("div",{className:"lg:col-span-4 grid grid-cols-1 md:grid-cols-2 gap-10 bg-slate-50 p-10 rounded-[4rem]",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 p-1",children:[d.jsx(BA,{size:20,className:"text-slate-400"}),d.jsx("span",{className:"text-[10px] font-black uppercase italic",children:"Notas del Da"})]}),d.jsx("textarea",{placeholder:"Anotaciones diarias o resumen emocional...",className:"input-field !bg-white !shadow-none !rounded-[2rem] !min-h-[180px] !py-6 font-medium",value:k.diary_note,onChange:R=>S({...k,diary_note:R.target.value})})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 p-1",children:[d.jsx(n0,{size:20,className:"text-rose-400"}),d.jsx("span",{className:"text-[10px] font-black uppercase italic",children:"Sintomatologa Fsica"})]}),d.jsx("textarea",{placeholder:"Sntomas detectados hoy (ej: taquicardia, mareos)...",className:"input-field !bg-white border-rose-100 !shadow-none !rounded-[2rem] !min-h-[180px] !py-6 text-rose-600 font-black italic",value:k.symptoms,onChange:R=>S({...k,symptoms:R.target.value})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[d.jsxs("div",{className:"flex items-center gap-4 bg-slate-900 p-6 rounded-[3rem] text-white",children:[d.jsx(lc,{className:"text-slate-500",size:24}),d.jsx("input",{type:"date",className:"bg-transparent font-black text-xl outline-none w-full cursor-pointer invert",value:k.date,onChange:R=>S({...k,date:R.target.value})})]}),d.jsx("button",{type:"submit",className:"w-full bg-emerald-600 text-white py-8 text-2xl font-black rounded-[4rem] shadow-2xl hover:scale-[1.02] transition-all duration-700",children:"Guardar Registro Mdico"})]})]})})]})]})})]})},GU=()=>{const[e,t]=ie.useState(()=>{const w=localStorage.getItem("finanzas_accounts");return w?JSON.parse(w):[]}),[a,r]=ie.useState(()=>{const w=localStorage.getItem("finanzas_transactions");return w?JSON.parse(w):[]}),[s,l]=ie.useState(null),[c,u]=ie.useState(!1),[h,m]=ie.useState({amount:"",date:yt(new Date,"yyyy-MM-dd"),note:"Pago realizado"});ie.useEffect(()=>{const w=()=>{t(JSON.parse(localStorage.getItem("finanzas_accounts")||"[]")),r(JSON.parse(localStorage.getItem("finanzas_transactions")||"[]"))};return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[]);const p=e.filter(w=>w.type==="Prstamo"||w.loanDetails),g=w=>{if(!w.loanDetails)return[];const{loanAmount:T,interestRate:A,term:k,firstPaymentDate:S,insurance:L}=w.loanDetails,V=A/100/12,P=V===0?T/k:T*V*Math.pow(1+V,k)/(Math.pow(1+V,k)-1);let N=T;const j=[];let I=or(S);for(let z=1;z<=k;z++){const X=N*V,q=P-X;N-=q,j.push({installment:z,date:yt(Nw(I,z-1),"yyyy-MM-dd"),payment:P+(L||0),principal:q,interest:X,insurance:L||0,remainingBalance:Math.max(0,N),isPaid:(w.paidInstallments||[]).includes(z)})}return j},y=(w,T)=>{const A=e.map(k=>{if(k.id===w){const S=k.paidInstallments||[],L=S.includes(T)?S.filter(V=>V!==T):[...S,T];return{...k,paidInstallments:L}}return k});t(A),localStorage.setItem("finanzas_accounts",JSON.stringify(A))},b=w=>{w.preventDefault();const T=parseFloat(h.amount);if(isNaN(T)||T<=0)return;const A=e.map(k=>{if(k.id===s){const S=k.manualPayments||[],L={id:crypto.randomUUID(),...h,amount:T};return{...k,manualPayments:[...S,L],balance:Math.max(0,k.balance-T)}}return k});t(A),localStorage.setItem("finanzas_accounts",JSON.stringify(A)),u(!1),m({amount:"",date:yt(new Date,"yyyy-MM-dd"),note:"Pago realizado"})},_=(w,T)=>{if(!window.confirm("Eliminar este registro de pago manual?"))return;const A=e.map(k=>{if(k.id===w){const S=k.manualPayments.find(L=>L.id===T);return{...k,manualPayments:k.manualPayments.filter(L=>L.id!==T),balance:k.balance+(S?S.amount:0)}}return k});t(A),localStorage.setItem("finanzas_accounts",JSON.stringify(A))};if(s){const w=p.find(j=>j.id===s);if(!w)return l(null),null;const T=g(w),A=a.filter(j=>j.accountId===w.id),k=w.manualPayments||[],S=A.filter(j=>j.type==="income").reduce((j,I)=>j+I.amount,0),L=k.reduce((j,I)=>j+I.amount,0),V=T.reduce((j,I)=>j+I.payment,0),P=Math.max(0,V-S-L),N=w.balance;return d.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>l(null),className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500",children:d.jsx(H4,{size:24})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:w.name}),d.jsxs("p",{className:"text-slate-500 font-medium capitalize",children:[w.type,"  Tasa: ",w.loanDetails.interestRate,"%  ",w.loanDetails.term," cuotas"]})]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs("button",{onClick:()=>u(!0),className:"btn-secondary flex items-center gap-2",children:[d.jsx(zn,{size:18}),d.jsx("span",{children:"Registrar Pago Manual"})]}),d.jsxs("div",{className:"px-4 py-2 bg-white border border-slate-200 rounded-xl shadow-sm",children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Saldo Actual"}),d.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["$",N.toLocaleString("es-MX")]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"card bg-slate-900 text-white border-none shadow-xl shadow-slate-200",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:d.jsx(oc,{size:20,className:"text-emerald-400"})}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Capital Pendiente"})]}),d.jsxs("h3",{className:"text-3xl font-bold mb-1",children:["$",N.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsx("p",{className:"text-slate-400 text-xs font-medium",children:"Saldo para liquidar hoy"})]}),d.jsxs("div",{className:"card border-slate-200 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:d.jsx(S0,{size:20,className:"text-blue-600"})}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Total proyectado"})]}),d.jsxs("h3",{className:"text-3xl font-bold text-slate-900 mb-1",children:["$",P.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsx("p",{className:"text-slate-400 text-xs font-medium",children:"Capital + Intereses futuros"})]}),d.jsxs("div",{className:"card border-slate-200 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg",children:d.jsx(xm,{size:20,className:"text-emerald-600"})}),d.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Abonos Realizados"})]}),d.jsxs("h3",{className:"text-3xl font-bold text-slate-900 mb-1",children:["$",(S+L).toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsx("p",{className:"text-slate-400 text-xs font-medium",children:"Incluye pagos manuales"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[d.jsx("div",{className:"lg:col-span-2 space-y-6",children:d.jsxs("div",{className:"card !p-0 overflow-hidden shadow-md border-slate-200/60",children:[d.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between",children:[d.jsxs("h4",{className:"font-bold text-slate-900 flex items-center gap-2",children:[d.jsx(lc,{size:18,className:"text-slate-400"})," Plan de Pagos"]}),d.jsx("div",{className:"px-2.5 py-1 bg-blue-50 text-blue-700 text-[10px] font-bold rounded-lg uppercase tracking-wider",children:"Sistema Francs"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50/30",children:[d.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Cuota"}),d.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Fecha"}),d.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-right",children:"Monto"}),d.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center",children:"Check"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:T.map(j=>d.jsxs("tr",{className:`hover:bg-slate-50/50 transition-colors ${j.isPaid?"bg-emerald-50/30":""}`,children:[d.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-slate-400",children:["#",j.installment]}),d.jsx("td",{className:"px-6 py-4 text-sm font-semibold text-slate-700",children:j.date}),d.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-slate-900 text-right",children:["$",j.payment.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsx("td",{className:"px-6 py-4 text-center",children:d.jsx("button",{onClick:()=>y(w.id,j.installment),className:`p-1.5 rounded-lg transition-all ${j.isPaid?"text-emerald-600 bg-emerald-100":"text-slate-300 hover:text-slate-400 hover:bg-slate-100"}`,children:j.isPaid?d.jsx(xm,{size:18}):d.jsx(mA,{size:18})})})]},j.installment))})]})})]})}),d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"card shadow-sm border-slate-200/60",children:[d.jsxs("h4",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[d.jsx(Z0,{size:18,className:"text-slate-400"})," Historial de Abonos"]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Desde Movimientos"}),A.length===0?d.jsx("p",{className:"text-xs text-slate-400 italic px-2",children:"Sin movimientos vinculados."}):A.map(j=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-900 truncate max-w-[120px]",children:j.note||"Abono"}),d.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:j.date})]}),d.jsxs("p",{className:"text-sm font-bold text-emerald-600",children:["+$",j.amount.toLocaleString("es-MX")]})]},j.id))]}),d.jsxs("div",{className:"space-y-3 pt-2",children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Pagos Manuales (Control)"}),k.length===0?d.jsx("p",{className:"text-xs text-slate-400 italic px-2",children:"Sin pagos manuales."}):k.map(j=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50/30 rounded-xl border border-blue-100 group relative",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-blue-900 truncate max-w-[120px]",children:j.note}),d.jsx("p",{className:"text-[10px] text-blue-500 font-medium",children:j.date})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("p",{className:"text-sm font-bold text-blue-600",children:["$",j.amount.toLocaleString("es-MX")]}),d.jsx("button",{onClick:()=>_(w.id,j.id),className:"p-1.5 text-slate-300 hover:text-rose-600 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(jr,{size:14})})]})]},j.id))]})]}),d.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-100",children:[d.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1",children:"Nota"}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed italic",children:"Los pagos manuales solo afectan el saldo de este prstamo y no se registran en tus otras cuentas de banco/efectivo."})]})]})})]}),c&&d.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>u(!1)}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-300 border border-slate-200",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 bg-slate-50/50",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Registrar Pago Manual"}),d.jsx("p",{className:"text-xs text-slate-500 font-medium mt-1",children:"Este pago solo afecta el control de este prstamo."})]}),d.jsxs("form",{onSubmit:b,className:"p-8 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Fecha"}),d.jsx("input",{type:"date",required:!0,className:"input-field",value:h.date,onChange:j=>m({...h,date:j.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Monto ($)"}),d.jsx("input",{type:"number",step:"0.01",required:!0,placeholder:"0.00",className:"input-field",value:h.amount,onChange:j=>m({...h,amount:j.target.value})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Descripcin / Nota"}),d.jsx("input",{type:"text",placeholder:"Ej. Pago histrico, abono extra...",className:"input-field",value:h.note,onChange:j=>m({...h,note:j.target.value})})]}),d.jsxs("div",{className:"flex gap-4 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 py-3 font-bold text-slate-500 hover:bg-slate-50 rounded-xl transition-all",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"flex-1 btn-primary !py-3",children:"Guardar Pago"})]})]})]})]})]})}return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[d.jsxs("header",{children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Mdulo de Deudas"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Controla tus prstamos y planes de pago."})]}),p.length===0?d.jsxs("div",{className:"card py-20 text-center border-dashed border-2 flex flex-col items-center",children:[d.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mb-6 text-slate-300",children:d.jsx(S0,{size:40})}),d.jsx("p",{className:"text-slate-500 font-bold text-lg",children:"No tienes deudas registradas."}),d.jsx("p",{className:"text-slate-400 max-w-sm mt-2",children:'Crea una cuenta de tipo "Prstamo" en el mdulo de Cuentas para comenzar.'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(w=>{const A=g(w).find(S=>!S.isPaid),k=(w.paidInstallments?.length||0)/w.loanDetails.term;return d.jsxs("div",{onClick:()=>l(w.id),className:"card group cursor-pointer hover:border-blue-300 shadow-sm hover:shadow-xl transition-all duration-300 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:w.color}}),d.jsxs("div",{className:"flex justify-between items-start mb-6",children:[d.jsx("div",{className:"p-3 bg-slate-50 rounded-xl text-slate-600 group-hover:bg-blue-50 group-hover:text-blue-600 transition-colors",children:d.jsx(S0,{size:24})}),d.jsx("div",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold tracking-wider uppercase ${k===1?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:k===1?"Liquidado":"Activo"})]}),d.jsx("h4",{className:"font-bold text-slate-900 text-xl mb-1",children:w.name}),d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-xs font-bold uppercase tracking-widest mb-6",children:[d.jsx(lc,{size:12})," Prximo pago: ",A?A.date:"Finalizado"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Saldo de Capital"}),d.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:["$",w.balance.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),d.jsxs("div",{className:"pt-2",children:[d.jsxs("div",{className:"flex justify-between items-end mb-1.5",children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Progreso"}),d.jsxs("p",{className:"text-xs font-bold text-slate-600",children:[(k*100).toFixed(0),"%"]})]}),d.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full overflow-hidden",children:d.jsx("div",{className:"bg-blue-600 h-full transition-all duration-700",style:{width:`${k*100}%`}})})]})]})]},w.id)})})]})},qU=300*1e3,mE=new Map,WU={BTC:"bitcoin",ETH:"ethereum",USDT:"tether",BNB:"binancecoin",XRP:"ripple",ADA:"cardano",DOGE:"dogecoin",SOL:"solana",DOT:"polkadot",MATIC:"polygon"},pE=e=>{const t=mE.get(e);return t&&Date.now()-t.timestamp<qU?t.price:null},wx=(e,t)=>{mE.set(e,{price:t,timestamp:Date.now()})},YU=async e=>{const t=e.toUpperCase(),a=pE(`CRYPTO_${t}`);if(a!==null)return a;try{const r=WU[t]||e.toLowerCase(),s=await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${r}&vs_currencies=usd`,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error("CoinGecko API error");const c=(await s.json())[r]?.usd;if(!c)throw new Error("Price not found");return wx(`CRYPTO_${t}`,c),c}catch(r){throw console.error(`Error fetching crypto price for ${e}:`,r),r}},XU=async(e,t)=>{const a=e.toUpperCase(),r=pE(`STOCK_${a}`);if(r!==null)return r;if(!t)throw new Error("Finnhub API key required for stock prices");try{const s=await fetch(`https://finnhub.io/api/v1/quote?symbol=${a}&token=${t}`,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error("Finnhub API error");const c=(await s.json()).c;if(!c||c===0)throw new Error("Invalid price data");return wx(`STOCK_${a}`,c),c}catch(s){throw console.error(`Error fetching stock price for ${e}:`,s),s}},KU=async(e,t)=>{const a=e.toUpperCase();try{const r=await fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${a}&apikey=${t}`,{headers:{Accept:"application/json"}});if(!r.ok)throw new Error("Alpha Vantage API error");const s=await r.json(),l=parseFloat(s["Global Quote"]?.["05. price"]);if(!l)throw new Error("Invalid price data");return wx(`STOCK_${a}`,l),l}catch(r){throw console.error(`Error fetching from Alpha Vantage for ${e}:`,r),r}},xE=async(e,t={})=>{const{assetType:a,symbol:r}=e;try{if(a==="crypto")return await YU(r);if(a==="stock"||a==="etf")if(t.finnhub)try{return await XU(r,t.finnhub)}catch(s){if(t.alphaVantage)return await KU(r,t.alphaVantage);throw s}else throw new Error("No API key configured for stocks");else throw new Error("Unsupported asset type")}catch(s){return console.error(`Failed to fetch price for ${r}:`,s),null}},JU=async(e,t={},a)=>{const r=[];for(let l=0;l<e.length;l++){const c=e[l];try{const u=await xE(c,t);r.push({id:c.id,success:!0,price:u,timestamp:Date.now()})}catch(u){r.push({id:c.id,success:!1,error:u.message})}a&&a((l+1)/e.length),l<e.length-1&&await new Promise(u=>setTimeout(u,100))}return r},ys=(e,t,a=1)=>!e||!t?0:(t-e)/e*100,dm=(e,t,a)=>!e||!t||!a?0:(t-e)*a,yw=e=>{if(!e)return"stale";const t=(Date.now()-e)/(1e3*60);return t<5?"fresh":t<60?"moderate":"stale"},QU=()=>{const[e,t]=ie.useState(()=>{const z=localStorage.getItem("finanzas_investments");return z?JSON.parse(z):[]}),[a,r]=ie.useState(()=>{const z=localStorage.getItem("finanzas_brokers");return z?JSON.parse(z):["GBM","Bitso","Interactive Brokers","Binance"]}),[s,l]=ie.useState(()=>{const z=localStorage.getItem("finanzas_api_keys");return z?JSON.parse(z):{finnhub:"",alphaVantage:""}}),[c,u]=ie.useState(!1),[h,m]=ie.useState(!1),[p,g]=ie.useState(!1),[y,b]=ie.useState(0),[_,w]=ie.useState(""),[T,A]=ie.useState({field:"roi",direction:"desc"}),[k,S]=ie.useState({broker:"",assetType:"stock",symbol:"",name:"",quantity:"",buyPrice:"",buyCurrency:"USD",buyDate:yt(new Date,"yyyy-MM-dd")});ie.useEffect(()=>{localStorage.setItem("finanzas_investments",JSON.stringify(e))},[e]),ie.useEffect(()=>{localStorage.setItem("finanzas_brokers",JSON.stringify(a))},[a]),ie.useEffect(()=>{localStorage.setItem("finanzas_api_keys",JSON.stringify(s))},[s]),ie.useEffect(()=>{e.some(X=>yw(X.lastUpdate)==="stale")&&e.length>0&&V()},[]);const L=async z=>{z.preventDefault();const X={id:crypto.randomUUID(),...k,quantity:parseFloat(k.quantity),buyPrice:parseFloat(k.buyPrice),currentPrice:parseFloat(k.buyPrice),lastUpdate:Date.now()};try{const q=await xE(X,s);q&&(X.currentPrice=q,X.lastUpdate=Date.now())}catch(q){console.warn("Could not fetch initial price:",q)}t([X,...e]),u(!1),S({broker:"",assetType:"stock",symbol:"",name:"",quantity:"",buyPrice:"",buyCurrency:"USD",buyDate:yt(new Date,"yyyy-MM-dd")})},V=async()=>{if(e.length===0)return;g(!0),b(0);const z=await JU(e,s,q=>b(q*100)),X=e.map(q=>{const Q=z.find(be=>be.id===q.id);return Q&&Q.success&&Q.price?{...q,currentPrice:Q.price,lastUpdate:Q.timestamp}:q});t(X),g(!1),b(0)},P=z=>{confirm("Eliminar esta inversin?")&&t(e.filter(X=>X.id!==z))},N=ie.useMemo(()=>{if(e.length===0)return{totalValue:0,totalCost:0,totalPL:0,totalROI:0,best:null,worst:null};let z=0,X=0,q=e[0],Q=e[0];e.forEach(R=>{const te=R.buyPrice*R.quantity,ye=R.currentPrice*R.quantity;X+=te,z+=ye;const ae=ys(R.buyPrice,R.currentPrice),Ee=ys(q.buyPrice,q.currentPrice),G=ys(Q.buyPrice,Q.currentPrice);ae>Ee&&(q=R),ae<G&&(Q=R)});const be=z-X,ve=X>0?be/X*100:0;return{totalValue:z,totalCost:X,totalPL:be,totalROI:ve,best:q,worst:Q}},[e]);ie.useMemo(()=>{const z={};return e.forEach(X=>{const q=X.currentPrice*X.quantity;z[X.assetType]=(z[X.assetType]||0)+q}),Object.entries(z).map(([X,q])=>({type:X,value:q,percentage:q/N.totalValue*100}))},[e,N.totalValue]);const j=ie.useMemo(()=>{let z=e.filter(X=>X.symbol.toLowerCase().includes(_.toLowerCase())||X.name.toLowerCase().includes(_.toLowerCase())||X.broker.toLowerCase().includes(_.toLowerCase()));return z.sort((X,q)=>{let Q,be;switch(T.field){case"roi":Q=ys(X.buyPrice,X.currentPrice),be=ys(q.buyPrice,q.currentPrice);break;case"pl":Q=dm(X.buyPrice,X.currentPrice,X.quantity),be=dm(q.buyPrice,q.currentPrice,q.quantity);break;case"value":Q=X.currentPrice*X.quantity,be=q.currentPrice*q.quantity;break;default:return 0}return T.direction==="asc"?Q-be:be-Q}),z},[e,_,T]),I=[{value:"stock",label:"Accin",icon:""},{value:"crypto",label:"Criptomoneda",icon:""},{value:"etf",label:"ETF",icon:""},{value:"bond",label:"Bono",icon:""},{value:"other",label:"Otro",icon:""}];return d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700 pb-20",children:[d.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-3xl font-black text-slate-900 tracking-tight flex items-center gap-3",children:["Portafolio de Inversiones ",d.jsx(fn,{className:"text-emerald-500"})]}),d.jsx("p",{className:"text-slate-500 font-medium italic",children:"Control total de tus inversiones con datos en tiempo real."})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("button",{onClick:V,disabled:p||e.length===0,className:"btn-secondary flex items-center gap-2",children:[d.jsx(cp,{className:p?"animate-spin":"",size:20}),d.jsx("span",{className:"hidden sm:inline",children:p?`${Math.round(y)}%`:"Actualizar Precios"})]}),d.jsx("button",{onClick:()=>m(!0),className:"btn-secondary !p-3",children:d.jsx(up,{size:20})}),d.jsxs("button",{onClick:()=>u(!0),className:"btn-primary flex items-center gap-2 shadow-xl shadow-blue-200",children:[d.jsx(zn,{size:20}),d.jsx("span",{className:"hidden sm:inline",children:"Nueva Inversin"})]})]})]}),e.length>0&&d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[d.jsxs(va.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card bg-gradient-to-br from-violet-500 to-purple-600 text-white shadow-2xl border-none",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx(aN,{size:32,className:"opacity-80"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-80",children:"ROI Total"})]}),d.jsxs("div",{className:"flex items-baseline gap-2",children:[d.jsxs("span",{className:"text-5xl font-black",children:[N.totalROI>=0?"+":"",N.totalROI.toFixed(2),"%"]}),N.totalROI>=0?d.jsx(fn,{size:24}):d.jsx(oc,{size:24})]})]}),d.jsxs(va.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:`card shadow-2xl border-none ${N.totalPL>=0?"bg-gradient-to-br from-emerald-500 to-green-600":"bg-gradient-to-br from-rose-500 to-red-600"} text-white`,children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx(_w,{size:32,className:"opacity-80"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-80",children:"Ganancia/Prdida"})]}),d.jsx("div",{className:"flex items-baseline gap-2",children:d.jsxs("span",{className:"text-4xl font-black",children:["$",N.totalPL>=0?"+":"",N.totalPL.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),d.jsxs("p",{className:"text-xs opacity-80 mt-2",children:["Valor: $",N.totalValue.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),N.best&&d.jsxs(va.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card bg-white shadow-xl border-2 border-emerald-100",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx(Y4,{size:24,className:"text-emerald-600"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-600",children:"Mejor"})]}),d.jsx("h4",{className:"font-black text-slate-900 text-lg mb-1",children:N.best.symbol}),d.jsxs("p",{className:"text-2xl font-black text-emerald-600",children:["+",ys(N.best.buyPrice,N.best.currentPrice).toFixed(2),"%"]}),d.jsx("p",{className:"text-xs text-slate-500 mt-2 italic",children:N.best.name||N.best.broker})]}),N.worst&&d.jsxs(va.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card bg-white shadow-xl border-2 border-rose-100",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx(op,{size:24,className:"text-rose-600"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-rose-600",children:"Peor"})]}),d.jsx("h4",{className:"font-black text-slate-900 text-lg mb-1",children:N.worst.symbol}),d.jsxs("p",{className:"text-2xl font-black text-rose-600",children:[ys(N.worst.buyPrice,N.worst.currentPrice).toFixed(2),"%"]}),d.jsx("p",{className:"text-xs text-slate-500 mt-2 italic",children:N.worst.name||N.worst.broker})]})]}),e.length>0&&d.jsxs("div",{className:"relative group",children:[d.jsx(ef,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-blue-500 transition-colors",size:20}),d.jsx("input",{type:"text",placeholder:"Buscar por smbolo, nombre o broker...",className:"input-field pl-16 py-5 bg-white border-slate-100 shadow-sm text-lg font-bold",value:_,onChange:z=>w(z.target.value)})]}),j.length>0?d.jsx("div",{className:"card !p-0 overflow-hidden shadow-xl border-none bg-white rounded-[2.5rem]",children:d.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{className:"bg-slate-900 text-white text-[9px] font-black uppercase tracking-widest whitespace-nowrap",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-6 border-r border-white/10",children:"Broker"}),d.jsx("th",{className:"px-8 py-6 border-r border-white/10",children:"Tipo"}),d.jsx("th",{className:"px-8 py-6 border-r border-white/10",children:"Activo"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-right",children:"Cantidad"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-right",children:"Precio Compra"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-right",children:"Precio Actual"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-right cursor-pointer hover:bg-white/10",onClick:()=>A({field:"pl",direction:T.field==="pl"&&T.direction==="desc"?"asc":"desc"}),children:"P&L"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-right cursor-pointer hover:bg-white/10",onClick:()=>A({field:"roi",direction:T.field==="roi"&&T.direction==="desc"?"asc":"desc"}),children:"ROI"}),d.jsx("th",{className:"px-6 py-6 border-r border-white/10 text-center",children:"Estado"}),d.jsx("th",{className:"px-4 py-6"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:j.map(z=>{const X=ys(z.buyPrice,z.currentPrice),q=dm(z.buyPrice,z.currentPrice,z.quantity),Q=yw(z.lastUpdate);return d.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors text-xs font-bold text-slate-800",children:[d.jsx("td",{className:"px-8 py-5 border-r border-slate-100",children:d.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-[10px] font-black",children:z.broker})}),d.jsxs("td",{className:"px-8 py-5 border-r border-slate-100 capitalize",children:[I.find(be=>be.value===z.assetType)?.icon," ",I.find(be=>be.value===z.assetType)?.label]}),d.jsx("td",{className:"px-8 py-5 border-r border-slate-100",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-black text-lg",children:z.symbol}),z.name&&d.jsx("p",{className:"text-[10px] text-slate-400 italic",children:z.name})]})}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-right font-mono",children:z.quantity.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:8})}),d.jsxs("td",{className:"px-6 py-5 border-r border-slate-100 text-right font-mono",children:["$",z.buyPrice.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsxs("td",{className:"px-6 py-5 border-r border-slate-100 text-right font-mono",children:["$",z.currentPrice.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsxs("td",{className:`px-6 py-5 border-r border-slate-100 text-right font-mono font-black ${q>=0?"text-emerald-600":"text-rose-600"}`,children:["$",q>=0?"+":"",q.toLocaleString("es-MX",{minimumFractionDigits:2})]}),d.jsxs("td",{className:`px-6 py-5 border-r border-slate-100 text-right font-mono font-black text-lg ${X>=0?"text-emerald-600":"text-rose-600"}`,children:[X>=0?"+":"",X.toFixed(2),"%"]}),d.jsx("td",{className:"px-6 py-5 border-r border-slate-100 text-center",children:d.jsx("div",{className:`inline-block w-3 h-3 rounded-full ${Q==="fresh"?"bg-emerald-500":Q==="moderate"?"bg-amber-500":"bg-slate-300"}`,title:Q==="fresh"?"Actualizado":Q==="moderate"?"Algo antiguo":"Desactualizado"})}),d.jsx("td",{className:"px-4 py-5 text-center",children:d.jsx("button",{onClick:()=>P(z.id),className:"p-2 text-slate-200 hover:text-rose-500 transition-colors bg-white rounded-xl shadow-sm border border-slate-50",children:d.jsx(jr,{size:16})})})]},z.id)})})]})})}):d.jsxs("div",{className:"py-20 text-center bg-white rounded-[3rem] border-2 border-dashed border-slate-100",children:[d.jsx(fn,{className:"mx-auto text-slate-100 mb-4",size:64}),d.jsx("p",{className:"text-slate-400 font-bold text-lg",children:e.length===0?"No hay inversiones registradas an.":"No se encontraron resultados."})]}),d.jsx(pc,{children:c&&d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx(va.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-slate-900/80 backdrop-blur-xl",onClick:()=>u(!1)}),d.jsxs(va.div,{initial:{opacity:0,scale:.95,y:40},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:40},className:"relative bg-white rounded-[4rem] shadow-2xl w-full max-w-3xl overflow-hidden max-h-[90vh] flex flex-col",children:[d.jsxs("div",{className:"px-12 py-8 border-b border-slate-50 flex items-center justify-between shrink-0 bg-slate-50/50",children:[d.jsx("h3",{className:"text-2xl font-black text-slate-900",children:"Nueva Inversin"}),d.jsx("button",{onClick:()=>u(!1),className:"p-4 text-slate-400 hover:bg-white rounded-full transition-all shadow-sm",children:d.jsx(Qr,{size:32})})]}),d.jsxs("form",{onSubmit:L,className:"p-12 overflow-y-auto custom-scrollbar flex-1 space-y-8",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Broker"}),d.jsxs("select",{required:!0,className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.broker,onChange:z=>S({...k,broker:z.target.value}),children:[d.jsx("option",{value:"",children:"Selecciona broker..."}),a.map(z=>d.jsx("option",{value:z,children:z},z))]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Tipo de Activo"}),d.jsx("select",{required:!0,className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.assetType,onChange:z=>S({...k,assetType:z.target.value}),children:I.map(z=>d.jsxs("option",{value:z.value,children:[z.icon," ",z.label]},z.value))})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Smbolo"}),d.jsx("input",{type:"text",required:!0,placeholder:"Ej: AAPL, BTC, TSLA",className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem] uppercase",value:k.symbol,onChange:z=>S({...k,symbol:z.target.value.toUpperCase()})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Nombre (Opcional)"}),d.jsx("input",{type:"text",placeholder:"Ej: Apple Inc.",className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.name,onChange:z=>S({...k,name:z.target.value})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Cantidad"}),d.jsx("input",{type:"number",required:!0,step:"any",min:"0",placeholder:"0.00",className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.quantity,onChange:z=>S({...k,quantity:z.target.value})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Precio de Compra"}),d.jsx("input",{type:"number",required:!0,step:"any",min:"0",placeholder:"0.00",className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.buyPrice,onChange:z=>S({...k,buyPrice:z.target.value})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Moneda"}),d.jsxs("select",{className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.buyCurrency,onChange:z=>S({...k,buyCurrency:z.target.value}),children:[d.jsx("option",{value:"USD",children:"USD"}),d.jsx("option",{value:"MXN",children:"MXN"}),d.jsx("option",{value:"EUR",children:"EUR"})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic",children:"Fecha de Compra"}),d.jsx("input",{type:"date",required:!0,className:"input-field !bg-slate-50 !border-none !font-black !py-5 !px-6 !rounded-[2rem]",value:k.buyDate,onChange:z=>S({...k,buyDate:z.target.value})})]})]}),d.jsx("button",{type:"submit",className:"w-full bg-emerald-600 text-white py-8 text-2xl font-black rounded-[4rem] shadow-2xl hover:scale-[1.02] transition-all duration-700",children:"Aadir Inversin"})]})]})]})}),d.jsx(pc,{children:h&&d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx(va.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-slate-900/80 backdrop-blur-xl",onClick:()=>m(!1)}),d.jsxs(va.div,{initial:{opacity:0,scale:.95,y:40},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:40},className:"relative bg-white rounded-[4rem] shadow-2xl w-full max-w-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[d.jsxs("div",{className:"px-12 py-8 border-b border-slate-50 flex items-center justify-between shrink-0 bg-slate-50/50",children:[d.jsx("h3",{className:"text-2xl font-black text-slate-900",children:"Configuracin de APIs"}),d.jsx("button",{onClick:()=>m(!1),className:"p-4 text-slate-400 hover:bg-white rounded-full transition-all shadow-sm",children:d.jsx(Qr,{size:32})})]}),d.jsxs("div",{className:"p-12 overflow-y-auto custom-scrollbar flex-1 space-y-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic flex items-center gap-2",children:["Finnhub API Key ",d.jsx("a",{href:"https://finnhub.io/register",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:d.jsx(vy,{size:12})})]}),d.jsx("input",{type:"text",placeholder:"Tu API key gratuita de Finnhub",className:"input-field !bg-slate-50 !border-none !font-mono !py-5 !px-6 !rounded-[2rem]",value:s.finnhub,onChange:z=>l({...s,finnhub:z.target.value})}),d.jsx("p",{className:"text-xs text-slate-500 italic px-2",children:"Requerida para obtener precios de acciones y ETFs. 60 llamadas/minuto gratis."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase px-2 italic flex items-center gap-2",children:["Alpha Vantage API Key (Opcional) ",d.jsx("a",{href:"https://www.alphavantage.co/support/#api-key",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:d.jsx(vy,{size:12})})]}),d.jsx("input",{type:"text",placeholder:"Fallback para acciones",className:"input-field !bg-slate-50 !border-none !font-mono !py-5 !px-6 !rounded-[2rem]",value:s.alphaVantage,onChange:z=>l({...s,alphaVantage:z.target.value})}),d.jsx("p",{className:"text-xs text-slate-500 italic px-2",children:"Usada como respaldo si Finnhub falla. 25 llamadas/da gratis."})]}),d.jsx("div",{className:"p-6 bg-blue-50 rounded-3xl border border-blue-100",children:d.jsxs("p",{className:"text-xs text-blue-900 font-bold",children:[d.jsx("strong",{children:"Nota:"})," Las criptomonedas usan CoinGecko (sin API key requerida). Tus claves se almacenan solo en tu navegador."]})})]})]})]})})]})};function ZU(){const[e,t]=ie.useState("dashboard"),[a,r]=ie.useState(!1),s=()=>r(!a),l=()=>{switch(e){case"dashboard":return d.jsx(Dy,{});case"budget":return d.jsx(tj,{});case"accounts":return d.jsx(UU,{});case"transactions":return d.jsx(zU,{});case"vehicles":return d.jsx(VU,{});case"medical":return d.jsx(HU,{});case"journal":return d.jsx($U,{});case"debts":return d.jsx(GU,{});case"investments":return d.jsx(QU,{});case"settings":return d.jsx(BU,{});default:return d.jsx(Dy,{})}};return d.jsxs("div",{className:"flex h-screen bg-[#f9fafb] overflow-hidden font-sans",children:[d.jsxs("header",{className:"lg:hidden fixed top-0 left-0 right-0 h-16 bg-white/80 backdrop-blur-md border-b border-slate-200/60 flex items-center justify-between px-6 z-50",children:[d.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"FinanzasPro"}),d.jsx("button",{onClick:s,className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors","aria-label":"Toggle Menu",children:a?d.jsx(Qr,{size:24}):d.jsx(RA,{size:24})})]}),a&&d.jsx("div",{className:"lg:hidden fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-40 transition-opacity",onClick:()=>r(!1)}),d.jsx("aside",{className:`
                fixed lg:static inset-y-0 left-0 w-72 bg-white border-r border-slate-200/60 z-40 transform transition-transform duration-300 ease-in-out
                ${a?"translate-x-0":"-translate-x-full lg:translate-x-0"}
            `,children:d.jsx(bN,{activeView:e,setActiveView:c=>{t(c),r(!1)}})}),d.jsx("main",{className:"flex-1 overflow-y-auto pt-16 lg:pt-0",children:d.jsx("div",{className:"max-w-7xl mx-auto p-6 md:p-10",children:d.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-700",children:l()})})})]})}F4.createRoot(document.getElementById("root")).render(d.jsx(A4.StrictMode,{children:d.jsx(ZU,{})}));
